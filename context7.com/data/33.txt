TITLE: yt-dlp Configuration File Example
DESCRIPTION: This configuration file demonstrates how to configure yt-dlp to always extract audio, prevent mtime copying, use a proxy, and save videos to a specific directory.  It shows the correct syntax for options within the file.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_8

LANGUAGE: none
CODE:
```
# Lines starting with # are comments

# Always extract audio
-x

# Do not copy the mtime
--no-mtime

# Use this proxy
--proxy 127.0.0.1:3128

# Save all videos under YouTube directory in your home directory
-o ~/YouTube/%(title)s.%(ext)s
```

----------------------------------------

TITLE: Download best video/audio formats (yt-dlp)
DESCRIPTION: Downloads and merges the best video-only and best audio-only formats, or downloads the best combined format if a video-only format isn't available. This is a common use case for obtaining the highest quality video and audio.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_44

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "bv+ba/b"
```

----------------------------------------

TITLE: Downloading Series Season with Nested Directories in yt-dlp
DESCRIPTION: This example demonstrates how to download an entire series season, creating nested directories for each series and season. It uses custom output paths and template variables like `series`, `season_number`, `season`, `episode_number`, and `episode` to structure the downloads.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_27

LANGUAGE: bash
CODE:
```
# Download entire series season keeping each series and each season in separate directory under C:/MyVideos
$ yt-dlp -P "C:/MyVideos" -o "%(series)s/%(season_number)s - %(season)s/%(episode_number)s - %(episode)s.%(ext)s" "https://videomore.ru/kino_v_detalyah/5_sezon/367617"
```

----------------------------------------

TITLE: Merging Video and Audio Formats with yt-dlp
DESCRIPTION: This command merges video and audio from separate formats into a single file using ffmpeg. The command downloads the best video-only format and the best audio-only format and muxes them together using ffmpeg. Requires ffmpeg to be installed.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_38

LANGUAGE: None
CODE:
```
-f bestvideo+bestaudio
```

----------------------------------------

TITLE: Extracting Video Information Python
DESCRIPTION: This snippet demonstrates how to extract video information without downloading the video.  It uses the `extract_info` method with the `download` parameter set to `False`. The extracted information is then sanitized using `ydl.sanitize_info` to make it JSON serializable before printing. Dependencies: yt_dlp, json.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_77

LANGUAGE: python
CODE:
```
import json
import yt_dlp

URL = 'https://www.youtube.com/watch?v=BaW_jenozKc'

# ℹ️ See help(yt_dlp.YoutubeDL) for a list of available options and public functions
ydl_opts = {}
with yt_dlp.YoutubeDL(ydl_opts) as ydl:
    info = ydl.extract_info(URL, download=False)

    # ℹ️ ydl.sanitize_info makes the info json-serializable
    print(json.dumps(ydl.sanitize_info(info)))
```

----------------------------------------

TITLE: Downloading Udemy Course with Chapter Directories in yt-dlp
DESCRIPTION: This example demonstrates how to download a Udemy course, organizing videos into separate directories for each chapter. It uses authentication credentials and custom output paths to organize the downloaded content under a "MyVideos" directory.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_26

LANGUAGE: bash
CODE:
```
# Download Udemy course keeping each chapter in separate directory under MyVideos directory in your home
$ yt-dlp -u user -p password -P "~/MyVideos" -o "%(playlist)s/%(chapter_number)s - %(chapter)s/%(title)s.%(ext)s" "https://www.udemy.com/java-tutorial"
```

----------------------------------------

TITLE: Embedding yt-dlp Basic Example Python
DESCRIPTION: This snippet demonstrates how to embed yt-dlp within a Python program for downloading videos. It initializes a YoutubeDL object and uses it to download videos from a list of URLs. It showcases the basic usage of the yt_dlp library.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_76

LANGUAGE: python
CODE:
```
from yt_dlp import YoutubeDL

URLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']
with YoutubeDL() as ydl:
    ydl.download(URLS)
```

----------------------------------------

TITLE: Adding Logger and Progress Hook Python
DESCRIPTION: This snippet demonstrates how to add a custom logger and progress hook to yt-dlp. It defines a `MyLogger` class with debug, info, warning, and error methods and a `my_hook` function that is called during the download process. These are then passed as 'logger' and 'progress_hooks' options to the YoutubeDL object. Dependency: yt_dlp.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_81

LANGUAGE: python
CODE:
```
import yt_dlp

URLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']

class MyLogger:
    def debug(self, msg):
        # For compatibility with youtube-dl, both debug and info are passed into debug
        # You can distinguish them by the prefix '[debug] '
        if msg.startswith('[debug] '):
            pass
        else:
            self.info(msg)

    def info(self, msg):
        pass

    def warning(self, msg):
        pass

    def error(self, msg):
        print(msg)


# ℹ️ See "progress_hooks" in help(yt_dlp.YoutubeDL)
def my_hook(d):
    if d['status'] == 'finished':
        print('Done downloading, now post-processing ...')


ydl_opts = {
    'logger': MyLogger(),
    'progress_hooks': [my_hook],
}

with yt_dlp.YoutubeDL(ydl_opts) as ydl:
    ydl.download(URLS)
```

----------------------------------------

TITLE: Verifying SHA checksums using GPG
DESCRIPTION: This snippet demonstrates how to verify the SHA256 and SHA512 checksums of the yt-dlp release files using GPG.  It first imports the public key, then uses the `gpg --verify` command to check the signatures against the checksum files. This ensures the integrity and authenticity of the downloaded files.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_0

LANGUAGE: shell
CODE:
```
curl -L https://github.com/yt-dlp/yt-dlp/raw/master/public.key | gpg --import
gpg --verify SHA2-256SUMS.sig SHA2-256SUMS
gpg --verify SHA2-512SUMS.sig SHA2-512SUMS
```

----------------------------------------

TITLE: Iterating Over Data: Handling None Values
DESCRIPTION: This snippet illustrates how to safely iterate over a list that might be `None` by using `or []` to provide an empty list as a fallback. This prevents `TypeError` exceptions during iteration.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_22

LANGUAGE: python
CODE:
```
thumbnail_data = data.get('thumbnails') or []
thumbnails = [{
    'url': item['url'],
    'height': item.get('h'),
} for item in thumbnail_data if item.get('url')]  # correct
```

----------------------------------------

TITLE: Install Nightly Channel (pip)
DESCRIPTION: This command installs the nightly release of yt-dlp using pip. It is the recommended way to install or update yt-dlp to the nightly channel. It leverages pip's `--pre` flag to install pre-release versions.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_2

LANGUAGE: Shell
CODE:
```
python3 -m pip install -U --pre "yt-dlp[default]"
```

----------------------------------------

TITLE: Streaming Downloaded Video to Standard Output in yt-dlp
DESCRIPTION: This example demonstrates how to stream the downloaded video directly to standard output.  The `-o -` option instructs yt-dlp to write the video data to stdout instead of a file.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_30

LANGUAGE: bash
CODE:
```
# Stream the video being downloaded to stdout
$ yt-dlp -o - BaW_jenozKc
```

----------------------------------------

TITLE: Correct Regular Expression: Non-Capturing Groups
DESCRIPTION: This snippet demonstrates the correct use of non-capturing groups `(?:...)` in regular expressions.  Unnecessary capturing groups should be avoided for clarity and efficiency.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_27

LANGUAGE: python
CODE:
```
r'(?:id|ID)=(?P<id>\d+)'
```

----------------------------------------

TITLE: Download video and audio separately (yt-dlp)
DESCRIPTION: Downloads the best video-only and best audio-only formats without merging them. An output template should be used since bestvideo and bestaudio will have the same file name. The `-o` option specifies the output filename using the title, format ID, and extension.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_46

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "bv,ba" -o "%(title)s.f%(format_id)s.%(ext)s"
```

----------------------------------------

TITLE: Safely Extracting Data from a Dictionary
DESCRIPTION: This snippet shows the correct way to extract data from a dictionary in yt-dlp, using the `.get()` method to avoid `KeyError` exceptions if the key is missing.  This is especially important for optional metadata fields.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_16

LANGUAGE: python
CODE:
```
description = meta.get('summary')  # correct
```

----------------------------------------

TITLE: yt-dlp Single File Download Example
DESCRIPTION: This command downloads a single video file from the specified URL and saves it with the name 'funny_video.flv'. Note that hard-coding the file extension is not recommended.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_15

LANGUAGE: bash
CODE:
```
yt-dlp -o funny_video.flv "https://some/video"
```

----------------------------------------

TITLE: Selecting a Specific Format by ID with yt-dlp
DESCRIPTION: This command downloads a specific format from a video using its format ID. The format ID can be obtained using `--list-formats` or `-F` options. The selected format depends on the available formats provided by the extractor for the specific video.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_31

LANGUAGE: None
CODE:
```
-f 22
```

----------------------------------------

TITLE: yt-dlp Verbose Output Command
DESCRIPTION: This code snippet shows how to run yt-dlp with verbose output and update flag (`-vU`). The output contains debugging information and is essential for bug reports.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_0

LANGUAGE: shell
CODE:
```
$ yt-dlp -vU <your command line>
```

----------------------------------------

TITLE: Modifying Metadata: Set title as Series name S01E05 (Bash)
DESCRIPTION: This command constructs the title field based on series name, season number, and episode number, using a formatted string. It utilizes the `series`, `season_number`, and `episode_number` fields to generate the title.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_70

LANGUAGE: bash
CODE:
```
$ yt-dlp --parse-metadata "%(series)s S%(season_number)02dE%(episode_number)02d:%(title)s"
```

----------------------------------------

TITLE: Safely Extracting Nested Data with traverse_obj
DESCRIPTION: This example demonstrates how to use `traverse_obj` to safely extract nested data from a dictionary in yt-dlp, avoiding potential `KeyError` exceptions. `traverse_obj` gracefully handles missing keys by returning `None`.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_18

LANGUAGE: python
CODE:
```
uploader = traverse_obj(meta, ('user', 'name'))  # correct
```

----------------------------------------

TITLE: Download smallest resolution video >= 480p (yt-dlp)
DESCRIPTION: Downloads the video with smallest resolution no worse than 480p, or the video with the largest resolution available if there is no such video, preferring better codec and then larger total bitrate for the same resolution. Uses format sorting.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_67

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "+res:480,codec,br"
```

----------------------------------------

TITLE: Using --netrc-cmd with gpg for Authentication (bash)
DESCRIPTION: This example demonstrates how to use the `--netrc-cmd` option to decrypt an encrypted .netrc file (`.authinfo.gpg`) using `gpg`. This enhances security by storing credentials in an encrypted format.  The command decrypts the file on the fly when yt-dlp requires the credentials.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_14

LANGUAGE: bash
CODE:
```
yt-dlp --netrc-cmd 'gpg --decrypt ~/.authinfo.gpg' 'https://www.youtube.com/watch?v=BaW_jenozKc'
```

----------------------------------------

TITLE: Printing Restricted Filename with Title and Extension in yt-dlp
DESCRIPTION: This example demonstrates how to use yt-dlp to print the filename using the video title and extension, while also restricting the filename to remove special characters. The `--restrict-filenames` flag ensures a safer filename across different filesystems.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_21

LANGUAGE: bash
CODE:
```
$ yt-dlp --print filename -o "%(title)s.%(ext)s" BaW_jenozKc --restrict-filenames
youtube-dl_test_video_.webm    # Restricted file name
```

----------------------------------------

TITLE: Selecting the n'th Best Format with yt-dlp
DESCRIPTION: This command downloads the n'th best format of a specific type.  For example, `best.2` selects the 2nd best combined format, and `bv*.3` selects the 3rd best format containing a video stream.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_35

LANGUAGE: None
CODE:
```
best.2
```

LANGUAGE: None
CODE:
```
bv*.3
```

----------------------------------------

TITLE: Download largest resolution video <= 720p (yt-dlp)
DESCRIPTION: Downloads the video with the largest resolution no better than 720p, or the video with the smallest resolution available if there is no such video, preferring larger framerate for formats with the same resolution. Uses format sorting.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_66

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "res:720,fps"
```

----------------------------------------

TITLE: Download best video with h264 or better codec (yt-dlp)
DESCRIPTION: Downloads the best video with worst codec no worse than h264, or the best video with best codec if there is no such video. Uses format sorting with codec and a minimum preference.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_64

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "+codec:h264"
```

----------------------------------------

TITLE: Download best video with largest resolution under 480p (yt-dlp)
DESCRIPTION: Downloads the best video available with the largest resolution but no better than 480p, or the best video with the smallest resolution if there is no video under 480p. `res:480` sets the maximum resolution.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_56

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "res:480"
```

----------------------------------------

TITLE: Download largest video under 50MB (yt-dlp)
DESCRIPTION: Downloads the largest video (that also has audio) but no bigger than 50 MB, or the smallest video (that also has audio) if there is no video under 50 MB. Uses format sorting rather than format selection.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_58

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "b" -S "filesize:50M"
```

----------------------------------------

TITLE: Filtering All Audio-Only Formats with yt-dlp
DESCRIPTION: This command uses the `all` selector to download all audio-only formats available for a video. It filters formats where the video codec is none.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_42

LANGUAGE: None
CODE:
```
-f "all[vcodec=none]"
```

----------------------------------------

TITLE: Downloading Video and Subtitles with Nested Uploader Directories in yt-dlp
DESCRIPTION: This example demonstrates downloading a video and its subtitles, creating a nested directory structure that includes the uploader. The video is stored directly under the uploader's directory, while the subtitles are placed in a "subs" subdirectory within the uploader's directory.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_29

LANGUAGE: bash
CODE:
```
# Download video as "C:\MyVideos\uploader\title.ext" and subtitles as "C:\MyVideos\uploader\subs\title.ext"
$ yt-dlp -P "C:/MyVideos" -o "%(uploader)s/%(title)s.%(ext)s" -o "subtitle:%(uploader)s/subs/%(title)s.%(ext)s" BaW_jenozKc --write-subs
```

----------------------------------------

TITLE: Download video closest to 50MB (yt-dlp)
DESCRIPTION: Downloads the best video (that also has audio) that is closest in size to 50 MB. `filesize~50M` prefers formats with a filesize closest to 50 MB.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_59

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "b" -S "filesize~50M"
```

----------------------------------------

TITLE: yt-dlp Output and Thumbnail Template Example
DESCRIPTION: This example shows how to set different output templates for the video and its thumbnail using the `-o` option. The video is saved with a filename based on its title and extension, while the thumbnail is saved in a folder named after the video.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_17

LANGUAGE: bash
CODE:
```
-o "%(title)s.%(ext)s" -o "thumbnail:%(title)s\%(title)s.%(ext)s"
```

----------------------------------------

TITLE: Downloading Multiple Formats with yt-dlp
DESCRIPTION: This command downloads multiple formats of the same video using a comma as a separator. All specified formats will be downloaded if they are available. It can be combined with the precedence feature to create more sophisticated format selections.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_37

LANGUAGE: None
CODE:
```
-f 22,17,18
```

LANGUAGE: None
CODE:
```
-f 136/137/mp4/bestvideo,140/m4a/bestaudio
```

----------------------------------------

TITLE: Downloading Video and Subtitles to Separate Directories in yt-dlp
DESCRIPTION: This example showcases how to download a video and its subtitles into separate directories using yt-dlp. It leverages the `-P` option to specify different output paths for the video and subtitles and an additional temporary directory.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_28

LANGUAGE: bash
CODE:
```
# Download video as "C:\MyVideos\uploader\title.ext", subtitles as "C:\MyVideos\subs\uploader\title.ext"
# and put all temporary files in "C:\MyVideos\tmp"
$ yt-dlp -P "C:/MyVideos" -P "temp:tmp" -P "subtitle:subs" -o "%(uploader)s/%(title)s.%(ext)s" BaW_jenozKc --write-subs
```

----------------------------------------

TITLE: YouTube .netrc Entry Example
DESCRIPTION: An example demonstrating how to configure a YouTube account inside the .netrc file. Substitute `myaccount@gmail.com` and `my_youtube_password` with your actual credentials. This entry tells yt-dlp how to automatically log in to YouTube.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_12

LANGUAGE: None
CODE:
```
machine youtube login myaccount@gmail.com password my_youtube_password
```

----------------------------------------

TITLE: Twitch .netrc Entry Example
DESCRIPTION: This example illustrates the format for storing Twitch credentials in the .netrc file. Replace `my_twitch_account_name` and `my_twitch_password` with your actual Twitch username and password. This enables yt-dlp to automatically authenticate with Twitch.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_13

LANGUAGE: None
CODE:
```
machine twitch login my_twitch_account_name password my_twitch_password
```

----------------------------------------

TITLE: Example .netrc Credentials Configuration
DESCRIPTION: This example shows how to format credentials within the .netrc file for YouTube and Twitch extractors. Replace `<extractor>`, `<username>`, and `<password>` with the appropriate values. The extractor name should be in lowercase.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_11

LANGUAGE: None
CODE:
```
machine <extractor> login <username> password <password>
```

----------------------------------------

TITLE: yt-dlp Thumbnail Template Example
DESCRIPTION: This example demonstrates how to disable thumbnail writing for videos but enable it for playlists. By setting the thumbnail template to empty, thumbnails will only be written for playlists.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_18

LANGUAGE: bash
CODE:
```
--write-thumbnail -o "thumbnail:"
```

----------------------------------------

TITLE: Interactive Format Selection with yt-dlp
DESCRIPTION: This command allows the user to interactively provide the format selector for each video being downloaded. It is useful when different videos have different available formats and the desired format is not known in advance.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_33

LANGUAGE: None
CODE:
```
-f -
```

----------------------------------------

TITLE: Combining Format Filters with yt-dlp
DESCRIPTION: This command demonstrates combining format filters. It selects up to 720p videos (or videos where the height is unknown) with a bitrate of at least 500 kbps.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_41

LANGUAGE: None
CODE:
```
-f "bv[height<=?720][tbr>500]"
```

----------------------------------------

TITLE: Prefixing Playlist Index with Separator in yt-dlp
DESCRIPTION: This example demonstrates how to conditionally prefix the playlist index with a separator ( " - ") only when it is available. It uses the `%(playlist_index&{} - |)s` template to handle cases where playlist index might not be present.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_24

LANGUAGE: bash
CODE:
```
# Prefix playlist index with " - " separator, but only if it is available
$ yt-dlp -o "%(playlist_index&{} - |)s%(title)s.%(ext)s" BaW_jenozKc "https://www.youtube.com/user/TheLinuxFoundation/playlists"
```

----------------------------------------

TITLE: Filtering Formats by Height with yt-dlp
DESCRIPTION: This command filters video formats based on their height.  It selects the best format with a height equal to 720p. Filters without a selector are interpreted as `best`.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_39

LANGUAGE: None
CODE:
```
-f "best[height=720]"
```

----------------------------------------

TITLE: Download best video with best extension (yt-dlp)
DESCRIPTION: Downloads the best video with the best extension. The `-S "ext"` option sorts formats based on extension, prioritizing mp4, mov, webm, and flv for video, and m4a, aac, mp3 for audio.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_53

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "ext"
```

----------------------------------------

TITLE: Update to Nightly Channel (yt-dlp)
DESCRIPTION: This command updates yt-dlp to the nightly release channel. It is used when the user has a stable executable/binary. This provides access to the latest fixes and features, though it may be less stable.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_1

LANGUAGE: Shell
CODE:
```
yt-dlp --update-to nightly
```

----------------------------------------

TITLE: Inline Value Assignment (Correct)
DESCRIPTION: This example demonstrates the correct way to assign a value directly within a return statement for better code readability when the variable is only used once.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_43

LANGUAGE: python
CODE:
```
return {
    'title': self._html_search_regex(r'<h1>([^<]+)</h1>', webpage, 'title'),
    # ...some lines of code...
}
```

----------------------------------------

TITLE: Using a Custom Format Selector Python
DESCRIPTION: This snippet demonstrates how to use a custom format selector in yt-dlp. It defines a `format_selector` function that selects the best video and audio formats that won't result in an mkv. This function is then passed as the 'format' option to the YoutubeDL object. The example provides a basic selection logic that prioritizes video without audio and audio without video, ensuring compatibility by matching extensions. Dependency: yt_dlp.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_83

LANGUAGE: python
CODE:
```
import yt_dlp

URLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']

def format_selector(ctx):
    """ Select the best video and the best audio that won't result in an mkv.
    NOTE: This is just an example and does not handle all cases """

    # formats are already sorted worst to best
    formats = ctx.get('formats')[::-1]

    # acodec='none' means there is no audio
    best_video = next(f for f in formats
                      if f['vcodec'] != 'none' and f['acodec'] == 'none')

    # find compatible audio extension
    audio_ext = {'mp4': 'm4a', 'webm': 'webm'}[best_video['ext']]
    # vcodec='none' means there is no video
    best_audio = next(f for f in formats if (
        f['acodec'] != 'none' and f['vcodec'] == 'none' and f['ext'] == audio_ext))

    # These are the minimum required fields for a merged format
    yield {
        'format_id': f'{best_video["format_id"]}+{best_audio["format_id"]}',
        'ext': best_video['ext'],
        'requested_formats': [best_video, best_audio],
        # Must be + separated list of protocols
        'protocol': f'{best_video["protocol"]}+{best_audio["protocol"]}'
    }


ydl_opts = {
    'format': format_selector,
}

with yt_dlp.YoutubeDL(ydl_opts) as ydl:
    ydl.download(URLS)
```

----------------------------------------

TITLE: Filtering Formats by Filesize with yt-dlp
DESCRIPTION: This command filters video formats based on their filesize. It selects the best format with a filesize greater than 10MB. Filters without a selector are interpreted as `best`.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_40

LANGUAGE: None
CODE:
```
-f "[filesize>10M]"
```

----------------------------------------

TITLE: Collapsing Fallback Values (Good)
DESCRIPTION: This example showcases a clean method for using a list of fallback values via the `_html_search_meta` function. It supports a list of keys, making the code concise and readable.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_45

LANGUAGE: python
CODE:
```
description = self._html_search_meta(
    ['og:description', 'description', 'twitter:description'],
    webpage, 'description', default=None)
```

----------------------------------------

TITLE: Download best video under 50MB (yt-dlp)
DESCRIPTION: Downloads the best video (that also has audio) but no bigger than 50 MB, or the worst video (that also has audio) if there is no video under 50 MB using format selection.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_57

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "b[filesize<50M] / w"
```

----------------------------------------

TITLE: Incorrectly Extracting Data from a Dictionary
DESCRIPTION: This code demonstrates the incorrect way to extract data from a dictionary, which will result in a `KeyError` if the key is not found.  It should be avoided when handling optional metadata.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_17

LANGUAGE: python
CODE:
```
description = meta['summary']  # incorrect
```

----------------------------------------

TITLE: Incorrectly Extracting Nested Data
DESCRIPTION: This snippet presents incorrect ways to access nested dictionary keys which would cause errors if any of the intermediate keys do not exist. Using direct indexing or nested `.get` calls is not robust.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_19

LANGUAGE: python
CODE:
```
uploader = meta['user']['name']  # incorrect
```

LANGUAGE: python
CODE:
```
uploader = meta.get('user', {}).get('name')  # incorrect
```

LANGUAGE: python
CODE:
```
uploader = try_get(meta, lambda x: x['user']['name'])  # old utility
```

----------------------------------------

TITLE: Collapsing Fallback Values (Unwieldy)
DESCRIPTION: This example shows an unwieldy way to handle multiple fallback values with chained `or` operators. The preferred approach uses a list of patterns instead.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_46

LANGUAGE: python
CODE:
```
description = (
    self._og_search_description(webpage, default=None)
    or self._html_search_meta('description', webpage, default=None)
    or self._html_search_meta('twitter:description', webpage, default=None))
```

----------------------------------------

TITLE: Searching Webpage Content with Regular Expressions
DESCRIPTION: This code snippet demonstrates how to use the `_search_regex` method with `fatal=False` to extract optional data from a webpage.  Setting `fatal=False` prevents the extraction process from halting if the regex doesn't find a match.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_20

LANGUAGE: python
CODE:
```
description = self._search_regex(
    r'<span[^>]+id="title"[^>]*>([^<]+)<',
    webpage, 'description', fatal=False)
```

----------------------------------------

TITLE: Trailing Parentheses (Incorrect)
DESCRIPTION: This example demonstrates the *incorrect* placement of trailing parentheses for grouping/functions when the arguments are written on multiple lines. The closing parenthesis should be on the same line as the last argument or indented to match the opening parenthesis.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_48

LANGUAGE: python
CODE:
```
url = traverse_obj(
    info,
    ('context', 'dispatcher', 'stores', 'VideoTitlePageStore', 'data', 'video', 0, 'VideoUrlSet', 'VideoUrl'),
    list
)
```

----------------------------------------

TITLE: Download best video under 480p (yt-dlp)
DESCRIPTION: Downloads the best video available but no better than 480p, or the worst video if there is no video under 480p. This example uses the older format selection method.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_54

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "bv*[height<=480]+ba/b[height<=480] / wv*+ba/w"
```

----------------------------------------

TITLE: Multiline Literal Dictionary (Incorrect)
DESCRIPTION: This example displays the incorrect method for creating multi-line dictionaries, where the closing curly brace isn't on a new line.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_50

LANGUAGE: python
CODE:
```
f = {'url': url,
     'format_id': format_id}
```

----------------------------------------

TITLE: Example yt-dlp Verbose Output
DESCRIPTION: This code snippet presents an example of the verbose output generated by yt-dlp when run with the `-vU` flag. It includes version information, Python details, optional libraries, and debugging information.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_1

LANGUAGE: text
CODE:
```
[debug] Command-line config: ['-vU', 'https://www.example.com/']
[debug] Encodings: locale cp65001, fs utf-8, pref cp65001, out utf-8, error utf-8, screen utf-8
[debug] yt-dlp version nightly@... from yt-dlp/yt-dlp-nightly-builds [1a176d874] (win_exe)
[debug] Python 3.10.11 (CPython AMD64 64bit) - Windows-10-10.0.20348-SP0 (OpenSSL 1.1.1t  7 Feb 2023)
[debug] exe versions: ffmpeg 7.0.2 (setts), ffprobe 7.0.2
[debug] Optional libraries: Cryptodome-3.21.0, brotli-1.1.0, certifi-2024.08.30, curl_cffi-0.5.10, mutagen-1.47.0, requests-2.32.3, sqlite3-3.40.1, urllib3-2.2.3, websockets-13.1
[debug] Proxy map: {}
[debug] Request Handlers: urllib, requests, websockets, curl_cffi
[debug] Loaded 1838 extractors
[debug] Fetching release info: https://api.github.com/repos/yt-dlp/yt-dlp/releases/latest
Latest version: nightly@... from yt-dlp/yt-dlp-nightly-builds
yt-dlp is up to date (nightly@... from yt-dlp/yt-dlp-nightly-builds)
...
```

----------------------------------------

TITLE: Utility Function Usage
DESCRIPTION: This snippet illustrates how to use convenience conversion and parsing functions from `yt_dlp/utils/`, such as `traverse_obj`, `float_or_none`, and `int_or_none`, for safe data handling.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_52

LANGUAGE: python
CODE:
```
description = traverse_obj(response, ('result', 'video', 'summary'), expected_type=str)
thumbnails = traverse_obj(response, ('result', 'thumbnails', ..., 'url'), expected_type=url_or_none)
video = traverse_obj(response, ('result', 'video', 0), default={}, expected_type=dict)
duration = float_or_none(video.get('durationMs'), scale=1000)
view_count = int_or_none(video.get('views'))
```

----------------------------------------

TITLE: Inline Value Assignment (Incorrect)
DESCRIPTION: This example showcases an incorrect approach where a variable is extracted unnecessarily and used in a distant part of the code, reducing readability.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_44

LANGUAGE: python
CODE:
```
TITLE_RE = r'<h1>([^<]+)</h1>'
# ...some lines of code...
title = self._html_search_regex(TITLE_RE, webpage, 'title')
# ...some lines of code...
return {
    'title': title,
    # ...some lines of code...
}
```

----------------------------------------

TITLE: Download best video and top two audio streams (yt-dlp)
DESCRIPTION: Downloads and merges the best format that has a video stream and the best 2 audio-only formats into one file.  The `--audio-multistreams` option is required to merge multiple audio streams. ba.2 will select the second best audio.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_48

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "bv*+ba+ba.2" --audio-multistreams
```

----------------------------------------

TITLE: Download best video with best protocol (yt-dlp)
DESCRIPTION: Downloads the best video available via the best protocol, where the best protocol is defined as https/ftps > http/ftp > m3u8_native > m3u8 > http_dash_segments. This uses format sorting.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_61

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "proto"
```

----------------------------------------

TITLE: Modifying Metadata: Regex example (Bash)
DESCRIPTION: This command parses the description field using a regular expression to extract the artist's name. The `(?P<artist>.+)` is a named capture group that captures any characters after 'Artist - ' and assigns it to the 'artist' field. This modifies the 'artist' metadata field of the video.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_69

LANGUAGE: bash
CODE:
```
$ yt-dlp --parse-metadata "description:Artist - (?P<artist>.+)"
```

----------------------------------------

TITLE: Modifying Metadata: Replace spaces and underscores (Bash)
DESCRIPTION: This command replaces all spaces and underscores in the title and uploader fields with hyphens. It utilizes the `--replace-in-metadata` option with a regular expression that matches either a space or an underscore. It applies this replacement to both the 'title' and 'uploader' fields.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_75

LANGUAGE: bash
CODE:
```
$ yt-dlp --replace-in-metadata "title,uploader" "[ _]" "-"
```

----------------------------------------

TITLE: Download best video via HTTP/HTTPS (yt-dlp)
DESCRIPTION: Downloads the best video available via direct link over HTTP/HTTPS protocol, or the best video available via any protocol if there is no such video. This uses format selection filters for protocol.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_60

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "(bv*+ba/b)[protocol^=http][protocol!*=dash] / (bv*+ba/b)"
```

----------------------------------------

TITLE: Modifying Metadata: Interpret Title as Artist - Title (Bash)
DESCRIPTION: This command interprets the title field as a combination of the artist and title, separated by a hyphen. It utilizes the `--parse-metadata` option with a template that extracts data from the 'artist' and 'title' fields. The resulting string becomes the new title.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_68

LANGUAGE: bash
CODE:
```
$ yt-dlp --parse-metadata "title:%(artist)s - %(title)s"
```

----------------------------------------

TITLE: Modifying Metadata: Remove formats from infojson (Bash)
DESCRIPTION: This command removes the 'formats' field from the infojson file generated by yt-dlp. By setting the `formats` field to an empty string, it effectively excludes the formats information from the JSON output. The `--write-info-json` flag is used to generate the infojson file.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_74

LANGUAGE: bash
CODE:
```
$ yt-dlp --parse-metadata "video::(?P<formats>)" --write-info-json
```

----------------------------------------

TITLE: Configuration File Encoding Declaration
DESCRIPTION: This snippet shows how to declare the encoding of a yt-dlp configuration file, useful when the default encoding is not sufficient. It must be the first line of the file.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_9

LANGUAGE: none
CODE:
```
# coding: ENCODING
```

----------------------------------------

TITLE: Modifying Metadata: Prioritize uploader as artist (Bash)
DESCRIPTION: This command prioritizes the uploader as the artist field in video metadata. It also embeds this modified metadata into the downloaded media file using the `--embed-metadata` flag. The `%(uploader|)s` part handles the case where the uploader field is empty.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_71

LANGUAGE: bash
CODE:
```
$ yt-dlp --parse-metadata "%(uploader|)s:%(meta_artist)s" --embed-metadata
```

----------------------------------------

TITLE: Filtering Videos Python
DESCRIPTION: This snippet demonstrates how to filter videos based on their duration before downloading. It defines a function `longer_than_a_minute` that checks if the video's duration is longer than a minute and returns a message if it's too short. This function is then used as a 'match_filter' option in the YoutubeDL object. Dependency: yt_dlp.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_80

LANGUAGE: python
CODE:
```
import yt_dlp

URLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']

def longer_than_a_minute(info, *, incomplete):
    """Download only videos longer than a minute (or with unknown duration)"""
    duration = info.get('duration')
    if duration and duration < 60:
        return 'The video is too short'

ydl_opts = {
    'match_filter': longer_than_a_minute,
}

with yt_dlp.YoutubeDL(ydl_opts) as ydl:
    error_code = ydl.download(URLS)
```

----------------------------------------

TITLE: Installing Editable Version with Dependencies
DESCRIPTION: This command installs an editable version of yt-dlp along with its default and development dependencies.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_4

LANGUAGE: shell
CODE:
```
$ python -m pip install -e ".[default,dev]"
```

----------------------------------------

TITLE: Checking code formatting
DESCRIPTION: Checks the code formatting of your extractor using hatch fmt. This ensures that your code follows the yt-dlp coding conventions.  It is crucial to pass this before submitting your changes. --check argument fails if there are formatting issues.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_12

LANGUAGE: shell
CODE:
```
$ hatch fmt --check
```

----------------------------------------

TITLE: Adding Custom PostProcessor Python
DESCRIPTION: This snippet demonstrates how to add a custom postprocessor to yt-dlp. It defines a `MyCustomPP` class that inherits from `yt_dlp.postprocessor.PostProcessor` and overrides the `run` method. This postprocessor is then added to the YoutubeDL object using the `add_post_processor` method. Dependency: yt_dlp.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_82

LANGUAGE: python
CODE:
```
import yt_dlp

URLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']

# ℹ️ See help(yt_dlp.postprocessor.PostProcessor)
class MyCustomPP(yt_dlp.postprocessor.PostProcessor):
    def run(self, info):
        self.to_screen('Doing stuff')
        return [], info


with yt_dlp.YoutubeDL() as ydl:
    # ℹ️ "when" can take any value in yt_dlp.utils.POSTPROCESS_WHEN
    ydl.add_post_processor(MyCustomPP(), when='pre_process')
    ydl.download(URLS)
```

----------------------------------------

TITLE: Correct Regular Expression: Flexible Matching
DESCRIPTION: This example illustrates a correct way to write flexible regular expressions that tolerate minor variations in the input. The expression accounts for variations in attributes while capturing desired data, using named groups for clarity.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_29

LANGUAGE: python
CODE:
```
title = self._search_regex(  # correct
    r'<span[^>]+class="title"[^>]*>([^<]+)', webpage, 'title')
```

LANGUAGE: python
CODE:
```
title = self._search_regex(  # correct
    r'<span[^>]+class=(["\'])title\1[^>]*>(?P<title>[^<]+)',
    webpage, 'title', group='title')
```

----------------------------------------

TITLE: Redundant Option Aliases in yt-dlp
DESCRIPTION: This snippet documents redundant options in yt-dlp and their equivalent alternatives. These options are still functional but can be replaced with the suggested alternatives for better clarity or compatibility. They primarily involve printing information, matching titles, setting view limits, user agent, referer, playlist options, and disabling colors.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_84

LANGUAGE: Text
CODE:
```
--get-description                --print description
--get-duration                   --print duration_string
--get-filename                   --print filename
--get-format                     --print format
--get-id                         --print id
--get-thumbnail                  --print thumbnail
-e, --get-title                  --print title
-g, --get-url                    --print urls
--match-title REGEX              --match-filters "title ~= (?i)REGEX"
--reject-title REGEX             --match-filters "title !~= (?i)REGEX"
--min-views COUNT                --match-filters "view_count >=? COUNT"
--max-views COUNT                --match-filters "view_count <=? COUNT"
--break-on-reject                Use --break-match-filters
--user-agent UA                  --add-headers "User-Agent:UA"
--referer URL                    --add-headers "Referer:URL"
--playlist-start NUMBER          -I NUMBER:
--playlist-end NUMBER            -I :NUMBER
--playlist-reverse               -I ::-1
--no-playlist-reverse            Default
--no-colors                      --color no_color
```

----------------------------------------

TITLE: Running Hatch Setup
DESCRIPTION: This command installs a pre-commit hook that performs linting and formatting checks before each commit. If any issues are found, the commit will be blocked, and the necessary changes will be made.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_2

LANGUAGE: shell
CODE:
```
$ hatch run setup
```

----------------------------------------

TITLE: Installing Pre-commit Hook
DESCRIPTION: This command installs the pre-commit hook to ensure code quality and style consistency.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_5

LANGUAGE: shell
CODE:
```
$ pre-commit install
```

----------------------------------------

TITLE: Installing Development Dependencies
DESCRIPTION: This command installs only the development dependencies required for yt-dlp.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_3

LANGUAGE: shell
CODE:
```
$ python -m devscripts.install_deps --include dev
```

----------------------------------------

TITLE: Downloading YouTube Playlist Videos in Separate Directories in yt-dlp
DESCRIPTION: This example demonstrates how to download YouTube playlist videos into separate directories, indexed by their order within the playlist. It uses output template variables like `playlist`, `playlist_index`, and `title` to construct the directory structure and filenames.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_22

LANGUAGE: bash
CODE:
```
# Download YouTube playlist videos in separate directory indexed by video order in a playlist
$ yt-dlp -o "%(playlist)s/%(playlist_index)s - %(title)s.%(ext)s" "https://www.youtube.com/playlist?list=PLwiyx1dc3P2JR9N8gQaQN_BCvlSlap7re"
```

----------------------------------------

TITLE: Download using info-json Python
DESCRIPTION: This snippet shows how to download a video using a pre-existing info-json file. It initializes a YoutubeDL object and uses the `download_with_info_file` method to download the video.  The snippet checks for errors during the download process and prints a message indicating success or failure. Dependency: yt_dlp.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_78

LANGUAGE: python
CODE:
```
import yt_dlp

INFO_FILE = 'path/to/video.info.json'

with yt_dlp.YoutubeDL() as ydl:
    error_code = ydl.download_with_info_file(INFO_FILE)

print('Some videos failed to download' if error_code
      else 'All videos successfully downloaded')
```

----------------------------------------

TITLE: Extract Audio Python
DESCRIPTION: This snippet demonstrates how to extract audio from a video using yt-dlp. It sets the 'format' option to select the best audio format and uses a postprocessor to extract the audio using ffmpeg. Dependencies: yt_dlp, FFmpeg.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_79

LANGUAGE: python
CODE:
```
import yt_dlp

URLS = ['https://www.youtube.com/watch?v=BaW_jenozKc']

ydl_opts = {
    'format': 'm4a/bestaudio/best',
    # ℹ️ See help(yt_dlp.postprocessor) for a list of available Postprocessors and their arguments
    'postprocessors': [{  # Extract audio using ffmpeg
        'key': 'FFmpegExtractAudio',
        'preferredcodec': 'm4a',
    }]
}

with yt_dlp.YoutubeDL(ydl_opts) as ydl:
    error_code = ydl.download(URLS)
```

----------------------------------------

TITLE: Modifying Metadata: Set comment field using description (Bash)
DESCRIPTION: This command sets the "comment" field in the video metadata to the description of the video. The `(?s)` flag in the regular expression enables dotall mode, allowing the dot (.) to match newline characters. It also embeds the modified metadata into the downloaded media file.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_72

LANGUAGE: bash
CODE:
```
$ yt-dlp --parse-metadata "description:(?s)(?P<meta_comment>.+)" --embed-metadata
```

----------------------------------------

TITLE: Cloning yt-dlp repository
DESCRIPTION: Clones the yt-dlp repository to your local machine. Replace YOUR_GITHUB_USERNAME with your actual GitHub username.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_9

LANGUAGE: shell
CODE:
```
$ git clone git@github.com:YOUR_GITHUB_USERNAME/yt-dlp.git
```

----------------------------------------

TITLE: Creating and Securing .netrc File (bash)
DESCRIPTION: This snippet demonstrates how to create a .netrc file and set its permissions to restrict access, enhancing security. This ensures only the user can read and write to the file, which stores sensitive credentials.  It uses `touch` to create the file and `chmod` to modify the file permissions.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_10

LANGUAGE: bash
CODE:
```
touch ${HOME}/.netrc
chmod a-rwx,u+rw ${HOME}/.netrc
```

----------------------------------------

TITLE: Correct Regular Expression: Specificity and Quantifiers
DESCRIPTION: This code demonstrates the correct way to use specific characters and quantifiers in regular expressions, preventing over-matching and potential catastrophic backtracking. `[^<]+` is preferred over `.+?`.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_34

LANGUAGE: python
CODE:
```
title = self._search_regex(r'<span\b[^>]+class="title"[^>]*>([^<]+)', webpage, 'title')
```

----------------------------------------

TITLE: Old Aliases in yt-dlp
DESCRIPTION: This snippet lists older aliases of yt-dlp options that are no longer documented and the current equivalents. These aliases have been updated or replaced by newer options. The old aliases involve options such as avconv location, clean infojson, CN verification proxy, dump headers, force write download archive, load info, prefer unsecure, rate limit, split tracks, SRT language, and trim file names.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_87

LANGUAGE: Text
CODE:
```
--avconv-location                --ffmpeg-location
--clean-infojson                 --clean-info-json
--cn-verification-proxy URL      --geo-verification-proxy URL
--dump-headers                   --print-traffic
--dump-intermediate-pages        --dump-pages
--force-write-download-archive   --force-write-archive
--load-info                      --load-info-json
--no-clean-infojson              --no-clean-info-json
--no-split-tracks                --no-split-chapters
--no-write-srt                   --no-write-subs
--prefer-unsecure                --prefer-insecure
--rate-limit RATE                --limit-rate RATE
--split-tracks                   --split-chapters
--srt-lang LANGS                 --sub-langs LANGS
--trim-file-names LENGTH         --trim-filenames LENGTH
--write-srt                      --write-subs
--yes-overwrites                 --force-overwrites
```

----------------------------------------

TITLE: Sponskrub Option Aliases in yt-dlp
DESCRIPTION: This snippet lists deprecated Sponskrub options and their corresponding `--sponsorblock` equivalents in yt-dlp. The Sponskrub integration has been superseded by native Sponsorblock support.  These options pertain to marking and removing sponsor segments in downloaded videos.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_88

LANGUAGE: Text
CODE:
```
--sponskrub                      --sponsorblock-mark all
--no-sponskrub                   --no-sponsorblock
--sponskrub-cut                  --sponsorblock-remove all
--no-sponskrub-cut               --sponsorblock-remove -all
--sponskrub-force                Not applicable
--no-sponskrub-force             Not applicable
--sponskrub-location             Not applicable
--sponskrub-args                 Not applicable
```

----------------------------------------

TITLE: Creating a new git branch
DESCRIPTION: Creates a new git branch for your new extractor.  This keeps your changes isolated from the main development branch. Replace yourextractor with the name of your extractor.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_10

LANGUAGE: shell
CODE:
```
$ cd yt-dlp
$ git checkout -b yourextractor
```

----------------------------------------

TITLE: Downloading YouTube Playlist Videos in Year-Based Directories in yt-dlp
DESCRIPTION: This example demonstrates how to download YouTube playlist videos into separate directories based on their upload year. It utilizes the `upload_date` variable with formatting to extract the year and create the appropriate directory structure.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_23

LANGUAGE: bash
CODE:
```
# Download YouTube playlist videos in separate directories according to their uploaded year
$ yt-dlp -o "%(upload_date>%Y)s/%(title)s.%(ext)s" "https://www.youtube.com/playlist?list=PLwiyx1dc3P2JR9N8gQaQN_BCvlSlap7re"
```

----------------------------------------

TITLE: Output Template Field Syntax
DESCRIPTION: This example shows the general syntax for output template fields in yt-dlp. It includes various components such as name, keys, addition, strftime formatting, alternate fields, replacement, default values, flags, width, precision, length and type.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_16

LANGUAGE: text
CODE:
```
%(name[.keys][addition][>strf][,alternate][&replacement][|default])[flags][width][.precision][length]type
```

----------------------------------------

TITLE: Downloading All Playlists in Separate Directories by Uploader in yt-dlp
DESCRIPTION: This example demonstrates how to download all playlists from a YouTube channel or user, keeping each playlist in a separate directory named after the playlist. The directory structure includes the uploader and playlist name for organization.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_25

LANGUAGE: bash
CODE:
```
# Download all playlists of YouTube channel/user keeping each playlist in separate directory:
$ yt-dlp -o "%(uploader)s/%(playlist)s/%(playlist_index)s - %(title)s.%(ext)s" "https://www.youtube.com/user/TheLinuxFoundation/playlists"
```

----------------------------------------

TITLE: Building with PyInstaller - Python
DESCRIPTION: This command uses the bundle.pyinstaller script to build the standalone executable of yt-dlp using pyinstaller.  It accepts arguments that can be passed to pyinstaller, such as --onefile or --onedir. Using `python -m bundle.pyinstaller` is the official and supported way to use PyInstaller.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_5

LANGUAGE: python
CODE:
```
python3 -m bundle.pyinstaller
```

----------------------------------------

TITLE: Download best video <= 720p, preferring >30fps (yt-dlp)
DESCRIPTION: Downloads the best video no better than 720p preferring framerate greater than 30, or the worst video (still preferring framerate greater than 30) if there is no such video. Uses complex format selection.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_65

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "((bv*[fps>30]/bv*)[height<=720]/(wv*[fps>30]/wv*)) + ba / (b[fps>30]/b)[height<=720]/(w[fps>30]/w)"
```

----------------------------------------

TITLE: Local parameters JSON example
DESCRIPTION: Example of a `test/local_parameters.json` file for storing login credentials or other sensitive information for testing extractors that require authentication. This avoids hardcoding credentials in the extractor code.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_14

LANGUAGE: json
CODE:
```
{
    "username": "your user name",
    "password": "your password"
}
```

----------------------------------------

TITLE: Printing Filename with Literal Name and Extension in yt-dlp
DESCRIPTION: This example demonstrates how to use yt-dlp to print the filename of a video while specifying a literal name and extension in the output template. It showcases basic output template usage with a fixed filename and the correct extension.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_19

LANGUAGE: bash
CODE:
```
$ yt-dlp --print filename -o "test video.%(ext)s" BaW_jenozKc
test video.webm    # Literal name with correct extension
```

----------------------------------------

TITLE: Modifying Metadata: Do not set synopsis (Bash)
DESCRIPTION: This command removes the synopsis metadata field by setting it to an empty string. This effectively prevents any synopsis from being written to the media file's metadata. The `:""` part sets the corresponding field to an empty string.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_73

LANGUAGE: bash
CODE:
```
$ yt-dlp --parse-metadata ":(?P<meta_synopsis>)"
```

----------------------------------------

TITLE: Selecting a Format by File Extension with yt-dlp
DESCRIPTION: This command downloads the best quality format of a specific file extension served as a single file. The supported file extensions are 3gp, aac, flv, m4a, mp3, mp4, ogg, wav, and webm.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_32

LANGUAGE: None
CODE:
```
-f webm
```

----------------------------------------

TITLE: Printing Filename with Title and Extension in yt-dlp
DESCRIPTION: This example demonstrates how to use yt-dlp to print the filename using the video title and extension. It shows how to incorporate metadata fields into the output filename using template variables.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_20

LANGUAGE: bash
CODE:
```
$ yt-dlp --print filename -o "%(title)s.%(ext)s" BaW_jenozKc
youtube-dl test video ''_ä↭𝕐.webm    # All kinds of weird characters
```

----------------------------------------

TITLE: Selecting Worst Quality Video-Only Format with yt-dlp
DESCRIPTION: This command downloads the worst quality video-only format. It is generally recommended to use `-S +size` or `-S +size,+br,+res,+fps` instead of `-f worstvideo` for more control over the selection criteria.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_34

LANGUAGE: None
CODE:
```
-f worstvideo
```

----------------------------------------

TITLE: Prioritizing Formats with yt-dlp
DESCRIPTION: This command downloads formats based on a preference order specified by slashes. The formats on the left side of the slash are preferred over the formats on the right side. If none of the specified formats are available, yt-dlp will complain that no suitable formats are available.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_36

LANGUAGE: None
CODE:
```
-f 22/17/18
```

----------------------------------------

TITLE: Download best video and all audio streams (yt-dlp)
DESCRIPTION: Downloads and merges the best format that has a video stream and all audio-only formats into one file. The `--audio-multistreams` option is required to merge multiple audio streams.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_47

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "bv*+mergeall[vcodec=none]" --audio-multistreams
```

----------------------------------------

TITLE: Download best video with h264/h265 codec (yt-dlp)
DESCRIPTION: Downloads the best video with either h264 or h265 codec, or the best video if there is no such video. This uses a regex to match vcodec against the desired codec types.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_62

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "(bv*[vcodec~='^((he|a)vc|h26[45])']+ba) / (bv*+ba/b)"
```

----------------------------------------

TITLE: Further Simplification of Iteration with traverse_obj
DESCRIPTION: This code shows how `traverse_obj` can be used to simplify the extraction of a list of thumbnails, mapping the original keys to the new info dict keys. It provides a concise and readable way to handle optional data.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_25

LANGUAGE: python
CODE:
```
thumbnails = traverse_obj(data, ('thumbnails', ..., {'url': 'url', 'height': 'h'}))
```

----------------------------------------

TITLE: Download best video with best audio (yt-dlp)
DESCRIPTION: Downloads the best video format that contains video, and if it doesn't already have an audio stream, merges it with the best audio-only format. `bv*+ba/b` is equivalent to `yt-dlp` alone.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_45

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "bv*+ba/b"
```

LANGUAGE: bash
CODE:
```
$ yt-dlp
```

----------------------------------------

TITLE: Download best video with largest height under 480p (yt-dlp)
DESCRIPTION: Downloads the best video available with the largest height but no better than 480p, or the best video with the smallest resolution if there is no video under 480p. `height:480` specifies the maximum height.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_55

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "height:480"
```

----------------------------------------

TITLE: Simplified Iteration with traverse_obj
DESCRIPTION: This example shows a simplified and safer way to iterate over nested data using `traverse_obj`, preventing potential `TypeError` exceptions when the data might be missing. It only yields objects that contain a 'url' key.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_24

LANGUAGE: python
CODE:
```
thumbnails = [{
    'url': item['url'],
    'height': item.get('h'),
} for item in traverse_obj(data, ('thumbnails', lambda _, v: v['url']))]
```

----------------------------------------

TITLE: Download best mp4 video or best available (yt-dlp)
DESCRIPTION: Downloads the best MP4 video available, or the best video if no MP4 is available.  This leverages format selection logic to try for the desired container first.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_52

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "bv*[ext=mp4]+ba[ext=m4a]/b[ext=mp4] / bv*+ba/b"
```

----------------------------------------

TITLE: Download best video with h264 codec (yt-dlp)
DESCRIPTION: Downloads the best video with best codec no better than h264, or the best video with worst codec if there is no such video.  Uses format sorting with codec and a maximum preference.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_63

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "codec:h264"
```

----------------------------------------

TITLE: Creating a new extractor template
DESCRIPTION: Creates a new extractor using a simple template. This template includes the basic structure for a new extractor, including the necessary imports, class definition, URL pattern, and test data. Replace YourExtractor with the actual name you have chosen for your extractor.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_11

LANGUAGE: python
CODE:
```
from .common import InfoExtractor


class YourExtractorIE(InfoExtractor):
    _VALID_URL = r'https?://(?:www\.)?yourextractor\.com/watch/(?P<id>[0-9]+)'
    _TESTS = [{
        'url': 'https://yourextractor.com/watch/42',
        'md5': 'TODO: md5 sum of the first 10241 bytes of the video file (use --test)',
        'info_dict': {
            # For videos, only the 'id' and 'ext' fields are required to RUN the test:
            'id': '42',
            'ext': 'mp4',
            # Then if the test run fails, it will output the missing/incorrect fields.
            # Properties can be added as:
            # * A value, e.g.
            #     'title': 'Video title goes here',
            # * MD5 checksum; start the string with 'md5:', e.g.
            #     'description': 'md5:098f6bcd4621d373cade4e832627b4f6',
            # * A regular expression; start the string with 're:', e.g.
            #     'thumbnail': r're:https?://.*\.jpg$',
            # * A count of elements in a list; start the string with 'count:', e.g.
            #     'tags': 'count:10',
            # * Any Python type, e.g.
            #     'view_count': int,
        }
    }]

    def _real_extract(self, url):
        video_id = self._match_id(url)
        webpage = self._download_webpage(url, video_id)

        # TODO more code goes here, for example ...
        title = self._html_search_regex(r'<h1>(.+?)</h1>', webpage, 'title')

        return {
            'id': video_id,
            'title': title,
            'description': self._og_search_description(webpage),
            'uploader': self._search_regex(r'<div[^>]+id="uploader"[^>]*>([^<]+)<', webpage, 'uploader', fatal=False),
            # TODO more properties (see yt_dlp/extractor/common.py)
        }
```

----------------------------------------

TITLE: Building Platform-Independent Binary - Makefile
DESCRIPTION: This command builds a platform-independent yt-dlp binary using the make utility. It requires build tools such as python, zip, make, pandoc, and pytest.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_6

LANGUAGE: Makefile
CODE:
```
make
```

----------------------------------------

TITLE: Not Recommended Option Aliases in yt-dlp
DESCRIPTION: This snippet documents yt-dlp options that are not recommended for use and lists their preferred alternatives. These options are still functional but there are better alternatives. The options involve forcing generic extractors, executing commands before download, handling formats and subtitles, printing JSON, autonumbering, metadata parsing, HLS preferences, listing formats, skipping DASH/HLS manifests, GEO bypassing, and more.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_85

LANGUAGE: Text
CODE:
```
--force-generic-extractor        --ies generic,default
--exec-before-download CMD       --exec "before_dl:CMD"
--no-exec-before-download        --no-exec
--all-formats                    -f all
--all-subs                       --sub-langs all --write-subs
--print-json                     -j --no-simulate
--autonumber-size NUMBER         Use string formatting, e.g. %(autonumber)03d
--autonumber-start NUMBER        Use internal field formatting like %(autonumber+NUMBER)s
--id                             -o "%(id)s.%(ext)s"
--metadata-from-title FORMAT     --parse-metadata "%(title)s:FORMAT"
--hls-prefer-native              --downloader "m3u8:native"
--hls-prefer-ffmpeg              --downloader "m3u8:ffmpeg"
--list-formats-old               --compat-options list-formats (Alias: --no-list-formats-as-table)
--list-formats-as-table          --compat-options -list-formats [Default] (Alias: --no-list-formats-old)
--youtube-skip-dash-manifest     --extractor-args "youtube:skip=dash" (Alias: --no-youtube-include-dash-manifest)
--youtube-skip-hls-manifest      --extractor-args "youtube:skip=hls" (Alias: --no-youtube-include-hls-manifest)
--youtube-include-dash-manifest  Default (Alias: --no-youtube-skip-dash-manifest)
--youtube-include-hls-manifest   Default (Alias: --no-youtube-skip-hls-manifest)
--geo-bypass                     --xff "default"
--no-geo-bypass                  --xff "never"
--geo-bypass-country CODE        --xff CODE
--geo-bypass-ip-block IP_BLOCK   --xff IP_BLOCK
```

----------------------------------------

TITLE: Compiling yt-dlp Binary - Makefile
DESCRIPTION: This command compiles only the yt-dlp binary without updating additional files. It requires python, zip, and make, but does not need pandoc and pytest.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_7

LANGUAGE: Makefile
CODE:
```
make yt-dlp
```

----------------------------------------

TITLE: Download smallest video available (yt-dlp)
DESCRIPTION: Downloads the smallest video available using the `-S` option, sorting by filesize and bitrate in ascending order. `+size,+br` ensures the smallest file size is prioritized.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_51

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "+size,+br"
```

----------------------------------------

TITLE: Download worst video available (yt-dlp)
DESCRIPTION: Downloads the worst video available using the old method of format selection. This is generally not recommended, as it often selects a very low-quality video.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_49

LANGUAGE: bash
CODE:
```
$ yt-dlp -f "wv*+wa/w"
```

----------------------------------------

TITLE: Grouping Format Selectors with yt-dlp
DESCRIPTION: This command groups format selectors using parentheses to download the best pre-merged mp4 and webm formats with a height lower than 480.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_43

LANGUAGE: None
CODE:
```
-f "(mp4,webm)[height<480]"
```

----------------------------------------

TITLE: Download best video with smallest resolution (yt-dlp)
DESCRIPTION: Downloads the best video available but with the smallest resolution using the `-S` option. The `+res` argument sorts the formats by resolution in ascending order.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_50

LANGUAGE: bash
CODE:
```
$ yt-dlp -S "+res"
```

----------------------------------------

TITLE: No Longer Supported Option Aliases in yt-dlp
DESCRIPTION: This snippet lists yt-dlp options that are no longer supported and may not function as intended. These options have been removed or are no longer actively maintained. The options involve preferring avconv, calling home, including ads, writing annotations, and compat options.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_89

LANGUAGE: Text
CODE:
```
--prefer-avconv                  avconv is not officially supported by yt-dlp (Alias: --no-prefer-ffmpeg)
--prefer-ffmpeg                  Default (Alias: --no-prefer-avconv)
-C, --call-home                  Not implemented
--no-call-home                   Default
--include-ads                    No longer supported
--no-include-ads                 Default
--write-annotations              No supported site has annotations now
--no-write-annotations           Default
--compat-options seperate-video-versions  No longer needed
--compat-options no-youtube-prefer-utc-upload-date  No longer supported
```

----------------------------------------

TITLE: Incorrect Regular Expression: Excessive Complexity
DESCRIPTION: This snippet illustrates an overly complex regular expression that can be simplified without losing functionality. Unnecessary complexity makes the regex harder to read and maintain.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_33

LANGUAGE: python
CODE:
```
_VALID_URL = r'https?:\/\/(?:www\.)?website\.com\/[^\/]+\/[^\/]+\/[^\/]+(?:\/[^\/]+)?\/(?P<display_id>[^\/]+)_(?P<id>\d+)'
```

----------------------------------------

TITLE: Installing PyInstaller Dependencies - Python
DESCRIPTION: This script installs the dependencies, including pyinstaller, required for building the yt-dlp executable.  It handles package management and ensures the necessary tools are available.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_3

LANGUAGE: python
CODE:
```
python3 devscripts/install_deps.py --include pyinstaller
```

----------------------------------------

TITLE: Providing Fallbacks for Data Extraction
DESCRIPTION: This code demonstrates providing fallbacks when extracting metadata from multiple sources. If the first source fails, it attempts to extract the data from another source, making the extractor more robust.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_26

LANGUAGE: python
CODE:
```
title = meta.get('title') or self._og_search_title(webpage)
```

----------------------------------------

TITLE: Searching Webpage Content with Regular Expressions and Default Value
DESCRIPTION: This example shows how to use the `_search_regex` method with `default=None` to provide a fallback value when the regex fails to find a match.  This is useful for optional metadata fields.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_21

LANGUAGE: python
CODE:
```
description = self._search_regex(
    r'<span[^>]+id="title"[^>]*>([^<]+)<',
    webpage, 'description', default=None)
```

----------------------------------------

TITLE: Incorrect Regular Expression: Capturing Groups
DESCRIPTION: This code shows an incorrect regular expression using capturing groups where non-capturing groups should be used.  Capturing unnecessary groups can reduce performance and make the regex harder to read.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_28

LANGUAGE: python
CODE:
```
r'(id|ID)=(?P<id>\d+)'
```

----------------------------------------

TITLE: Quotes: Using Single Quotes for Strings
DESCRIPTION: This describes the convention of using single quotes for strings and double quotes for docstrings within the project.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_42



----------------------------------------

TITLE: Creating Lazy Extractors - Python
DESCRIPTION: This script creates lazy extractors to improve the startup performance of yt-dlp binaries.  Running this script before building is recommended.  The YTDLP_NO_LAZY_EXTRACTORS environment variable can be set to disable lazy extractor loading.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_4

LANGUAGE: python
CODE:
```
python3 devscripts/make_lazy_extractors.py
```

----------------------------------------

TITLE: Downloading JSON Data with yt-dlp
DESCRIPTION: This code demonstrates how to download JSON data using the `_download_json` method in yt-dlp.  It fetches data from a specified URL, associating it with a video ID. The function is used to retrieve structured metadata for further processing.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_15

LANGUAGE: python
CODE:
```
meta = self._download_json(url, video_id)
```

----------------------------------------

TITLE: Correct Regular Expression: Minimal Complexity
DESCRIPTION: This code demonstrates the correct way to construct regular expressions, using the simplest possible expression that still fulfills the requirements.  Each part of the regex should have a specific purpose.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_32

LANGUAGE: python
CODE:
```
_VALID_URL = r'https?://(?:www\.)?website\.com/(?:[^/]+/){3,4}(?P<display_id>[^/]+)_(?P<id>\d+)'
```

----------------------------------------

TITLE: Incorrectly Iterating Over Data: Handling None Values
DESCRIPTION: This code demonstrates an incorrect approach to iterating over potentially missing data, leading to a `TypeError` if `thumbnail_data` is `None`.  Directly iterating without a fallback will cause the script to crash.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_23

LANGUAGE: python
CODE:
```
thumbnail_data = data.get('thumbnails')
thumbnails = [{
    'url': item['url'],
    'height': item.get('h'),
} for item in thumbnail_data]  # incorrect
```

----------------------------------------

TITLE: Removed Option Aliases in yt-dlp
DESCRIPTION: This snippet lists yt-dlp options that have been deprecated since 2014 and are now entirely removed. The options involve auto numbering and setting a title/literal for output.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_90

LANGUAGE: Text
CODE:
```
-A, --auto-number                -o "%(autonumber)s-%(id)s.%(ext)s"
-t, -l, --title, --literal       -o "%(title)s-%(id)s.%(ext)s"
```

----------------------------------------

TITLE: Netscape HTTP Cookie File Format
DESCRIPTION: Demonstrates the structure and syntax of a Netscape HTTP Cookie file. It includes examples of how cookies are stored, including attributes like domain, path, secure flag, expiration timestamp, name, and value.  The file includes examples of both HTTPOnly and regular (JS accessible) cookies.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/test/testdata/cookies/httponly_cookies.txt#_snippet_0

LANGUAGE: text
CODE:
```
# Netscape HTTP Cookie File
# http://curl.haxx.se/rfc/cookie_spec.html
# This is a generated file!  Do not edit.

#HttpOnly_www.foobar.foobar	FALSE	/	TRUE	2147483647	HTTPONLY_COOKIE	HTTPONLY_COOKIE_VALUE
www.foobar.foobar	FALSE	/	TRUE	2147483647	JS_ACCESSIBLE_COOKIE	JS_ACCESSIBLE_COOKIE_VALUE
```

----------------------------------------

TITLE: Adding and committing changes
DESCRIPTION: Adds the new extractor files to the git repository, commits the changes with a descriptive message, and pushes the branch to the remote repository. Replace yourextractor with the actual name of your extractor.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_13

LANGUAGE: shell
CODE:
```
$ git add yt_dlp/extractor/_extractors.py
$ git add yt_dlp/extractor/yourextractor.py
$ git commit -m '[yourextractor] Add extractor'
$ git push origin yourextractor
```

----------------------------------------

TITLE: Developer Options in yt-dlp
DESCRIPTION: This snippet lists yt-dlp options intended for developers and not meant for regular users. These options are used for testing and debugging purposes. The options include testing, loading pages, printing youtube signature code, and allowing unplayable formats.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/README.md#_snippet_86

LANGUAGE: Text
CODE:
```
--test                           Download only part of video for testing extractors
--load-pages                     Load pages dumped by --write-pages
--youtube-print-sig-code         For testing youtube signatures
--allow-unplayable-formats       List unplayable formats also
--no-allow-unplayable-formats    Default
```

----------------------------------------

TITLE: Incorrect Regular Expression: Over-Matching
DESCRIPTION: This example illustrates the incorrect use of general quantifiers (like `.*`) in regular expressions, leading to over-matching and potentially catastrophic backtracking.  Specificity is key to efficient regex performance.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_35

LANGUAGE: python
CODE:
```
title = self._search_regex(r'<span\b.*class="title".*>(.+?)<', webpage, 'title')
```

----------------------------------------

TITLE: Multiline Literal Dictionary (Correct)
DESCRIPTION: This example shows the correct way to define a multi-line literal dictionary, ensuring the closing curly brace is on a new line.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_49

LANGUAGE: python
CODE:
```
f = {
    'url': url,
    'format_id': format_id,
}
```

----------------------------------------

TITLE: List Comprehension (Correct - Multiline)
DESCRIPTION: Demonstrates a correct way to write a multi-line list comprehension with the closing bracket on a new line.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_51

LANGUAGE: python
CODE:
```
formats = [
    process_formats(f) for f in format_data
    if f.get('type') in ('hls', 'dash', 'direct') and f.get('downloadable')
]
```

----------------------------------------

TITLE: Trailing Parentheses (Correct - Multiline)
DESCRIPTION: This example demonstrates the correct placement of trailing parentheses for grouping/functions when the arguments are written on multiple lines, keeping the closing parenthesis aligned with the opening one.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_47

LANGUAGE: python
CODE:
```
url = traverse_obj(
    info,
    ('context', 'dispatcher', 'stores', 'VideoTitlePageStore', 'data', 'video', 0, 'VideoUrlSet', 'VideoUrl'),
    list)
```

----------------------------------------

TITLE: Correct Line Length: Single Line Code
DESCRIPTION: This snippet demonstrates how to keep a single, short line of code on one line, instead of splitting it across multiple lines.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_38

LANGUAGE: python
CODE:
```
uploader = traverse_obj(info, ('uploader', 'name'), ('author', 'fullname'))
```

----------------------------------------

TITLE: Correct Line Length: Avoiding Splits
DESCRIPTION: This snippet shows an example of how to keep strings on a single line when their length is within reasonable limits, adhering to the line length policy.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_36

LANGUAGE: python
CODE:
```
'https://www.youtube.com/watch?v=FqZTN594JQw&list=PLMYEtVRpaqY00V9W81Cwmzp6N6vZqfUKD4'
```

----------------------------------------

TITLE: Example HTML
DESCRIPTION: This provides an HTML example that can be used to extract the "title" value from the "span" tag.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_30

LANGUAGE: html
CODE:
```
<span style="position: absolute; left: 910px; width: 90px; float: right; z-index: 9999;" class="title">some fancy title</span>
```

----------------------------------------

TITLE: Incorrect Regular Expression: Strict Matching
DESCRIPTION: This snippet illustrates an overly specific regular expression that is prone to failure if the input HTML changes even slightly.  It's important to write regexes that are flexible and resilient to minor variations.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_31

LANGUAGE: python
CODE:
```
title = self._search_regex(  # incorrect
    r'<span style="position: absolute; left: 910px; width: 90px; float: right; z-index: 9999;" class="title">(.*?)</span>',
    webpage, 'title', group='title')
```

LANGUAGE: python
CODE:
```
title = self._search_regex(  # incorrect
    r'<span style=".*?" class="title">(.*?)</span>',
    webpage, 'title', group='title')
```

----------------------------------------

TITLE: Incorrect Line Length: Excessive Multi-Line
DESCRIPTION: This example presents an incorrect excessive splitting of a function call across multiple lines, hindering readability. The aim should be to make use of multi-line formatting only where it enhances clarity.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_41

LANGUAGE: python
CODE:
```
formats = self._extract_m3u8_formats(m3u8_url,
                                     video_id,
                                     'mp4',
                                     'm3u8_native',
                                     m3u8_id='hls',
                                     note='Downloading HD m3u8 information',
                                     errnote='Unable to download HD m3u8 information')
```

----------------------------------------

TITLE: Running Tests Manually
DESCRIPTION: This command runs the tests for yt-dlp without using hatch.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_6

LANGUAGE: shell
CODE:
```
$ python -m devscripts.run_tests
```

----------------------------------------

TITLE: Incorrect Line Length: Unnecessary Multi-Line
DESCRIPTION: This example shows the unnecessary splitting of a simple line of code onto multiple lines, reducing readability. Small lines should remain single lines.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_39

LANGUAGE: python
CODE:
```
uploader = traverse_obj(
    info,
    ('uploader', 'name'),
    ('author', 'fullname'))
```

----------------------------------------

TITLE: Correct Line Length: Multi-Line Function Call
DESCRIPTION: This code illustrates the correct way to split a long function call across multiple lines for readability, adhering to the line length policy. However, unnecessary splits should be avoided. The goal is to break up long parameter lists or expressions for clarity.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_40

LANGUAGE: python
CODE:
```
formats = self._extract_m3u8_formats(
    m3u8_url, video_id, 'mp4', 'm3u8_native', m3u8_id='hls',
    note='Downloading HD m3u8 information', errnote='Unable to download HD m3u8 information')
```

----------------------------------------

TITLE: Formatting Code Manually
DESCRIPTION: These commands format the code using ruff and autopep8.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_7

LANGUAGE: shell
CODE:
```
$ ruff check --fix .
$ autopep8 --in-place .
```

----------------------------------------

TITLE: Checking Code Manually
DESCRIPTION: These commands check the code for style issues using ruff and autopep8 without applying fixes.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_8

LANGUAGE: shell
CODE:
```
$ ruff check .
$ autopep8 --diff .
```

----------------------------------------

TITLE: Incorrect Line Length: Unnecessary Splits
DESCRIPTION: This snippet shows an example of an unnecessary split of a string literal over multiple lines. Short strings should be kept on a single line for readability.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/CONTRIBUTING.md#_snippet_37

LANGUAGE: python
CODE:
```
'https://www.youtube.com/watch?v=FqZTN594JQw&list='
'PLMYEtVRpaqY00V9W81Cwmzp6N6vZqfUKD4'
```

----------------------------------------

TITLE: Generate CA Certificate (openssl, sh)
DESCRIPTION: This shell snippet generates a Certificate Authority (CA) key and certificate using openssl. It creates a prime256v1 ECDSA key, then creates a self-signed X.509 certificate valid for 6027 days. The certificate's subject is set to '/CN=ytdlptest'.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/test/testdata/certificate/instructions.md#_snippet_0

LANGUAGE: sh
CODE:
```
openssl ecparam -name prime256v1 -genkey -noout -out ca.key
openssl req -new -x509 -sha256 -days 6027 -key ca.key -out ca.crt -subj "/CN=ytdlptest"
```

----------------------------------------

TITLE: Generate Client Certificate (openssl, sh)
DESCRIPTION: This shell snippet generates client certificates and keys, including an encrypted version. It first creates an ECDSA key, encrypts it with AES256 using the password 'foobar', and then generates a certificate signing request. Finally, it signs the request using the CA to create the client certificate and appends the client keys to the certificate files for combined certificate and key usage.
SOURCE: https://github.com/yt-dlp/yt-dlp/blob/master/test/testdata/certificate/instructions.md#_snippet_1

LANGUAGE: sh
CODE:
```
openssl ecparam -name prime256v1 -genkey -noout -out client.key
openssl ec -in client.key -out clientencrypted.key -passout pass:foobar -aes256
openssl req -new -sha256 -key client.key -out client.csr -subj "/CN=ytdlptest2"
openssl x509 -req -in client.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out client.crt -days 6027 -sha256
cp client.crt clientwithkey.crt
cp client.crt clientwithencryptedkey.crt
cat client.key >> clientwithkey.crt
cat clientencrypted.key >> clientwithencryptedkey.crt
```