TITLE: Defining PowerToys Module Interface Class in C++
DESCRIPTION: Core interface class definition that all PowerToys modules must implement. Contains virtual methods for module lifecycle management, configuration, and custom actions.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_0

LANGUAGE: cpp
CODE:
```
class PowertoyModuleIface {
public:
  virtual const wchar_t* get_name() = 0;
  virtual const wchar_t** get_events() = 0;
  virtual bool get_config(wchar_t* buffer, int *buffer_size) = 0;
  virtual void set_config(const wchar_t* config) = 0;
  virtual void call_custom_action(const wchar_t* action) {};
  virtual void enable() = 0;
  virtual void disable() = 0;
  virtual bool is_enabled() = 0;
  virtual void destroy() = 0;
};

typedef PowertoyModuleIface* (__cdecl *powertoy_create_func)();
```

----------------------------------------

TITLE: Defining ICommandProvider and Related Interfaces in C#
DESCRIPTION: This snippet defines the core interfaces for creating DevPal extensions, including ICommandSettings, IFallbackHandler, IFallbackCommandItem, and ICommandProvider. These interfaces outline the structure and requirements for command providers in DevPal.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_16

LANGUAGE: csharp
CODE:
```
interface ICommandSettings {
    IContentPage SettingsPage { get; };
};

interface IFallbackHandler {
    void UpdateQuery(String query);
};

interface IFallbackCommandItem requires ICommandItem {
    IFallbackHandler FallbackHandler{ get; };
    String DisplayTitle { get; };
};

interface ICommandProvider requires Windows.Foundation.IClosable, INotifyItemsChanged
{
    String Id { get; };
    String DisplayName { get; };
    IIconInfo Icon { get; };
    ICommandSettings Settings { get; };
    Boolean Frozen { get; };

    ICommandItem[] TopLevelCommands();
    IFallbackCommandItem[] FallbackCommands();

    ICommand GetCommand(String id);

    void InitializeWithHost(IExtensionHost host);
};
```

----------------------------------------

TITLE: Defining ICommandProvider Interface for Command Palette Extensions in C#
DESCRIPTION: Core interface for Command Palette extensions that serves as the entry point. It defines a method to provide top-level commands that will appear in the root view of the Command Palette.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_4

LANGUAGE: csharp
CODE:
```
public interface ICommandProvider
{
    IEnumerable<ICommand> GetCommands();
}
```

----------------------------------------

TITLE: Defining ICommand Interface for Command Palette Actions in C#
DESCRIPTION: Interface that represents executable commands within the Command Palette. It defines the structure for command units that can be executed from ListItems and ContextItems.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_5

LANGUAGE: csharp
CODE:
```
public interface ICommand
{
    string Name { get; }
    void Execute();
}
```

----------------------------------------

TITLE: Defining Command and CommandResult Interfaces in C#
DESCRIPTION: Core interface definitions for the DevPal SDK's command system. Defines ICommand, CommandResultKind enumeration, and related interfaces for handling command execution results.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_3

LANGUAGE: c#
CODE:
```
interface ICommand requires INotifyPropChanged{
    String Name{ get; };
    String Id{ get; };
    IIconInfo Icon{ get; };
}

enum CommandResultKind {
    Dismiss,    // Reset the palette to the main page and dismiss
    GoHome,     // Go back to the main page, but keep it open
    GoBack,     // Go back one level
    Hide,       // Keep this page open, but hide the palette.
    KeepOpen,   // Do nothing.
    GoToPage,   // Go to another page. GoToPageArgs will tell you where.
    ShowToast,  // Display a transient message to the user
    Confirm,    // Display a confirmation dialog
};

enum NavigationMode {
    Push,   // Push the target page onto the navigation stack
    GoBack, // Go back one page before navigating to the target page
    GoHome, // Go back to the home page before navigating to the target page
};

[uuid("f9d6423b-bd5e-44bb-a204-2f5c77a72396")]
interface ICommandResultArgs{};
interface ICommandResult {
    CommandResultKind Kind { get; };
    ICommandResultArgs Args { get; };
}
interface IGoToPageArgs requires ICommandResultArgs{
    String PageId { get; };
    NavigationMode NavigationMode { get; };
}
interface IToastArgs requires ICommandResultArgs{
    String Message { get; };
    ICommandResult Result { get; };
}
interface IConfirmationArgs requires ICommandResultArgs{
    String Title { get; };
    String Description { get; };
    ICommand PrimaryCommand { get; };
    Boolean IsPrimaryCommandCritical { get; };
}

// This is a "leaf" of the UI. This is something that can be "done" by the user.
// * A ListPage
// * the MoreCommands flyout of for a ListItem or a MarkdownPage
interface IInvokableCommand requires ICommand {
    ICommandResult Invoke(Object sender);
}
```

----------------------------------------

TITLE: Implementing a Fallback Command with Dynamic Naming in C#
DESCRIPTION: This snippet demonstrates how to implement a fallback command that changes its name dynamically based on user input. It includes a SpongebotPage class that implements IFallbackHandler and a SpongebotCommandsProvider class that provides the fallback command.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_17

LANGUAGE: csharp
CODE:
```
public class SpongebotPage : Microsoft.CommandPalette.Extensions.Toolkit.MarkdownPage, IFallbackHandler
{
    // Name, Icon, IPropertyChanged: all those are defined in the MarkdownPage base class
    public SpongebotPage()
    {
        this.Name = "";
        this.Icon = new("https://imgflip.com/s/meme/Mocking-Spongebob.jpg");
    }
    public void IFallbackHandler.UpdateQuery(string query) {
        if (string.IsNullOrEmpty(query)) {
            this.Name = "";
        } else {
            this.Name = ConvertToAlternatingCase(query);
        }
        return Task.CompletedTask.AsAsyncCommand();
    }
    static string ConvertToAlternatingCase(string input) {
        StringBuilder sb = new StringBuilder();
        for (var i = 0; i < input.Length; i++)
        {
            sb.Append(i % 2 == 0 ? char.ToUpper(input[i]) : char.ToLower(input[i]));
        }
        return sb.ToString();
    }
    public override string Body() {
        var t = _GenerateMeme(this.Name); // call out to imgflip APIs to generate the meme
        t.ConfigureAwait(false);
        return t.Result;
    }
}
internal sealed class SpongebotCommandsProvider : CommandProvider
{
    public ICommandItem[] TopLevelCommands() => [];
    public IFallbackCommandItem[] FallbackCommands()
    {
        var spongebotPage = new SpongebotPage();
        var listItem = new FallbackCommandItem(spongebotPage);
        // ^ The FallbackCommandItem ctor will automatically set its FallbackHandler to the
        // Command passed in, if the command implements IFallbackHandler
        return [ listItem ];
    }
}
```

----------------------------------------

TITLE: Implementing IPlugin Interface in C#
DESCRIPTION: Core interface that all PowerToys Run plugins must implement, containing Init() and Query() functions for plugin initialization and search functionality.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/overview.md#2025-04-15_snippet_0

LANGUAGE: csharp
CODE:
```
interface IPlugin
{
    void Init();
    void Query();
}
```

----------------------------------------

TITLE: Defining Plugin Interfaces in C#
DESCRIPTION: Core interfaces that define how plugins interact with PowerToys Run. IPlugin handles initialization and fast queries, while IDelayedExecutionPlugin is for long-running queries like file searching.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/architecture.md#2025-04-15_snippet_0

LANGUAGE: C#
CODE:
```
    public interface IPlugin
    {
        // Query plugin
        List<Result> Query(Query query);

        // Initialize plugin
        void Init(PluginInitContext context);
    }

    public interface IDelayedExecutionPlugin : IFeatures
    {
        // Query plugin
        List<Result> Query(Query query, bool delayedExecution);
    }
```

----------------------------------------

TITLE: PowerToys Module Name Getter Method
DESCRIPTION: Virtual method definition for retrieving the PowerToy module's name. The returned name will be cached by the runner.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_2

LANGUAGE: cpp
CODE:
```
virtual const wchar_t* get_name()
```

----------------------------------------

TITLE: Implementing Media Controls List Item in C#
DESCRIPTION: Example implementation of a MediaListItem that displays the current track with play/pause and navigation controls. The code demonstrates how to create a ListItem with context commands and update its properties based on the current media session.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_7

LANGUAGE: csharp
CODE:
```
internal sealed class MediaListItem : ListItem
{
    // Theis is an example of a ListItem that displays the currently track
    // This TogglePlayMediaCommand is the default action when the user selects the item.
    public MediaListItem() : base(new TogglePlayMediaCommand())
    {
        // These two commands make up the "More commands" flyout for the item.
        this.MoreCommands = [
            new CommandContextItem(new PrevNextTrackCommand(true)),
            new CommandContextItem(new PrevNextTrackCommand(false))
        ];

        GlobalSystemMediaTransportControlsSessionManager.RequestAsync().AsTask().ContinueWith(async (task) => {
            var manager = task.Result;
            var mediaSession = manager.GetCurrentSession();
            var properties = await this.mediaSession.TryGetMediaPropertiesAsync().AsTask();
            this.Title = properties.Title;
            // update other things too
        });

    }
}
internal sealed class TogglePlayMediaCommand : InvokableCommand
{
    public TogglePlayMediaCommand()
    {
        Name = "Play";
        Icon = new("\ue768"); //play
    }

    public ICommandResult Invoke()
    {
        _ = mediaSession.TryTogglePlayPauseAsync();
        return new ICommandResult(CommandResultKind.KeepOpen);
    }
}
// And a similar InvokableCommand for the PrevNextTrackCommand
```

----------------------------------------

TITLE: Implementing settings management with helper classes in C#
DESCRIPTION: Example showing how to implement settings management using the PowerToys Command Palette Extensions Toolkit. This code demonstrates defining settings, loading/saving state, and creating a settings page that automatically generates a form UI.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_20

LANGUAGE: csharp
CODE:
```
class MyAppSettings {
    private readonly Helpers.Settings _settings = new();
    public Helpers.Settings Settings => _settings;

    public MyAppSettings() {
        // Define the structure of your settings here.
        var onOffSetting = new Helpers.ToggleSetting("onOff", "Enable feature", "This feature will do something cool", true);
        var textSetting = new Helpers.TextSetting("whatever", "Text setting", "This is a text setting", "Default text");
        _settings.Add(onOffSetting);
        _settings.Add(onOffSetting);
    }
    public void LoadSavedData()
    {
        // Possibly, load the settings from a file or something
        var persistedData = /* load the settings from file */;
        _settings.LoadState(persistedData);
    }
    public void SaveSettings()
    {
        /* You can save the settings to the file here */
        var mySettingsFilePath = /* whatever */;
        string mySettingsJson = mySettings.Settings.GetState();
        // Or you could raise a event to indicate to the rest of your app that settings have changed.
    }
}

class MySettingsPage : Microsoft.CommandPalette.Extensions.Toolkit.FormPage
{
    private readonly MyAppSettings mySettings;
    public MySettingsPage(MyAppSettings s) {
        mySettings = s;
        mySettings.Settings.SettingsChanged += SettingsChanged;
    }
    public override IForm[] Forms() {
        // If you haven't already:
        mySettings.Settings.LoadSavedData();
        return mySettings.Settings.ToForms();
    }

    private void SettingsChanged(object sender, Settings args)
    {
        /* Do something with the new settings here */
        var onOff = _settings.GetSetting<bool>("onOff");
        ExtensionHost.LogMessage(new LogMessage() { Message = $"MySettingsPage: Changed the value of onOff to {onOff}" });

        // Possibly even:
        mySettings.SaveSettings();
    }
}

// elsewhere in your app:

MyAppSettings instance = /* Up to you how you want to pass this around.
                            Singleton, dependency injection, whatever. */
var onOff = instance.Settings.Get("onOff");
```

----------------------------------------

TITLE: Defining Keyboard Remapping Profile JSON Structure
DESCRIPTION: JSON schema for individual keyboard remapping profiles (default.json) that defines key remappings and shortcuts for both global and app-specific contexts.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_1

LANGUAGE: json
CODE:
```
{
    "remapKeys": {
        "inProcess": [
            {
                "originalKeys":"91",
                "newRemapKeys":"162;70"
            },
            {
                "originalKeys":"92",
                "newRemapKeys":"162;70"
            }
        ]
    },
    "remapShortcuts": {
        "global": [
            {
                "originalKeys":"164;37",
                "newRemapKeys":"162;65"
            },
            {
                "originalKeys":"162;68",
                "newRemapKeys":"91"
            }
        ],
        "appSpecific": [
            {
                "originalKeys":"91;162;65",
                "newRemapKeys":"162;86",
                "targetApp":"msedge"
            }
        ]
    }
}
```

----------------------------------------

TITLE: Initializing FrameworkView for XAML UI in C++
DESCRIPTION: Creates a CoreWindow and CoreApplicationView, then initializes a FrameworkView object to set up the XAML framework for the Keyboard Manager UI. This approach is used to support Mica and replaces the previous XAML Island implementation.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagerui.md#2025-04-15_snippet_0

LANGUAGE: C++
CODE:
```
CoreWindow^ window = reinterpret_cast<CoreWindow^>(CoreWindow::Create(nullptr, 1500));
CoreApplicationView^ view = new CoreApplicationViewStub();
FrameworkView^ frameworkView = ref new FrameworkView(window, view);
```

----------------------------------------

TITLE: Implementing PowerToy Settings Configuration in C++
DESCRIPTION: Example implementation of PowerToy settings configuration including get_config and set_config methods. Shows how to create settings controls for boolean toggles, integer spinners, string inputs, color pickers and custom actions.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_0

LANGUAGE: cpp
CODE:
```
  // Return JSON with the configuration options.
  virtual bool get_config(wchar_t* buffer, int* buffer_size) override {
    HINSTANCE hinstance = reinterpret_cast<HINSTANCE>(&__ImageBase);

    // Create a Settings object.
    PowerToysSettings::Settings settings(hinstance, get_name());
    settings.set_description(L"Serves as an example powertoy, with example settings.");

    // Show an overview link in the Settings page
    settings.set_overview_link(L"https://github.com/microsoft/PowerToys");

    // Show a video link in the Settings page.
    settings.set_video_link(L"https://www.youtube.com/watch?v=d3LHo2yXKoY&t=21462");

    // Add a bool property with a toggle editor.
    settings.add_bool_toggle(
      L"test_bool_toggle", // property name.
      L"This is what a BoolToggle property looks like", // description or resource id of the localized string.
      g_settings.test_bool_prop // property value.
    );

    // Add an integer property with a spinner editor.
    settings.add_int_spinner(
      L"test_int_spinner", // property name
      L"This is what a IntSpinner property looks like", // description or resource id of the localized string.
      g_settings.test_int_prop, // property value.
      0, // min value.
      100, // max value.
      10 // incremental step.
    );

    // Add a string property with a textbox editor.
    settings.add_string(
      L"test_string_text", // property name.
      L"This is what a String property looks like", // description or resource id of the localized string.
      g_settings.test_string_prop // property value.
    );

    // Add a string property with a color picker editor.
    settings.add_color_picker(
      L"test_color_picker", // property name.
      L"This is what a ColorPicker property looks like", // description or resource id of the localized string.
      g_settings.test_color_prop // property value.
    );

    // Add a custom action property. When using this settings type, the "PowertoyModuleIface::call_custom_action()"
    // method should be overridden as well.
    settings.add_custom_action(
      L"test_custom_action", // action name.
      L"This is what a CustomAction property looks like", // label above the field.
      L"Call a custom action", // button text.
      L"Press the button to call a custom action in the Example PowerToy" // display values / extended info.
    );

    return settings.serialize_to_buffer(buffer, buffer_size);
  }

  // Called by the runner to pass the updated settings values as a serialized JSON.
  virtual void set_config(const wchar_t* config) override { 
    try {
      // Parse the input JSON string.
      PowerToysSettings::PowerToyValues values =
        PowerToysSettings::PowerToyValues::from_json_string(config);

      // Update the bool property.
      if (values.is_bool_value(L"test_bool_toggle")) {
        g_settings.test_bool_prop = values.get_bool_value(L"test_bool_toggle");
      }

      // Update the int property.
      if (values.is_int_value(L"test_int_spinner")) {
        g_settings.test_int_prop = values.get_int_value(L"test_int_spinner");
      }

      // Update the string property.
      if (values.is_string_value(L"test_string_text")) {
        g_settings.test_string_prop = values.get_string_value(L"test_string_text");
      }

      // Update the color property.
      if (values.is_string_value(L"test_color_picker")) {
        g_settings.test_color_prop = values.get_string_value(L"test_color_picker");
      }

      // If you don't need to do any custom processing of the settings, proceed
      // to persists the values calling:
      values.save_to_settings_file();
      // Otherwise call a custom function to process the settings before saving them to disk:
      // save_settings();
    }
    catch (std::exception& ex) {
      // Improper JSON.
    }
  }
```

----------------------------------------

TITLE: Implementing Hacker News extension with helper classes in C#
DESCRIPTION: Complete implementation of a Hacker News extension using Microsoft.CommandPalette.Extensions.Toolkit helper classes. This example demonstrates how to create list items with commands and tags, and how to implement a list page with loading state.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_19

LANGUAGE: csharp
CODE:
```
class NewsListItem : Microsoft.CommandPalette.Extensions.Toolkit.ListItem {
    private NewsPost _post;
    public NewsListItem(NewsPost post)
    {
        _post = post;
        Title = post.Title;
        Subtitle = post.Url;
    }
    public IContextItem[] Commands => [
        new CommandContextItem(new OpenUrlCommand(post.Url, CommandResult.KeepOpen)),
        new CommandContextItem(new OpenUrlCommand(post.CommentsUrl, CommandResult.KeepOpen){
            Name = "Open comments",
            Icon = "\uE8F2" // ChatBubbles
        })
    ];
    public ITag[] Tags => [ new Tag(){ Text=post.Poster, new Tag(){ Text=post.Points } } ];
}
class HackerNewsPage: Microsoft.CommandPalette.Extensions.Toolkit.ListPage {
    public HackerNewsPage()
    {
        Loading = true;
    }
    IListItem[] GetItems(String query) {
        List<NewsItem> items = /* do some RSS feed stuff */;
        this.IsLoading = false;
        return items
                .Select((post) => new NewsListItem(post))
                .ToArray();
    }
}
```

----------------------------------------

TITLE: Using GetSettings Utility Function in C#
DESCRIPTION: The GetSettings function reads a settings file from a PowerToy's settings folder, creating one with default configurations if it doesn't exist. It should only be called by the SettingsRepository to avoid file access contention with the runner process. Objects deserialized with this function must implement the ISettingsConfig interface.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/settings-utilities.md#2025-04-15_snippet_0

LANGUAGE: C#
CODE:
```
GetSettings<T>(powertoy, filename)
```

----------------------------------------

TITLE: Proposed Interface for Commands with Parameters in C#
DESCRIPTION: This code snippet shows a proposed interface for allowing commands to accept parameters. It defines an interface that extends ICommand with parameter specifications and a method to invoke the command with arguments.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_24

LANGUAGE: csharp
CODE:
```
interface IInvokableCommandWithParameters requires ICommand {
    ActionParameters Parameters { get; };
    CommandResult InvokeWithArgs(ActionArguments args);
}
```

----------------------------------------

TITLE: Interpreting Calculation Expression using Mages Library in C#
DESCRIPTION: This code snippet demonstrates how the Calculator plugin interprets a mathematical expression using the Mages library. It takes a query search string and the current UI culture as inputs to perform the calculation.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/calculator.md#2025-04-15_snippet_0

LANGUAGE: csharp
CODE:
```
var result = CalculateEngine.Interpret(query.Search, CultureInfo.CurrentUICulture);
```

----------------------------------------

TITLE: Defining Content Page Interfaces for Command Palette Extensions in C#
DESCRIPTION: Defines the interfaces for creating rich content pages in Command Palette extensions. These interfaces allow extensions to display more complex content like forms, markdown, and hierarchical content structures.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_10

LANGUAGE: csharp
CODE:
```
[uuid("b64def0f-8911-4afa-8f8f-042bd778d088")]
interface IContent requires INotifyPropChanged {
}

interface IFormContent requires IContent {
    String TemplateJson { get; };
    String DataJson { get; };
    String StateJson { get; };
    ICommandResult SubmitForm(String inputs, String data);
}

interface IMarkdownContent requires IContent {
    String Body { get; };
}

interface ITreeContent requires IContent, INotifyItemsChanged {
    IContent RootContent { get; };
    IContent[] GetChildren();
}

interface IContentPage requires IPage, INotifyItemsChanged {
    IContent[] GetContent();
    IDetails Details { get; };
    IContextItem[] Commands { get; };
}
```

----------------------------------------

TITLE: Implementing Complete SSH Hosts List Page with Config Parsing
DESCRIPTION: Full implementation of the SSHHostsListPage class that parses the SSH config file to extract host information and displays it in the Command Palette. Includes regex pattern matching, file reading, and conversion to ListItems.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_15

LANGUAGE: csharp
CODE:
```
internal sealed partial class SSHHostsListPage : ListPage
{
    private static readonly string _defaultConfigFile = Environment.GetFolderPath(Environment.SpecialFolder.UserProfile) + "\\.ssh\\config";

    private static readonly Regex _hostRegex = new(@"^Host\s+(?:(\S*) ?)*?\s*$", RegexOptions.Compiled | RegexOptions.IgnoreCase | RegexOptions.Multiline);

    public SSHHostsListPage()
    {
        Icon = new(string.Empty);
        Name = "SSH Keychain";
    }

    private static async Task<List<SSHKeychainItem>> GetSSHHosts()
    {
        var hosts = new List<SSHKeychainItem>();
        var configFile = _defaultConfigFile;

        if (!File.Exists(configFile))
        {
            return hosts;
        }

        var options = new FileStreamOptions()
        {
            Access = FileAccess.Read,
        };

        using var reader = new StreamReader(configFile, options);
        var fileContent = await reader.ReadToEndAsync();

        if (!string.IsNullOrEmpty(fileContent))
        {
            var matches = _hostRegex.Matches(fileContent);
            hosts = matches.Select(match => new SSHKeychainItem { HostName = match.Groups[1].Value }).ToList();
        }

        return hosts;
    }

    public override ISection[] GetItems()
    {
        var t = DoGetItems();
        t.ConfigureAwait(false);
        return t.Result;
    }

    private async Task<ISection[]> DoGetItems()
    {
        List<SSHKeychainItem> items = await GetSSHHosts();
        var s = new ListSection()
        {
            Title = "SSH Hosts",
            Items = items.Select((host) => new ListItem(new NoOpCommand())
            {
                Title = host.HostName,
                Subtitle = host.EscapedHost,
            }).ToArray(),
        };
        return [s];
    }
}
```

----------------------------------------

TITLE: Defining KeyboardManager Settings JSON Structure
DESCRIPTION: JSON schema for the main settings.json file that stores keyboard configuration profiles and active configuration state.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_0

LANGUAGE: json
CODE:
```
{
    "properties": {
        "activeConfiguration": {
            "value":"default"
        },
        "keyboardConfigurations": {
            "value":["default"]
        }
    },
    "name":"Keyboard Manager",
    "version":"1"
}
```

----------------------------------------

TITLE: Defining Details Interfaces for Command Palette Extensions in C#
DESCRIPTION: This set of interfaces defines how additional information can be displayed about an action or item in both List and Markdown pages. It includes structures for tags, links, commands and other elements that can appear in details sections.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_14

LANGUAGE: c#
CODE:
```
interface ITag {
    IIconInfo Icon { get; };
    String Text { get; };
    OptionalColor Foreground { get; };
    OptionalColor Background { get; };
    String ToolTip { get; };
};

[uuid("6a6dd345-37a3-4a1e-914d-4f658a4d583d")]
interface IDetailsData {}
interface IDetailsElement {
    String Key { get; };
    IDetailsData Data { get; };
}
interface IDetails {
    IIconInfo HeroImage { get; };
    String Title { get; };
    String Body { get; };
    IDetailsElement[] Metadata { get; };
}
interface IDetailsTags requires IDetailsData {
    ITag[] Tags { get; };
}
interface IDetailsLink requires IDetailsData {
    Windows.Foundation.Uri Link { get; };
    String Text { get; };
}
interface IDetailsCommand requires IDetailsData {
    ICommand Command { get; };
}
[uuid("58070392-02bb-4e89-9beb-47ceb8c3d741")]
interface IDetailsSeparator requires IDetailsData {}
```

----------------------------------------

TITLE: Configuring plugin.json for PowerToys Run Plugins
DESCRIPTION: The required JSON structure for the plugin.json file that must be included in the root folder of any PowerToys Run plugin. This configuration defines the plugin's metadata, including ID, activation keyword, and icon paths.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/new-plugin-checklist.md#2025-04-15_snippet_0

LANGUAGE: json
CODE:
```
{
  "ID": string, // GUID string
  "ActionKeyword": string, // Direct activation phrase
  "IsGlobal": boolean,
  "Name": string, // Has to be unique, same as 'PluginName' in the project name pattern  
  "Author": string,
  "Version": "1.0.0", // For future compatibility
  "Language": "csharp", // So far we support only csharp 
  "Website": "https://aka.ms/powertoys", // Has to be an absolute uri starting with "http://" or "https://".
  "ExecuteFileName": string, // Should be {Type}.PowerToys.Run.Plugin.{PluginName}.dll
  "IcoPathDark": string, // Path to dark theme icon. The path is relative to the root plugin folder 
  "IcoPathLight": string // Path to light theme icon. The path is relative to the root plugin folder
  "DynamicLoading": bool // Sets whether the plugin should dynamically load any dependencies isolated from the core application.  
}
```

----------------------------------------

TITLE: Defining List Page Interfaces in C#
DESCRIPTION: Core interface definitions for DevPal's list pages functionality. Includes interfaces for context items, command items, list items, grid properties, and page implementations that establish the contract between extensions and the host application.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_6

LANGUAGE: csharp
CODE:
```
[uuid("c78b9851-e76b-43ee-8f76-da5ba14e69a4")]
interface IContextItem {}

interface ICommandItem requires INotifyPropChanged {
    ICommand Command{ get; };
    IContextItem[] MoreCommands{ get; };
    IIconInfo Icon{ get; };
    String Title{ get; };
    String Subtitle{ get; };
}

interface ICommandContextItem requires ICommandItem, IContextItem {
    Boolean IsCritical { get; }; // READ: "make this red"
    KeyChord RequestedShortcut { get; };
}

[uuid("924a87fc-32fe-4471-9156-84b3b30275a6")]
interface ISeparatorContextItem requires IContextItem {}

interface IListItem requires ICommandItem {
    ITag[] Tags{ get; };
    IDetails Details{ get; };
    String Section { get; };
    String TextToSuggest { get; };
}

interface IGridProperties  {
    Windows.Foundation.Size TileSize { get; };
}

interface IListPage requires IPage, INotifyItemsChanged {
    // DevPal will be responsible for filtering the list of items, unless the
    // class implements IDynamicListPage
    String SearchText { get; };
    String PlaceholderText { get; };
    Boolean ShowDetails{ get; };
    IFilters Filters { get; };
    IGridProperties GridProperties { get; };
    Boolean HasMoreItems { get; };
    ICommandItem EmptyContent { get; };

    IListItem[] GetItems();
    void LoadMore();
}

interface IDynamicListPage requires IListPage {
    String SearchText { set; };
}
```

----------------------------------------

TITLE: Creating List Items for SSH Hosts in PowerToys Command Palette
DESCRIPTION: This method retrieves SSH hosts and creates a ListSection containing ListItem objects for each host. Each ListItem is associated with a LaunchSSHHostCommand to enable SSH connection functionality when selected.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_17

LANGUAGE: csharp
CODE:
```
    private async Task<ISection[]> DoGetItems()
    {
        List<SSHKeychainItem> items = await GetSSHHosts();
        var s = new ListSection()
        {
            Title = "SSH Hosts",
            Items = items.Select((host) => new ListItem(new LaunchSSHHostCommand(host))
            {
                Title = host.HostName,
                Subtitle = host.EscapedHost,
            }).ToArray(),
        };
        return [s];
    }
```

----------------------------------------

TITLE: Implementing Filtering Interfaces for Command Palette Extensions in C#
DESCRIPTION: Defines the interfaces for implementing list filtering capabilities in a Command Palette extension. This allows users to filter or pivot the results with customizable filter options controlled by the extension.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_9

LANGUAGE: csharp
CODE:
```
[uuid("ef5db50c-d26b-4aee-9343-9f98739ab411")]
interface IFilterItem {}

[uuid("0a923c7f-5b7b-431d-9898-3c8c841d02ed")]
interface ISeparatorFilterItem requires IFilterItem {}

interface IFilter requires IFilterItem {
    String Id { get; };
    String Name { get; };
    IIconInfo Icon { get; };
}

interface IFilters {
    String CurrentFilterId { get; set; };
    IFilterItem[] Filters();
}
```

----------------------------------------

TITLE: Defining IDynamicListPage Interface for Dynamic Filtering in C#
DESCRIPTION: Interface definition for dynamic list pages that extends IListPage with custom filtering capabilities. It allows developers to control how lists are filtered based on user queries.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_3

LANGUAGE: csharp
CODE:
```
interface IDynamicListPage requires IListPage {
    ISection[] GetItems(String query); // DevPal will do no filtering of these items
}
```

----------------------------------------

TITLE: Handling Keyboard Hook Events in C++
DESCRIPTION: The HandleKeyboardHookEvent method processes keyboard events, applying remappings and handling UI interactions. It checks various conditions and calls corresponding remapping methods in a specific order.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_2

LANGUAGE: cpp
CODE:
```
HandleKeyboardHookEvent
```

----------------------------------------

TITLE: Detecting Foreground Process in C++ for PowerToys Keyboard Manager
DESCRIPTION: The GetCurrentApplication function is used to detect the foreground process for app-specific shortcuts. It handles regular processes and full-screen UWP apps, using GetForegroundWindow, get_process_path, and GetGUIThreadInfo APIs.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagercommon.md#2025-04-15_snippet_3

LANGUAGE: C++
CODE:
```
GetCurrentApplication
```

----------------------------------------

TITLE: Implementing Property Change Notification in C#
DESCRIPTION: This code defines interfaces for property change notification in Command Palette extensions. It provides a simple mechanism similar to INotifyPropertyChanged that doesn't require XAML, allowing developers to notify DevPal when properties change.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_15

LANGUAGE: cs
CODE:
```
interface INotifyPropChanged {
    event Windows.Foundation.TypedEventHandler<Object, PropChangedEventArgs> PropChanged;
}
runtimeclass PropChangedEventArgs {
    String PropName { get; };
}
interface INotifyItemsChanged {
    event Windows.Foundation.TypedEventHandler<Object, ItemsChangedEventArgs> ItemsChanged;
}
runtimeclass ItemsChangedEventArgs {
    Int32 TotalItems { get; };
}
```

----------------------------------------

TITLE: Handling Full-screen UWP Apps in C++ for PowerToys
DESCRIPTION: The GetFullscreenUWPWindowHandle function is used to find the window handle for full-screen UWP apps when the standard method fails. It uses the GetGUIThreadInfo API to locate the window linked to the GUI thread.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagercommon.md#2025-04-15_snippet_4

LANGUAGE: C++
CODE:
```
GetFullscreenUWPWindowHandle
```

----------------------------------------

TITLE: Defining Page Interfaces in C#
DESCRIPTION: Interface definition for Pages in the DevPal SDK. Pages are commands that represent individual views in the application and provide the structure for navigation between different parts of the application.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_5

LANGUAGE: csharp
CODE:
```
interface IPage requires ICommand {
    String Title { get; };
    Boolean IsLoading { get; };

    OptionalColor AccentColor { get; };
}
```

----------------------------------------

TITLE: FancyZones Class Responsibilities Enumeration
DESCRIPTION: Lists the main responsibilities of the FancyZones class, which serves as the top-level entity and entry point for all user actions. It handles starting the FancyZones Editor, tracking work areas per monitor, monitoring virtual desktops, and detecting changes in the work environment.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/specs/FancyZones-DCR.md#2025-04-15_snippet_0

LANGUAGE: text
CODE:
```
1. Starting FancyZones Editor (C#) with appropriate command line arguments on user request.
2. Keeping track of WorkArea per monitor (currently active work area on each connected monitor).
3. Keeping track of active virtual desktops. This is performed in separate thread by polling VirtualDesktopIDs registry key and parsing its content.
4. Detecting every change in work environment, such as creating / destroying / switching between virtual desktops, closing FancyZones Editor, changing display settings and handling those changes.
```

----------------------------------------

TITLE: Configuring PowerToys Installation and Settings with Winget YAML
DESCRIPTION: This YAML configuration file demonstrates how to install PowerToys and configure its settings using the winget configure command. It includes resource definitions for installing PowerToys and configuring specific settings for ShortcutGuide and FancyZones modules.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/dsc-configure.md#2025-04-15_snippet_0

LANGUAGE: yaml
CODE:
```
properties:
  resources:
    - resource: Microsoft.WinGet.DSC/WinGetPackage
      directives:
        description: Install PowerToys
        allowPrerelease: true
      settings:
        id: PowerToys (Preview)
        source: winget

    - resource: PowerToysConfigure
      directives:
        description: Configure PowerToys
      settings:
        ShortcutGuide:
          Enabled: false
          OverlayOpacity: 1
        FancyZones:
          Enabled: true
          FancyzonesEditorHotkey: "Shift+Ctrl+Alt+F"
  configurationVersion: 0.2.0
```

----------------------------------------

TITLE: Initializing Logger in C# Projects
DESCRIPTION: This C# code snippet shows how to initialize the logger in the main function or equivalent. It specifies the location where logs will be saved.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/logging.md#2025-04-15_snippet_2

LANGUAGE: C#
CODE:
```
Logger.InitializeLogger("\\FancyZones\\Editor\\Logs");
```

----------------------------------------

TITLE: Initializing Keyboard Hook for Hotkey Control in C#
DESCRIPTION: This method initializes and starts a keyboard hook for the hotkey control, setting up callbacks for key events and defining filtering logic for keyboard events. It connects the UI layer with the native keyboard hook implementation.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/hotkeycontrol.md#2025-04-15_snippet_0

LANGUAGE: csharp
CODE:
```
        public HotkeySettingsControlHook(KeyEvent keyDown, KeyEvent keyUp, IsActive isActive, FilterAccessibleKeyboardEvents filterAccessibleKeyboardEvents)
        {
            _keyDown = keyDown;
            _keyUp = keyUp;
            _isActive = isActive;
            _filterKeyboardEvent = filterAccessibleKeyboardEvents;
            _hook = new KeyboardHook(HotkeySettingsHookCallback, IsActive, FilterKeyboardEvents);
            _hook.Start();
        }
        
```

----------------------------------------

TITLE: Saving PowerToys Settings from JSON Config
DESCRIPTION: Shows how to implement the set_config method to save PowerToy settings received as a JSON string. The method parses the JSON and saves it to the settings file.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_12

LANGUAGE: cpp
CODE:
```
// Called by the runner to pass the updated settings values as a serialized JSON.
virtual void set_config(const wchar_t* config) override { 
  try {
    // Parse the input JSON string.
    PowerToysSettings::PowerToyValues values =
      PowerToysSettings::PowerToyValues::from_json_string(config);
...
    values.save_to_settings_file();
  }
  catch (std::exception& ex) {
    // Improper JSON.
  }
}
```

----------------------------------------

TITLE: Describing Wox.Plugin Functionality in Markdown
DESCRIPTION: This snippet outlines the key functionalities and usage of the Wox.Plugin component. It highlights its role in defining base objects and interfaces for plugins, its use as a reference for C# plugin authors, and its inclusion of base commands used across all plugins.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/launcher/Wox.Plugin/README.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
* Defines base objects and interfaces for plugins
* Plugin authors making C# plugins should reference this DLL via nuget
* Contains base commands used by all plugins
```

----------------------------------------

TITLE: PowerShell Script for Creating New Command Palette Extensions
DESCRIPTION: PowerShell script command for generating a new extension project. It creates the necessary files and project structure with customizable name and display name parameters.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_6

LANGUAGE: powershell
CODE:
```
.\Exts\NewExtension.ps1 -name MastodonExtension -DisplayName "Mastodon extension for cmdpal"
```

----------------------------------------

TITLE: Initializing Logger for Low-Privilege Processes in C#
DESCRIPTION: This C# code snippet demonstrates how to initialize the logger for low-privilege processes by setting an optional second parameter to true.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/logging.md#2025-04-15_snippet_3

LANGUAGE: C#
CODE:
```
Logger.InitializeLogger("\\FileExplorer\\Monaco\\Logs", true);
```

----------------------------------------

TITLE: Implementing Toast Notification Handlers in C++
DESCRIPTION: Shows how to use toast notifications with background activation by first calling the notification function from your code and then implementing a handler function to process button clicks in handler_functions.cpp.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/common/common.md#2025-04-15_snippet_1

LANGUAGE: cpp
CODE:
```
// Your .cpp where you'd like to show a toast

#include <common/notifications.h>

void some_func() {
// ...
  notifications::show_toast_background_activated(
    L"Toast message!",                                                  // text displayed in a toast
    L"awesome_toast",                                                   // activation handler id
    {L"Press me!", L"Also could press me!", L"I'm here to be pressed!"} // buttons in a toast
  );
```

----------------------------------------

TITLE: Parsing and Validating URIs in C# for PowerToys URI Plugin
DESCRIPTION: The ExtendedUriParser.cs file parses user input to return a System.Uri result using UriBuilder. It handles edge cases not covered by UriBuilder, such as inputs ending with ':', '.', or '://'.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/uri.md#2025-04-15_snippet_0

LANGUAGE: C#
CODE:
```
// Code not provided in the original text, but would be located at:
// src/modules/launcher/Plugins/Microsoft.Plugin.Uri/UriHelper/ExtendedUriParser.cs
```

----------------------------------------

TITLE: Handling IPC Messages in C# PowerToys Runner
DESCRIPTION: Implements the callback for receiving IPC messages from the Runner process. Parses incoming JSON messages and executes all registered handlers from the IPCResponseHandleList. Includes error handling for JSON parsing failures.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/runner-ipc.md#2025-04-15_snippet_0

LANGUAGE: csharp
CODE:
```
// receive IPC Message
Program.IPCMessageReceivedCallback = (string msg) =>
{
    if (ShellPage.ShellHandler.IPCResponseHandleList != null)
    {
        try
        {
            JsonObject json = JsonObject.Parse(msg);
            foreach (Action<JsonObject> handle in ShellPage.ShellHandler.IPCResponseHandleList)
            {
                handle(json);
            }
        }
        catch (Exception)
        {
        }
    }
};
```

----------------------------------------

TITLE: Saving Keyboard Manager Configuration to File in C++
DESCRIPTION: This method saves the current keyboard remapping configuration to a JSON file. It uses a named mutex to prevent concurrent access with PowerToys Settings. The method is called when the user clicks OK in the Edit Keyboard or Edit Shortcuts windows.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagercommon.md#2025-04-15_snippet_1

LANGUAGE: C++
CODE:
```
bool KeyboardManagerState::SaveConfigToFile()
{
    // ... (code omitted for brevity)
    wil::unique_mutex_nothrow mutex;
    if (mutex.try_acquire(key_remapping_file_mutex_name, 1000))
    {
        try
        {
            // Write settings to file
            std::ofstream output(file_name);
            output << std::setw(4) << json_obj << std::endl;
            output.close();
            return true;
        }
        catch (...)
        {
            return false;
        }
    }
    return false;
}
```

----------------------------------------

TITLE: Plugin Settings JSON Structure
DESCRIPTION: Configuration structure for PowerToys Run plugins stored in settings.json, initialized from plugin.json on first run. Defines ActionKeyword and IsGlobal settings.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/overview.md#2025-04-15_snippet_1

LANGUAGE: json
CODE:
```
{
    "ActionKeyword": "string",
    "IsGlobal": boolean
}
```

----------------------------------------

TITLE: Implementing Hacker News List Page Extension in C#
DESCRIPTION: A comprehensive example demonstrating how to create a Hacker News extension with list items, commands to open links and comments, and tag display functionality. The example shows the structure for news posts and how to create list items with context commands.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_8

LANGUAGE: csharp
CODE:
```
class NewsPost {
    string Title;
    string Url;
    string CommentsUrl;
    string Poster;
    int Points;
}
class LinkCommand(NewsPost post) : Microsoft.CommandPalette.Extensions.Toolkit.InvokableCommand {
    public string Name => "Open link";
    public CommandResult Invoke() {
        Process.Start(new ProcessStartInfo(post.Url) { UseShellExecute = true });
        return CommandResult.KeepOpen;
    }
}
class CommentCommand(NewsPost post) : Microsoft.CommandPalette.Extensions.Toolkit.InvokableCommand {
    public string Name => "Open comments";
    public CommandResult Invoke() {
        Process.Start(new ProcessStartInfo(post.CommentsUrl) { UseShellExecute = true });
        return CommandResult.KeepOpen;
    }
}
class NewsListItem(NewsPost post) : Microsoft.CommandPalette.Extensions.Toolkit.ListItem {
    public string Title => post.Title;
    public string Subtitle => post.Poster;
    public IContextItem[] Commands => [
        new CommandContextItem(new LinkCommand(post)),
        new CommandContextItem(new CommentCommand(post))
    ];
    public ITag[] Tags => [ new Tag(){ Text=post.Points } ];
}
class HackerNewsPage: Microsoft.CommandPalette.Extensions.Toolkit.ListPage {
    public bool Loading => true;
    IListItem[] GetItems() {
        List<NewsItem> items = /* do some RSS feed stuff */;
        this.IsLoading = false;
        return items
                .Select((post) => new NewsListItem(post))
                .ToArray();
    }
}
```

----------------------------------------

TITLE: Implementing Custom Action Handler in PowerToys
DESCRIPTION: Shows how to implement the call_custom_action() method to handle custom action button clicks. The method parses the action data and performs specific logic based on the action name.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_10

LANGUAGE: cpp
CODE:
```
  // Signal from the Settings editor to call a custom action.
  // This can be used to spawn more complex editors.
  virtual void call_custom_action(const wchar_t* action) override {
    static UINT custom_action_num_calls = 0;
    try {
      // Parse the action values, including name.
      PowerToysSettings::CustomActionObject action_object =
        PowerToysSettings::CustomActionObject::from_json_string(action);

      if (action_object.get_name() == L"test_custom_action") {
        // Custom action code to increase and show a counter.
        ++custom_action_num_calls;
        std::wstring msg(L"I have been called ");
        msg += std::to_wstring(custom_action_num_calls);
        msg += L" time(s).";
        MessageBox(NULL, msg.c_str(), L"Custom action call.", MB_OK | MB_TOPMOST);
      }
    }
    catch (std::exception& ex) {
      // Improper JSON.
    }
  }
```

----------------------------------------

TITLE: Manually Building and Saving PowerToys Settings
DESCRIPTION: Shows how to manually build a PowerToyValues object containing various property types and save it to the settings file. This approach offers more control over the settings processing.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_13

LANGUAGE: cpp
CODE:
```
// This method of saving the module settings is only required if you need to do any
// custom processing of the settings before saving them to disk.
void ExamplePowertoy::save_settings() {
  try {
    // Create a PowerToyValues object for this PowerToy
    PowerToysSettings::PowerToyValues values(get_name());

    // Save the bool property.
    values.add_property(
      L"test_bool_toggle", // property name
      g_settings.test_bool_prop // property value
    );

    // Save the int property.
    values.add_property(
      L"test_int_spinner", // property name
      g_settings.test_int_prop // property value
    );

    // Save the string property.
    values.add_property(
      L"test_string_text", // property name
      g_settings.test_string_prop // property value
    );

    // Save the color property.
    values.add_property(
      L"test_color_picker", // property name
      g_settings.test_color_prop // property value
    );

    // Save the PowerToyValues JSON to the power toy settings file.
    values.save_to_settings_file();
  }
  catch (std::exception& ex) {
    // Couldn't save the settings.
  }
}
```

----------------------------------------

TITLE: OleDB Search Implementation for Windows Indexer
DESCRIPTION: Implements database querying functionality to search the Windows Search index through OleDB connections. Executes queries against the SystemIndex catalog to retrieve file search results.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/indexer.md#2025-04-15_snippet_1

LANGUAGE: C#
CODE:
```
// OleDBSearch.cs reference
```

----------------------------------------

TITLE: Registering Toast Notification Handler Functions in C++
DESCRIPTION: Demonstrates how to implement and register a toast notification handler function that processes button clicks based on their index. This needs to be added to handler_functions.cpp and registered in the handlers_map.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/common/common.md#2025-04-15_snippet_2

LANGUAGE: cpp
CODE:
```
// handler_functions.cpp
void awesome_toast_handler(IBackgroundTaskInstance, const size_t button_id)
{
  switch(button_id)
  {
    case 0:
      // handle "Press me!" button click
    case 1:
      // handle "Also could press me!" button click
    case 2:
      // handle "I'm here to be pressed!" button click
  }
}

namespace
{
  const std::unordered_map<std::wstring_view, handler_function_t> handlers_map = {
    // ...other handlers...
    {L"awesome_toast", awesome_toast_handler}
  };}
```

----------------------------------------

TITLE: Drive Detection Implementation for Windows Search Indexer
DESCRIPTION: Component that checks Windows registry to determine if Enhanced Mode indexing is enabled by verifying the EnableFindMyFiles registry value. Used to display appropriate warnings about partial system indexing.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/indexer.md#2025-04-15_snippet_0

LANGUAGE: C#
CODE:
```
// IndexerDriveDetection.cs reference
```

----------------------------------------

TITLE: Windows Search API Integration
DESCRIPTION: Implements high-level search functionality using the Windows Search API, initializing query helpers and managing metadata retrieval. Handles file attribute filtering and result ranking based on last modified date.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/indexer.md#2025-04-15_snippet_2

LANGUAGE: C#
CODE:
```
// WindowsSearchAPI.cs reference
```

----------------------------------------

TITLE: Loading PowerToys Settings from File
DESCRIPTION: Shows how to load PowerToy settings from the settings file. The code loads various property types (boolean, integer, string, color) and handles exceptions if the settings file is corrupted.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_11

LANGUAGE: cpp
CODE:
```
// Load the settings file.
void ExamplePowertoy::init_settings() {
  try {
    // Load and parse the settings file for this PowerToy.
    PowerToysSettings::PowerToyValues settings =
      PowerToysSettings::PowerToyValues::load_from_settings_file(get_name());

    // Load the bool property.
    if (settings.is_bool_value(L"test_bool_toggle")) {
      g_settings.test_bool_prop = settings.get_bool_value(L"test_bool_toggle");
    }

    // Load the int property.
    if (settings.is_int_value(L"test_int_spinner")) {
      g_settings.test_int_prop = settings.get_int_value(L"test_int_spinner");
    }

    // Load the string property.
    if (settings.is_string_value(L"test_string_text")) {
      g_settings.test_string_prop = settings.get_string_value(L"test_string_text");
    }

    // Load the color property.
    if (settings.is_string_value(L"test_color_picker")) {
      g_settings.test_color_prop = settings.get_string_value(L"test_color_picker");
    }
  }
  catch (std::exception& ex) {
    // Error while loading from the settings file. Let default values stay as they are.
  }
}
```

----------------------------------------

TITLE: Implementing SSH Connection Command in C#
DESCRIPTION: This class creates a command to launch Windows Terminal with an SSH connection to a selected host. It implements the InvokableCommand interface with an Invoke method that starts a command prompt and executes the SSH command with the appropriate host.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_16

LANGUAGE: csharp
CODE:
```
internal sealed partial class LaunchSSHHostCommand : InvokableCommand
{
    private readonly SSHKeychainItem _host;

    internal LaunchSSHHostCommand(SSHKeychainItem host)
    {
        this._host = host;
        this.Name = "Connect";
        this.Icon = new("\uE8A7");
    }

    public override CommandResult Invoke()
    {
        try
        {
            Process.Start("cmd.exe", $"/k ssh {_host.HostName}");
        }
        catch
        {
            Process.Start(new ProcessStartInfo("cmd.exe", $"/k ssh {_host.HostName}") { UseShellExecute = true });
        }

        return CommandResult.KeepOpen();
    }
}
```

----------------------------------------

TITLE: Reading a String Value in PowerToys
DESCRIPTION: Shows how to read a string value from a PowerToyValues object. The code checks if the value exists using is_string_value() before retrieving it with get_string_value().
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_6

LANGUAGE: cpp
CODE:
```
// Update the string property.
if (values.is_string_value(L"test_string_text")) {
  g_settings.test_string_prop = values.get_string_value(L"test_string_text");
}
```

----------------------------------------

TITLE: Implementing a Simple Command Example in C#
DESCRIPTION: Example implementation of a simple invokable command that opens Hacker News in the default web browser. Demonstrates basic command implementation using the toolkit's InvokableCommand class.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_4

LANGUAGE: cs
CODE:
```
class HackerNewsPage : Microsoft.CommandPalette.Extensions.Toolkit.InvokableCommand {
    public class HackerNewsPage()
    {
        Name = "Hacker News";
        Icon = "https://news.ycombinator.com/favicon.ico";
    }

    public ICommandResult Invoke() {
        Process.Start(new ProcessStartInfo("https://news.ycombinator.com/") { UseShellExecute = true });
        return CommandResult.Hide();
    }
}
```

----------------------------------------

TITLE: Updating Command Palette Provider with SSHHostsListPage
DESCRIPTION: Updated implementation of the Command Provider that links the top-level command to the SSHHostsListPage, enabling navigation to the SSH hosts list when the command is executed.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_12

LANGUAGE: csharp
CODE:
```
private readonly IListItem[] _commands = [
       new ListItem(new SSHHostsListPage())
        {
            Title = "Search SSH Keys",
            Subtitle = "Quickly find and launch into hosts from your SSH config file",
        },
    ];
```

----------------------------------------

TITLE: Checking Keyboard State for Shortcut Remapping in C++
DESCRIPTION: This method checks if any keys other than those in the specified shortcut are pressed. It's used in the HandleShortcutRemapEvent to ensure shortcut-to-shortcut remaps are only applied when no other keys are pressed.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagercommon.md#2025-04-15_snippet_2

LANGUAGE: C++
CODE:
```
bool Shortcut::IsKeyboardStateClearExceptShortcut(BYTE* keyboardState, bool isKeyCodeUsed[])
{
    // ... (code omitted for brevity)
    for (int keyCode = 0; keyCode < 256; keyCode++)
    {
        if (!IgnoreKeyCode((DWORD)keyCode) && !isKeyCodeUsed[keyCode] && (keyboardState[keyCode] & 0x80))
        {
            return false;
        }
    }
    return true;
}
```

----------------------------------------

TITLE: Detecting Shortcut UI Backend in C++
DESCRIPTION: The DetectShortcutUIBackend method handles hook operations for the shortcut Type UI in both Remap keys and Remap shortcuts windows. It updates the UI with the shortcut from recent events when the Type button is clicked.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_4

LANGUAGE: cpp
CODE:
```
KeyboardManagerState.DetectShortcutUIBackend(data, true)
```

LANGUAGE: cpp
CODE:
```
KeyboardManagerState.DetectShortcutUIBackend(data, false)
```

----------------------------------------

TITLE: PowerToys Module Disable Method
DESCRIPTION: Virtual method for disabling the PowerToy module and freeing memory.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_7

LANGUAGE: cpp
CODE:
```
virtual void disable()
```

----------------------------------------

TITLE: Basic Toast Notification Usage in C++
DESCRIPTION: Demonstrates the two main functions for showing toast notifications in PowerToys. The first function shows a simple toast with just a message, while the second allows for background activation with custom buttons.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/common/common.md#2025-04-15_snippet_0

LANGUAGE: cpp
CODE:
```
    void show_toast(std::wstring_view message);       // #1
    
    void show_toast_background_activated(             // #2
      std::wstring_view message,
      std::wstring_view background_handler_id,
      std::vector<std::wstring_view> button_labels);
```

----------------------------------------

TITLE: Registering DevPal Extension in AppxManifest
DESCRIPTION: XML configuration showing how to register a DevPal extension in the application manifest. Includes both COM server registration and app extension declaration with required properties and interfaces.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_0

LANGUAGE: xml
CODE:
```
<Extensions>
    <com:Extension Category="windows.comServer">
        <com:ComServer>
            <com:ExeServer Executable="ExtensionName.exe" Arguments="-RegisterProcessAsComServer" DisplayName="Sample Extension">
                <com:Class Id="<Extension CLSID Here>" DisplayName="Sample Extension" />
            </com:ExeServer>
        </com:ComServer>
    </com:Extension>
    <uap3:Extension Category="windows.appExtension">
        <uap3:AppExtension Name="com.microsoft.commandpalette"
                           Id="YourApplicationUniqueId"
                           PublicFolder="Public"
                           DisplayName="Sample Extension"
                           Description="Sample Extension for Run">
            <uap3:Properties>
                <CmdPalProvider>
                    <Activation>
                        <CreateInstance ClassId="<Extension CLSID Here>" />
                    </Activation>
                    <SupportedInterfaces>
                        <Commands />
                    </SupportedInterfaces>
                </CmdPalProvider>
            </uap3:Properties>
        </uap3:AppExtension>
    </uap3:Extension>
</Extensions>
```

----------------------------------------

TITLE: Mocking SendInput Method for Keyboard Manager Testing in C++
DESCRIPTION: This snippet demonstrates how the SendInput method is mocked for testing the Keyboard Manager module. It processes input events, handles key states, and simulates low-level hook behavior.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardeventhandlers.md#2025-04-15_snippet_0

LANGUAGE: cpp
CODE:
```
// Iterate over all the inputs in the INPUT vector argument.
// If the event is a key up event, then it is considered WM_SYSKEYUP if Alt is held down, otherwise it is WM_KEYUP.
// If the event is a key down event, then it is considered WM_SYSKEYDOWN if either Alt is held down or if it is F10, otherwise it is WM_KEYDOWN.
// An optional function which can be set on the MockedInput handler can be used to test for the number of times a key event is received by the system with a particular condition using sendVirtualInputCallCondition.
// The hook logic for a low level hook which returns 0 or 1 can be set on the MockedInput handler such that it behaves like a low level hook would behave with actual keyboard input.
// If the method returns 1, then the keyboard state is not updated, and if it returns 0 the corresponding key event is used to update the key state.
// For updating the keyboard state, KEYUP messages result in the state for that key code being set to false, and KEYDOWN result in the state for that key code being set to true.
// For modifiers the behavior is slightly different as if the key state of the L/R version is modified, it should also modify the common version, and if a common version is released, it should release both the L and R versions.
```

----------------------------------------

TITLE: Adding Resource Generation Build Event in C++ Projects
DESCRIPTION: Configures a pre-build event that converts .resx files to .rc and resource.h files for C++ projects. This target calls a PowerShell script to handle the conversion process before the build begins.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_1

LANGUAGE: XML
CODE:
```
<Target Name="GenerateResourceFiles" BeforeTargets="PrepareForBuild">
    <Exec Command="powershell -NonInteractive -executionpolicy Unrestricted $(SolutionDir)tools\build\convert-resx-to-rc.ps1 $(MSBuildThisFileDirectory) resource.base.h resource.h ProjName.base.rc ProjName.rc" />
</Target>
```

----------------------------------------

TITLE: Reading a Color Picker Value in PowerToys
DESCRIPTION: Shows how to read a color value from a PowerToyValues object. The code checks if the string value exists using is_string_value() before retrieving it with get_string_value().
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_8

LANGUAGE: cpp
CODE:
```
// Update the color property.
if (values.is_string_value(L"test_color_picker")) {
  g_settings.test_color_prop = values.get_string_value(L"test_color_picker");
}
```

----------------------------------------

TITLE: Defining Custom Language Template in Monaco Editor
DESCRIPTION: Template for creating a new language definition using Monaco's Monarch syntax. This exports a function that returns the language configuration object.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/common/FilePreviewCommon.md#2025-04-15_snippet_0

LANGUAGE: javascript
CODE:
```
export function idDefinition() {
    return {
        ...
    }
}
```

----------------------------------------

TITLE: Implementing ShowWindow Function in C# for Window Management
DESCRIPTION: This function calls the Windows API to show or hide a window with a specified handle. It imports the necessary ShowWindow function from user32.dll and provides a managed wrapper around it.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/AdvancedPaste/AdvancedPaste/NativeMethods.txt#2025-04-15_snippet_0

LANGUAGE: C#
CODE:
```
ShowWindow

```

----------------------------------------

TITLE: Implementing a Command Provider for SSH Keychain Extension in C#
DESCRIPTION: Example implementation of a CommandProvider class for an SSH Keychain extension. It defines a top-level command "Search SSH Keys" that will appear in the Command Palette root view.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_7

LANGUAGE: csharp
CODE:
```
public class SSHKeychainCommandsProvider : CommandProvider
{
    public SSHKeychainCommandsProvider()
    {
        DisplayName = "SSH Keychain Commands";
    }

    private readonly ICommandItem[] _commands = [
       new CommandItem(new NoOpCommand())
        {
            Title = "Search SSH Keys",
            Subtitle = "Quickly find and launch into hosts from your SSH config file",
        },
    ];

    public override ICommandItem[] TopLevelCommands()
    {
        return _commands;
    }
}
```

----------------------------------------

TITLE: Setting Scan Code for Key Events in C++
DESCRIPTION: The SetKeyEvent method uses MapVirtualKey API to find the scan code from the virtual key code, preventing issues with applications that filter out key events with scan code 0.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_7

LANGUAGE: cpp
CODE:
```
SetKeyEvent
```

----------------------------------------

TITLE: StatusMessage interface definitions for PowerToys Command Palette
DESCRIPTION: Interfaces defining the status message system for PowerToys Command Palette extensions. These interfaces allow extensions to display progress indicators, success/error messages, and log debug information through the host application.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_21

LANGUAGE: csharp
CODE:
```
enum MessageState
{
    Info = 0,
    Success,
    Warning,
    Error,
};

enum StatusContext
{
    Page,
    Extension
};

interface IProgressState requires INotifyPropChanged
{
    Boolean IsIndeterminate { get; };
    UInt32 ProgressPercent { get; };
};

interface IStatusMessage requires INotifyPropChanged
{
    MessageState State { get; };
    IProgressState Progress { get; };
    String Message { get; };
    // TODO! Icon maybe? Work with design on this
};

interface ILogMessage
{
    MessageState State { get; };
    String Message { get; };
};

interface IExtensionHost
{
    Windows.Foundation.IAsyncAction ShowStatus(IStatusMessage message, StatusContext context);
    Windows.Foundation.IAsyncAction HideStatus(IStatusMessage message);

    Windows.Foundation.IAsyncAction LogMessage(ILogMessage message);
};
```

----------------------------------------

TITLE: Handling Key Delay Events in C++
DESCRIPTION: This method checks if the UI is in the foreground and runs registered key delay handlers if so. It's part of the KeyboardManagerState class and is called from the low-level keyboard hook.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagercommon.md#2025-04-15_snippet_0

LANGUAGE: C++
CODE:
```
void KeyboardManagerState::HandleKeyDelayEvent()
{
    // Check if the UI is in focus
    if (CheckUIState())
    {
        for (int i = 0; i < key_delay_objects.size(); i++)
        {
            key_delay_objects[i]->DelayThread();
        }
    }
}
```

----------------------------------------

TITLE: Optional Plugin Settings Table in Markdown
DESCRIPTION: A markdown table showing the configurable settings for the Windows System Commands Plugin, including their keys, default values, and descriptions. These settings control confirmation dialogs, localization, and search result priority.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/system.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
| Key | Default value | Name/Description |
|--------------|-----------|------------|
| `ConfirmSystemCommands` | `false` | Show a dialog to confirm system commands |
| `LocalizeSystemCommands` | `true` | Use localized system commands instead of English ones |
| `ReduceNetworkResultScore` | `true` | Reduce the priority of 'IP' and 'MAC' results to improve the order in the global results |
```

----------------------------------------

TITLE: Configuring Optional Plugin Settings for Time and Date in PowerToys
DESCRIPTION: Details the optional settings available for the Time and Date plugin, including their keys, types, default values, and descriptions.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/timedate.md#2025-04-15_snippet_1

LANGUAGE: markdown
CODE:
```
| Key | Type | Default value | Name | Description |
|--------------|--------------|-----------|------------|------------|
| `OnlyDateTimeNowGlobal` | Checkbox | `true` | Show only 'Time', 'Date', and 'Now' result for system time on global queries | Regardless of this setting, for global queries the first word of the query has to be a complete match. |
| `TimeWithSeconds` | Checkbox | `false` | Show time with seconds | This setting applies to the 'Time' and 'Now' result. |
| `DateWithWeekday` | Checkbox | `false` | Show date with weekday and name of month | This setting applies to the 'Date' and 'Now' result. |
| `HideNumberMessageOnGlobalQuery` | Checkbox | `false` | Hide 'Invalid number input' error message on global queries | |
| `CalendarFirstWeekRule` | Combo box | `-1` (Use system settings) | First week of the year | Configure the calendar rule for the first week of the year. |
| `FirstDayOfWeek` | Combo box | `-1` (Use system settings) | First day of the week | |
| `CustomFormats` | Multiline text box | `string.Empty` | Custom formats | Use date and time string format syntax and DOW (Day of Week), WOM (Week of Month), WOY (Week of the year), EAB (Era abbreviation), WFT (Windows File Time), UXT (Unix Time), UMS (Unix Time in milliseconds), OAD (OLE Automation date), EXC (Excel's 1900 based date value), EXF (Excel's 1904 based date value). If the format starts with UTC:, then Universal Time (UTC) is used. (Use a backslash to escape format sequences and the backslash character as text.) |
```

----------------------------------------

TITLE: Registering Preview Handler DLL using RegAsm
DESCRIPTION: Commands for registering a preview handler DLL to the system. This involves adding the handler to the Global Assembly Cache and registering it with RegAsm.exe. Note that this direct registration method is not recommended for production use.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/previewpane/README.md#2025-04-15_snippet_1

LANGUAGE: batch
CODE:
```
cd C:\Windows\Microsoft.NET\Framework64\4.0.x.x
gacutil -i <path to XYZPreviewHandler.dll>
RegAsm.exe /codebase <path to XYZPreviewHandler.dll>
```

----------------------------------------

TITLE: Defining Supported Units in UnitHandler.cs
DESCRIPTION: This code snippet references the UnitHandler.cs file where the currently supported units for conversion are defined. It includes various physical quantities such as acceleration, angle, area, and more.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/community.unitconverter.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
These are the ones that are currently enabled (though UnitsNet supports many more). They are defined in [`UnitHandler.cs`](/src/modules/launcher/Plugins/Community.PowerToys.Run.Plugin.UnitConverter/UnitHandler.cs).
```

----------------------------------------

TITLE: Detecting Single Key Remap UI Backend in C++
DESCRIPTION: The DetectSingleRemapKeyUIBackend method handles hook operations for the single key Type UI in the Remap keys window. It updates the UI with the latest key from recent events when the left column Type button is clicked.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_3

LANGUAGE: cpp
CODE:
```
KeyboardManagerState.DetectSingleRemapKeyUIBackend
```

----------------------------------------

TITLE: Defining Custom Time and Date Formats in PowerToys
DESCRIPTION: Explains how users can create custom time and date formats in the plugin settings. Each format is defined on a separate line with a name and syntax pattern.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/timedate.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
**Custom format definition**
The user can create its own formats. One per line in the settings text box. The format of each line is `<name>=<syntax pattern>`.
If the syntax pattern starting with `UTC:` then we use the UTC time instead of the local time.
As syntax pattern the pattern from `DateTime.ToString()` and the following custom pattern are available:
- DOW: Number of the day in the week.
- WOM: Number of week in the month.
- WOY: Number of the week in the year.
- EAB: Era abbreviation.
- WFT: Windows file time.
- UXT: Unix time stamp.
- UMS: Unix time stamp in milliseconds.
- OAD: OLE Automation date.
- EXC: Excel's 1900 based date value.
- EXF: Excel's 1904 based date value.
```

----------------------------------------

TITLE: Managing UI Controls with Vector of Unique Pointers in C++
DESCRIPTION: Uses vectors of unique pointers to manage SingleKeyRemapControl and ShortcutControl objects, ensuring proper memory management and access to UI components.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagerui.md#2025-04-15_snippet_3

LANGUAGE: C++
CODE:
```
std::vector<std::vector<std::unique_ptr<SingleKeyRemapControl>>> singleKeyRemapControlObjects;
std::vector<std::vector<std::unique_ptr<ShortcutControl>>> shortcutControlObjects;
```

----------------------------------------

TITLE: Creating ICommandContextItem from IListItem Command in C#
DESCRIPTION: This snippet demonstrates how a new ICommandContextItem is created from an IListItem's default Command when displaying it as a context item. It shows the property mapping between the list item and the context item object.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_22

LANGUAGE: csharp
CODE:
```
ICommandContextItem(){
    Command = ICommandItem.Command,
    MoreCommands = null,
    Icon = Command.Icon, // use icon from command, not list item
    Title = Command.Name, // Use command's name, not list item
    Subtitle = IListItem.Title, // Use the title of the list item as the tooltip on the context menu
    IsCritical = false,
}
```

----------------------------------------

TITLE: Sending Dummy Key Events in C++
DESCRIPTION: A function to send dummy key events (key down and key up) using the undocumented 0xFF virtual key code. This prevents unintended behavior with modifier keys in certain scenarios.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_8

LANGUAGE: cpp
CODE:
```
// Code for sending dummy key events
INPUT dummyEvent[2];
SetKeyEvent(&dummyEvent[0], 0xFF, KEYEVENTF_KEYDOWN);
SetKeyEvent(&dummyEvent[1], 0xFF, KEYEVENTF_KEYUP);
SendInput(2, dummyEvent, sizeof(INPUT));
```

----------------------------------------

TITLE: PowerToys Module Configuration Getter Method
DESCRIPTION: Method for retrieving module configuration settings. Returns false if buffer is null or too small, setting required size in buffer_size parameter.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_3

LANGUAGE: cpp
CODE:
```
virtual bool get_config(wchar_t* buffer, int *buffer_size)
```

----------------------------------------

TITLE: Handling Extended Keys in C++
DESCRIPTION: The SetKeyEvent method checks for extended keys using IsExtendedKey and sets the KEYEVENTF_EXTENDEDKEY flag accordingly. This prevents issues with NumPad versions of keys being sent inadvertently.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_6

LANGUAGE: cpp
CODE:
```
SetKeyEvent
```

LANGUAGE: cpp
CODE:
```
IsExtendedKey
```

----------------------------------------

TITLE: Querying OneNote Pages in C#
DESCRIPTION: This snippet demonstrates how to search OneNote pages based on a user query using the ScipBe-Common-Office library. The results are cached for 1 day for improved performance.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/onenote.md#2025-04-15_snippet_0

LANGUAGE: csharp
CODE:
```
var pages = OneNoteProvider.FindPages(query.Search);
```

----------------------------------------

TITLE: Defining Minimum Windows Setting Entry in JSON
DESCRIPTION: Demonstrates the minimum required fields for adding a new Windows setting entry in the WindowsSettings.json file. It includes the Name, Type, and Command properties.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/windowssettings.md#2025-04-15_snippet_0

LANGUAGE: json
CODE:
```
  {
    "Name": "mySetting",
    "Type": "AppSettingsApp",
    "Command": "ms-settings:mySetting"
  }
```

----------------------------------------

TITLE: PowerToys Module Factory Function Type Definition
DESCRIPTION: Type definition for the factory function that creates PowerToy objects. Must be exported by each module's DLL as powertoy_create().
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_1

LANGUAGE: cpp
CODE:
```
typedef PowertoyModuleIface* (__cdecl *powertoy_create_func)()
```

----------------------------------------

TITLE: PowerToys Module Custom Action Handler
DESCRIPTION: Method for handling custom actions triggered from the Settings editor, such as spawning custom editors.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_5

LANGUAGE: cpp
CODE:
```
virtual void call_custom_action(const wchar_t* action)
```

----------------------------------------

TITLE: Launching Keyboard Manager UI in C++
DESCRIPTION: The call_custom_action method is used to launch the Keyboard Manager UI when the user clicks the Remap buttons from the settings page. It checks for existing windows and launches a new one if needed.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_5

LANGUAGE: cpp
CODE:
```
call_custom_action
```

----------------------------------------

TITLE: Num Lock State Management
DESCRIPTION: Implementation for managing Num Lock key state when suppressing events, using additional key up/down events with suppression flags to maintain correct state.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_10

LANGUAGE: cpp
CODE:
```
// When suppressing Num Lock key down event
SendInput(KEYEVENTF_KEYUP, VK_NUMLOCK, KEYBOARDMANAGER_SUPPRESS_FLAG);
SendInput(KEYEVENTF_KEYDOWN, VK_NUMLOCK, KEYBOARDMANAGER_SUPPRESS_FLAG);
```

----------------------------------------

TITLE: Defining Color and OptionalColor Structures in C#
DESCRIPTION: These structures provide a way to represent colors independently of Windows.UI.Color and handle cases where colors may be optional. The OptionalColor struct avoids ownership semantics issues that might arise with IReference<Color>.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_13

LANGUAGE: c#
CODE:
```
struct Color
{
    UInt8 R;
    UInt8 G;
    UInt8 B;
    UInt8 A;
};

struct OptionalColor
{
    Boolean HasValue;
    Microsoft.CommandPalette.Extensions.Color Color;
};
```

----------------------------------------

TITLE: Retrieving Resource Strings in C++
DESCRIPTION: Shows how to retrieve localized strings in C++ code using the GET_RESOURCE_STRING method.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/guidance.md#2025-04-15_snippet_2

LANGUAGE: cpp
CODE:
```
#include <common.h>

std::wstring GET_RESOURCE_STRING(IDS_MODULE_DISPLAYNAME)
```

----------------------------------------

TITLE: Defining Full Windows Setting Entry in JSON
DESCRIPTION: Shows a complete entry for a Windows setting in the WindowsSettings.json file, including all optional fields such as Areas, AltNames, Note, IntroducedInBuild, DeprecatedInBuild, and ShowAsFirstResult.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/windowssettings.md#2025-04-15_snippet_1

LANGUAGE: json
CODE:
```
  {
    "Name": "mySetting",
    "Type": "AppSettingsApp",
    "Command": "ms-settings:mySetting",
    "Areas": [ "AreaMySettingArea" ],
    "AltNames": [ "NiceSetting" ],
    "Note": "NoteMySettingNote",
    "IntroducedInBuild" : 1903,
    "DeprecatedInBuild" : 2004,
    "ShowAsFirstResult" : true
  }
```

----------------------------------------

TITLE: Defining IMarkdownPage Interface for Command Palette Markdown Pages in C#
DESCRIPTION: Interface definition for markdown pages within the Command Palette that display rich formatted content. It includes methods to retrieve markdown bodies, details, and associated commands for context.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_1

LANGUAGE: csharp
CODE:
```
interface IMarkdownPage requires IPage {
     String[] Bodies(); // TODO! should this be an IBody, so we can make it observable?
     IDetails Details();
     IContextItem[] Commands { get; };
 }
```

----------------------------------------

TITLE: Japanese IME Modifier Key Handling
DESCRIPTION: Code for handling modifier key interactions with Caps Lock on Japanese IME keyboards, using suppressed key events to prevent modifier key stuck states.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_11

LANGUAGE: cpp
CODE:
```
// For Ctrl to Caps Lock remap
SendInput(KEYEVENTF_KEYUP, VK_CONTROL, KEYBOARDMANAGER_SUPPRESS_FLAG);
SendInput(KEYEVENTF_KEYDOWN, VK_CAPITAL, 0);
SuppressKey(VK_CONTROL);

// For Caps Lock to Ctrl remap
SendInput(KEYEVENTF_KEYDOWN, VK_CONTROL, 0);
SendInput(KEYEVENTF_KEYUP, VK_CONTROL, KEYBOARDMANAGER_SUPPRESS_FLAG);
SuppressKey(VK_CAPITAL);
```

----------------------------------------

TITLE: Unregistering Preview Handler DLL using RegAsm
DESCRIPTION: Commands for unregistering a previously registered preview handler DLL from the system. This involves using RegAsm.exe to unregister the DLL and removing it from the Global Assembly Cache.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/previewpane/README.md#2025-04-15_snippet_2

LANGUAGE: batch
CODE:
```
cd C:\Windows\Microsoft.NET\Framework64\4.0.x.x
RegAsm.exe /unregister <path to XYZPreviewHandler.dll>
gacutil -u XYZPreviewHandler
```

----------------------------------------

TITLE: Including Localized Resources in C# Projects
DESCRIPTION: XML configuration to include all localized resource files in a C# project. This embeds all culture-specific resources in the compiled assembly.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_4

LANGUAGE: XML
CODE:
```
<EmbeddedResource Include="Properties\Resources.*.resx" />
```

----------------------------------------

TITLE: Adding a Boolean Toggle Setting in PowerToys
DESCRIPTION: Shows how to add a boolean property with a toggle editor to a Settings object. The toggle requires a property name, description string, and the property value to be displayed and modified.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_1

LANGUAGE: cpp
CODE:
```
// Add a bool property with a toggle editor.
settings.add_bool_toggle(
  L"test_bool_toggle", // property name.
  L"This is what a BoolToggle property looks like", // description or resource id of the localized string.
  g_settings.test_bool_prop // property value.
);
```

----------------------------------------

TITLE: Defining IFormPage Interface for Command Palette Form Pages in C#
DESCRIPTION: Interface definition for form pages within the Command Palette that display interactive forms. It includes a method to retrieve the forms to be displayed on the page.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_2

LANGUAGE: csharp
CODE:
```
interface IFormPage requires IPage {
     IForm[] Forms();
 }
```

----------------------------------------

TITLE: Cross-DLL Safe String Allocation in C++ for PowerToys
DESCRIPTION: The GetForegroundProcess method uses a specific string allocation technique to avoid exceptions when running tests across DLL boundaries. It uses an output variable approach instead of returning a string directly.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagercommon.md#2025-04-15_snippet_5

LANGUAGE: C++
CODE:
```
GetForegroundProcess
```

----------------------------------------

TITLE: Specifying Test Scope for FancyZones Module in PowerToys UI Testing
DESCRIPTION: C# code snippet demonstrating how to set the scope for UI tests specific to the FancyZones module in PowerToys. It shows the class inheritance and constructor setup.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/UITests.md#2025-04-15_snippet_1

LANGUAGE: csharp
CODE:
```
[TestClass]
public class RunFancyZonesTest : UITestBase
{
    public RunFancyZonesTest()
        : base(PowerToysModule.FancyZone)
    {
    }
}
```

----------------------------------------

TITLE: Adding a String Setting in PowerToys
DESCRIPTION: Shows how to add a string property with a textbox editor to a Settings object. The text input requires a property name, description string, and the current property value.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_5

LANGUAGE: cpp
CODE:
```
// Add a string property with a textbox editor.
settings.add_string(
  L"test_string_text", // property name.
  L"This is what a String property looks like", // description or resource id of the localized string.
  g_settings.test_string_prop // property value.
);
```

----------------------------------------

TITLE: Reading a Boolean Toggle Value in PowerToys
DESCRIPTION: Shows how to read a boolean value from a PowerToyValues object. The code checks if the value exists using is_bool_value() before retrieving it with get_bool_value().
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_2

LANGUAGE: cpp
CODE:
```
// Update the bool property.
if (values.is_bool_value(L"test_bool_toggle")) {
  g_settings.test_bool_prop = values.get_bool_value(L"test_bool_toggle");
}
```

----------------------------------------

TITLE: Defining IListPage Interface for Command Palette List Pages in C#
DESCRIPTION: Interface definition for list pages within the Command Palette that display filterable lists of items. It includes properties for search text, placeholder text, detail visibility, filters, and grid properties along with a method to retrieve items.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_0

LANGUAGE: csharp
CODE:
```
interface IListPage requires IPage {
    String SearchText { get; };
    String PlaceholderText { get; };
    Boolean ShowDetails{ get; };
    IFilters Filters { get; };
    IGridProperties GridProperties { get; };

    ISection[] GetItems(); // DevPal will be responsible for filtering the list of items
}
```

----------------------------------------

TITLE: Resolving Valid URIs in C# for PowerToys URI Plugin
DESCRIPTION: The UriResolver.cs file validates hosts for URIs. Currently, it returns true for all valid URIs created from user queries, but can be expanded to filter specific hosts in the future.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/uri.md#2025-04-15_snippet_1

LANGUAGE: C#
CODE:
```
// Code not provided in the original text, but would be located at:
// src/modules/launcher/Plugins/Microsoft.Plugin.Uri/UriHelper/UriResolver.cs
```

----------------------------------------

TITLE: PowerToys Telemetry Structure Overview
DESCRIPTION: Hierarchical structure showing the relationship between telemetry components including Settings.UI.Library/Telemetry for event generation, EventBase for common PowerToys telemetry attributes, and IEvent for base telemetry requirements.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/telemetry.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
# Telemetry\n## Overview\n[`Settings.UI.Library/Telemetry`](/src/settings-ui/Settings.UI.Library/Telemetry) contains telemetry events generated by `Settingsv2.` These event classes are derived from the [`EventBase`](/src/common/ManagedTelemetry/Telemetry/Events/EventBase.cs) class and [`IEvent`](/src/common/ManagedTelemetry/Telemetry/Events/IEvent.cs) class.
```

----------------------------------------

TITLE: Adding an Integer Spinner Setting in PowerToys
DESCRIPTION: Shows how to add an integer property with a spinner editor to a Settings object. The spinner requires a property name, description, current value, minimum and maximum values, and an incremental step.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_3

LANGUAGE: cpp
CODE:
```
// Add an integer property with a spinner editor.
settings.add_int_spinner(
  L"test_int_spinner", // property name
  L"This is what a IntSpinner property looks like", // description or resource id of the localized string.
  g_settings.test_int_prop, // property value.
  0, // min value.
  100, // max value.
  10 // incremental step.
);
```

----------------------------------------

TITLE: Creating SSHHostsListPage for Command Palette Extension
DESCRIPTION: Implementation of a ListPage class that displays a list of SSH hosts. This class creates a new page in the Command Palette with a section title and placeholder items.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_9

LANGUAGE: csharp
CODE:
```
internal sealed class SSHHostsListPage : ListPage
{
    public SSHHostsListPage()
    {
        Icon = new(string.Empty);
        Name = "SSH Keychain";
    }

    public override ISection[] GetItems()
    {
        return [
            new ListSection()
            {
                Title = "SSH Hosts",
                Items = [
                    new ListItem(new NoOpCommand()) { Title = "TODO: Implement your extension here" }
                ],
            }
        ];
    }
}
```

----------------------------------------

TITLE: Focusing OneNote Window in C#
DESCRIPTION: This code snippet shows how to restore and focus the OneNote application window when a user selects a search result. It uses PInvoke to interact with Windows API for window management.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/onenote.md#2025-04-15_snippet_1

LANGUAGE: csharp
CODE:
```
if (PInvoke.IsIconic(handle))
{
    PInvoke.ShowWindow(handle, SHOW_WINDOW_CMD.SW_RESTORE);
}

PInvoke.SetForegroundWindow(handle);
```

----------------------------------------

TITLE: Creating Dynamic Grid for Keyboard Manager UI in C++
DESCRIPTION: Initializes a Grid with multiple columns to structure the Keyboard Manager UI. Rows are added dynamically when the add button is pressed.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagerui.md#2025-04-15_snippet_2

LANGUAGE: C++
CODE:
```
Grid uiGrid;
// Add column definitions
// ...

// Add rows dynamically
if (addButton.Click())
{
    RowDefinition row;
    uiGrid.RowDefinitions().Append(row);
    // Add UI elements to the new row
}
```

----------------------------------------

TITLE: Reading an Integer Spinner Value in PowerToys
DESCRIPTION: Shows how to read an integer value from a PowerToyValues object. The code checks if the value exists using is_int_value() before retrieving it with get_int_value().
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_4

LANGUAGE: cpp
CODE:
```
// Update the int property.
if (values.is_int_value(L"test_int_spinner")) {
  g_settings.test_int_prop = values.get_int_value(L"test_int_spinner");
}
```

----------------------------------------

TITLE: PowerToys Module Configuration Setter Method
DESCRIPTION: Method for applying updated configuration settings from the Settings editor to the module.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_4

LANGUAGE: cpp
CODE:
```
virtual void set_config(const wchar_t* config)
```

----------------------------------------

TITLE: Telemetry Event Logging in KeyboardManager
DESCRIPTION: Code snippets showing the telemetry events emitted by Keyboard Manager for tracking usage and errors. Events include enable/disable state, remap counts, and error logging.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanager.md#2025-04-15_snippet_9

LANGUAGE: cpp
CODE:
```
// Enable/Disable telemetry
KeyboardManager_EnableKeyboardManager(true/false);

// Remap count telemetry
KeyboardManager_KeyRemapCount(remapCount);
KeyboardManager_OSLevelShortcutRemapCount(shortcutCount);
KeyboardManager_AppSpecificShortcutRemapCount(appSpecificCount);

// Error telemetry
KeyboardManager_Error(methodName, errorCode, errorMessage);
```

----------------------------------------

TITLE: Adding a Color Picker Setting in PowerToys
DESCRIPTION: Shows how to add a color property with a color picker editor to a Settings object. The color picker requires a property name, description string, and the current color value in #RRGGBB format.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_7

LANGUAGE: cpp
CODE:
```
// Add a string property with a color picker editor.
settings.add_color_picker(
  L"test_color_picker", // property name.
  L"This is what a ColorPicker property looks like", // description or resource id of the localized string.
  g_settings.test_color_prop // property value.
);
```

----------------------------------------

TITLE: COM Object Creation and Foreground Window Management in C++
DESCRIPTION: These functions are used for creating COM objects and managing foreground windows. They are essential for GUI operations and inter-process communication in Windows applications.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Microsoft.CmdPal.UI.ViewModels/NativeMethods.txt#2025-04-15_snippet_1

LANGUAGE: C++
CODE:
```
CoCreateInstance
SetForegroundWindow
IsIconic
```

----------------------------------------

TITLE: PowerToys Module Enable Method
DESCRIPTION: Virtual method for enabling the PowerToy module functionality.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_6

LANGUAGE: cpp
CODE:
```
virtual void enable()
```

----------------------------------------

TITLE: Creating SSH Keychain Data Class
DESCRIPTION: Implementation of a data class that represents an SSH host with properties for the host name and an escaped version of the host for JSON encoding.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_14

LANGUAGE: csharp
CODE:
```
internal class SSHKeychainItem
{
    internal string Host { get; init; }

    internal string EscapedHost => JsonEncodedText.Encode(Host).ToString();
}
```

----------------------------------------

TITLE: Updating PowerToys with Scoop in PowerShell
DESCRIPTION: This command updates an existing Microsoft PowerToys installation to the latest version using the Scoop package manager. Run this from either a command line or PowerShell interface.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/unofficialInstallMethods.md#2025-04-15_snippet_3

LANGUAGE: powershell
CODE:
```
scoop update powertoys
```

----------------------------------------

TITLE: Implementing StringTable in RC File
DESCRIPTION: Demonstrates how to define localized strings in a Windows resource script file using StringTable.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/guidance.md#2025-04-15_snippet_1

LANGUAGE: cpp
CODE:
```
STRINGTABLE
BEGIN
    IDS_MODULE_DISPLAYNAME               L"Module Name"
END
```

----------------------------------------

TITLE: Monitor Information Retrieval in Windows C/C++
DESCRIPTION: Functions for getting information about monitors associated with windows. These are used to query display device properties and configurations.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Exts/Microsoft.CmdPal.Ext.Apps/NativeMethods.txt#2025-04-15_snippet_4

LANGUAGE: C
CODE:
```
MonitorFromWindow
GetMonitorInfo
```

----------------------------------------

TITLE: PowerToys Module State Checker Method
DESCRIPTION: Virtual method that returns the current enabled/disabled state of the PowerToy module.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_8

LANGUAGE: cpp
CODE:
```
virtual bool is_enabled() = 0;
```

----------------------------------------

TITLE: Registering New Language in Monaco
DESCRIPTION: Function call to register a new language with Monaco editor, specifying the language ID, file extensions, and definition.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/common/FilePreviewCommon.md#2025-04-15_snippet_2

LANGUAGE: javascript
CODE:
```
registerAdditionalNewLanguage("id", [".fileExtension"], idDefinition(), monaco)
```

----------------------------------------

TITLE: Defining String Resource IDs in C++ Header
DESCRIPTION: Shows how to define string resource IDs in a C++ header file (resource.h). XXX should be replaced with a unique integer ID.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/guidance.md#2025-04-15_snippet_0

LANGUAGE: cpp
CODE:
```
#define IDS_MODULE_DISPLAYNAME                    XXX
```

----------------------------------------

TITLE: Shell and Stream Operations in C++
DESCRIPTION: These functions are related to shell operations and stream creation. They are used for file operations and loading of shell resources.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Microsoft.CmdPal.UI.ViewModels/NativeMethods.txt#2025-04-15_snippet_4

LANGUAGE: C++
CODE:
```
SHCreateStreamOnFileEx
CoAllowSetForegroundWindow
SHCreateStreamOnFileEx
SHLoadIndirectString
```

----------------------------------------

TITLE: Checking OneNote Installation in C#
DESCRIPTION: This snippet demonstrates how the plugin checks if OneNote is installed and available. It attempts to access OneNote in the constructor and catches a COMException if OneNote is not installed, setting a flag accordingly.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/onenote.md#2025-04-15_snippet_2

LANGUAGE: csharp
CODE:
```
try
{
    _ = OneNoteProvider.PageItems.Any();
    _oneNoteInstalled = true;
}
catch (COMException)
{
    // OneNote isn't installed, plugin won't do anything.
    _oneNoteInstalled = false;
}
```

----------------------------------------

TITLE: Registering Additional File Extension
DESCRIPTION: Function call to register additional file extensions for an existing language in Monaco editor.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/common/FilePreviewCommon.md#2025-04-15_snippet_4

LANGUAGE: javascript
CODE:
```
registerAdditionalLanguage("id", [".fileExtension"], "existingId", monaco)
```

----------------------------------------

TITLE: PowerShell Command for Direct IDL Generation to Consumption Location
DESCRIPTION: An alternative PowerShell command that generates the IDL file and outputs it directly to the location where it's consumed in the project structure. This simplifies the workflow by eliminating manual file copying.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_26

LANGUAGE: powershell
CODE:
```
.\doc\initial-sdk-spec\generate-interface.ps1 > .\extensionsdk\Microsoft.CommandPalette.Extensions\Microsoft.CommandPalette.Extensions.Toolkit.idl
```

----------------------------------------

TITLE: String Table Format for Resource Files in C++ Projects
DESCRIPTION: Template for string table entries in .rc files with language specification. This format ensures resources are properly localized for different languages in C++ projects.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_2

LANGUAGE: C++
CODE:
```
#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_ENU)
LANGUAGE LANG_ENGLISH, SUBLANG_ENGLISH_US

STRINGTABLE
BEGIN
    strings
END

#endif
```

----------------------------------------

TITLE: Retrieving System Memory Information in Windows C/C++
DESCRIPTION: Functions for querying system memory status and physically installed memory. These are used to gather information about the system's memory resources.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Exts/Microsoft.CmdPal.Ext.Apps/NativeMethods.txt#2025-04-15_snippet_0

LANGUAGE: C
CODE:
```
GetPhysicallyInstalledSystemMemory
GlobalMemoryStatusEx
GetSystemInfo
```

----------------------------------------

TITLE: Generating Markdown Table of Contents for PowerToys Launcher Documentation
DESCRIPTION: This Markdown snippet creates a table of contents for the PowerToys Launcher documentation. It includes links to various sections such as architecture, debugging, and a list of available plugins.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/readme.md#2025-04-15_snippet_0

LANGUAGE: Markdown
CODE:
```
# Table of Contents
1. [Architecture](/doc/devdocs/modules/launcher/architecture.md)
2. [Debugging](/doc/devdocs/modules/launcher/debugging.md)
3. [New Plugin Checklist](/doc/devdocs/modules/launcher/new-plugin-checklist.md)
4. [Project Structure](/doc/devdocs/modules/launcher/project_structure.md)
5. [Telemetry](/doc/devdocs/modules/launcher/telemetry.md)
6. Plugins
    - [Overview](/doc/devdocs/modules/launcher/plugins/overview.md)
    - [Calculator](/doc/devdocs/modules/launcher/plugins/calculator.md)
    - [Folder](/doc/devdocs/modules/launcher/plugins/folder.md)
    - [History](/doc/devdocs/modules/launcher/plugins/history.md)
    - [Indexer](/doc/devdocs/modules/launcher/plugins/indexer.md)
    - [OneNote](/doc/devdocs/modules/launcher/plugins/onenote.md)
    - [Program](/doc/devdocs/modules/launcher/plugins/program.md)
    - [Registry](/doc/devdocs/modules/launcher/plugins/registry.md)
    - [Shell](/doc/devdocs/modules/launcher/plugins/shell.md)
    - [Time and Date](/doc/devdocs/modules/launcher/plugins/timedate.md)
    - [Unit Converter](/doc/devdocs/modules/launcher/plugins/community.unitconverter.md)
    - [Uri](/doc/devdocs/modules/launcher/plugins/uri.md)
    - [Value Generator](/doc/devdocs/modules/launcher/plugins/community.valuegenerator.md)
    - [Web Search](/doc/devdocs/modules/launcher/plugins/WebSearch.md)
    - [Windows Settings](/doc/devdocs/modules/launcher/plugins/windowssettings.md)
    - [Windows System Commands](/doc/devdocs/modules/launcher/plugins/system.md)
    - [Window Walker](/doc/devdocs/modules/launcher/plugins/windowwalker.md)
```

----------------------------------------

TITLE: Enhancing SSHHostsListPage with Multiple ListItems
DESCRIPTION: Enhanced version of the SSHHostsListPage that displays multiple ListItems with different properties, including titles, subtitles, and tags to demonstrate UI capabilities of the Command Palette.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_13

LANGUAGE: csharp
CODE:
```
internal sealed class SSHHostsListPage : ListPage
{
    public SSHHostsListPage()
    {
        Icon = new(string.Empty);
        Name = "SSH Keychain";
    }

    public override ISection[] GetItems()
    {
        return [
            new ListSection()
            {
                Title = "SSH Hosts",
                Items = [
                    new ListItem(new NoOpCommand()) { Title = "TODO: Implement your extension here" },
                    new ListItem(new NoOpCommand()) { Title = "Another list item", Subtitle = "this one has a subtitle" },
                    new ListItem(new NoOpCommand())
                    {
                        Title = "A list item with a tag",
                        Subtitle = "this one with tags",
                        Tags = [new Tag()
                               {
                                   Text = "Example Tag",
                               }
                               ],
                    }
                ],
            }
        ];
    }
}
```

----------------------------------------

TITLE: Configuring PowerToys Module Template XML Definition for Visual Studio
DESCRIPTION: This XML configuration defines the Visual Studio template for creating PowerToys modules. It specifies template metadata, supported platforms, file structures, and parameter replacement rules that Visual Studio will use when a developer creates a new PowerToys module project.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/ModuleTemplate/README.md#2025-04-15_snippet_0

LANGUAGE: XML
CODE:
```
<VSTemplate Version="3.0.0" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" Type="Project">
  <TemplateData>
    <Name>PowerToys Module</Name>
    <Description>A project for creating a PowerToys module</Description>
    <ProjectType>VC</ProjectType>
    <ProjectSubType>
    </ProjectSubType>
	  <LanguageTag>C++</LanguageTag>
	  <PlatformTag>windows</PlatformTag>
	  <ProjectTypeTag>extension</ProjectTypeTag>
    <SortOrder>1000</SortOrder>
    <CreateNewFolder>true</CreateNewFolder>
    <DefaultName>PowerToy</DefaultName>
    <ProvideDefaultName>true</ProvideDefaultName>
    <LocationField>Enabled</LocationField>
    <EnableLocationBrowseButton>true</EnableLocationBrowseButton>
    <Icon>__TemplateIcon.ico</Icon>
  </TemplateData>
  <TemplateContent>
    <Project TargetFileName="$projectname$.vcxproj" File="ModuleTemplate.vcxproj" ReplaceParameters="true">
      <ProjectItem ReplaceParameters="false" TargetFileName="$projectname$.vcxproj.filters">ModuleTemplate.vcxproj.filters</ProjectItem>
      <ProjectItem ReplaceParameters="true" TargetFileName="dllmain.cpp">dllmain.cpp</ProjectItem>
      <ProjectItem ReplaceParameters="false" TargetFileName="pch.cpp">pch.cpp</ProjectItem>
      <ProjectItem ReplaceParameters="false" TargetFileName="trace.cpp">trace.cpp</ProjectItem>
      <ProjectItem ReplaceParameters="false" TargetFileName="pch.h">pch.h</ProjectItem>
      <ProjectItem ReplaceParameters="false" TargetFileName="resource.h">resource.h</ProjectItem>
      <ProjectItem ReplaceParameters="false" TargetFileName="trace.h">trace.h</ProjectItem>
      <ProjectItem ReplaceParameters="true" TargetFileName="$projectname$.rc">ModuleTemplate.rc</ProjectItem>
    </Project>
  </TemplateContent>
</VSTemplate>
```

----------------------------------------

TITLE: Configuring Localization with LocProject.json
DESCRIPTION: Example configuration file used to enable localization for a PowerToys project. This JSON file defines the language set, source resource file location, copy options, and output path for localized resources.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_0

LANGUAGE: JSON
CODE:
```
{
    "Projects": [
        {
            "LanguageSet": "Azure_Languages",
            "LocItems": [
                {
                    "SourceFile": "src\\path\\resources\\Resources.resx",
                    "CopyOption": "LangIDOnName",
                    "OutputPath": "src\\path\\resources"
                }
            ]
        }
    ]
}
```

----------------------------------------

TITLE: Using Auto-Generated Resources in C#
DESCRIPTION: Shows the simplified approach of accessing string resources using the auto-generated Resources class in C#.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/guidance.md#2025-04-15_snippet_5

LANGUAGE: csharp
CODE:
```
string validUIDisplayString = Resources.ValidUIDisplayString;
```

----------------------------------------

TITLE: Structuring Markdown Navigation for Keyboard Manager Docs
DESCRIPTION: A markdown-formatted table of contents that links to the four main documentation sections for the PowerToys Keyboard Manager module: core module, event handlers, UI, and common components.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/README.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
# Table of Contents
The devdocs for Keyboard Manager have been divided into the following modules:
1. [Keyboard Manager Module](keyboardmanager.md)
2. [Keyboard Event Handlers](keyboardeventhandlers.md)
3. [Keyboard Manager UI](keyboardmanagerui.md)
4. [Keyboard Manager Common](keyboardmanagercommon.md)
```

----------------------------------------

TITLE: LCL File Format Example for Translations
DESCRIPTION: Example of a localization (LCL) file entry that contains both the source string and its translation. This XML format is used by the CDPX Localization system to manage translations.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_8

LANGUAGE: XML
CODE:
```
<Item ItemId=";EditKeyboard_WindowName" ItemType="0;.resx" PsrId="211" Leaf="true">
    <Str Cat="Text">
        <Val><![CDATA[Remap keys]]></Val>
        <Tgt Cat="Text" Stat="Loc" Orig="New">
            <Val><![CDATA[Remapper des touches]]></Val>
        </Tgt>
    </Str>
    <Disp Icon="Str" />
</Item>
```

----------------------------------------

TITLE: Configuring Custom Tray Times in Awake Settings JSON
DESCRIPTION: Example JSON configuration that shows how to set custom time intervals in the Awake tray menu. The configuration includes display settings, mode selection, default timer values, and custom tray time entries defined as key-value pairs where the key is the display name and the value is the duration in seconds.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/planning/awake.md#2025-04-15_snippet_0

LANGUAGE: json
CODE:
```
{
    "properties": {
        "awake_keep_display_on": true,
        "awake_mode": 2,
        "awake_hours": 0,
        "awake_minutes": 3,
        "tray_times": {
            "Custom length": 1800,
            "Another custom length": 3600
        }
    },
    "name": "Awake",
    "version": "1.0"
}
```

----------------------------------------

TITLE: Using ResourceManager in C#
DESCRIPTION: Demonstrates manual string resource retrieval using ResourceManager in C# code.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/guidance.md#2025-04-15_snippet_4

LANGUAGE: csharp
CODE:
```
System.Resources.ResourceManager manager = new System.Resources.ResourceManager(baseName, assembly);
string validUIDisplayString = manager.GetString("ValidUIDisplayString", resourceCulture);
```

----------------------------------------

TITLE: Enabling Mica Background in C++ for XAML UI
DESCRIPTION: Applies the Mica background effect to the root or page background of the Keyboard Manager UI. Falls back to ApplicationPageBackgroundThemeBrush if Mica is not available.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/keyboardmanager/keyboardmanagerui.md#2025-04-15_snippet_1

LANGUAGE: C++
CODE:
```
if (BackdropMaterial::IsApiAvailable())
{
    BackdropMaterial::SetApplyToRootOrPageBackground(rootGrid, true);
}
else
{
    rootGrid.Background(Application::Current().Resources().Lookup(box_value(L"ApplicationPageBackgroundThemeBrush")).as<Brush>());
}
```

----------------------------------------

TITLE: Logger Functions in C# Projects
DESCRIPTION: This C# code snippet lists the available logging functions in the Logger class, including methods for logging errors, warnings, info, debug messages, and tracing.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/logging.md#2025-04-15_snippet_4

LANGUAGE: C#
CODE:
```
// Logs an error that the utility encountered
Logger.LogError(string message);
Logger.LogError(string message, Exception ex);
// Logs an error that isn't that grave
Logger.LogWarning(string message);
// Logs what the app is doing at the moment
Logger.LogInfo(string message);
// Like LogInfo just with infos important for debugging
Logger.LogDebug(string message);
// Logs the current state of the utility.
Logger.LogTrace();
```

----------------------------------------

TITLE: Importing spdlog Library in C++ Projects
DESCRIPTION: This XML snippet shows how to include the spdlog library in a C++ project's .vcxproj file. It imports the spdlog.props file, which adds the required include directories and links the library binary.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/logging.md#2025-04-15_snippet_0

LANGUAGE: XML
CODE:
```
<Import Project="..\..\..\deps\spdlog.props" />
```

----------------------------------------

TITLE: Defining Resources in RESX XML
DESCRIPTION: Example of defining localized strings in a .NET RESX resource file with value and comment.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/guidance.md#2025-04-15_snippet_3

LANGUAGE: xml
CODE:
```
  <data name="ValidUIDisplayString" xml:space="preserve">
    <value>Description to be displayed on UI.</value>
    <comment>This text is displayed when XYZ button clicked.</comment>
  </data>
```

----------------------------------------

TITLE: Creating a reusable OpenUrl command with C# helper class
DESCRIPTION: Implementation of a helper class for opening URLs in a browser. This class extends the Microsoft.CommandPalette.Extensions.Toolkit.InvokableCommand and provides a simple way to create commands that open URLs.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_18

LANGUAGE: csharp
CODE:
```
class OpenUrlCommand(string targetUrl, CommandResult result) : Microsoft.CommandPalette.Extensions.Toolkit.InvokableCommand {
    public OpenUrlCommand()
    {
        Name = "Open";
        Icon = new("\uE8A7"); // OpenInNewWindow
    }
    public CommandResult Invoke() {
        Process.Start(new ProcessStartInfo(targetUrl) { UseShellExecute = true });
        return result;
    }
}
```

----------------------------------------

TITLE: Initializing MouseWithoutBorders.Common Properties in C#
DESCRIPTION: This snippet shows the initialization of various properties in the MouseWithoutBorders.Common class. It includes fields for managing clipboard events, screen dimensions, network communication, and input simulation.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/MouseWithoutBorders/MouseWithoutBorders.UnitTests/Core/Logger.PrivateDump.original.txt#2025-04-15_snippet_0

LANGUAGE: C#
CODE:
```
lastClipboardEventTime = 0;
clipboardCopiedTime = 0;
Comma = System.Char[];
Star = System.Char[];
NullSeparator = System.Char[];
<LastIDWithClipboardData>k__BackingField = NONE;
<NextClipboardViewer>k__BackingField = 0;
<IsClipboardDataImage>k__BackingField = False;
lastClipboardObject = 
<HasSwitchedMachineSinceLastCopy>k__BackingField = False;
ClipboardThreadOldLock = O;
screenWidth = 0;
screenHeight = 0;
lastX = 0;
lastY = 0;
mainFormVisible = True;
runOnLogonDesktop = False;
runOnScrSaverDesktop = False;
toggleIconsIndex = 0;
EvSwitch = EventWaitHandle;
lastPos = {X=0,Y=0};
switchCount = 0;
lastReconnectByHotKeyTime = 0;
tcpPort = 0;
secondOpenSocketTry = False;
binaryName = MM;
<PaintCount>k__BackingField = 0;
<RunWithNoAdminRight>k__BackingField = False;
<Is64bitOS>k__BackingField = False;
socketMutexBalance = 0;
<BlockingUI>k__BackingField = False;
<UIThreadID>k__BackingField = 0;
<InputCallbackThreadID>k__BackingField = 0;
InputSimulationLock = O;
```

----------------------------------------

TITLE: Adding Custom Token Theme Rule
DESCRIPTION: Configuration object for defining custom token colors and styles in Monaco editor's theme.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/common/FilePreviewCommon.md#2025-04-15_snippet_3

LANGUAGE: javascript
CODE:
```
{token: 'token-name', foreground: 'ff0000'}
```

----------------------------------------

TITLE: Installing PowerToys Build Prerequisites from Command Line
DESCRIPTION: Commands to restore NuGet packages and build the BugReportTool and StylesReportTool solutions, which are prerequisites for building the PowerToys installer.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/readme.md#2025-04-15_snippet_0

LANGUAGE: batch
CODE:
```
nuget restore .\tools\BugReportTool\BugReportTool.sln
msbuild -p:Platform=x64 -p:Configuration=Release .\tools\BugReportTool\BugReportTool.sln

nuget restore .\tools\StylesReportTool\StylesReportTool.sln
msbuild -p:Platform=x64 -p:Configuration=Release .\tools\StylesReportTool\StylesReportTool.sln
```

----------------------------------------

TITLE: PowerToys Module Destructor Method
DESCRIPTION: Virtual method for cleaning up and destroying the PowerToy module instance.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/interface.md#2025-04-15_snippet_9

LANGUAGE: cpp
CODE:
```
virtual void destroy()
```

----------------------------------------

TITLE: Defining IconData and IconInfo Structures in C#
DESCRIPTION: These structures provide ways to specify icons in the Command Palette extensions system. IconData encapsulates different ways to represent icons, while IconInfo allows specifying both light and dark theme versions of an icon.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_12

LANGUAGE: cs
CODE:
```
struct IconData {
    IconData(String iconString);
    static IconData FromStream(Windows.Storage.Streams.IRandomAccessStreamReference stream);

    String Icon { get; };
    Windows.Storage.Streams.IRandomAccessStreamReference Data { get; };
}
struct IIconInfo {
    IIconInfo(String iconString);
    IIconInfo(IconData lightIcon, IconData darkIcon);

    IconData Light { get; };
    IconData Dark { get; };
}
```

----------------------------------------

TITLE: Defining Constants for MouseWithoutBorders.Common in C#
DESCRIPTION: This snippet shows the definition of various constants used in the MouseWithoutBorders.Common class. These constants include sizes, timeouts, and Windows message codes for input handling.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/MouseWithoutBorders/MouseWithoutBorders.UnitTests/Core/Logger.PrivateDump.original.txt#2025-04-15_snippet_1

LANGUAGE: C#
CODE:
```
BIG_CLIPBOARD_DATA_TIMEOUT = 30000;
MAX_CLIPBOARD_DATA_SIZE_CAN_BE_SENT_INSTANTLY_TCP = 1048576;
MAX_CLIPBOARD_FILE_SIZE_CAN_BE_SENT = 104857600;
TEXT_HEADER_SIZE = 12;
DATA_SIZE = 48;
TEXT_TYPE_SEP = {4CFF57F7-BEDD-43d5-AE8F-27A61E886F2F};
TOGGLE_ICONS_SIZE = 4;
ICON_ONE = 0;
ICON_ALL = 1;
ICON_SMALL_CLIPBOARD = 2;
ICON_BIG_CLIPBOARD = 3;
ICON_ERROR = 4;
JUST_GOT_BACK_FROM_SCREEN_SAVER = 9999;
NETWORK_STREAM_BUF_SIZE = 1048576;
SymAlBlockSize = 16;
PW_LENGTH = 16;
HELPER_FORM_TEXT = Mouse without Borders Helper;
HelperProcessName = PowerToys.MouseWithoutBordersHelper;
MAX_LOG = 10000;
MaxLogExceptionPerHour = 1000;
HeaderSENT = Be{0},Ke{1},Mo{2},He{3},Mx{4},Tx{5},Im{6},By{7},Cl{8},Dr{9},De{10},Ed{11},Ie{12},Ni{13};
HeaderRECEIVED = Be{0},Ke{1},Mo{2},He{3},Mx{4},Tx{5},Im{6},By{7},Cl{8},Dr{9},De{10},Ed{11},In{12},Ni{13},Pc{14}/{15};
MAX_MACHINE = 4;
MAX_SOCKET = 8;
HEARTBEAT_TIMEOUT = 1500000;
SKIP_PIXELS = 1;
JUMP_PIXELS = 2;
PACKAGE_SIZE = 32;
PACKAGE_SIZE_EX = 64;
WP_PACKAGE_SIZE = 6;
KEYEVENTF_KEYDOWN = 1;
KEYEVENTF_KEYUP = 2;
WH_MOUSE = 7;
WH_KEYBOARD = 2;
WH_MOUSE_LL = 14;
WH_KEYBOARD_LL = 13;
WM_MOUSEMOVE = 512;
WM_LBUTTONDOWN = 513;
WM_RBUTTONDOWN = 516;
WM_MBUTTONDOWN = 519;
WM_XBUTTONDOWN = 523;
WM_LBUTTONUP = 514;
WM_RBUTTONUP = 517;
WM_MBUTTONUP = 520;
WM_XBUTTONUP = 524;
WM_LBUTTONDBLCLK = 515;
WM_RBUTTONDBLCLK = 518;
WM_MBUTTONDBLCLK = 521;
WM_MOUSEWHEEL = 522;
WM_KEYDOWN = 256;
WM_KEYUP = 257;
WM_SYSKEYDOWN = 260;
WM_SYSKEYUP = 261;
```

----------------------------------------

TITLE: Describing UnitHandler Class
DESCRIPTION: This snippet describes the UnitHandler class, which performs the actual unit conversions. It mentions support for abbreviations in user input, allowing for flexible input formats.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/community.unitconverter.md#2025-04-15_snippet_2

LANGUAGE: markdown
CODE:
```
### [`UnitHandler`](/src/modules/launcher/Plugins/Community.PowerToys.Run.Plugin.UnitConverter/UnitHandler.cs)
 - Class that does the actual conversion.
 - Supports abbreviations in user input (single, double, or none).
```

----------------------------------------

TITLE: Installing PowerToys with Chocolatey in PowerShell
DESCRIPTION: This command installs Microsoft PowerToys using the Chocolatey package manager. Users should run this from either a command line or PowerShell interface.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/unofficialInstallMethods.md#2025-04-15_snippet_0

LANGUAGE: powershell
CODE:
```
choco install powertoys
```

----------------------------------------

TITLE: Adding a Custom Action Button in PowerToys
DESCRIPTION: Shows how to add a custom action property with a button control to a Settings object. This can be used to trigger module-specific functionality from the settings UI.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/tools/project_template/README.md#2025-04-15_snippet_9

LANGUAGE: cpp
CODE:
```
// Add a custom action property. When using this settings type, the "PowertoyModuleIface::call_custom_action()"
// method should be overridden as well.
settings.add_custom_action(
  L"test_custom_action", // action name.
  L"This is what a CustomAction property looks like", // label above the field: a string literal or a resource id
  L"Call a custom action", // button text: a string literal or a resource id
  L"Press the button to call a custom action in the Example PowerToy" // display values / extended info: a string literal or a resource id
);
```

----------------------------------------

TITLE: Invoking PowerToysConfigure DSC Resource Directly
DESCRIPTION: This PowerShell command demonstrates how to invoke the PowerToysConfigure DSC resource directly, specifying properties for the Awake module and enabling debug output.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/dsc-configure.md#2025-04-15_snippet_6

LANGUAGE: powershell
CODE:
```
Invoke-DscResource -Name PowerToysConfigure -Method Set -ModuleName Microsoft.PowerToys.Configure -Property @{ Debug = $true; Awake = @{ Enabled = $false; Mode = "TIMED"; IntervalMinutes = "10" } }
```

----------------------------------------

TITLE: Initializing ListItem with NoOpCommand in Command Palette
DESCRIPTION: Initial implementation of a Command Palette command with NoOpCommand that doesn't perform any action when executed. This represents the base state before implementing actual functionality.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_8

LANGUAGE: csharp
CODE:
```
private readonly IListItem[] _commands = [
       new ListItem(new NoOpCommand())
        {
            Title = "Search SSH Keys",
            Subtitle = "Quickly find and launch into hosts from your SSH config file",
        },
    ];
```

----------------------------------------

TITLE: Upgrading PowerToys with Chocolatey in PowerShell
DESCRIPTION: This command upgrades an existing Microsoft PowerToys installation to the latest version using the Chocolatey package manager. Run this from either a command line or PowerShell interface.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/unofficialInstallMethods.md#2025-04-15_snippet_1

LANGUAGE: powershell
CODE:
```
choco upgrade powertoys
```

----------------------------------------

TITLE: PowerToys Settings Events Documentation
DESCRIPTION: Documentation of specific telemetry events in Settingsv2: SettingsBootEvent for UI initialization timing and SettingsEnabledEvent for module state changes.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/telemetry.md#2025-04-15_snippet_1

LANGUAGE: markdown
CODE:
```
## Events\nThe following events are generated by `Settingsv2`:\n1. [`SettingsBootEvent`](/src/settings-ui/Settings.UI.Library/Telemetry/Events/SettingsBootEvent.cs): This event captures the time taken by `Settingsv2` to initialize `MainWindow` UI control.\n2. [`SettingsEnabledEvent.cs`](/src/settings-ui/Settings.UI.Library/Telemetry/Events/SettingsEnabledEvent.cs): This event is generated when a module is enabled or disabled.
```

----------------------------------------

TITLE: Configuring PSModulePath for PowerToys DSC Resource
DESCRIPTION: This PowerShell command adds the current directory to the PSModulePath environment variable, allowing DSC to discover the PowerToys DSC Resource module.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/dsc-configure.md#2025-04-15_snippet_3

LANGUAGE: powershell
CODE:
```
$env:PSModulePath += ";$pwd"
```

----------------------------------------

TITLE: Launching Windows Store for DevPal Extensions
DESCRIPTION: Demonstrates how to open the Windows Store to a list of DevPal extensions using a specific URI scheme. This method is limited as it doesn't allow direct querying of available extensions.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_2

LANGUAGE: csharp
CODE:
```
ms-windows-store://assoc/?Tags=AppExtension-com.microsoft.commandpalette
```

----------------------------------------

TITLE: Verifying PowerToys DSC Module and Resource Availability
DESCRIPTION: These PowerShell commands check if the PowerToys DSC module is discoverable and if the PowerToysConfigure resource is available.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/dsc-configure.md#2025-04-15_snippet_4

LANGUAGE: powershell
CODE:
```
Get-Module -ListAvailable | grep PowerToys
Get-DSCResource | grep PowerToys
```

----------------------------------------

TITLE: Testing PowerToys Configuration with Winget
DESCRIPTION: This PowerShell command shows how to use winget to apply a PowerToys configuration file, accepting configuration agreements and disabling interactivity.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/dsc-configure.md#2025-04-15_snippet_7

LANGUAGE: powershell
CODE:
```
winget configure .\configuration.winget --accept-configuration-agreements --disable-interactivity
```

----------------------------------------

TITLE: Importing PowerToys DSC Module for Diagnostics
DESCRIPTION: This PowerShell command force-imports the PowerToys DSC module to diagnose any issues with module discovery or loading.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/dsc-configure.md#2025-04-15_snippet_5

LANGUAGE: powershell
CODE:
```
Import-Module .\Microsoft.PowerToys.Configure.psd1
```

----------------------------------------

TITLE: Importing Custom Language Module in Monaco
DESCRIPTION: Import statement for adding a new custom language module to the Monaco special languages configuration.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/common/FilePreviewCommon.md#2025-04-15_snippet_1

LANGUAGE: javascript
CODE:
```
import { idDefinition } from './customLanguages/file.js';
```

----------------------------------------

TITLE: Class Diagram of DevPalette SDK Interface Relationships
DESCRIPTION: A mermaid class diagram showing the relationships between various interfaces in the SDK. The diagram illustrates inheritance hierarchies and property relationships with multiplicity indicators (* for 0 or more, ? for optional, 1 for required).
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_23

LANGUAGE: mermaid
CODE:
```
classDiagram
    class ICommand {
        String Name
        String Id
        IIconInfo Icon
    }
    IPage --|> ICommand
    class IPage  {
        String Title
        Boolean IsLoading
    }

    IInvokableCommand --|> ICommand
    class IInvokableCommand  {
        ICommandResult Invoke(object context)
    }

    class IForm {
        String TemplateJson()
        String DataJson()
        String StateJson()
        ICommandResult SubmitForm(String payload)
    }
    IFormPage --|> IPage
    class IFormPage  {
        IForm[] Forms()
    }
    IForm "*" *-- IFormPage

    IMarkdownPage --|> IPage
    class IMarkdownPage  {
        String[] Bodies()
        IDetails Details()
        IContextItem[] Commands
    }
    %% IMarkdownPage *-- IDetails
    IContextItem "*" *-- IMarkdownPage
    IDetails "?" *-- IMarkdownPage
    %%%%%%%%%

    class IFilterItem

    ISeparatorFilterItem --|> IFilterItem
    class ISeparatorFilterItem

    IFilter --|> IFilterItem
    class IFilter  {
        String Id
        String Name
        IIconInfo Icon
    }

    class IFilters {
        String CurrentFilterId
        IFilterItem[] AvailableFilters()
    }
    IFilterItem "*" *-- IFilters

    class IFallbackHandler {
        void UpdateQuery(String query)
    }


    %% IListItem --|> INotifyPropChanged
    class IListItem  {
        IIconInfo Icon
        String Title
        String Subtitle
        ICommand Command
        IContextItem[] MoreCommands
        ITag[] Tags
        IDetails Details
        IFallbackHandler FallbackHandler
        String Section
        String TextToSuggest
    }
    IContextItem "*" *-- IListItem
    IDetails "?" *-- IListItem
    ICommand "?" *-- IListItem
    ITag "*" *-- IListItem
    IFallbackHandler "?" *-- IListItem

    class IGridProperties  {
        Windows.Foundation.Size TileSize
    }

    IListPage --|> IPage
    class IListPage  {
        String SearchText
        String PlaceholderText
        Boolean ShowDetails
        IFilters Filters
        IGridProperties GridProperties
        Boolean HasMore

        IListItem[] GetItems()
        void LoadMore()
    }
    IListItem "*" *-- IListPage
    IFilters "*" *-- IListPage
    IGridProperties "?" *-- IListPage

    IDynamicListPage --|> IListPage
    class IDynamicListPage  {
        +String SearchText set;
    }

    class IDetails {
        IIconInfo HeroImage
        String Title
        String Body
        IDetailsElement[] Metadata
    }

    class ITag {
        IIconInfo Icon
        String Text
        Color Color
        String ToolTip
        ICommand Command
    }
    ICommand "?" *-- ITag

    %%%%%%
    class IContextItem

    ISeparatorContextItem --|> IContextItem
    class ISeparatorContextItem
    ICommandContextItem --|> IContextItem
    class ICommandContextItem  {
        ICommand Command
        String Tooltip
        Boolean IsCritical
    }
    ICommand "?" *-- ICommandContextItem



    class ICommandProvider {
        String DisplayName
        IIconInfo Icon
        Boolean Frozen

        ICommandItem[] TopLevelCommands()
        IFallbackCommandItem[] FallbackCommands()
        IListItem GetCommand(String id)
    }
    ICommandItem "*" *-- ICommandProvider
    IFallbackCommandItem "*" *-- ICommandProvider
```

----------------------------------------

TITLE: Installing Preview Handler Dependencies to GAC using gacutil
DESCRIPTION: Command for adding preview handler dependencies to the Global Assembly Cache (GAC). This is part of the direct DLL registration process, which is not the recommended approach but may be used for development purposes.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/previewpane/README.md#2025-04-15_snippet_0

LANGUAGE: batch
CODE:
```
gacutil -i <path to dependency>
```

----------------------------------------

TITLE: Installing PSDesiredStateConfiguration Module
DESCRIPTION: This PowerShell command installs the PSDesiredStateConfiguration module, which is required for working with DSC resources.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/dsc-configure.md#2025-04-15_snippet_2

LANGUAGE: powershell
CODE:
```
Install-Module -Name PSDesiredStateConfiguration -RequiredVersion 2.0.7
```

----------------------------------------

TITLE: Updating Command Palette Provider with NoOpCommand
DESCRIPTION: Example showing the initial state of the Command Provider with a NoOpCommand that doesn't execute any action when selected in the Command Palette.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_11

LANGUAGE: csharp
CODE:
```
private readonly IListItem[] _commands = [
       new ListItem(new NoOpCommand())
        {
            Title = "Search SSH Keys",
            Subtitle = "Quickly find and launch into hosts from your SSH config file",
        },
    ];
```

----------------------------------------

TITLE: Executing PowerToys Settings Commands
DESCRIPTION: These PowerShell commands demonstrate how the PowerToysConfigure resource invokes PowerToys.Settings.exe to apply the configuration settings specified in the Winget configuration file.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/settingsv2/dsc-configure.md#2025-04-15_snippet_1

LANGUAGE: powershell
CODE:
```
PowerToys.Settings.exe set ShortcutGuide.Enabled false
PowerToys.Settings.exe set FancyZones.Enabled true
PowerToys.Settings.exe set FancyZones.FancyzonesEditorHotkey "Shift+Ctrl+Alt+F"
```

----------------------------------------

TITLE: Caching Extension Data in JSON Format
DESCRIPTION: JSON structure used by DevPal to cache information about extensions and their top-level commands. This cache includes details such as package family name, COM CLSID, display name, frozen status, and command properties.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_1

LANGUAGE: jsonc
CODE:
```
{
    "extensions": [
        {
            "pfn": "TemplateExtension_0.0.1.0_x64__8wekyb3d8bbwe",
            "clsid": "{FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF}",

            "displayName": "TemplateDisplayName",
            "frozen": true,
            "commands":
            [
                {
                    "id": "TemplateExtension.MyFirstCommand",
                    "icon": "",
                    "title": "",
                    "subtitle": "",
                    "name": "",
                    "moreCommands": [ /* Additional commands... */]
                }
            ]
        }
    ]

}
```

----------------------------------------

TITLE: Importing Logger Class in C# Projects
DESCRIPTION: This C# code snippet demonstrates how to import the Logger class from ManagedCommon in C# projects. It's required in all files that use the logger.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/logging.md#2025-04-15_snippet_1

LANGUAGE: C#
CODE:
```
using ManagedCommon;
```

----------------------------------------

TITLE: Measuring Regular Files and Hard-links in PowerToys Installation Directory using PowerShell
DESCRIPTION: PowerShell commands to calculate the size of regular files and hard-links in the PowerToys installation directory. These commands help distinguish between the actual disk usage and what File Explorer reports, demonstrating the space efficiency gained through hard-linking.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/disk-usage-footprint.md#2025-04-15_snippet_0

LANGUAGE: powershell
CODE:
```
Regular files:
ls -Recurse -File -force -ErrorAction SilentlyContinue | ? LinkType -ne HardLink | Measure-Object -Property Length -Sum

Hard-links
ls -Recurse -File -force -ErrorAction SilentlyContinue | ? LinkType -e HardLink | Measure-Object -Property Length -Sum
```

----------------------------------------

TITLE: Describing InputInterpreter Class
DESCRIPTION: This snippet describes the InputInterpreter class, which is responsible for manipulating user input to ensure correct interpretation for unit conversion. It mentions the use of regex for input processing.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/plugins/community.unitconverter.md#2025-04-15_snippet_1

LANGUAGE: markdown
CODE:
```
### [`InputInterpreter`](/src/modules/launcher/Plugins/Community.PowerToys.Run.Plugin.UnitConverter/InputInterpreter.cs)
 - Class which manipulates user input such that it may be interpreted correctly and thus converted.
 - Uses a regex amongst other things to do this.
```

----------------------------------------

TITLE: Configuring Project References for PowerToys UI Tests in C#
DESCRIPTION: XML configuration for setting up a new UI test project in PowerToys. It specifies output type, test running behavior, output path, and required package and project references.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/UITests.md#2025-04-15_snippet_0

LANGUAGE: xml
CODE:
```
<PropertyGroup>
	<OutputType>Library</OutputType>
	<!-- This is a UI test, so don't run as part of MSBuild -->
	<RunVSTest>false</RunVSTest>
</PropertyGroup>

<PropertyGroup>
	<OutputPath>..\..\..\..\$(Platform)\$(Configuration)\tests\KeyboardManagerUITests\</OutputPath>
</PropertyGroup>

<ItemGroup>
    <PackageReference Include="MSTest" />
    <ProjectReference Include="..\..\..\common\UITestAutomation\UITestAutomation.csproj" />
    <Folder Include="Properties\" />
</ItemGroup>
```

----------------------------------------

TITLE: PowerShell Command for Generating IDL from Documentation
DESCRIPTION: A PowerShell command that generates the Interface Definition Language (IDL) file for the SDK directly from the documentation. It uses the mistletoe Python package to parse and process the markdown file.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_25

LANGUAGE: powershell
CODE:
```
.\generate-interface.ps1 > .\Microsoft.DevPalette.Extensions.idl
```

----------------------------------------

TITLE: Including RESW Files in UWP Projects
DESCRIPTION: XML configurations for including resource files in UWP projects. The first line shows a specific culture reference, while the second line shows a wildcard pattern to include all available cultures.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_7

LANGUAGE: XML
CODE:
```
<PRIResource Include="Strings\en-us\Resources.resw" />
```

LANGUAGE: XML
CODE:
```
<PRIResource Include="Strings\*\Resources.resw" />
```

----------------------------------------

TITLE: Retrieving System Memory Information in C++
DESCRIPTION: This snippet includes functions for querying system memory status and physically installed memory. These are used to gather information about the system's memory resources.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Microsoft.CmdPal.UI.ViewModels/NativeMethods.txt#2025-04-15_snippet_0

LANGUAGE: C++
CODE:
```
GetPhysicallyInstalledSystemMemory
GlobalMemoryStatusEx
GetSystemInfo
```

----------------------------------------

TITLE: Listing NuGet Packages for PowerToys in Markdown
DESCRIPTION: This snippet provides a comprehensive list of NuGet packages and their versions used in the PowerToys project. It includes various categories of packages such as UI toolkits, data handling libraries, Windows SDK components, and utility packages.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/NOTICE.md#2025-04-15_snippet_3

LANGUAGE: markdown
CODE:
```
## NuGet Packages used by PowerToys

- AdaptiveCards.ObjectModel.WinUI3 2.0.0-beta
- AdaptiveCards.Rendering.WinUI3 2.1.0-beta
- AdaptiveCards.Templating 2.0.2
- Appium.WebDriver 4.4.5
- Azure.AI.OpenAI 1.0.0-beta.17
- CommunityToolkit.Common 8.4.0
- CommunityToolkit.Mvvm 8.4.0
- CommunityToolkit.WinUI.Animations 8.2.250129-preview2
- CommunityToolkit.WinUI.Collections 8.2.250129-preview2
- CommunityToolkit.WinUI.Controls.Primitives 8.2.250129-preview2
- CommunityToolkit.WinUI.Controls.Segmented 8.2.250129-preview2
- CommunityToolkit.WinUI.Controls.SettingsControls 8.2.250129-preview2
- CommunityToolkit.WinUI.Controls.Sizers 8.2.250129-preview2
- CommunityToolkit.WinUI.Converters 8.2.250129-preview2
- CommunityToolkit.WinUI.Extensions 8.2.250129-preview2
- CommunityToolkit.WinUI.UI.Controls.DataGrid 7.1.2
- CommunityToolkit.WinUI.UI.Controls.Markdown 7.1.2
- ControlzEx 6.0.0
- HelixToolkit 2.24.0
- HelixToolkit.Core.Wpf 2.24.0
- hyjiacan.pinyin4net 4.1.1
- Interop.Microsoft.Office.Interop.OneNote 1.1.0.2
- LazyCache 2.4.0
- Mages 3.0.0
- Markdig.Signed 0.34.0
- MessagePack 3.1.3
- Microsoft.Bcl.AsyncInterfaces 9.0.4
- Microsoft.CodeAnalysis.NetAnalyzers 9.0.0
- Microsoft.Data.Sqlite 9.0.4
- Microsoft.Diagnostics.Tracing.TraceEvent 3.1.16
- Microsoft.DotNet.ILCompiler (A)
- Microsoft.Extensions.DependencyInjection 9.0.4
- Microsoft.Extensions.Hosting 9.0.4
- Microsoft.Extensions.Hosting.WindowsServices 9.0.4
- Microsoft.Extensions.Logging 9.0.4
- Microsoft.Extensions.Logging.Abstractions 9.0.4
- Microsoft.NET.ILLink.Tasks (A)
- Microsoft.SemanticKernel 1.15.0
- Microsoft.Toolkit.Uwp.Notifications 7.1.2
- Microsoft.Web.WebView2 1.0.2903.40
- Microsoft.Win32.SystemEvents 9.0.4
- Microsoft.Windows.Compatibility 9.0.4
- Microsoft.Windows.CsWin32 0.2.46-beta
- Microsoft.Windows.CsWinRT 2.2.0
- Microsoft.Windows.SDK.BuildTools 10.0.22621.2428
- Microsoft.WindowsAppSDK 1.6.250205002
- Microsoft.WindowsPackageManager.ComInterop 1.10.120-preview
- Microsoft.Xaml.Behaviors.WinUI.Managed 2.0.9
- Microsoft.Xaml.Behaviors.Wpf 1.1.39
- ModernWpfUI 0.9.4
- Moq 4.18.4
- MSTest 3.8.3
- NLog.Extensions.Logging 5.3.8
- NLog.Schema 5.2.8
- OpenAI 2.0.0
- ReverseMarkdown 4.1.0
- ScipBe.Common.Office.OneNote 3.0.1
- SharpCompress 0.37.2
- StreamJsonRpc 2.21.69
- StyleCop.Analyzers 1.2.0-beta.556
- System.CodeDom 9.0.4
- System.CommandLine 2.0.0-beta4.22272.1
- System.ComponentModel.Composition 9.0.4
- System.Configuration.ConfigurationManager 9.0.4
- System.Data.OleDb 9.0.4
- System.Data.SqlClient 4.8.6
- System.Diagnostics.EventLog 9.0.4
- System.Diagnostics.PerformanceCounter 9.0.4
- System.Drawing.Common 9.0.4
- System.IO.Abstractions 22.0.13
- System.IO.Abstractions.TestingHelpers 22.0.13
- System.Management 9.0.4
- System.Net.Http 4.3.4
- System.Private.Uri 4.3.2
- System.Reactive 6.0.1
- System.Runtime.Caching 9.0.4
- System.ServiceProcess.ServiceController 9.0.4
- System.Text.Encoding.CodePages 9.0.4
- System.Text.Json 9.0.4
- System.Text.RegularExpressions 4.3.1
- UnicodeInformation 2.6.0
- UnitsNet 5.56.0
- UTF.Unknown 2.5.1
- WinUIEx 2.2.0
- WPF-UI 3.0.5
- WyHash 1.0.5
```

----------------------------------------

TITLE: Configuring Build Output Directory for Fuzzing Tests in .NET
DESCRIPTION: Example of the directory structure where fuzzing test job dependencies should be defined, showing the path to the compiled test assemblies.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/Hosts/Hosts.FuzzTests/Fuzz.md#2025-04-15_snippet_0

LANGUAGE: plaintext
CODE:
```
PowerToys\x64\Debug\tests\Hosts.FuzzTests\net8.0-windows10.0.19041.0
```

----------------------------------------

TITLE: Key-Value Format for Resource Conversion
DESCRIPTION: Plain-text key-value format used as an intermediate step when converting XAML resources to RESX format. This format uses simple key=value pairs that can be processed by resgen.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_6

LANGUAGE: plaintext
CODE:
```
wox_plugin_calculator_plugin_name=Calculator
wox_plugin_calculator_plugin_description=Allows to do mathematical calculations.(Try 5*3-2 in Wox)
wox_plugin_calculator_not_a_number=Not a number (NaN)
```

----------------------------------------

TITLE: COM Object Creation and Foreground Window Management in Windows C/C++
DESCRIPTION: Functions for creating COM objects and managing foreground windows. These are used for component object model interactions and window focus control.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Exts/Microsoft.CmdPal.Ext.Apps/NativeMethods.txt#2025-04-15_snippet_1

LANGUAGE: C
CODE:
```
CoCreateInstance
SetForegroundWindow
IsIconic
```

----------------------------------------

TITLE: Checking resources.pri with makepri.exe
DESCRIPTION: Command line instruction for using makepri.exe to dump the contents of a resources.pri file to verify if localized resources are properly included.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_11

LANGUAGE: markdown
CODE:
```
makepri.exe dump /if .\resources.pri
```

----------------------------------------

TITLE: Installing PowerToys via WinGet - Machine-wide Scope
DESCRIPTION: PowerShell command to install Microsoft PowerToys with machine-wide scope using the WinGet package manager, making it available for all users on the system.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/README.md#2025-04-15_snippet_1

LANGUAGE: powershell
CODE:
```
winget install --scope machine Microsoft.PowerToys -s winget
```

----------------------------------------

TITLE: XAML Resource Format Example for Migration to RESX
DESCRIPTION: Example of XAML string resources that need to be converted to the RESX format. This shows the original format used in XAML files with string keys and values.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_5

LANGUAGE: XML
CODE:
```
<system:String x:Key="wox_plugin_calculator_plugin_name">Calculator</system:String>
<system:String x:Key="wox_plugin_calculator_plugin_description">Allows to do mathematical calculations.(Try 5*3-2 in Wox)</system:String>
<system:String x:Key="wox_plugin_calculator_not_a_number">Not a number (NaN)</system:String>
```

----------------------------------------

TITLE: Including Resource Files in C++ Projects
DESCRIPTION: XML configuration that excludes resource files from direct compilation. This ensures the resources are handled by the custom build process rather than the standard compiler.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_3

LANGUAGE: XML
CODE:
```
<None Include="Resources.resx" />
```

----------------------------------------

TITLE: Window Focus and Activation Management in Windows C/C++
DESCRIPTION: Functions for setting foreground windows, focus, and active windows. These are used to control which window has user interaction priority.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Exts/Microsoft.CmdPal.Ext.Apps/NativeMethods.txt#2025-04-15_snippet_3

LANGUAGE: C
CODE:
```
SetForegroundWindow
SetFocus
SetActiveWindow
```

----------------------------------------

TITLE: Installing PowerToys via WinGet - User Scope
DESCRIPTION: PowerShell command to install Microsoft PowerToys with user scope using the WinGet package manager. This is the default installation method when using WinGet.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/README.md#2025-04-15_snippet_0

LANGUAGE: powershell
CODE:
```
winget install Microsoft.PowerToys -s winget
```

----------------------------------------

TITLE: Viewing Localized Resources in resources.pri File
DESCRIPTION: Example XML structure showing how localized resources appear in a resources.pri file after using makepri.exe to dump its contents. The snippet shows a named resource with French and English-US language variants.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_9

LANGUAGE: xml
CODE:
```
<NamedResource name="GeneralSettings_RunningAsAdminText" uri="ms-resource://f4f787a5-f0ae-47a9-be89-5408b1dd2b47/Resources/GeneralSettings_RunningAsAdminText">
    <Candidate qualifiers="Language-FR" type="String">
        <Value>Running as administrator</Value>
    </Candidate>
    <Candidate qualifiers="Language-EN-US" isDefault="true" type="String">
        <Value>Running as administrator</Value>
    </Candidate>
</NamedResource>
```

----------------------------------------

TITLE: Example List Section with Placeholder Item in Command Palette
DESCRIPTION: Code snippet showing a ListSection with a single ListItem that has a placeholder title and NoOpCommand. This represents the structure for displaying content in a Command Palette page.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/command-pal-anatomy/command-palette-anatomy.md#2025-04-15_snippet_10

LANGUAGE: csharp
CODE:
```
new ListSection()
            {
                Title = "SSH Hosts",
                Items = [
                    new ListItem(new NoOpCommand()) { Title = "TODO: Implement your extension here" }
                ],
            }
```

----------------------------------------

TITLE: Shell Stream and String Operations in Windows C/C++
DESCRIPTION: Functions for creating file streams and loading indirect strings. These are used for file I/O operations and resource string management in shell contexts.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Exts/Microsoft.CmdPal.Ext.Apps/NativeMethods.txt#2025-04-15_snippet_5

LANGUAGE: C
CODE:
```
SHCreateStreamOnFileEx
CoAllowSetForegroundWindow
SHCreateStreamOnFileEx
SHLoadIndirectString
```

----------------------------------------

TITLE: Windows API Window Management Functions
DESCRIPTION: List of Windows API functions for managing windows, monitors, DPI, thread interactions, and GUI elements. These functions are commonly used in native Windows applications for window manipulation and system interaction.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/peek/Peek.UI/NativeMethods.txt#2025-04-15_snippet_0

LANGUAGE: C++
CODE:
```
MonitorFromWindow
GetMonitorInfo
GetDpiForWindow
GetForegroundWindow
SetForegroundWindow
SetActiveWindow
GetWindowThreadProcessId
GetCurrentThreadId
AttachThreadInput
BringWindowToTop
ShowWindow
GetWindowTextLength
FindWindowEx
SID_STopLevelBrowser
GetClassName
_SVGIO
MONITORINFO
GetWindowRect
SET_WINDOW_POS_FLAGS
SetWindowPos
GetWindowPlacement
SetWindowPlacement
GetGUIThreadInfo
```

----------------------------------------

TITLE: Adding Resource Component to PowerToys MSI
DESCRIPTION: XML code for creating a resource component in the Product.wxs file to include localized satellite DLLs in the MSI installer. This needs to be added only after the Localization team has committed the initial LCL files.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/localization.md#2025-04-15_snippet_10

LANGUAGE: xml
CODE:
```
<Component Id="ProjName_$(var.IdSafeLanguage)_Component" Directory="Resource$(var.IdSafeLanguage)ProjNameInstallFolder">
    <File Id="ProjName_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\ProjName\$(var.Language)\ProjName.resources.dll" />
</Component>
```

----------------------------------------

TITLE: Window Management and Hotkey Registration in C++
DESCRIPTION: This set of functions is used for registering hotkeys, modifying window properties, and managing window focus. They are crucial for implementing custom window behaviors and keyboard shortcuts.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Microsoft.CmdPal.UI.ViewModels/NativeMethods.txt#2025-04-15_snippet_2

LANGUAGE: C++
CODE:
```
RegisterHotKey
SetWindowLongPtr
CallWindowProc
ShowWindow
SetForegroundWindow
SetFocus
SetActiveWindow
```

----------------------------------------

TITLE: Windows API Function Names for Security and Package Management
DESCRIPTION: A list of Windows API function names and constants used for COM client impersonation, thread token handling, package identification, and folder path retrieval in the PowerToys project.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/extensionsdk/Microsoft.CommandPalette.Extensions.Toolkit/NativeMethods.txt#2025-04-15_snippet_0

LANGUAGE: plaintext
CODE:
```
CoImpersonateClient
GetCurrentThread
OpenThreadToken
GetPackageFamilyNameFromToken
CoRevertToSelf
SHGetKnownFolderPath
KNOWN_FOLDER_FLAG
GetCurrentPackageId
```

----------------------------------------

TITLE: PowerToys URL Mapping Table in Markdown
DESCRIPTION: A markdown table containing mappings between short URLs and their corresponding full URLs for PowerToys resources, including store links, documentation, images, and support pages.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/akaLinks.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
| ShortUrl | TargetUrl |
|----------|----------|
| getpowertoys | ms-windows-store://pdp/?productid=XP89DCGQ3K6VLD |
| installpowertoys | https://github.com/microsoft/PowerToys/releases/latest |
| powertoys-license | https://github.com/microsoft/PowerToys/blob/main/LICENSE |
| powertoys | https://github.com/microsoft/PowerToys |
| PowerToysAppCompat | https://github.com/microsoft/PowerToys/wiki/Application-Compatibility |
| powerToysCannotRemapKeys | https://learn.microsoft.com/windows/powertoys/keyboard-manager#keys-that-cannot-be-remapped |
| powerToysColorPickerImageSmall | https://github.com/microsoft/PowerToys/wiki/images/overview/ColorPicker_small.png |
| powerToysColorPickerSettingImage | https://raw.githubusercontent.com/microsoft/PowerToys/main/doc/images/overview/ColorPicker_large.png |
| powertoysDetectedElevatedHelp | https://learn.microsoft.com/windows/powertoys/administrator |
| powertoys-docs | https://learn.microsoft.com/windows/powertoys |
| powerToysFancyZoneImageSmall | https://github.com/microsoft/PowerToys/wiki/images/overview/FancyZones_small.png |
| powerToysFancyZoneSettingImage | https://raw.githubusercontent.com/microsoft/PowerToys/main/doc/images/overview/FancyZones_large.png |
| powerToysGiveFeedback | https://github.com/microsoft/PowerToys/issues |
| powerToysImageResizerImageSmall | https://github.com/microsoft/PowerToys/wiki/images/overview/ImageResizer_small.png |
| powerToysImageResizerSettingImage | https://raw.githubusercontent.com/microsoft/PowerToys/main/doc/images/overview/ImageResizer_large.png |
| powerToysKBMImageSmall | https://github.com/microsoft/PowerToys/wiki/images/overview/KBM_small.png |
| powerToysKBMSettingImage | https://raw.githubusercontent.com/microsoft/PowerToys/main/doc/images/overview/KBM_large.png |
| PowerToysOverview | https://learn.microsoft.com/windows/powertoys/ |
| PowerToysOverview_ColorPicker | https://learn.microsoft.com/windows/powertoys/color-picker |
| PowerToysOverview_FancyZones | https://learn.microsoft.com/windows/powertoys/fancyzones |
| PowerToysOverview_FileExplorerAddOns | https://learn.microsoft.com/windows/powertoys/file-explorer |
| PowerToysOverview_ImageResizer | https://learn.microsoft.com/windows/powertoys/image-resizer |
| PowerToysOverview_KeyboardManager | https://learn.microsoft.com/windows/powertoys/keyboard-manager |
| PowerToysOverview_MouseUtilities | https://learn.microsoft.com/windows/powertoys/mouse-utilities |
| PowerToysOverview_PowerRename | https://learn.microsoft.com/windows/powertoys/powerrename |
| PowerToysOverview_PowerToysRun | https://learn.microsoft.com/windows/powertoys/run |
| PowerToysOverview_ShortcutGuide | https://learn.microsoft.com/windows/powertoys/shortcut-guide |
| powerToysPowerLauncherImageSmall | https://github.com/microsoft/PowerToys/wiki/images/overview/PowerLauncher_small.png |
| powerToysPowerLauncherSettingImage | https://raw.githubusercontent.com/microsoft/PowerToys/main/doc/images/overview/PowerLauncher_large.png |
| powerToysPowerPreviewImageSmall | https://github.com/microsoft/PowerToys/wiki/images/overview/PowerPreview_small.png |
| powerToysPowerPreviewSettingImage | https://raw.githubusercontent.com/microsoft/PowerToys/main/doc/images/overview/PowerPreview_large.png |
| powerToysPowerRenameImageSmall | https://github.com/microsoft/PowerToys/wiki/images/overview/PowerRename_small.png |
| powerToysPowerRenameSettingImage | https://raw.githubusercontent.com/microsoft/PowerToys/main/doc/images/overview/PowerRename_large.png |
| powerToysPTImageSmall | https://github.com/microsoft/PowerToys/wiki/images/overview/PT_small.png |
| powerToysPTSettingImage | https://raw.githubusercontent.com/microsoft/PowerToys/main/doc/images/overview/PT_large.png |
| powerToysReportBug | https://github.com/microsoft/PowerToys/issues/new?assignees=&labels=Issue-Bug%2CTriage-Needed&template=bug_report.yml&title= |
| powerToysRequestFeature | https://github.com/microsoft/PowerToys/issues/new?assignees=&labels=&template=feature_request.md&title= |
| powerToysShortcutGuideImageSmall | https://github.com/microsoft/PowerToys/wiki/images/overview/ShortcutGuide_small.png |
| powerToysShortcutGuideSettingImage | https://raw.githubusercontent.com/microsoft/PowerToys/main/doc/images/overview/ShortcutGuide_large.png |
| powertoyswiki | https://github.com/microsoft/PowerToys/wiki |
```

----------------------------------------

TITLE: Windows COM Marshaling and Stream Functions Reference
DESCRIPTION: Core COM functions used for creating COM instances, marshaling interfaces between processes, and working with global memory streams. These functions are essential for COM interop and cross-process communication in Windows.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/exts/Microsoft.CmdPal.Ext.WinGet/NativeMethods.txt#2025-04-15_snippet_0

LANGUAGE: c++
CODE:
```
CoCreateInstance
CoMarshalInterface
CoUnmarshalInterface
CreateStreamOnHGlobal
MSHCTX
MSHLFLAGS
```

----------------------------------------

TITLE: Monitor Information Retrieval in C++
DESCRIPTION: These functions are used to get information about the monitor on which a window is displayed. They are useful for multi-monitor setups and screen-aware applications.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Microsoft.CmdPal.UI.ViewModels/NativeMethods.txt#2025-04-15_snippet_3

LANGUAGE: C++
CODE:
```
MonitorFromWindow
GetMonitorInfo
```

----------------------------------------

TITLE: PowerToys Keyboard Manager Events Table
DESCRIPTION: HTML table documenting telemetry events for the Keyboard Manager feature, including configuration loading, remap counts, and usage tracking events.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/DATA_AND_PRIVACY.md#2025-04-15_snippet_1

LANGUAGE: markdown
CODE:
```
### Keyboard Manager
<table style="width:100%">
  <tr>
    <th>Event Name</th>
    <th>Description</th>
  </tr>
  <!-- Event entries -->
</table>
```

----------------------------------------

TITLE: Mozilla Public License v1.1 for UTF.Unknown Package
DESCRIPTION: The full text of the Mozilla Public License Version 1.1 that governs the UTF.Unknown NuGet package used for encoding detection. The license defines terms for source code distribution, modifications, and intellectual property considerations.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/NOTICE.md#2025-04-15_snippet_2

LANGUAGE: text
CODE:
```
                          MOZILLA PUBLIC LICENSE
                                Version 1.1

                              ---------------

1. Definitions.

     1.0.1. "Commercial Use" means distribution or otherwise making the
     Covered Code available to a third party.

     1.1. "Contributor" means each entity that creates or contributes to
     the creation of Modifications.

     1.2. "Contributor Version" means the combination of the Original
     Code, prior Modifications used by a Contributor, and the Modifications
     made by that particular Contributor.

     1.3. "Covered Code" means the Original Code or Modifications or the
     combination of the Original Code and Modifications, in each case
     including portions thereof.

     1.4. "Electronic Distribution Mechanism" means a mechanism generally
     accepted in the software development community for the electronic
     transfer of data.

     1.5. "Executable" means Covered Code in any form other than Source
     Code.

     1.6. "Initial Developer" means the individual or entity identified
     as the Initial Developer in the Source Code notice required by Exhibit
     A.

     1.7. "Larger Work" means a work which combines Covered Code or
     portions thereof with code not governed by the terms of this License.

     1.8. "License" means this document.

     1.8.1. "Licensable" means having the right to grant, to the maximum
     extent possible, whether at the time of the initial grant or
     subsequently acquired, any and all of the rights conveyed herein.

     1.9. "Modifications" means any addition to or deletion from the
     substance or structure of either the Original Code or any previous
     Modifications. When Covered Code is released as a series of files, a
     Modification is:
          A. Any addition to or deletion from the contents of a file
          containing Original Code or previous Modifications.

          B. Any new file that contains any part of the Original Code or
          previous Modifications.

     1.10. "Original Code" means Source Code of computer software code
     which is described in the Source Code notice required by Exhibit A as
     Original Code, and which, at the time of its release under this
     License is not already Covered Code governed by this License.

     1.10.1. "Patent Claims" means any patent claim(s), now owned or
     hereafter acquired, including without limitation,  method, process,
     and apparatus claims, in any patent Licensable by grantor.

     1.11. "Source Code" means the preferred form of the Covered Code for
     making modifications to it, including all modules it contains, plus
     any associated interface definition files, scripts used to control
     compilation and installation of an Executable, or source code
     differential comparisons against either the Original Code or another
     well known, available Covered Code of the Contributor's choice. The
     Source Code can be in a compressed or archival form, provided the
     appropriate decompression or de-archiving software is widely available
     for no charge.

     1.12. "You" (or "Your")  means an individual or a legal entity
     exercising rights under, and complying with all of the terms of, this
     License or a future version of this License issued under Section 6.1.
     For legal entities, "You" includes any entity which controls, is
     controlled by, or is under common control with You. For purposes of
     this definition, "control" means (a) the power, direct or indirect,
     to cause the direction or management of such entity, whether by
     contract or otherwise, or (b) ownership of more than fifty percent
     (50%) of the outstanding shares or beneficial ownership of such
     entity.

2. Source Code License.

     2.1. The Initial Developer Grant.
     The Initial Developer hereby grants You a world-wide, royalty-free,
     non-exclusive license, subject to third party intellectual property
     claims:
          (a)  under intellectual property rights (other than patent or
          trademark) Licensable by Initial Developer to use, reproduce,
          modify, display, perform, sublicense and distribute the Original
          Code (or portions thereof) with or without Modifications, and/or
          as part of a Larger Work; and

          (b) under Patents Claims infringed by the making, using or
          selling of Original Code, to make, have made, use, practice,
          sell, and offer for sale, and/or otherwise dispose of the
          Original Code (or portions thereof).

          (c) the licenses granted in this Section 2.1(a) and (b) are
          effective on the date Initial Developer first distributes
          Original Code under the terms of this License.

          (d) Notwithstanding Section 2.1(b) above, no patent license is
          granted: 1) for code that You delete from the Original Code; 2)
          separate from the Original Code;  or 3) for infringements caused
          by: i) the modification of the Original Code or ii) the
          combination of the Original Code with other software or devices.

     2.2. Contributor Grant.
     Subject to third party intellectual property claims, each Contributor
     hereby grants You a world-wide, royalty-free, non-exclusive license

          (a)  under intellectual property rights (other than patent or
          trademark) Licensable by Contributor, to use, reproduce, modify,
          display, perform, sublicense and distribute the Modifications
          created by such Contributor (or portions thereof) either on an
          unmodified basis, with other Modifications, as Covered Code
          and/or as part of a Larger Work; and

          (b) under Patent Claims infringed by the making, using, or
          selling of  Modifications made by that Contributor either alone
          and/or in combination with its Contributor Version (or portions
          of such combination), to make, use, sell, offer for sale, have
          made, and/or otherwise dispose of: 1) Modifications made by that
          Contributor (or portions thereof); and 2) the combination of
          Modifications made by that Contributor with its Contributor
          Version (or portions of such combination).

          (c) the licenses granted in Sections 2.2(a) and 2.2(b) are
          effective on the date Contributor first makes Commercial Use of
          the Covered Code.

          (d)    Notwithstanding Section 2.2(b) above, no patent license is
          granted: 1) for any code that Contributor has deleted from the
          Contributor Version; 2)  separate from the Contributor Version;
          3)  for infringements caused by: i) third party modifications of
          Contributor Version or ii)  the combination of Modifications made
          by that Contributor with other software  (except as part of the
          Contributor Version) or other devices; or 4) under Patent Claims
          infringed by Covered Code in the absence of Modifications made by
          that Contributor.

3. Distribution Obligations.

     3.1. Application of License.
     The Modifications which You create or to which You contribute are
     governed by the terms of this License, including without limitation
     Section 2.2. The Source Code version of Covered Code may be
     distributed only under the terms of this License or a future version
     of this License released under Section 6.1, and You must include a
     copy of this License with every copy of the Source Code You
     distribute. You may not offer or impose any terms on any Source Code
     version that alters or restricts the applicable version of this
     License or the recipients' rights hereunder. However, You may include
     an additional document offering the additional rights described in
     Section 3.5.

     3.2. Availability of Source Code.
     Any Modification which You create or to which You contribute must be
     made available in Source Code form under the terms of this License
     either on the same media as an Executable version or via an accepted
     Electronic Distribution Mechanism to anyone to whom you made an
     Executable version available; and if made available via Electronic
     Distribution Mechanism, must remain available for at least twelve (12)
     months after the date it initially became available, or at least six
     (6) months after a subsequent version of that particular Modification
     has been made available to such recipients. You are responsible for
     ensuring that the Source Code version remains available even if the
     Electronic Distribution Mechanism is maintained by a third party.

     3.3. Description of Modifications.
     You must cause all Covered Code to which You contribute to contain a
     file documenting the changes You made to create that Covered Code and
     the date of any change. You must include a prominent statement that
     the Modification is derived, directly or indirectly, from Original
     Code provided by the Initial Developer and including the name of the
     Initial Developer in (a) the Source Code, and (b) in any notice in an
     Executable version or related documentation in which You describe the
     origin or ownership of the Covered Code.

     3.4. Intellectual Property Matters
          (a) Third Party Claims.
          If Contributor has knowledge that a license under a third party's
          intellectual property rights is required to exercise the rights
          granted by such Contributor under Sections 2.1 or 2.2,
          Contributor must include a text file with the Source Code
          distribution titled "LEGAL" which describes the claim and the
```

----------------------------------------

TITLE: Visual Studio Formatting Keyboard Shortcut
DESCRIPTION: Keyboard shortcut command to format the current document in Visual Studio using ClangFormat
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/style.md#2025-04-15_snippet_1

LANGUAGE: text
CODE:
```
CTRL+K CTRL+D
```

----------------------------------------

TITLE: Window Management and Hotkey Registration in Windows C/C++
DESCRIPTION: Functions for registering hotkeys, modifying window properties, and manipulating window states. These are used for custom keyboard shortcuts and window behavior control.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/Exts/Microsoft.CmdPal.Ext.Apps/NativeMethods.txt#2025-04-15_snippet_2

LANGUAGE: C
CODE:
```
RegisterHotKey
SetWindowLongPtr
CallWindowProc
ShowWindow
```

----------------------------------------

TITLE: Referencing PowerToys Run Process in Markdown
DESCRIPTION: This snippet identifies the process associated with PowerToys Run, which is crucial for attaching the debugger.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/debugging.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
`PowerToys Run` is a single exe file associated with `launcher.exe` process and debugger should be attached to this process.
```

----------------------------------------

TITLE: Example Output of Monitor Info Report Tool
DESCRIPTION: Shows the format of the log file generated by the Monitor Report Tool. The output includes monitor metrics, display device information, and monitor enumeration status.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/tools/monitor-info-report.md#2025-04-15_snippet_0

LANGUAGE: text
CODE:
```
GetSystemMetrics = 2
GetMonitorInfo OK
EnumDisplayDevices OK:
        DeviceID = \\?\DISPLAY#VSCBD34#5&25664547&0&UID4355#{e6f07b5f-ee97-4a90-b076-33f57bf4eaa7}
        DeviceKey = \Registry\Machine\System\CurrentControlSet\Control\Class\{4d36e96e-e325-11ce-bfc1-08002be10318}\0002
        DeviceName = \\.\DISPLAY1\Monitor0
        DeviceString = Generic PnP Monitor
GetMonitorInfo OK
EnumDisplayDevices OK:
        DeviceID = \\?\DISPLAY#ENC2682#5&25664547&0&UID4357#{e6f07b5f-ee97-4a90-b076-33f57bf4eaa7}
        DeviceKey = \Registry\Machine\System\CurrentControlSet\Control\Class\{4d36e96e-e325-11ce-bfc1-08002be10318}\0003
        DeviceName = \\.\DISPLAY2\Monitor0
        DeviceString = Generic PnP Monitor
EnumDisplayMonitors OK
```

----------------------------------------

TITLE: Navigating FancyZones DrawLayoutTest Tool in Markdown
DESCRIPTION: Describes the location of the DrawLayoutTest tool within the PowerToys project structure and outlines its primary functionalities, including toggling zone appearance and exiting the application.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/tools/fancyzones-draw-layout-test.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
# [FancyZones_DrawLayoutTest](/tools/FancyZones_DrawLayoutTest/)

This test tool is created in order to debug issues related to the drawing of zone layout on screen.

Currently, only column layout is supported with modifiable number of zones. Pressing **w** key toggles zone appearance on primary screen (multi monitor support not yet in place). Pressing **q** key exits application.

Application is DPI unaware which means that application does not scale for DPI changes and it always assumes to have a scale factor of 100% (96 DPI). Scaling will be automatically performed by the system.
```

----------------------------------------

TITLE: Referencing Development Environment Setup in Markdown
DESCRIPTION: This snippet provides a link to the instructions for setting up the PowerToys development environment, which is a prerequisite for debugging.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/debugging.md#2025-04-15_snippet_1

LANGUAGE: markdown
CODE:
```
Setup development environment for PowerToys by following instruction [here.](https://github.com/microsoft/PowerToys/tree/main/doc/devdocs#prerequisites-for-compiling-powertoys)
```

----------------------------------------

TITLE: Starting PowerToys Telemetry Trace Capture with WPR
DESCRIPTION: Command to initiate telemetry trace capture using Windows Performance Recorder with the PowerToys trace profile
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/common/Telemetry/readme.md#2025-04-15_snippet_0

LANGUAGE: batch
CODE:
```
wpr.exe -start "PowerToys.wprp"
```

----------------------------------------

TITLE: PowerToys Mouse Jump Events Table
DESCRIPTION: HTML table documenting telemetry events for the Mouse Jump feature, including enabling, invocation, and cursor teleportation events.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/DATA_AND_PRIVACY.md#2025-04-15_snippet_3

LANGUAGE: markdown
CODE:
```
### Mouse Jump
<table style="width:100%">
  <tr>
    <th>Event Name</th>
    <th>Description</th>
  </tr>
  <!-- Event entries -->
</table>
```

----------------------------------------

TITLE: Listing Bug Report Tool File Contents
DESCRIPTION: This snippet enumerates the files included in the bug report generated by the PowerToys Bug Report Tool. It details various log files, system information, and configuration data collected to assist in troubleshooting.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/tools/bug-report-tool.md#2025-04-15_snippet_0

LANGUAGE: plaintext
CODE:
```
* Settings files of the modules.
* Logs of the modules and the runner.
* Update log files.
* `compatibility-tab-info.txt` - Information about compatibility settings set for certain PowerToys executables both in the user and system scope.
* `context-menu-packages.txt` - Information about the packages that are registered for the new Windows 11 context menu.
* `dotnet-installation-info.txt` - Information about the installed .NET versions.
* `EventViewer-*.xml` - These files contain event logs from the Windows Event Viewer for the executable specified in the file name.
* `gpo-configuration-info.txt` - Information about the configured GPO.
* `installationFolderStructure.txt` - Information about the folder structure of the installation. All lines with files have the following structure: `FileName Version MD5Hash`.
* `last_version_run.json` - Information about the last version of PowerToys that was run.
* `log_settings.json` - Information about the log level settings.
* `monitor-report-info.txt` - Information about the monitors connected to the system. This file is created by the monitor info report tool.
* `oobe_settings.json` - Information about the OOBE settings.
* `registry-report-info.txt` - Information about the registry keys that are used by PowerToys.
* `settings_placement.json` - Information about the placement of the settings window.
* `settings-telemetry.json` - Information about the last time telemetry data was sent.
* `UpdateState.json` - Information about the last update check and the current status of the update download.
* `windows-settings.txt` - Information about the Windows language settings.
* `windows-version.txt` - Information about the Windows version.
```

----------------------------------------

TITLE: Configuring Download Patterns in OneFuzz Pipeline for PowerToys
DESCRIPTION: YAML configuration example for the job-fuzz.yml pipeline file, showing how to set up artifact download patterns to match a specific fuzzing test project.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/Hosts/Hosts.FuzzTests/Fuzz.md#2025-04-15_snippet_1

LANGUAGE: yaml
CODE:
```
 - download: current
        displayName: Download artifacts
        artifact: $(ArtifactName)
        patterns: |-
          **/tests/Hosts.FuzzTests/**
```

----------------------------------------

TITLE: PowerShell XAML Styling Command
DESCRIPTION: Command to apply XAML styling using PowerShell script
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/style.md#2025-04-15_snippet_0

LANGUAGE: PowerShell
CODE:
```
.\.pipelines\applyXamlStyling.ps1 -Main
```

----------------------------------------

TITLE: Markdown Link to Image Resizer Documentation
DESCRIPTION: Markdown link syntax directing users to the official PowerToys Image Resizer documentation overview page on Microsoft's website.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/imageresizer/README.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
[Image Resizer Overview](https://aka.ms/PowerToysOverview_ImageResizer)
```

----------------------------------------

TITLE: Embedding Image in Markdown using HTML Tag
DESCRIPTION: HTML image tag embedded within a markdown file that references a local image file named 'a.jpg' in the same directory.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/previewpane/UnitTests-MarkdownPreviewHandler/HelperFiles/MarkdownWithHTMLImageTag.txt#2025-04-15_snippet_0

LANGUAGE: html
CODE:
```
<img src="./a.jpg" \>
```

----------------------------------------

TITLE: PowerToys Mouse Highlighter Events Table
DESCRIPTION: HTML table documenting telemetry events for the Mouse Highlighter feature, tracking enabling and session starts.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/DATA_AND_PRIVACY.md#2025-04-15_snippet_2

LANGUAGE: markdown
CODE:
```
### Mouse Highlighter
<table style="width:100%">
  <tr>
    <th>Event Name</th>
    <th>Description</th>
  </tr>
  <!-- Event entries -->
</table>
```

----------------------------------------

TITLE: ClangFormat Path Reference
DESCRIPTION: Environment variable path reference for ClangFormat executable in Visual Studio
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/style.md#2025-04-15_snippet_2

LANGUAGE: text
CODE:
```
%VCINSTALLDIR%\Tools\Llvm\bin\
```

----------------------------------------

TITLE: Basic JavaScript Alert in HTML Script Tag
DESCRIPTION: A simple script that creates an alert dialog with the message 'hello'. This is a common example used to demonstrate Cross-Site Scripting (XSS) vulnerabilities in web applications.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/previewpane/UnitTests-MarkdownPreviewHandler/HelperFiles/MarkdownWithscript.txt#2025-04-15_snippet_0

LANGUAGE: html
CODE:
```
<script>alert("hello")</script>
```

----------------------------------------

TITLE: Initializing Service State and Time Constants in Python
DESCRIPTION: Defines variables for tracking service error messages and initializes time-related constants including date range boundaries and Unix epoch reference. Uses boolean flag for error message state tracking.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/MouseWithoutBorders/MouseWithoutBorders.UnitTests/Core/Logger.PrivateDump.expected.txt#2025-04-15_snippet_0

LANGUAGE: python
CODE:
```
shownErrMessage = False
lastStartServiceTime = ????????????
--_dateData = ????????????
--MinValue = 01/01/0001 00:00:00
--MaxValue = 31/12/9999 23:59:59
--UnixEpoch = 01/01/1970 00:00:00
```

----------------------------------------

TITLE: Installing PowerToys with Scoop in PowerShell
DESCRIPTION: This command installs Microsoft PowerToys using the Scoop package manager. Users should run this from either a command line or PowerShell interface.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/unofficialInstallMethods.md#2025-04-15_snippet_2

LANGUAGE: powershell
CODE:
```
scoop install powertoys
```

----------------------------------------

TITLE: Keyboard Shortcut for Command Palette in Markdown
DESCRIPTION: Defines the default keyboard shortcut for launching the Command Palette using Markdown syntax.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/README.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
<kbd>Win+Alt+Space</kbd>
```

----------------------------------------

TITLE: Implementing GitHub Issue Page with Markdown Content in C#
DESCRIPTION: This class demonstrates how to create a GitHub issue page using the Command Palette Extensions Toolkit. It constructs a page with issue metadata and displays the issue body as Markdown content.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/cmdpal/doc/initial-sdk-spec/initial-sdk-spec.md#2025-04-15_snippet_11

LANGUAGE: cs
CODE:
```
class GitHubIssue {
    string Title;
    string Url;
    string Body;
    string Author;
    string[] Tags;
    string[] AssignedTo;
}
class GithubIssuePage: Microsoft.CommandPalette.Extensions.Toolkit.ContentPage {
    private readonly MarkdownContent issueBody;
    public GithubIssuePage(GithubIssue issue)
    {
        Commands = [ new CommandContextItem(new Microsoft.CommandPalette.Extensions.Toolkit.OpenUrlCommand(issue.Url)) ];
        Details = new Details(){
            Title = "",
            Body = "",
            Metadata = [
                new Microsoft.CommandPalette.Extensions.Toolkit.DetailsTags(){
                    Key = "Author",
                    Tags = [new Tag(issue.Author)]
                },
                new Microsoft.CommandPalette.Extensions.Toolkit.DetailsTags(){
                    Key = "Assigned To",
                    Tags = issue.AssignedTo.Select((user) => new Tag(user)).ToArray()
                },
                new Microsoft.CommandPalette.Extensions.Toolkit.DetailsTags(){
                    Key = "Tags",
                    Tags = issue.Tags.Select((tag) => new Tag(tag)).ToArray()
                }
            ]
        };

        issueBody = new MarkdownContent(issue.Body);
    }

    public override IContent[] GetContent() => [issueBody];
}
```

----------------------------------------

TITLE: PowerToys Event Documentation Table Structure
DESCRIPTION: HTML table structure used consistently throughout the document to display PowerToys event names and their descriptions. Each table represents a different PowerToys module.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/DATA_AND_PRIVACY.md#2025-04-15_snippet_0

LANGUAGE: html
CODE:
```
<table style="width:100%">
  <tr>
    <th>Event Name</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>Microsoft.PowerToys.[EventName]</td>
    <td>[Event Description]</td>
  </tr>
</table>
```

----------------------------------------

TITLE: Displaying Mozilla Public License Version 1.1 for UTF.Unknown Package
DESCRIPTION: This snippet shows the full text of the Mozilla Public License Version 1.1 that applies to the UTF.Unknown package used in PowerToys for encoding detection. It defines terms like Commercial Use, Contributor, Covered Code, and outlines the rights and responsibilities of users and contributors.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/NOTICE.md#2025-04-15_snippet_1

LANGUAGE: plaintext
CODE:
```
                          MOZILLA PUBLIC LICENSE
                                Version 1.1

                              ---------------

1. Definitions.

     1.0.1. "Commercial Use" means distribution or otherwise making the
     Covered Code available to a third party.

     1.1. "Contributor" means each entity that creates or contributes to
     the creation of Modifications.

     1.2. "Contributor Version" means the combination of the Original
     Code, prior Modifications used by a Contributor, and the Modifications
     made by that particular Contributor.

     1.3. "Covered Code" means the Original Code or Modifications or the
     combination of the Original Code and Modifications, in each case
     including portions thereof.

     1.4. "Electronic Distribution Mechanism" means a mechanism generally
     accepted in the software development community for the electronic
     transfer of data.

     1.5. "Executable" means Covered Code in any form other than Source
     Code.

     1.6. "Initial Developer" means the individual or entity identified
     as the Initial Developer in the Source Code notice required by Exhibit
     A.

     1.7. "Larger Work" means a work which combines Covered Code or
     portions thereof with code not governed by the terms of this License.

     1.8. "License" means this document.

     1.8.1. "Licensable" means having the right to grant, to the maximum
     extent possible, whether at the time of the initial grant or
     subsequently acquired, any and all of the rights conveyed herein.

     1.9. "Modifications" means any addition to or deletion from the
     substance or structure of either the Original Code or any previous
     Modifications. When Covered Code is released as a series of files, a
     Modification is:
          A. Any addition to or deletion from the contents of a file
          containing Original Code or previous Modifications.

          B. Any new file that contains any part of the Original Code or
          previous Modifications.

     1.10. "Original Code" means Source Code of computer software code
     which is described in the Source Code notice required by Exhibit A as
     Original Code, and which, at the time of its release under this
     License is not already Covered Code governed by this License.

     1.10.1. "Patent Claims" means any patent claim(s), now owned or
     hereafter acquired, including without limitation,  method, process,
     and apparatus claims, in any patent Licensable by grantor.

     1.11. "Source Code" means the preferred form of the Covered Code for
     making modifications to it, including all modules it contains, plus
     any associated interface definition files, scripts used to control
     compilation and installation of an Executable, or source code
     differential comparisons against either the Original Code or another
     well known, available Covered Code of the Contributor's choice. The
     Source Code can be in a compressed or archival form, provided the
     appropriate decompression or de-archiving software is widely available
     for no charge.

     1.12. "You" (or "Your")  means an individual or a legal entity
     exercising rights under, and complying with all of the terms of, this
     License or a future version of this License issued under Section 6.1.
     For legal entities, "You" includes any entity which controls, is
     controlled by, or is under common control with You. For purposes of
     this definition, "control" means (a) the power, direct or indirect,
     to cause the direction or management of such entity, whether by
     contract or otherwise, or (b) ownership of more than fifty percent
     (50%) of the outstanding shares or beneficial ownership of such
     entity.

2. Source Code License.

     2.1. The Initial Developer Grant.
     The Initial Developer hereby grants You a world-wide, royalty-free,
     non-exclusive license, subject to third party intellectual property
     claims:
          (a)  under intellectual property rights (other than patent or
          trademark) Licensable by Initial Developer to use, reproduce,
          modify, display, perform, sublicense and distribute the Original
          Code (or portions thereof) with or without Modifications, and/or
          as part of a Larger Work; and

          (b) under Patents Claims infringed by the making, using or
          selling of Original Code, to make, have made, use, practice,
          sell, and offer for sale, and/or otherwise dispose of the
          Original Code (or portions thereof).

          (c) the licenses granted in this Section 2.1(a) and (b) are
          effective on the date Initial Developer first distributes
          Original Code under the terms of this License.

          (d) Notwithstanding Section 2.1(b) above, no patent license is
          granted: 1) for code that You delete from the Original Code; 2)
          separate from the Original Code;  or 3) for infringements caused
          by: i) the modification of the Original Code or ii) the
          combination of the Original Code with other software or devices.

     2.2. Contributor Grant.
     Subject to third party intellectual property claims, each Contributor
     hereby grants You a world-wide, royalty-free, non-exclusive license

          (a)  under intellectual property rights (other than patent or
          trademark) Licensable by Contributor, to use, reproduce, modify,
          display, perform, sublicense and distribute the Modifications
          created by such Contributor (or portions thereof) either on an
          unmodified basis, with other Modifications, as Covered Code
          and/or as part of a Larger Work; and

          (b) under Patent Claims infringed by the making, using, or
          selling of  Modifications made by that Contributor either alone
          and/or in combination with its Contributor Version (or portions
          of such combination), to make, use, sell, offer for sale, have
          made, and/or otherwise dispose of: 1) Modifications made by that
          Contributor (or portions thereof); and 2) the combination of
          Modifications made by that Contributor with its Contributor
          Version (or portions of such combination).

          (c) the licenses granted in Sections 2.2(a) and 2.2(b) are
          effective on the date Contributor first makes Commercial Use of
          the Covered Code.

          (d)    Notwithstanding Section 2.2(b) above, no patent license is
          granted: 1) for any code that Contributor has deleted from the
          Contributor Version; 2)  separate from the Contributor Version;
          3)  for infringements caused by: i) third party modifications of
          Contributor Version or ii)  the combination of Modifications made
          by that Contributor with other software  (except as part of the
          Contributor Version) or other devices; or 4) under Patent Claims
          infringed by Covered Code in the absence of Modifications made by
          that Contributor.

3. Distribution Obligations.

     3.1. Application of License.
     The Modifications which You create or to which You contribute are
     governed by the terms of this License, including without limitation
     Section 2.2. The Source Code version of Covered Code may be
     distributed only under the terms of this License or a future version
     of this License released under Section 6.1, and You must include a
     copy of this License with every copy of the Source Code You
     distribute. You may not offer or impose any terms on any Source Code
     version that alters or restricts the applicable version of this
     License or the recipients' rights hereunder. However, You may include
     an additional document offering the additional rights described in
     Section 3.5.

     3.2. Availability of Source Code.
     Any Modification which You create or to which You contribute must be
     made available in Source Code form under the terms of this License
     either on the same media as an Executable version or via an accepted
     Electronic Distribution Mechanism to anyone to whom you made an
     Executable version available; and if made available via Electronic
     Distribution Mechanism, must remain available for at least twelve (12)
     months after the date it initially became available, or at least six
     (6) months after a subsequent version of that particular Modification
     has been made available to such recipients. You are responsible for
     ensuring that the Source Code version remains available even if the
     Electronic Distribution Mechanism is maintained by a third party.

     3.3. Description of Modifications.
     You must cause all Covered Code to which You contribute to contain a
     file documenting the changes You made to create that Covered Code and
     the date of any change. You must include a prominent statement that
     the Modification is derived, directly or indirectly, from Original
     Code provided by the Initial Developer and including the name of the
     Initial Developer in (a) the Source Code, and (b) in any notice in an
     Executable version or related documentation in which You describe the
     origin or ownership of the Covered Code.

     3.4. Intellectual Property Matters
          (a) Third Party Claims.
          If Contributor has knowledge that a license under a third party's
          intellectual property rights is required to exercise the rights
          granted by such Contributor under Sections 2.1 or 2.2,
          Contributor must include a text file with the Source Code
          distribution titled "LEGAL" which describes the claim and the
```

----------------------------------------

TITLE: WyHash Public Domain License Declaration
DESCRIPTION: The license text for the WyHash package used in the Command Palette utility for calculating stable string hashes. This is a public domain dedication that allows unrestricted use of the software.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/NOTICE.md#2025-04-15_snippet_0

LANGUAGE: text
CODE:
```
This is free and unencumbered software released into the public domain.

Anyone is free to copy, modify, publish, use, compile, sell, or
distribute this software, either in source code form or as a compiled
binary, for any purpose, commercial or non-commercial, and by any
means.

In jurisdictions that recognize copyright laws, the author or authors
of this software dedicate any and all copyright interest in the
software to the public domain. We make this dedication for the benefit
of the public at large and to the detriment of our heirs and
successors. We intend this dedication to be an overt act of
relinquishment in perpetuity of all present and future rights to this
software under copyright law.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR
OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.

For more information, please refer to <http://unlicense.org/>
```

----------------------------------------

TITLE: PowerToys Event Documentation Table Structure
DESCRIPTION: HTML table template used for documenting PowerToys events, showing event names and their descriptions.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/DATA_AND_PRIVACY.md#2025-04-15_snippet_4

LANGUAGE: html
CODE:
```
<table style=\"width:100%\">\n  <tr>\n    <th>Event Name</th>\n    <th>Description</th>\n  </tr>\n  <tr>\n    <td>x</td>\n    <td>x</td>\n  </tr>\n  <tr>\n    <td>x</td>\n    <td>x</td>\n  </tr>\n  <tr>\n    <td>x</td>\n    <td>x</td>\n  </tr>\n</table>
```

----------------------------------------

TITLE: Defining PluginID in PowerToys Run Plugin Main Class
DESCRIPTION: Example of how to properly implement the required PluginID static property in the Main class of a PowerToys Run plugin. The ID must match the one specified in the plugin.json file.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/modules/launcher/new-plugin-checklist.md#2025-04-15_snippet_1

LANGUAGE: csharp
CODE:
```
public static string PluginID => "xxxxxxx"; // The part xxxxxxx stands for the plugin ID.
```

----------------------------------------

TITLE: PowerToys Admin Documentation Link in Markdown
DESCRIPTION: Markdown link redirecting to the official Microsoft documentation about PowerToys administrator privileges and elevation scenarios.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/run-as-admin-detection.md#2025-04-15_snippet_0

LANGUAGE: markdown
CODE:
```
[PowerToys and running as Administrator](https://aka.ms/powertoysDetectedElevatedHelp)
```

----------------------------------------

TITLE: Stopping PowerToys Telemetry Trace Capture
DESCRIPTION: Command to stop the telemetry trace capture and save results to a Trace.etl file
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/common/Telemetry/readme.md#2025-04-15_snippet_1

LANGUAGE: batch
CODE:
```
wpr.exe -Stop "Trace.etl"
```

----------------------------------------

TITLE: Implementing KeyboardManager UI Test in PowerToys
DESCRIPTION: Complete C# class example for a UI test of the KeyboardManager module in PowerToys. It demonstrates opening the editor, maximizing the window, adding a key remapping, and returning to settings.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/doc/devdocs/UITests.md#2025-04-15_snippet_2

LANGUAGE: csharp
CODE:
```
using Microsoft.PowerToys.UITest;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace UITests_KeyboardManager
{
    [TestClass]
    public class RunKeyboardManagerUITests : UITestBase
    {
        [TestMethod]
        public void OpenKeyboardManagerEditor()
        {
            // Open KeyboardManagerEditor
            this.Session.Find<Button>(By.Name("Remap a key")).Click();
            this.Session.Attach("Remap keys");

            // Maximize window
            var window = Session.Find<Window>(By.Name("Remap keys")).Maximize();

            // Add Key Remapping
            this.Session.Find<Button>(By.Name("Add key remapping")).Click();
            window.Close();

            // Back to Settings
            this.Session.Attach(PowerToysModule.PowerToysSettings);
        }
    }
}
```

----------------------------------------

TITLE: Windows Shell Enums and Interfaces
DESCRIPTION: Core Windows shell enums and COM interfaces used for implementing preview handlers and shell integration. Includes property store flags, shell context flags, display name formats, attribute flags and preview handler interfaces.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/peek/Peek.Common/NativeMethods.txt#2025-04-15_snippet_0

LANGUAGE: C++
CODE:
```
GETPROPERTYSTOREFLAGS
_SHCONTF
SIGDN
SHGDNF
SIATTRIBFLAGS
IInitializeWithFile
IInitializeWithItem
IInitializeWithStream
IPreviewHandler
IPreviewHandlerVisuals
```

----------------------------------------

TITLE: JavaScript Alert Script
DESCRIPTION: A basic JavaScript alert that displays 'hello' in a browser popup window.
SOURCE: https://github.com/microsoft/PowerToys/blob/main/src/modules/previewpane/UnitTests-MarkdownPreviewHandler/HelperFiles/MarkdownWithExternalImage.txt#2025-04-15_snippet_0

LANGUAGE: javascript
CODE:
```
alert("hello")
```