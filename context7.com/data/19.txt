TITLE: Implementing a Dynamic Proxy Using Reflection in Java
DESCRIPTION: This code snippet demonstrates how to implement a dynamic proxy in Java using the InvocationHandler interface and reflection to invoke methods on the target object.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_9

LANGUAGE: Java
CODE:
```
public class DebugInvocationHandler implements InvocationHandler {
    /**
     * 代理类中的真实对象
     */
    private final Object target;

    public DebugInvocationHandler(Object target) {
        this.target = target;
    }

    public Object invoke(Object proxy, Method method, Object[] args) throws InvocationTargetException, IllegalAccessException {
        System.out.println("before method " + method.getName());
        Object result = method.invoke(target, args);
        System.out.println("after method " + method.getName());
        return result;
    }
}
```

----------------------------------------

TITLE: Implementing HashMap put Method - Java
DESCRIPTION: Method to insert key-value pairs into HashMap. Handles null checks, hash calculations, and collision resolution through either linked lists or red-black trees. Includes resizing logic when threshold is exceeded.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
public V put(K key, V value) {
    return putVal(hash(key), key, value, false, true);
}

final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) {
    Node<K,V>[] tab; Node<K,V> p; int n, i;
    if ((tab = table) == null || (n = tab.length) == 0)
        n = (tab = resize()).length;
    if ((p = tab[i = (n - 1) & hash]) == null)
        tab[i] = newNode(hash, key, value, null);
    else {
        Node<K,V> e; K k;
        if (p.hash == hash &&
            ((k = p.key) == key || (key != null && key.equals(k))))
                e = p;
        else if (p instanceof TreeNode)
            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);
        else {
            for (int binCount = 0; ; ++binCount) {
                if ((e = p.next) == null) {
                    p.next = newNode(hash, key, value, null);
                    if (binCount >= TREEIFY_THRESHOLD - 1)
                        treeifyBin(tab, hash);
                    break;
                }
                if (e.hash == hash &&
                    ((k = e.key) == key || (key != null && key.equals(k))))
                    break;
                p = e;
            }
        }
        if (e != null) {
            V oldValue = e.value;
            if (!onlyIfAbsent || oldValue == null)
                e.value = value;
            afterNodeAccess(e);
            return oldValue;
        }
    }
    ++modCount;
    if (++size > threshold)
        resize();
    afterNodeInsertion(evict);
    return null;
}
```

----------------------------------------

TITLE: Monitoring Thread Pool Status in Java
DESCRIPTION: This code snippet demonstrates how to create a method that periodically prints the status of a thread pool, including pool size, active threads, completed tasks, and queue size.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-best-practices.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
/**
 * 打印线程池的状态
 *
 * @param threadPool 线程池对象
 */
public static void printThreadPoolStatus(ThreadPoolExecutor threadPool) {
    ScheduledExecutorService scheduledExecutorService = new ScheduledThreadPoolExecutor(1, createThreadFactory("print-images/thread-pool-status", false));
    scheduledExecutorService.scheduleAtFixedRate(() -> {
        log.info("=========================");
        log.info("ThreadPool Size: [{}]", threadPool.getPoolSize());
        log.info("Active Threads: {}", threadPool.getActiveCount());
        log.info("Number of Tasks : {}", threadPool.getCompletedTaskCount());
        log.info("Number of Tasks in Queue: {}", threadPool.getQueue().size());
        log.info("=========================");
    }, 0, 1, TimeUnit.SECONDS);
}
```

----------------------------------------

TITLE: Task Composition with CompletableFuture
DESCRIPTION: Demonstrates how to compose multiple CompletableFuture tasks using thenCompose() and thenCombine() methods.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/completablefuture-intro.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
CompletableFuture<String> future
        = CompletableFuture.supplyAsync(() -> "hello!")
        .thenCompose(s -> CompletableFuture.supplyAsync(() -> s + "world!"));
assertEquals("hello!world!", future.get());
```

----------------------------------------

TITLE: Implementing Structured Concurrency in Java
DESCRIPTION: This code snippet demonstrates the basic usage of StructuredTaskScope, which is the fundamental API for structured concurrency in Java. It shows how to fork tasks, join them, and process results or exceptions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java20.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
try (var scope = new StructuredTaskScope<Object>()) {
    // Fork threads to execute subtasks
    Future<Integer> future1 = scope.fork(task1);
    Future<String> future2 = scope.fork(task2);
    // Wait for threads to complete
    scope.join();
    // Process results/exceptions
    ... process results/exceptions ...
} // close
```

----------------------------------------

TITLE: Adding Two Numbers as Linked Lists in Java
DESCRIPTION: Implementation to add two numbers represented as linked lists in reverse order. Creates a dummy head node to handle edge cases and uses a carry variable to manage additions. Returns the sum as a new linked list.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/linkedlist-algorithm-problems.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
class Solution {
public ListNode addTwoNumbers(ListNode l1, ListNode l2) {
    ListNode dummyHead = new ListNode(0);
    ListNode p = l1, q = l2, curr = dummyHead;
    //carry 表示进位数
    int carry = 0;
    while (p != null || q != null) {
        int x = (p != null) ? p.val : 0;
        int y = (q != null) ? q.val : 0;
        int sum = carry + x + y;
        //进位数
        carry = sum / 10;
        //新节点的数值为sum % 10
        curr.next = new ListNode(sum % 10);
        curr = curr.next;
        if (p != null) p = p.next;
        if (q != null) q = q.next;
    }
    if (carry > 0) {
        curr.next = new ListNode(carry);
    }
    return dummyHead.next;
}
}
```

----------------------------------------

TITLE: Initializing ArrayList with Different Constructors in Java
DESCRIPTION: This snippet shows three constructors for ArrayList: default (no arguments), with initial capacity, and from an existing collection. It demonstrates how ArrayList initializes its internal array based on different inputs.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
/**
 * 默认初始容量大小
 */
private static final int DEFAULT_CAPACITY = 10;

private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};

/**
 * 默认构造函数，使用初始容量10构造一个空列表(无参数构造)
 */
public ArrayList() {
    this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
}

/**
 * 带初始容量参数的构造函数。（用户自己指定容量）
 */
public ArrayList(int initialCapacity) {
    if (initialCapacity > 0) {//初始容量大于0
        //创建initialCapacity大小的数组
        this.elementData = new Object[initialCapacity];
    } else if (initialCapacity == 0) {//初始容量等于0
        //创建空数组
        this.elementData = EMPTY_ELEMENTDATA;
    } else {//初始容量小于0，抛出异常
        throw new IllegalArgumentException("Illegal Capacity: " + initialCapacity);
    }
}


/**
 *构造包含指定collection元素的列表，这些元素利用该集合的迭代器按顺序返回
 *如果指定的集合为null，throws NullPointerException。
 */
public ArrayList(Collection<? extends E> c) {
    elementData = c.toArray();
    if ((size = elementData.length) != 0) {
        // c.toArray might (incorrectly) not return Object[] (see 6260652)
        if (elementData.getClass() != Object[].class)
            elementData = Arrays.copyOf(elementData, size, Object[].class);
    } else {
        // replace with empty array.
        this.elementData = EMPTY_ELEMENTDATA;
    }
}
```

----------------------------------------

TITLE: Manual Bloom Filter Implementation in Java
DESCRIPTION: A custom implementation of a Bloom Filter in Java using BitSet and multiple hash functions. Includes methods for adding elements and checking existence.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/bloom-filter.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
import java.util.BitSet;

public class MyBloomFilter {
    private static final int DEFAULT_SIZE = 2 << 24;
    private static final int[] SEEDS = new int[]{3, 13, 46, 71, 91, 134};
    private BitSet bits = new BitSet(DEFAULT_SIZE);
    private SimpleHash[] func = new SimpleHash[SEEDS.length];

    public MyBloomFilter() {
        for (int i = 0; i < SEEDS.length; i++) {
            func[i] = new SimpleHash(DEFAULT_SIZE, SEEDS[i]);
        }
    }

    public void add(Object value) {
        for (SimpleHash f : func) {
            bits.set(f.hash(value), true);
        }
    }

    public boolean contains(Object value) {
        boolean ret = true;
        for (SimpleHash f : func) {
            ret = ret && bits.get(f.hash(value));
        }
        return ret;
    }

    public static class SimpleHash {
        private int cap;
        private int seed;

        public SimpleHash(int cap, int seed) {
            this.cap = cap;
            this.seed = seed;
        }

        public int hash(Object value) {
            int h;
            return (value == null) ? 0 : Math.abs((cap - 1) & seed * ((h = value.hashCode()) ^ (h >>> 16)));
        }
    }
}
```

----------------------------------------

TITLE: Exception Handling Example with CompletableFuture
DESCRIPTION: Shows practical example of handling exceptions using handle() method in CompletableFuture with error fallback.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/completablefuture-intro.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
CompletableFuture<String> future
        = CompletableFuture.supplyAsync(() -> {
    if (true) {
        throw new RuntimeException("Computation error!");
    }
    return "hello!";
}).handle((res, ex) -> {
    // res 代表返回的结果
    // ex 的类型为 Throwable ，代表抛出的异常
    return res != null ? res : "world!";
});
assertEquals("world!", future.get());
```

----------------------------------------

TITLE: Iterating and Modifying Collections in Java
DESCRIPTION: Explains why removing or adding elements during a foreach loop can cause ConcurrentModificationException. Suggests using Iterator for removal operations and demonstrates the use of removeIf() method introduced in Java 8.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
List<Integer> list = new ArrayList<>();
for (int i = 1; i <= 10; ++i) {
    list.add(i);
}
list.removeIf(filter -> filter % 2 == 0); /* 删除list中的所有偶数 */
System.out.println(list); /* [1, 3, 5, 7, 9] */
```

----------------------------------------

TITLE: Managing Dependencies with dependencyManagement in Parent POM
DESCRIPTION: Shows how to use the dependencyManagement section in a parent POM file to centrally define dependency versions. This ensures consistent dependency versions across all child modules.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_2

LANGUAGE: xml
CODE:
```
<dependencyManagement>
  <dependencies>
    <dependency>
      <groupId>org.junit.jupiter</groupId>
      <artifactId>junit-jupiter</artifactId>
      <version>5.7.2</version>
      <scope>test</scope>
    </dependency>
  </dependencies>
</dependencyManagement>
```

----------------------------------------

TITLE: Custom Thread Pool Executor for MDC Context Propagation
DESCRIPTION: Custom implementation of ThreadPoolTaskExecutor that preserves MDC context values when tasks are executed asynchronously, ensuring requestId propagation across thread boundaries in asynchronous operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_16

LANGUAGE: java
CODE:
```
public class MyThreadPoolTaskExecutor extends ThreadPoolTaskExecutor {

    @Override
    public void execute(Runnable runnable) {
        Map<String, String> context = MDC.getCopyOfContextMap();
        super.execute(() -> run(runnable, context));
    }

    @Override
    private void run(Runnable runnable, Map<String, String> context) {
        if (context != null) {
            MDC.setContextMap(context);
        }
        try {
            runnable.run();
        } finally {
            MDC.remove();
        }
    }
}
```

----------------------------------------

TITLE: Creating CompletableFuture Objects
DESCRIPTION: Example showing how to create CompletableFuture objects and handle RPC responses asynchronously.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/completablefuture-intro.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
CompletableFuture<RpcResponse<Object>> resultFuture = new CompletableFuture<>();
resultFuture.complete(rpcResponse);
rpcResponse = completableFuture.get();

CompletableFuture<String> future = CompletableFuture.completedFuture("hello!");
assertEquals("hello!", future.get());
```

----------------------------------------

TITLE: Processing Selected Keys with Java NIO Selector
DESCRIPTION: Demonstrates how to iterate through selected keys in a Selector and handle different types of events like accept, connect, read and write operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/nio-basis.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
Set<SelectionKey> selectedKeys = selector.selectedKeys();
Iterator<SelectionKey> keyIterator = selectedKeys.iterator();
while (keyIterator.hasNext()) {
    SelectionKey key = keyIterator.next();
    if (key != null) {
        if (key.isAcceptable()) {
            // ServerSocketChannel 接收了一个新连接
        } else if (key.isConnectable()) {
            // 表示一个新连接建立
        } else if (key.isReadable()) {
            // Channel 有准备好的数据，可以读取
        } else if (key.isWritable()) {
            // Channel 有空闲的 Buffer，可以写入数据
        }
    }
    keyIterator.remove();
}
```

----------------------------------------

TITLE: Demonstrating HashMap Operations in Java
DESCRIPTION: A complete Java class that demonstrates common HashMap operations including initialization, adding elements, iterating through keys and values, handling Entry sets, and using utility methods like size, isEmpty, remove, get, containsKey, containsValue, and replace.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
package map;

import java.util.Collection;
import java.util.HashMap;
import java.util.Set;

public class HashMapDemo {

    public static void main(String[] args) {
        HashMap<String, String> map = new HashMap<String, String>();
        // 键不能重复，值可以重复
        map.put("san", "张三");
        map.put("si", "李四");
        map.put("wu", "王五");
        map.put("wang", "老王");
        map.put("wang", "老王2");// 老王被覆盖
        map.put("lao", "老王");
        System.out.println("-------直接输出hashmap:-------");
        System.out.println(map);
        /**
         * 遍历HashMap
         */
        // 1.获取Map中的所有键
        System.out.println("-------foreach获取Map中所有的键:------");
        Set<String> keys = map.keySet();
        for (String key : keys) {
            System.out.print(key+"  ");
        }
        System.out.println();//换行
        // 2.获取Map中所有值
        System.out.println("-------foreach获取Map中所有的值:------");
        Collection<String> values = map.values();
        for (String value : values) {
            System.out.print(value+"  ");
        }
        System.out.println();//换行
        // 3.得到key的值的同时得到key所对应的值
        System.out.println("-------得到key的值的同时得到key所对应的值:-------");
        Set<String> keys2 = map.keySet();
        for (String key : keys2) {
            System.out.print(key + "：" + map.get(key)+"   ");

        }
        /**
         * 如果既要遍历key又要value，那么建议这种方式，因为如果先获取keySet然后再执行map.get(key)，map内部会执行两次遍历。
         * 一次是在获取keySet的时候，一次是在遍历所有key的时候。
         */
        // 当我调用put(key,value)方法的时候，首先会把key和value封装到
        // Entry这个静态内部类对象中，把Entry对象再添加到数组中，所以我们想获取
        // map中的所有键值对，我们只要获取数组中的所有Entry对象，接下来
        // 调用Entry对象中的getKey()和getValue()方法就能获取键值对了
        Set<java.util.Map.Entry<String, String>> entrys = map.entrySet();
        for (java.util.Map.Entry<String, String> entry : entrys) {
            System.out.println(entry.getKey() + "--" + entry.getValue());
        }

        /**
         * HashMap其他常用方法
         */
        System.out.println("after map.size()："+map.size());
        System.out.println("after map.isEmpty()："+map.isEmpty());
        System.out.println(map.remove("san"));
        System.out.println("after map.remove()："+map);
        System.out.println("after map.get(si)："+map.get("si"));
        System.out.println("after map.containsKey(si)："+map.containsKey("si"));
        System.out.println("after containsValue(李四)："+map.containsValue("李四"));
        System.out.println(map.replace("si", "李四2"));
        System.out.println("after map.replace(si, 李四2):"+map);
    }

}
```

----------------------------------------

TITLE: Finding the Kth Node from End of a Linked List in Java
DESCRIPTION: This algorithm finds the kth node from the end of a linked list using two pointers. The first pointer advances k nodes, then both pointers move until the first reaches the end. The second pointer will then point to the kth node from the end. Time complexity is O(n) with a single pass through the list.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
/*
//链表类
public class ListNode {
    int val;
    ListNode next = null;

    ListNode(int val) {
        this.val = val;
    }
}*/

//时间复杂度O(n),一次遍历即可
public class Solution {
    public ListNode FindKthToTail(ListNode head,int k) {
        ListNode pre=null,p=null;
        //两个指针都指向头结点
        p=head;
        pre=head;
        //记录k值
        int a=k;
        //记录节点的个数
        int count=0;
        //p指针先跑，并且记录节点数，当p指针跑了k-1个节点后，pre指针开始跑，
        //当p指针跑到最后时，pre所指指针就是倒数第k个节点
        while(p!=null){
            p=p.next;
            count++;
            if(k<1){
                pre=pre.next;
            }
            k--;
        }
        //如果节点个数小于所求的倒数第k个节点，则返回空
        if(count<a) return null;
        return pre;

    }
}
```

----------------------------------------

TITLE: Creating Virtual Thread Using Thread.ofVirtual()
DESCRIPTION: Shows two ways to create virtual threads using Thread.ofVirtual(): creating an unstarted thread and creating/starting a thread immediately.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/virtual-thread.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class VirtualThreadTest {
  public static void main(String[] args) {
    CustomThread customThread = new CustomThread();
    // 创建不启动
    Thread unStarted = Thread.ofVirtual().unstarted(customThread);
    unStarted.start();
    // 创建直接启动
    Thread.ofVirtual().start(customThread);
  }
}
static class CustomThread implements Runnable {
  @Override
  public void run() {
    System.out.println("CustomThread run");
  }
}
```

----------------------------------------

TITLE: Implementing Dynamic Proxy with Java Reflection
DESCRIPTION: Example implementation of a debug invocation handler using Java's reflection API. The handler intercepts method calls and adds logging before and after method execution.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/reflection.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class DebugInvocationHandler implements InvocationHandler {
    /**
     * 代理类中的真实对象
     */
    private final Object target;

    public DebugInvocationHandler(Object target) {
        this.target = target;
    }


    public Object invoke(Object proxy, Method method, Object[] args) throws InvocationTargetException, IllegalAccessException {
        System.out.println("before method " + method.getName());
        Object result = method.invoke(target, args);
        System.out.println("after method " + method.getName());
        return result;
    }
}
```

----------------------------------------

TITLE: Configuring Custom Spring ThreadPoolExecutor
DESCRIPTION: Configuration class that creates a custom thread pool executor for Spring async operations. It calculates optimal thread pool parameters based on available processors and sets various configurations like core pool size, max pool size, queue capacity, and thread naming.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-best-practices.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
@Configuration
@EnableAsync
public class ThreadPoolExecutorConfig {

    @Bean(name="threadPoolExecutor")
    public Executor threadPoolExecutor(){
        ThreadPoolTaskExecutor threadPoolExecutor = new ThreadPoolTaskExecutor();
        int processNum = Runtime.getRuntime().availableProcessors(); // 返回可用处理器的Java虚拟机的数量
        int corePoolSize = (int) (processNum / (1 - 0.2));
        int maxPoolSize = (int) (processNum / (1 - 0.5));
        threadPoolExecutor.setCorePoolSize(corePoolSize); // 核心池大小
        threadPoolExecutor.setMaxPoolSize(maxPoolSize); // 最大线程数
        threadPoolExecutor.setQueueCapacity(maxPoolSize * 1000); // 队列程度
        threadPoolExecutor.setThreadPriority(Thread.MAX_PRIORITY);
        threadPoolExecutor.setDaemon(false);
        threadPoolExecutor.setKeepAliveSeconds(300);// 线程空闲时间
        threadPoolExecutor.setThreadNamePrefix("test-Executor-"); // 线程名字前缀
        return threadPoolExecutor;
    }
}
```

----------------------------------------

TITLE: Implementing Exception Handling Methods in CompletableFuture
DESCRIPTION: Demonstrates different methods for handling exceptions in CompletableFuture including handle(), handleAsync(), and exceptionally().
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/completablefuture-intro.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
public <U> CompletableFuture<U> handle(
    BiFunction<? super T, Throwable, ? extends U> fn) {
    return uniHandleStage(null, fn);
}

public <U> CompletableFuture<U> handleAsync(
    BiFunction<? super T, Throwable, ? extends U> fn) {
    return uniHandleStage(defaultExecutor(), fn);
}

public <U> CompletableFuture<U> handleAsync(
    BiFunction<? super T, Throwable, ? extends U> fn, Executor executor) {
    return uniHandleStage(screenExecutor(executor), fn);
}
```

----------------------------------------

TITLE: Creating Virtual Threads in Java
DESCRIPTION: This code demonstrates four different methods to create virtual threads in Java, showcasing the flexibility and ease of use of this new feature.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java20.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
// 1. Using Thread.ofVirtual()
Thread thread = Thread.ofVirtual(() -> {
  // your code here
}).start();

// 2. Using Thread.startVirtualThread()
Thread thread = Thread.startVirtualThread(() -> {
  // your code here
});

// 3. Using Executors.newVirtualThreadPerTaskExecutor()
var executorService = Executors.newVirtualThreadPerTaskExecutor();
executorService.submit(() -> {
  // your code here
});

// 4. Using ThreadFactory
CustomThread customThread = new CustomThread();
ThreadFactory factory = Thread.ofVirtual().factory();
Thread thread = factory.newThread(customThread);
thread.start();
```

----------------------------------------

TITLE: Merging Two Sorted Linked Lists - Iterative Solution
DESCRIPTION: Java implementation for merging two sorted linked lists into a single sorted list using iterative approach. Handles edge cases like empty lists and maintains sorted order in the merged result.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_12

LANGUAGE: java
CODE:
```
public class Solution {
    public ListNode Merge(ListNode list1,ListNode list2) {
       if(list1 == null){
            return list2;
        }
        if(list2 == null){
            return list1;
        }
        ListNode mergeHead = null;
        ListNode current = null;
        while(list1!=null && list2!=null){
            if(list1.val <= list2.val){
                if(mergeHead == null){
                   mergeHead = current = list1;
                }else{
                   current.next = list1;
                   current = list1;
                }
                list1 = list1.next;
            }else{
                if(mergeHead == null){
                   mergeHead = current = list2;
                }else{
                   current.next = list2;
                   current = list2;
                }
                list2 = list2.next;
            }
        }
        if(list1 == null){
            current.next = list2;
        }else{
            current.next = list1;
        }
        return mergeHead;
    }
}
```

----------------------------------------

TITLE: 使用Curator实现ZooKeeper分布式锁
DESCRIPTION: 展示了如何使用Curator框架实现ZooKeeper分布式锁，包括可重入锁、不可重入锁和多重锁的创建、获取与释放过程。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
CuratorFramework client = ZKUtils.getClient();
client.start();
// 分布式可重入排它锁
InterProcessLock lock1 = new InterProcessMutex(client, lockPath1);
// 分布式不可重入排它锁
InterProcessLock lock2 = new InterProcessSemaphoreMutex(client, lockPath2);
// 将多个锁作为一个整体
InterProcessMultiLock lock = new InterProcessMultiLock(Arrays.asList(lock1, lock2));

if (!lock.acquire(10, TimeUnit.SECONDS)) {
   throw new IllegalStateException("不能获取多锁");
}
System.out.println("已获取多锁");
System.out.println("是否有第一个锁: " + lock1.isAcquiredInThisProcess());
System.out.println("是否有第二个锁: " + lock2.isAcquiredInThisProcess());
try {
    // 资源操作
    resource.use();
} finally {
    System.out.println("释放多个锁");
    lock.release();
}
System.out.println("是否有第一个锁: " + lock1.isAcquiredInThisProcess());
System.out.println("是否有第二个锁: " + lock2.isAcquiredInThisProcess());
client.close();
```

----------------------------------------

TITLE: Processing Async Results with CompletableFuture
DESCRIPTION: Examples of processing async computation results using thenApply(), thenAccept(), and related methods.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/completablefuture-intro.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
CompletableFuture<String> future = CompletableFuture.completedFuture("hello!")
        .thenApply(s -> s + "world!");
assertEquals("hello!world!", future.get());

CompletableFuture<String> future = CompletableFuture.supplyAsync(() -> "hello!")
        .whenComplete((res, ex) -> {
            System.out.println(res);
            assertNull(ex);
        });
assertEquals("hello!", future.get());
```

----------------------------------------

TITLE: BigDecimal Utility Class Implementation
DESCRIPTION: A comprehensive utility class providing simplified methods for BigDecimal operations including arithmetic, conversion, and comparison.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/bigdecimal.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
import java.math.BigDecimal;
import java.math.RoundingMode;

public class BigDecimalUtil {
    private static final int DEF_DIV_SCALE = 10;
    private BigDecimalUtil() {}

    public static double add(double v1, double v2) {
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.add(b2).doubleValue();
    }

    public static double subtract(double v1, double v2) {
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.subtract(b2).doubleValue();
    }

    public static double multiply(double v1, double v2) {
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.multiply(b2).doubleValue();
    }

    public static double divide(double v1, double v2) {
        return divide(v1, v2, DEF_DIV_SCALE);
    }

    public static double divide(double v1, double v2, int scale) {
        if (scale < 0) {
            throw new IllegalArgumentException(
                    "The scale must be a positive integer or zero");
        }
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.divide(b2, scale, RoundingMode.HALF_EVEN).doubleValue();
    }

    public static double round(double v, int scale) {
        if (scale < 0) {
            throw new IllegalArgumentException(
                    "The scale must be a positive integer or zero");
        }
        BigDecimal b = BigDecimal.valueOf(v);
        BigDecimal one = new BigDecimal("1");
        return b.divide(one, scale, RoundingMode.HALF_UP).doubleValue();
    }

    public static float convertToFloat(double v) {
        BigDecimal b = new BigDecimal(v);
        return b.floatValue();
    }

    public static int convertsToInt(double v) {
        BigDecimal b = new BigDecimal(v);
        return b.intValue();
    }

    public static long convertsToLong(double v) {
        BigDecimal b = new BigDecimal(v);
        return b.longValue();
    }

    public static double returnMax(double v1, double v2) {
        BigDecimal b1 = new BigDecimal(v1);
        BigDecimal b2 = new BigDecimal(v2);
        return b1.max(b2).doubleValue();
    }

    public static double returnMin(double v1, double v2) {
        BigDecimal b1 = new BigDecimal(v1);
        BigDecimal b2 = new BigDecimal(v2);
        return b1.min(b2).doubleValue();
    }

    public static int compareTo(double v1, double v2) {
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.compareTo(b2);
    }
}
```

----------------------------------------

TITLE: String Concatenation with '+' Operator in Java
DESCRIPTION: This code demonstrates how Java concatenates strings using the '+' operator. Under the hood, the compiler uses StringBuilder to perform the concatenation, as shown in the bytecode analysis.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_12

LANGUAGE: java
CODE:
```
String str1 = "he";
String str2 = "llo";
String str3 = "world";
String str4 = str1 + str2 + str3;
```

----------------------------------------

TITLE: Growing ArrayList Capacity in Java
DESCRIPTION: This method is the core of ArrayList's expansion mechanism. It calculates the new capacity (typically 1.5 times the old capacity) and handles cases where the new capacity exceeds the maximum array size.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_7

LANGUAGE: Java
CODE:
```
/**
 * 要分配的最大数组大小
 */
private static final int MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;

/**
 * ArrayList扩容的核心方法。
 */
private void grow(int minCapacity) {
    // oldCapacity为旧容量，newCapacity为新容量
    int oldCapacity = elementData.length;
    // 将oldCapacity 右移一位，其效果相当于oldCapacity /2，
    // 我们知道位运算的速度远远快于整除运算，整句运算式的结果就是将新容量更新为旧容量的1.5倍，
    int newCapacity = oldCapacity + (oldCapacity >> 1);

    // 然后检查新容量是否大于最小需要容量，若还是小于最小需要容量，那么就把最小需要容量当作数组的新容量，
    if (newCapacity - minCapacity < 0)
        newCapacity = minCapacity;

    // 如果新容量大于 MAX_ARRAY_SIZE,进入(执行) `hugeCapacity()` 方法来比较 minCapacity 和 MAX_ARRAY_SIZE，
    // 如果minCapacity大于最大容量，则新容量则为`Integer.MAX_VALUE`，否则，新容量大小则为 MAX_ARRAY_SIZE 即为 `Integer.MAX_VALUE - 8`。
    if (newCapacity - MAX_ARRAY_SIZE > 0)
        newCapacity = hugeCapacity(minCapacity);

    // minCapacity is usually close to size, so this is a win:
    elementData = Arrays.copyOf(elementData, newCapacity);
}
```

----------------------------------------

TITLE: Reading File Content Using Scanner with Try-with-Resources in Java
DESCRIPTION: This code snippet shows how to use the try-with-resources statement in Java 7+ to automatically close resources like Scanner when reading a file.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
try (Scanner scanner = new Scanner(new File("test.txt"))) {
    while (scanner.hasNext()) {
        System.out.println(scanner.nextLine());
    }
} catch (FileNotFoundException fnfe) {
    fnfe.printStackTrace();
}
```

----------------------------------------

TITLE: Non-blocking Offer Operation in ArrayBlockingQueue
DESCRIPTION: Implementation of non-blocking offer operation that immediately returns false if the queue is full instead of waiting.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_13

LANGUAGE: java
CODE:
```
public boolean offer(E e) {
        checkNotNull(e);
        final ReentrantLock lock = this.lock;
        lock.lock();
        try {
             if (count == items.length)
                return false;
            else {
                enqueue(e);
                return true;
            }
        } finally {
            lock.unlock();
        }
    }
```

----------------------------------------

TITLE: Implementing Zero-Copy File Transfer in Java
DESCRIPTION: Example showing how to use Java's FileChannel.transferTo() method to implement zero-copy file transfer functionality. This approach improves performance by reducing CPU copies and context switches.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/rocketmq-questions.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
FileChannel channel = FileChannel.open(Paths.get("./test.txt"), StandardOpenOption.WRITE, StandardOpenOption.CREATE);
//调用transferTo方法向目标数据传输
channel.transferTo(position, len, target);
```

----------------------------------------

TITLE: Implementing HashMap get Method - Java
DESCRIPTION: Method to retrieve values from HashMap using key. Handles both direct array access and traversal of collision chains (linked list or tree).
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
public V get(Object key) {
    Node<K,V> e;
    return (e = getNode(hash(key), key)) == null ? null : e.value;
}

final Node<K,V> getNode(int hash, Object key) {
    Node<K,V>[] tab; Node<K,V> first, e; int n; K k;
    if ((tab = table) != null && (n = tab.length) > 0 &&
        (first = tab[(n - 1) & hash]) != null) {
        if (first.hash == hash && 
            ((k = first.key) == key || (key != null && key.equals(k))))
            return first;
        if ((e = first.next) != null) {
            if (first instanceof TreeNode)
                return ((TreeNode<K,V>)first).getTreeNode(hash, key);
            do {
                if (e.hash == hash &&
                    ((k = e.key) == key || (key != null && key.equals(k))))
                    return e;
            } while ((e = e.next) != null);
        }
    }
    return null;
}
```

----------------------------------------

TITLE: Thread-safe Singleton Implementation using Double-Checked Locking
DESCRIPTION: Implementation of singleton pattern using volatile and synchronized keywords to ensure thread safety
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class Singleton {

    private volatile static Singleton uniqueInstance;

    private Singleton() {
    }

    public  static Singleton getUniqueInstance() {
       //先判断对象是否已经实例过，没有实例化过才进入加锁代码
        if (uniqueInstance == null) {
            //类对象加锁
            synchronized (Singleton.class) {
                if (uniqueInstance == null) {
                    uniqueInstance = new Singleton();
                }
            }
        }
        return uniqueInstance;
    }
}
```

----------------------------------------

TITLE: AtomicInteger Implementation
DESCRIPTION: Core implementation of AtomicInteger class showing how it uses Unsafe class for atomic operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
private static final Unsafe unsafe = Unsafe.getUnsafe();
private static final long valueOffset;

static {
    try {
        valueOffset = unsafe.objectFieldOffset
            (AtomicInteger.class.getDeclaredField("value"));
    } catch (Exception ex) { throw new Error(ex); }
}
private volatile int value;

public final boolean compareAndSet(int expect, int update) {
    return unsafe.compareAndSwapInt(this, valueOffset, expect, update);
}

public final int getAndAdd(int delta) {
    return unsafe.getAndAddInt(this, valueOffset, delta);
}

public final int getAndIncrement() {
    return unsafe.getAndAddInt(this, valueOffset, 1);
}

public final int getAndDecrement() {
    return unsafe.getAndAddInt(this, valueOffset, -1);
}
```

----------------------------------------

TITLE: Demonstrating Try-Catch-Finally Exception Handling in Java
DESCRIPTION: This code snippet shows how to use try-catch-finally blocks in Java for exception handling. It throws a RuntimeException in the try block, catches it in the catch block, and executes the finally block regardless of the exception.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
try {
    System.out.println("Try to do something");
    throw new RuntimeException("RuntimeException");
} catch (Exception e) {
    System.out.println("Catch Exception -> " + e.getMessage());
} finally {
    System.out.println("Finally");
}
```

----------------------------------------

TITLE: WebSocket Client Implementation in JavaScript
DESCRIPTION: Frontend JavaScript code to establish WebSocket connection, handle events and send/receive messages.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/web-real-time-message-push.md#2025-04-20_snippet_3

LANGUAGE: javascript
CODE:
```
<script>
    var ws = new WebSocket('ws://localhost:7777/webSocket/10086');
    console.log('ws连接状态：' + ws.readyState);
    ws.onopen = function () {
        console.log('ws连接状态：' + ws.readyState);
        ws.send('test1');
    }
    ws.onmessage = function (data) {
        console.log('接收到来自服务器的消息：');
        console.log(data);
        ws.close();
    }
    ws.onclose = function () {
        console.log('ws连接状态：' + ws.readyState);
    }
    ws.onerror = function (error) {
        console.log(error);
    }
    function sendMessage() {
        var content = $("#message").val();
        $.ajax({
            url: '/socket/publish?userId=10086&message=' + content,
            type: 'GET',
            data: { "id": "7777", "content": content },
            success: function (data) {
                console.log(data)
            }
        })
    }
</script>
```

----------------------------------------

TITLE: Using System.arraycopy() in ArrayList add() Method
DESCRIPTION: This snippet shows how ArrayList's add(int index, E element) method uses System.arraycopy() to shift elements and make room for a new element at a specific index position.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
    /**
     * 在此列表中的指定位置插入指定的元素。
     *先调用 rangeCheckForAdd 对index进行界限检查；然后调用 ensureCapacityInternal 方法保证capacity足够大；
     *再将从index开始之后的所有成员后移一个位置；将element插入index位置；最后size加1。
     */
    public void add(int index, E element) {
        rangeCheckForAdd(index);

        ensureCapacityInternal(size + 1);  // Increments modCount!!
        //arraycopy()方法实现数组自己复制自己
        //elementData:源数组;index:源数组中的起始位置;elementData：目标数组；index + 1：目标数组中的起始位置； size - index：要复制的数组元素的数量；
        System.arraycopy(elementData, index, elementData, index + 1, size - index);
        elementData[index] = element;
        size++;
    }
```

----------------------------------------

TITLE: Implementing Queue using Two Stacks
DESCRIPTION: Implementation of a queue data structure using two stacks. Uses stack1 for push operations and stack2 for pop operations to maintain FIFO order.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_14

LANGUAGE: java
CODE:
```
import java.util.Stack;

public class Solution {
    Stack<Integer> stack1 = new Stack<Integer>();
    Stack<Integer> stack2 = new Stack<Integer>();

    public void push(int node) {
        stack1.push(node);
    }

    public int pop() {
        if(stack1.empty()&&stack2.empty()){
            throw new RuntimeException("Queue is empty!");
        }
        if(stack2.empty()){
            while(!stack1.empty()){
                stack2.push(stack1.pop());
            }
        }
          return stack2.pop();
    }
}
```

----------------------------------------

TITLE: ArrayList Capacity Management in Java
DESCRIPTION: Implementation of ArrayList's capacity management including growth mechanisms, size calculations, and array resizing logic. Shows how ArrayList handles dynamic resizing operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
private void grow(int minCapacity) {
    int oldCapacity = elementData.length;
    int newCapacity = oldCapacity + (oldCapacity >> 1);
    if (newCapacity - minCapacity < 0)
        newCapacity = minCapacity;
    if (newCapacity - MAX_ARRAY_SIZE > 0)
        newCapacity = hugeCapacity(minCapacity);
    elementData = Arrays.copyOf(elementData, newCapacity);
}

private static int hugeCapacity(int minCapacity) {
    if (minCapacity < 0)
        throw new OutOfMemoryError();
    return (minCapacity > MAX_ARRAY_SIZE) ?
            Integer.MAX_VALUE :
            MAX_ARRAY_SIZE;
}
```

----------------------------------------

TITLE: HashMap Put Operation (Java)
DESCRIPTION: This snippet shows part of the put operation in HashMap, demonstrating the logic for handling hash collisions and potential resizing.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_7

LANGUAGE: Java
CODE:
```
public V put(K key, V value) {
    return putVal(hash(key), key, value, false, true);
}

final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) {
    // ...
    if ((p = tab[i = (n - 1) & hash]) == null)
        tab[i] = newNode(hash, key, value, null);
    else {
    // ...
}

    // ...
    if (++size > threshold)
        resize();
    afterNodeInsertion(evict);
    return null;
}
```

----------------------------------------

TITLE: Finding Longest Common Prefix in String Array (Java)
DESCRIPTION: Implements a method to find the longest common prefix among an array of strings. It first sorts the array, then compares characters of the first and last strings to find the common prefix. Includes input validation and handling of edge cases.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/string-algorithm-problems.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public class Main {
 public static String replaceSpace(String[] strs) {
  if (!checkStrs(strs)) {
   return "";
  }
  int len = strs.length;
  StringBuilder res = new StringBuilder();
  Arrays.sort(strs);
  int m = strs[0].length();
  int n = strs[len - 1].length();
  int num = Math.min(m, n);
  for (int i = 0; i < num; i++) {
   if (strs[0].charAt(i) == strs[len - 1].charAt(i)) {
    res.append(strs[0].charAt(i));
   } else
    break;
  }
  return res.toString();
 }

 private static boolean checkStrs(String[] strs) {
  boolean flag = false;
  if (strs != null) {
   for (int i = 0; i < strs.length; i++) {
    if (strs[i] != null && strs[i].length() != 0) {
     flag = true;
    } else {
     flag = false;
     break;
    }
   }
  }
  return flag;
 }

 public static void main(String[] args) {
  String[] strs = { "customer", "car", "cat" };
  System.out.println(Main.replaceSpace(strs));
 }
}
```

----------------------------------------

TITLE: HTTP Request Interceptor for TraceId Management
DESCRIPTION: Implementation of a Spring HandlerInterceptorAdapter that manages requestId in the MDC context, either retrieving it from incoming HTTP headers or generating a new one when not present.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_15

LANGUAGE: java
CODE:
```
@Slf4j
@Component
public class LogInterceptor extends HandlerInterceptorAdapter {

    @Override
    public void afterCompletion(HttpServletRequest arg0, HttpServletResponse arg1, Object arg2, Exception arg3) {
        MDC.remove("requestId");
    }

    @Override
    public void postHandle(HttpServletRequest arg0, HttpServletResponse arg1, Object arg2, ModelAndView arg3) {
    }

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {

        String requestId = request.getHeader(BaseConstant.REQUEST_ID_KEY);
        if (StringUtils.isBlank(requestId)) {
            requestId = UUID.randomUUID().toString().replace("-", "");
        }
        MDC.put("requestId", requestId);
        return true;
    }
}
```

----------------------------------------

TITLE: Basic BigDecimal Operations in Java
DESCRIPTION: Example of using BigDecimal for precise decimal calculations and comparisons.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/bigdecimal.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
BigDecimal a = new BigDecimal("1.0");
BigDecimal b = new BigDecimal("0.9");
BigDecimal c = new BigDecimal("0.8");

BigDecimal x = a.subtract(b);
BigDecimal y = b.subtract(c);

System.out.println(x.compareTo(y));// 0
```

----------------------------------------

TITLE: Kryo Serialization Implementation in Java
DESCRIPTION: A Java class implementing serialization and deserialization using the Kryo library. It includes methods for serializing objects to byte arrays and deserializing byte arrays back to objects, with thread-safe handling of Kryo instances.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/serialization.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
@Slf4j
public class KryoSerializer implements Serializer {

    private final ThreadLocal<Kryo> kryoThreadLocal = ThreadLocal.withInitial(() -> {
        Kryo kryo = new Kryo();
        kryo.register(RpcResponse.class);
        kryo.register(RpcRequest.class);
        return kryo;
    });

    @Override
    public byte[] serialize(Object obj) {
        try (ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
             Output output = new Output(byteArrayOutputStream)) {
            Kryo kryo = kryoThreadLocal.get();
            kryo.writeObject(output, obj);
            kryoThreadLocal.remove();
            return output.toBytes();
        } catch (Exception e) {
            throw new SerializeException("Serialization failed");
        }
    }

    @Override
    public <T> T deserialize(byte[] bytes, Class<T> clazz) {
        try (ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(bytes);
             Input input = new Input(byteArrayInputStream)) {
            Kryo kryo = kryoThreadLocal.get();
            Object o = kryo.readObject(input, clazz);
            kryoThreadLocal.remove();
            return clazz.cast(o);
        } catch (Exception e) {
            throw new SerializeException("Deserialization failed");
        }
    }
}
```

----------------------------------------

TITLE: Collection copyOf() Method Usage in Java 10
DESCRIPTION: Shows the implementation and usage of the copyOf() static method for creating immutable copies of collections.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java10.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
static <E> List<E> copyOf(Collection<? extends E> coll) {
    return ImmutableCollections.listCopy(coll);
}
```

----------------------------------------

TITLE: Implementing ArrayList Class Definition in Java
DESCRIPTION: Shows the basic class definition of ArrayList including its inheritance from AbstractList and implementation of List, RandomAccess, Cloneable, and Serializable interfaces.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class ArrayList<E> extends AbstractList<E>
        implements List<E>, RandomAccess, Cloneable, java.io.Serializable{

  }
```

----------------------------------------

TITLE: Creating a Fair ArrayBlockingQueue in Java
DESCRIPTION: Demonstrates how to create an ArrayBlockingQueue with fairness enabled, which ensures that threads access the queue in the order they requested access.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-collections.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
private static ArrayBlockingQueue<Integer> blockingQueue = new ArrayBlockingQueue<Integer>(10,true);
```

----------------------------------------

TITLE: SQL Primary Key Query Example
DESCRIPTION: Shows a primary key lookup that can leverage an index for direct data retrieval. This query demonstrates how even in MyISAM engine, lookups by primary key can be efficient when only the primary key is needed in the result.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-index.md#2025-04-20_snippet_3

LANGUAGE: sql
CODE:
```
SELECT id FROM table WHERE id=1;
```

----------------------------------------

TITLE: Converting Collections to Arrays in Java
DESCRIPTION: Explains the correct way to convert collections to arrays using the toArray(T[] array) method. Emphasizes the importance of passing an empty array of the correct type to ensure type safety and JVM optimization.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
String [] s= new String[]{
    "dog", "lazy", "a", "over", "jumps", "fox", "brown", "quick", "A"
};
List<String> list = Arrays.asList(s);
Collections.reverse(list);
//没有指定类型的话会报错
s=list.toArray(new String[0]);
```

----------------------------------------

TITLE: Creating and Managing a Thread Pool with ThreadPoolExecutor in Java
DESCRIPTION: This class demonstrates how to create a custom thread pool using ThreadPoolExecutor, submit tasks to it, and manage its lifecycle. It sets core and max pool sizes, keep-alive time, and uses an ArrayBlockingQueue for the work queue.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-summary.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
import java.util.concurrent.ArrayBlockingQueue;
import java.util.concurrent.ThreadPoolExecutor;
import java.util.concurrent.TimeUnit;

public class ThreadPoolExecutorDemo {

    private static final int CORE_POOL_SIZE = 5;
    private static final int MAX_POOL_SIZE = 10;
    private static final int QUEUE_CAPACITY = 100;
    private static final Long KEEP_ALIVE_TIME = 1L;
    public static void main(String[] args) {

        //使用阿里巴巴推荐的创建线程池的方式
        //通过ThreadPoolExecutor构造函数自定义参数创建
        ThreadPoolExecutor executor = new ThreadPoolExecutor(
                CORE_POOL_SIZE,
                MAX_POOL_SIZE,
                KEEP_ALIVE_TIME,
                TimeUnit.SECONDS,
                new ArrayBlockingQueue<>(QUEUE_CAPACITY),
                new ThreadPoolExecutor.CallerRunsPolicy());

        for (int i = 0; i < 10; i++) {
            //创建WorkerThread对象（WorkerThread类实现了Runnable 接口）
            Runnable worker = new MyRunnable("" + i);
            //执行Runnable
            executor.execute(worker);
        }
        //终止线程池
        executor.shutdown();
        while (!executor.isTerminated()) {
        }
        System.out.println("Finished all threads");
    }
}
```

----------------------------------------

TITLE: ReentrantLock Interruption Example
DESCRIPTION: Demonstrates ReentrantLock's interruptible locking functionality with a complete example
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_14

LANGUAGE: java
CODE:
```
public class MyRentrantlock {
    Thread t = new Thread() {
        @Override
        public void run() {
            ReentrantLock r = new ReentrantLock();
            r.lock();
            System.out.println("lock() : lock count :" + r.getHoldCount());
            interrupt();
            System.out.println("Current thread is intrupted");
            r.tryLock();
            System.out.println("tryLock() on intrupted thread lock count :" + r.getHoldCount());
            try {
                System.out.println("Current Thread isInterrupted:" + Thread.currentThread().isInterrupted());
                r.lockInterruptibly();
                System.out.println("lockInterruptibly() --NOt executable statement" + r.getHoldCount());
            } catch (InterruptedException e) {
                r.lock();
                System.out.println("Error");
            } finally {
                r.unlock();
            }
            System.out.println("lockInterruptibly() not able to Acqurie lock: lock count :" + r.getHoldCount());
            r.unlock();
            System.out.println("lock count :" + r.getHoldCount());
            r.unlock();
            System.out.println("lock count :" + r.getHoldCount());
        }
    };
    public static void main(String str[]) {
        MyRentrantlock m = new MyRentrantlock();
        m.t.start();
    }
}
```

----------------------------------------

TITLE: LinkedList Element Insertion Operations
DESCRIPTION: Implementation of add methods for inserting elements at the end or at a specific position in the list.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
public boolean add(E e) {
    linkLast(e);
    return true;
}

public void add(int index, E element) {
    checkPositionIndex(index);
    if (index == size)
        linkLast(element);
    else
        linkBefore(element, node(index));
}
```

----------------------------------------

TITLE: Finding Kth Node from End of Linked List in Java
DESCRIPTION: Implementation to find the kth node from the end of a linked list. Uses two pointers with one pointer starting k nodes ahead to find the target node in a single pass.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/linkedlist-algorithm-problems.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public class Solution {
  public ListNode FindKthToTail(ListNode head, int k) {
    // 如果链表为空或者k小于等于0
    if (head == null || k <= 0) {
      return null;
    }
    // 声明两个指向头结点的节点
    ListNode node1 = head, node2 = head;
    // 记录节点的个数
    int count = 0;
    // 记录k值，后面要使用
    int index = k;
    // p指针先跑，并且记录节点数，当node1节点跑了k-1个节点后，node2节点开始跑，
    // 当node1节点跑到最后时，node2节点所指的节点就是倒数第k个节点
    while (node1 != null) {
      node1 = node1.next;
      count++;
      if (k < 1) {
        node2 = node2.next;
      }
      k--;
    }
    // 如果节点个数小于所求的倒数第k个节点，则返回空
    if (count < index)
      return null;
    return node2;

  }
}
```

----------------------------------------

TITLE: Implementing CAS Operations with Unsafe Class
DESCRIPTION: Core CAS operation methods provided by sun.misc.Unsafe class for atomic operations on Object, int, and long types
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/cas.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
boolean compareAndSwapObject(Object o, long offset, Object expected, Object x);

boolean compareAndSwapInt(Object o, long offset, int expected, int x);

boolean compareAndSwapLong(Object o, long offset, long expected, long x);
```

----------------------------------------

TITLE: Implementing Serializable Interface in Java
DESCRIPTION: An example of a Java class implementing the Serializable interface for JDK's built-in serialization. The class represents an RPC request with various fields and includes a serialVersionUID for version control.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/serialization.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
@AllArgsConstructor
@NoArgsConstructor
@Getter
@Builder
@ToString
public class RpcRequest implements Serializable {
    private static final long serialVersionUID = 1905122041950251207L;
    private String requestId;
    private String interfaceName;
    private String methodName;
    private Object[] parameters;
    private Class<?>[] paramTypes;
    private RpcMessageTypeEnum rpcMessageTypeEnum;
}
```

----------------------------------------

TITLE: Implementing Pessimistic Locking with synchronized and ReentrantLock in Java
DESCRIPTION: Demonstrates how to use synchronized keyword and ReentrantLock class to implement pessimistic locking in Java. These methods ensure exclusive access to shared resources.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/optimistic-lock-and-pessimistic-lock.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public void performSynchronisedTask() {
    synchronized (this) {
        // 需要同步的操作
    }
}

private Lock lock = new ReentrantLock();
lock.lock();
try {
   // 需要同步的操作
} finally {
    lock.unlock();
}
```

----------------------------------------

TITLE: Reading File Content with FileInputStream in Java
DESCRIPTION: Demonstrates how to read file content using FileInputStream, including skipping bytes and reading individual characters.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-basis.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
try (InputStream fis = new FileInputStream("input.txt")) {
    System.out.println("Number of remaining bytes:"
            + fis.available());
    int content;
    long skip = fis.skip(2);
    System.out.println("The actual number of bytes skipped:" + skip);
    System.out.print("The content read from file:");
    while ((content = fis.read()) != -1) {
        System.out.print((char) content);
    }
} catch (IOException e) {
    e.printStackTrace();
}
```

----------------------------------------

TITLE: HashMap putMapEntries Method Implementation
DESCRIPTION: Method for bulk insertion of entries from another Map into HashMap with proper capacity handling.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
final void putMapEntries(Map<? extends K, ? extends V> m, boolean evict) {
    int s = m.size();
    if (s > 0) {
        if (table == null) {
            float ft = ((float)s / loadFactor) + 1.0F;
            int t = ((ft < (float)MAXIMUM_CAPACITY) ?
                    (int)ft : MAXIMUM_CAPACITY);
            if (t > threshold)
                threshold = tableSizeFor(t);
        }
        else if (s > threshold)
            resize();
        for (Map.Entry<? extends K, ? extends V> e : m.entrySet()) {
            K key = e.getKey();
            V value = e.getValue();
            putVal(hash(key), key, value, false, evict);
        }
    }
}
```

----------------------------------------

TITLE: Zero Copy Implementation with MappedByteBuffer
DESCRIPTION: Demonstrates how to use MappedByteBuffer to implement zero-copy file loading into memory using memory mapping technique.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/nio-basis.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
private void loadFileIntoMemory(File xmlFile) throws IOException {
  FileInputStream fis = new FileInputStream(xmlFile);
  // 创建 FileChannel 对象
  FileChannel fc = fis.getChannel();
  // FileChannel.map() 将文件映射到直接内存并返回 MappedByteBuffer 对象
  MappedByteBuffer mmb = fc.map(FileChannel.MapMode.READ_ONLY, 0, fc.size());
  xmlFileBuffer = new byte[(int)fc.size()];
  mmb.get(xmlFileBuffer);
  fis.close();
}
```

----------------------------------------

TITLE: 使用Redisson实现分布式锁的基本操作
DESCRIPTION: 展示了如何使用Redisson库获取和释放分布式锁。Redisson的锁具有自动续期机制，防止锁在操作未完成时过期。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
// 1.获取指定的分布式锁对象
RLock lock = redisson.getLock("lock");
// 2.拿锁且不设置锁超时时间，具备 Watch Dog 自动续期机制
lock.lock();
// 3.执行业务
...
// 4.释放锁
lock.unlock();
```

----------------------------------------

TITLE: Implementing HashMap resize Method - Java
DESCRIPTION: Method to handle HashMap resizing operations. Manages both initial table creation and capacity expansion, including rehashing of existing entries.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
final Node<K,V>[] resize() {
    Node<K,V>[] oldTab = table;
    int oldCap = (oldTab == null) ? 0 : oldTab.length;
    int oldThr = threshold;
    int newCap, newThr = 0;
    if (oldCap > 0) {
        if (oldCap >= MAXIMUM_CAPACITY) {
            threshold = Integer.MAX_VALUE;
            return oldTab;
        }
        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY && oldCap >= DEFAULT_INITIAL_CAPACITY)
            newThr = oldThr << 1;
    }
    else if (oldThr > 0)
        newCap = oldThr;
    else {
        newCap = DEFAULT_INITIAL_CAPACITY;
        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);
    }
    if (newThr == 0) {
        float ft = (float)newCap * loadFactor;
        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ? (int)ft : Integer.MAX_VALUE);
    }
    threshold = newThr;
    @SuppressWarnings({"rawtypes","unchecked"})
        Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];
    table = newTab;
    if (oldTab != null) {
        for (int j = 0; j < oldCap; ++j) {
            Node<K,V> e;
            if ((e = oldTab[j]) != null) {
                oldTab[j] = null;
                if (e.next == null)
                    newTab[e.hash & (newCap - 1)] = e;
                else if (e instanceof TreeNode)
                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);
                else {
                    Node<K,V> loHead = null, loTail = null;
                    Node<K,V> hiHead = null, hiTail = null;
                    Node<K,V> next;
                    do {
                        next = e.next;
                        if ((e.hash & oldCap) == 0) {
                            if (loTail == null)
                                loHead = e;
                            else
                                loTail.next = e;
                            loTail = e;
                        }
                        else {
                            if (hiTail == null)
                                hiHead = e;
                            else
                                hiTail.next = e;
                            hiTail = e;
                        }
                    } while ((e = next) != null);
                    if (loTail != null) {
                        loTail.next = null;
                        newTab[j] = loHead;
                    }
                    if (hiTail != null) {
                        hiTail.next = null;
                        newTab[j + oldCap] = hiHead;
                    }
                }
            }
        }
    }
    return newTab;
}
```

----------------------------------------

TITLE: Java Stream-based Array Conversion
DESCRIPTION: Demonstrates using Java 8 Stream API to convert arrays to ArrayList, including support for primitive types.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
Integer [] myArray = { 1, 2, 3 };
List myList = Arrays.stream(myArray).collect(Collectors.toList());
//基本类型也可以实现转换（依赖boxed的装箱操作）
int [] myArray2 = { 1, 2, 3 };
List myList = Arrays.stream(myArray2).boxed().collect(Collectors.toList());
```

----------------------------------------

TITLE: Put Operation in Java 8 ConcurrentHashMap
DESCRIPTION: This method handles the put operation in Java 8 ConcurrentHashMap. It uses a combination of CAS and synchronized blocks to ensure thread-safety during insertion or update of key-value pairs.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/concurrent-hash-map-source-code.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
final V putVal(K key, V value, boolean onlyIfAbsent) {
    if (key == null || value == null) throw new NullPointerException();
    int hash = spread(key.hashCode());
    int binCount = 0;
    for (Node<K,V>[] tab = table;;) {
        Node<K,V> f; int n, i, fh;
        if (tab == null || (n = tab.length) == 0)
            tab = initTable();
        else if ((f = tabAt(tab, i = (n - 1) & hash)) == null) {
            if (casTabAt(tab, i, null,new Node<K,V>(hash, key, value, null)))
                break;
        }
        else if ((fh = f.hash) == MOVED)
            tab = helpTransfer(tab, f);
        else {
            V oldVal = null;
            synchronized (f) {
                if (tabAt(tab, i) == f) {
                    if (fh >= 0) {
                        binCount = 1;
                        for (Node<K,V> e = f;; ++binCount) {
                            K ek;
                            if (e.hash == hash &&
                                ((ek = e.key) == key ||
                                 (ek != null && key.equals(ek)))) {
                                oldVal = e.val;
                                if (!onlyIfAbsent)
                                    e.val = value;
                                break;
                            }
                            Node<K,V> pred = e;
                            if ((e = e.next) == null) {
                                pred.next = new Node<K,V>(hash, key,
                                                          value, null);
                                break;
                            }
                        }
                    }
                    else if (f instanceof TreeBin) {
                        Node<K,V> p;
                        binCount = 2;
                        if ((p = ((TreeBin<K,V>)f).putTreeVal(hash, key,
                                                       value)) != null) {
                            oldVal = p.val;
                            if (!onlyIfAbsent)
                                p.val = value;
                        }
                    }
                }
            }
            if (binCount != 0) {
                if (binCount >= TREEIFY_THRESHOLD)
                    treeifyBin(tab, i);
                if (oldVal != null)
                    return oldVal;
                break;
            }
        }
    }
    addCount(1L, binCount);
    return null;
}
```

----------------------------------------

TITLE: ConcurrentHashMap Segment Put Implementation
DESCRIPTION: Internal put implementation within a segment that handles locking, entry creation/update, and rehashing.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/concurrent-hash-map-source-code.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
final V put(K key, int hash, V value, boolean onlyIfAbsent) {
    HashEntry<K,V> node = tryLock() ? null : scanAndLockForPut(key, hash, value);
    V oldValue;
    try {
        HashEntry<K,V>[] tab = table;
        int index = (tab.length - 1) & hash;
        HashEntry<K,V> first = entryAt(tab, index);
        for (HashEntry<K,V> e = first;;) {
            if (e != null) {
                K k;
                if ((k = e.key) == key ||
                    (e.hash == hash && key.equals(k))) {
                    oldValue = e.value;
                    if (!onlyIfAbsent) {
                        e.value = value;
                        ++modCount;
                    }
                    break;
                }
                e = e.next;
            }
            else {
                if (node != null)
                    node.setNext(first);
                else
                    node = new HashEntry<K,V>(hash, key, value, first);
                int c = count + 1;
                if (c > threshold && tab.length < MAXIMUM_CAPACITY)
                    rehash(node);
                else
                    setEntryAt(tab, index, node);
                ++modCount;
                count = c;
                oldValue = null;
                break;
            }
        }
    } finally {
        unlock();
    }
    return oldValue;
}
```

----------------------------------------

TITLE: ThreadLocalMap.set() Method Implementation in Java
DESCRIPTION: The method handles setting values in ThreadLocal's internal map, dealing with key collisions and stale entries. It calculates the hash index, searches for available slots, and handles replacement, stale entry clearing, and potential rehashing operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
private void set(ThreadLocal<?> key, Object value) {
    Entry[] tab = table;
    int len = tab.length;
    int i = key.threadLocalHashCode & (len-1);

    for (Entry e = tab[i];
         e != null;
         e = tab[i = nextIndex(i, len)]) {
        ThreadLocal<?> k = e.get();

        if (k == key) {
            e.value = value;
            return;
        }

        if (k == null) {
            replaceStaleEntry(key, value, i);
            return;
        }
    }

    tab[i] = new Entry(key, value);
    int sz = ++size;
    if (!cleanSomeSlots(i, sz) && sz >= threshold)
        rehash();
}
```

----------------------------------------

TITLE: Implementing ThreadLocal's set() Method in Java
DESCRIPTION: Source code of ThreadLocal's set() method, showing how it interacts with ThreadLocalMap.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
public void set(T value) {
    Thread t = Thread.currentThread();
    ThreadLocalMap map = getMap(t);
    if (map != null)
        map.set(this, value);
    else
        createMap(t, value);
}

void createMap(Thread t, T firstValue) {
    t.threadLocals = new ThreadLocalMap(this, firstValue);
}
```

----------------------------------------

TITLE: Creating Virtual Thread Using Executors.newVirtualThreadPerTaskExecutor()
DESCRIPTION: Shows how to create virtual threads using the ExecutorService with newVirtualThreadPerTaskExecutor() method.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/virtual-thread.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
public class VirtualThreadTest {
  public static void main(String[] args) {
    CustomThread customThread = new CustomThread();
    ExecutorService executor = Executors.newVirtualThreadPerTaskExecutor();
    executor.submit(customThread);
  }
}
static class CustomThread implements Runnable {
  @Override
  public void run() {
    System.out.println("CustomThread run");
  }
}
```

----------------------------------------

TITLE: Implementing ArrayList Class Structure in Java
DESCRIPTION: Core implementation of ArrayList class showing fundamental data structures, constants, and constructors. Includes default capacity, empty array instances, and various initialization options.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public class ArrayList<E> extends AbstractList<E>
        implements List<E>, RandomAccess, Cloneable, java.io.Serializable {
    private static final long serialVersionUID = 8683452581122892189L;
    private static final int DEFAULT_CAPACITY = 10;
    private static final Object[] EMPTY_ELEMENTDATA = {};
    private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};
    transient Object[] elementData;
    private int size;

    public ArrayList(int initialCapacity) {
        if (initialCapacity > 0) {
            this.elementData = new Object[initialCapacity];
        } else if (initialCapacity == 0) {
            this.elementData = EMPTY_ELEMENTDATA;
        } else {
            throw new IllegalArgumentException("Illegal Capacity: " +
                    initialCapacity);
        }
    }

    public ArrayList() {
        this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
    }

    public ArrayList(Collection<? extends E> c) {
        elementData = c.toArray();
        if ((size = elementData.length) != 0) {
            if (elementData.getClass() != Object[].class)
                elementData = Arrays.copyOf(elementData, size, Object[].class);
        } else {
            this.elementData = EMPTY_ELEMENTDATA;
        }
    }
```

----------------------------------------

TITLE: Validating Palindrome String (Java)
DESCRIPTION: Implements a method to check if a given string is a valid palindrome. It ignores non-alphanumeric characters and is case-insensitive. The method uses two pointers moving from both ends towards the center to compare characters.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/string-algorithm-problems.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
class Solution {
  public  boolean isPalindrome(String s) {
    if (s.length() == 0)
      return true;
    int l = 0, r = s.length() - 1;
    while (l < r) {
      if (!Character.isLetterOrDigit(s.charAt(l))) {
        l++;
      } else if (!Character.isLetterOrDigit(s.charAt(r))) {
        r--;
      } else {
        if (Character.toLowerCase(s.charAt(l)) != Character.toLowerCase(s.charAt(r)))
          return false;
        l++;
        r--;
      }
    }
    return true;
  }
}
```

----------------------------------------

TITLE: LRU Cache Implementation Using LinkedHashMap
DESCRIPTION: Shows how to implement a simple LRU (Least Recently Used) cache by extending LinkedHashMap and overriding removeEldestEntry method.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedhashmap-source-code.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public class LRUCache<K, V> extends LinkedHashMap<K, V> {
    private final int capacity;

    public LRUCache(int capacity) {
        super(capacity, 0.75f, true);
        this.capacity = capacity;
    }

    /**
     * 判断size超过容量时返回true，告知LinkedHashMap移除最老的缓存项(即链表的第一个元素)
     */
    @Override
    protected boolean removeEldestEntry(Map.Entry<K, V> eldest) {
        return size() > capacity;
    }
}
```

----------------------------------------

TITLE: Implementing Radix Sort in Java
DESCRIPTION: Java implementation of the Radix Sort algorithm, including the main sorting function that uses counting sort as a subroutine.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/10-classical-sorting-algorithms.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
public static int[] radixSort(int[] arr) {
    if (arr.length < 2) {
        return arr;
    }
    int N = 1;
    int maxValue = arr[0];
    for (int element : arr) {
        if (element > maxValue) {
            maxValue = element;
        }
    }
    while (maxValue / 10 != 0) {
        maxValue = maxValue / 10;
        N += 1;
    }
    for (int i = 0; i < N; i++) {
        List<List<Integer>> radix = new ArrayList<>();
        for (int k = 0; k < 10; k++) {
            radix.add(new ArrayList<Integer>());
        }
        for (int element : arr) {
            int idx = (element / (int) Math.pow(10, i)) % 10;
            radix.get(idx).add(element);
        }
        int idx = 0;
        for (List<Integer> l : radix) {
            for (int n : l) {
                arr[idx++] = n;
            }
        }
    }
    return arr;
}
```

----------------------------------------

TITLE: Parallel Execution of Multiple CompletableFuture Tasks
DESCRIPTION: Shows how to run multiple CompletableFuture tasks in parallel using allOf() and anyOf() methods.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/completablefuture-intro.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
CompletableFuture<Void> task1 =
  CompletableFuture.supplyAsync(()->{
    //自定义业务操作
  });
......
CompletableFuture<Void> task6 =
  CompletableFuture.supplyAsync(()->{
    //自定义业务操作
  });
......
 CompletableFuture<Void> headerFuture=CompletableFuture.allOf(task1,.....,task6);

  try {
    headerFuture.join();
  } catch (Exception ex) {
    ......
  }
System.out.println("all done. ");
```

----------------------------------------

TITLE: ConcurrentHashMap Put Method Implementation
DESCRIPTION: Thread-safe put operation that handles null checks, segment selection, and initializes segments if needed.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/concurrent-hash-map-source-code.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public V put(K key, V value) {
    Segment<K,V> s;
    if (value == null)
        throw new NullPointerException();
    int hash = hash(key);
    int j = (hash >>> segmentShift) & segmentMask;
    if ((s = (Segment<K,V>)UNSAFE.getObject
         (segments, (j << SSHIFT) + SBASE)) == null)
        s = ensureSegment(j);
    return s.put(key, hash, value, false);
}
```

----------------------------------------

TITLE: Configuring Maven Compiler Plugin for Java Version
DESCRIPTION: Example of configuring the Maven Compiler Plugin to use a specific Java version (Java 8 in this case) for compiling a project. This overrides Maven's default Java 5 compiler setting.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_1

LANGUAGE: xml
CODE:
```
<build>
  <plugins>
    <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-compiler-plugin</artifactId>
      <version>3.8.1</version>
      <configuration>
        <source>1.8</source>
        <target>1.8</target>
      </configuration>
    </plugin>
  </plugins>
</build>
```

----------------------------------------

TITLE: Using CompletableFuture Factory Methods
DESCRIPTION: Demonstration of using runAsync() and supplyAsync() static factory methods to create CompletableFuture instances.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/completablefuture-intro.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
CompletableFuture<Void> future = CompletableFuture.runAsync(() -> System.out.println("hello!"));
future.get();
CompletableFuture<String> future2 = CompletableFuture.supplyAsync(() -> "hello!");
assertEquals("hello!", future2.get());
```

----------------------------------------

TITLE: Converting Collections to Maps in Java
DESCRIPTION: Shows how to convert collections to maps using the Collectors.toMap() method. Warns about potential NullPointerException when values are null and explains the underlying mechanism using the merge() method.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
class Person {
    private String name;
    private String phoneNumber;
     // getters and setters
}

List<Person> bookList = new ArrayList<>();
bookList.add(new Person("jack","18163138123"));
bookList.add(new Person("martin",null));
// 空指针异常
bookList.stream().collect(Collectors.toMap(Person::getName, Person::getPhoneNumber));
```

----------------------------------------

TITLE: Sending Transaction Message Method in Java
DESCRIPTION: This method builds and sends a transaction message using RocketMQ. It constructs the message body, sets the destination, and sends the message in a transaction, returning the result.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/rocketmq-questions.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
public TransactionSendResult sendTransactionMessage(String msgBody, String tag, Function<String, Boolean> function) {
    // 构建消息体
    Message<String> message = buildMessage(msgBody);

    // 构建消息投递信息
    String destination = buildDestination(tag);

    TransactionSendResult result = rocketMQTemplate.sendMessageInTransaction(destination, message, function);
    return result;
}
```

----------------------------------------

TITLE: Checking for Red-Black Tree Conversion in HashMap (Java)
DESCRIPTION: This snippet shows the logic in HashMap's putVal method for converting a linked list to a red-black tree when the list length exceeds the threshold (8).
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
for (int binCount = 0; ; ++binCount) {
    if ((e = p.next) == null) {
        p.next = newNode(hash, key, value, null);
        if (binCount >= TREEIFY_THRESHOLD - 1)
            treeifyBin(tab, hash);
        break;
    }
    if (e.hash == hash &&
        ((k = e.key) == key || (key != null && key.equals(k))))
        break;
    p = e;
}
```

----------------------------------------

TITLE: Configuring JaCoCo Maven Plugin for Code Coverage
DESCRIPTION: Example configuration of the JaCoCo Maven plugin for measuring code coverage during tests. This setup prepares the JaCoCo agent and generates a code coverage report after tests are run.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_9

LANGUAGE: xml
CODE:
```
<build>
  <plugins>
    <plugin>
      <groupId>org.jacoco</groupId>
      <artifactId>jacoco-maven-plugin</artifactId>
      <version>0.8.8</version>
      <executions>
        <execution>
          <goals>
            <goal>prepare-agent</goal>
          </goals>
        </execution>
        <execution>
          <id>generate-code-coverage-report</id>
          <phase>test</phase>
          <goals>
            <goal>report</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
  </plugins>
</build>
```

----------------------------------------

TITLE: Implementing Singleton Pattern in Spring
DESCRIPTION: Core implementation of Spring's singleton pattern using ConcurrentHashMap as a thread-safe singleton registry. This code shows how Spring manages singleton beans and ensures only one instance is created per bean name.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-design-patterns-summary.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
// 通过 ConcurrentHashMap（线程安全） 实现单例注册表
private final Map<String, Object> singletonObjects = new ConcurrentHashMap<String, Object>(64);

public Object getSingleton(String beanName, ObjectFactory<?> singletonFactory) {
        Assert.notNull(beanName, "'beanName' must not be null");
        synchronized (this.singletonObjects) {
            // 检查缓存中是否存在实例
            Object singletonObject = this.singletonObjects.get(beanName);
            if (singletonObject == null) {
                //...省略了很多代码
                try {
                    singletonObject = singletonFactory.getObject();
                }
                //...省略了很多代码
                // 如果实例对象在不存在，我们注册到单例注册表中。
                addSingleton(beanName, singletonObject);
            }
            return (singletonObject != NULL_OBJECT ? singletonObject : null);
        }
    }
    //将对象添加到单例注册表
    protected void addSingleton(String beanName, Object singletonObject) {
            synchronized (this.singletonObjects) {
                this.singletonObjects.put(beanName, (singletonObject != null ? singletonObject : NULL_OBJECT));

            }
        }
}
```

----------------------------------------

TITLE: Counting Active Users with Redis BITOP and BITCOUNT
DESCRIPTION: This code shows how to use the BITOP command to perform logical AND/OR operations on bitmaps representing user activity data from different days, followed by BITCOUNT to calculate the number of active users.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
> BITOP and desk1 20210308 20210309
(integer) 1
> BITCOUNT desk1
(integer) 1
```

----------------------------------------

TITLE: Vector API Computation Example
DESCRIPTION: Demonstrates the use of Vector API for optimized array computations, comparing scalar and vector-based implementations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java22-23.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
static final VectorSpecies<Float> SPECIES = FloatVector.SPECIES_PREFERRED;

void vectorComputation(float[] a, float[] b, float[] c) {
    int i = 0;
    int upperBound = SPECIES.loopBound(a.length);
    for (; i < upperBound; i += SPECIES.length()) {
        var va = FloatVector.fromArray(SPECIES, a, i);
        var vb = FloatVector.fromArray(SPECIES, b, i);
        var vc = va.mul(va)
                   .add(vb.mul(vb))
                   .neg();
        vc.intoArray(c, i);
    }
    for (; i < a.length; i++) {
        c[i] = (a[i] * a[i] + b[i] * b[i]) * -1.0f;
    }
}
```

----------------------------------------

TITLE: Creating Virtual Thread Using Thread.startVirtualThread()
DESCRIPTION: Demonstrates how to create and start a virtual thread using Thread.startVirtualThread() method with a custom Runnable implementation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/virtual-thread.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class VirtualThreadTest {
  public static void main(String[] args) {
    CustomThread customThread = new CustomThread();
    Thread.startVirtualThread(customThread);
  }
}

static class CustomThread implements Runnable {
  @Override
  public void run() {
    System.out.println("CustomThread run");
  }
}
```

----------------------------------------

TITLE: Using Redis SETBIT and BITOP Commands for User Activity Tracking
DESCRIPTION: This code demonstrates how to use Redis Bitmap operations to track and analyze user activity across multiple days. The example shows initializing user activity data with SETBIT and performing logical operations with BITOP to count active users.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
> SETBIT 20210308 1 1
(integer) 0
> SETBIT 20210308 2 1
(integer) 0
> SETBIT 20210309 1 1
(integer) 0
```

----------------------------------------

TITLE: SQL SELECT查询语句
DESCRIPTION: 展示了不同形式的SELECT查询语句
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_4

LANGUAGE: sql
CODE:
```
SELECT prod_name
FROM products;

SELECT prod_id, prod_name, prod_price
FROM products;

SELECT *
FROM products;

SELECT DISTINCT
vend_id FROM products;

-- 返回前 5 行
SELECT * FROM mytable LIMIT 5;
SELECT * FROM mytable LIMIT 0, 5;
-- 返回第 3 ~ 5 行
SELECT * FROM mytable LIMIT 2, 3;
```

----------------------------------------

TITLE: Solving Frog Jump Problem with Dynamic Programming in Java
DESCRIPTION: This code solves the problem of counting ways a frog can jump to the nth step when it can jump either 1 or 2 steps at a time. The solution uses an iterative approach similar to the Fibonacci sequence calculation, with O(n) time complexity.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
int jumpFloor(int number) {
    if (number <= 0) {
        return 0;
    }
    if (number == 1) {
        return 1;
    }
    if (number == 2) {
        return 2;
    }
    int first = 1, second = 2, third = 0;
    for (int i = 3; i <= number; i++) {
        third = first + second;
        first = second;
        second = third;
    }
    return third;
}
```

----------------------------------------

TITLE: BigDecimal Arithmetic Operations in Java
DESCRIPTION: Demonstrates addition, subtraction, multiplication, and division operations using BigDecimal with rounding modes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/bigdecimal.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
BigDecimal a = new BigDecimal("1.0");
BigDecimal b = new BigDecimal("0.9");
System.out.println(a.add(b));// 1.9
System.out.println(a.subtract(b));// 0.1
System.out.println(a.multiply(b));// 0.90
System.out.println(a.divide(b, 2, RoundingMode.HALF_UP));// 1.11
```

----------------------------------------

TITLE: Implementing hugeCapacity Method for ArrayList Memory Management in Java
DESCRIPTION: This method handles large capacity increases in ArrayList when the required capacity exceeds standard limits. It determines whether to use Integer.MAX_VALUE or MAX_ARRAY_SIZE based on the requested minimum capacity.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
private static int hugeCapacity(int minCapacity) {
    if (minCapacity < 0) // overflow
        throw new OutOfMemoryError();
    // 对minCapacity和MAX_ARRAY_SIZE进行比较
    // 若minCapacity大，将Integer.MAX_VALUE作为新数组的大小
    // 若MAX_ARRAY_SIZE大，将MAX_ARRAY_SIZE作为新数组的大小
    // MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;
    return (minCapacity > MAX_ARRAY_SIZE) ?
        Integer.MAX_VALUE :
        MAX_ARRAY_SIZE;
}
```

----------------------------------------

TITLE: Implementing a Generic Class in Java
DESCRIPTION: This code snippet shows how to define a generic class in Java, which can work with any type specified at instantiation time.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_6

LANGUAGE: Java
CODE:
```
public class Generic<T>{

    private T key;

    public Generic(T key) {
        this.key = key;
    }

    public T getKey(){
        return key;
    }
}
```

----------------------------------------

TITLE: CAS Operations in Unsafe Class
DESCRIPTION: Core CAS (Compare-And-Swap) operations implemented in Unsafe class for atomic updates of object fields, int and long values.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
boolean compareAndSwapObject(Object o, long offset, Object expected, Object x);

boolean compareAndSwapInt(Object o, long offset, int expected, int x);

boolean compareAndSwapLong(Object o, long offset, long expected, long x);
```

----------------------------------------

TITLE: Pattern Matching in Switch Expressions
DESCRIPTION: Example of using pattern matching in switch expressions with different types.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java21.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
static String formatterPatternSwitch(Object obj) {
    return switch (obj) {
        case Integer i -> String.format("int %d", i);
        case Long l    -> String.format("long %d", l);
        case Double d  -> String.format("double %f", d);
        case String s  -> String.format("String %s", s);
        default        -> obj.toString();
    };
}
```

----------------------------------------

TITLE: Reading File Content Using Scanner in Java with Try-Catch-Finally
DESCRIPTION: This code snippet demonstrates how to read a text file using Scanner in Java, with proper resource management using try-catch-finally blocks.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
Scanner scanner = null;
try {
    scanner = new Scanner(new File("D://read.txt"));
    while (scanner.hasNext()) {
        System.out.println(scanner.nextLine());
    }
} catch (FileNotFoundException e) {
    e.printStackTrace();
} finally {
    if (scanner != null) {
        scanner.close();
    }
}
```

----------------------------------------

TITLE: Initialization in Java 8 ConcurrentHashMap
DESCRIPTION: This method initializes the table in Java 8 ConcurrentHashMap using a spin-lock and CAS operations. It handles concurrent initialization attempts by multiple threads.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/concurrent-hash-map-source-code.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
private final Node<K,V>[] initTable() {
    Node<K,V>[] tab; int sc;
    while ((tab = table) == null || tab.length == 0) {
        //　如果 sizeCtl < 0 ,说明另外的线程执行CAS 成功，正在进行初始化。
        if ((sc = sizeCtl) < 0)
            // 让出 CPU 使用权
            Thread.yield(); // lost initialization race; just spin
        else if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) {
            try {
                if ((tab = table) == null || tab.length == 0) {
                    int n = (sc > 0) ? sc : DEFAULT_CAPACITY;
                    @SuppressWarnings("unchecked")
                    Node<K,V>[] nt = (Node<K,V>[])new Node<?,?>[n];
                    table = tab = nt;
                    sc = n - (n >>> 2);
                }
            } finally {
                sizeCtl = sc;
            }
            break;
        }
    }
    return tab;
}
```

----------------------------------------

TITLE: Creating Virtual Thread Using ThreadFactory
DESCRIPTION: Demonstrates virtual thread creation using a ThreadFactory obtained from Thread.ofVirtual().factory().
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/virtual-thread.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public class VirtualThreadTest {
  public static void main(String[] args) {
    CustomThread customThread = new CustomThread();
    ThreadFactory factory = Thread.ofVirtual().factory();
    Thread thread = factory.newThread(customThread);
    thread.start();
  }
}

static class CustomThread implements Runnable {
  @Override
  public void run() {
    System.out.println("CustomThread run");
  }
}
```

----------------------------------------

TITLE: Java Reference Types Examples
DESCRIPTION: Code examples showing different types of references in Java including strong, soft, weak and phantom references.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-garbage-collection.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
String strongReference = new String("abc");
```

LANGUAGE: java
CODE:
```
String str = new String("abc");
SoftReference<String> softReference = new SoftReference<String>(str);
```

LANGUAGE: java
CODE:
```
String str = new String("abc");
WeakReference<String> weakReference = new WeakReference<>(str);
str = null;
```

LANGUAGE: java
CODE:
```
String str = new String("abc");
ReferenceQueue queue = new ReferenceQueue();
PhantomReference pr = new PhantomReference(str, queue);
```

----------------------------------------

TITLE: Obtaining Class Objects in Java
DESCRIPTION: Different methods to obtain Class objects in Java including using class literal, Class.forName(), instance.getClass(), and ClassLoader.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/reflection.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
Class alunbarClass = TargetObject.class;
```

LANGUAGE: java
CODE:
```
Class alunbarClass1 = Class.forName("cn.javaguide.TargetObject");
```

LANGUAGE: java
CODE:
```
TargetObject o = new TargetObject();
Class alunbarClass2 = o.getClass();
```

LANGUAGE: java
CODE:
```
ClassLoader.getSystemClassLoader().loadClass("cn.javaguide.TargetObject");
```

----------------------------------------

TITLE: Implementing Quick Sort in Java
DESCRIPTION: Java implementation of the Quick Sort algorithm, including the partition function and the recursive sorting method.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/10-classical-sorting-algorithms.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public static int partition(int[] array, int low, int high) {
    int pivot = array[high];
    int pointer = low;
    for (int i = low; i < high; i++) {
        if (array[i] <= pivot) {
            int temp = array[i];
            array[i] = array[pointer];
            array[pointer] = temp;
            pointer++;
        }
        System.out.println(Arrays.toString(array));
    }
    int temp = array[pointer];
    array[pointer] = array[high];
    array[high] = temp;
    return pointer;
}
public static void quickSort(int[] array, int low, int high) {
    if (low < high) {
        int position = partition(array, low, high);
        quickSort(array, low, position - 1);
        quickSort(array, position + 1, high);
    }
}
```

----------------------------------------

TITLE: Timed Offer Operation in ArrayBlockingQueue
DESCRIPTION: Implementation of offer operation that waits up to a specified timeout for space to become available.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_18

LANGUAGE: java
CODE:
```
public boolean offer(E e, long timeout, TimeUnit unit)
        throws InterruptedException {

        checkNotNull(e);
        long nanos = unit.toNanos(timeout);
        final ReentrantLock lock = this.lock;
        lock.lockInterruptibly();
        try {
            while (count == items.length) {
                if (nanos <= 0)
                    return false;
                nanos = notFull.awaitNanos(nanos);
            }
            enqueue(e);
            return true;
        } finally {
            lock.unlock();
        }
    }
```

----------------------------------------

TITLE: Implementing AES Encryption and Decryption in Java
DESCRIPTION: A comprehensive Java implementation of AES encryption and decryption using GCM mode and NoPadding. This example includes initialization, encryption, and decryption methods that handle string data and uses Base64 encoding for the encrypted output.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/security/encryption-algorithms.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
private static final String AES_ALGORITHM = "AES";
// AES密钥
private static final String AES_SECRET_KEY = "4128D9CDAC7E2F82951CBAF7FDFE675B";
// AES加密模式为GCM，填充方式为NoPadding
// AES-GCM 是流加密（Stream cipher）算法，所以对应的填充模式为 NoPadding，即无需填充。
private static final String AES_TRANSFORMATION = "AES/GCM/NoPadding";
// 加密器
private static Cipher encryptionCipher;
// 解密器
private static Cipher decryptionCipher;

/**
 * 完成一些初始化工作
 */
public static void init() throws Exception {
    // 将AES密钥转换为SecretKeySpec对象
    SecretKeySpec secretKeySpec = new SecretKeySpec(AES_SECRET_KEY.getBytes(), AES_ALGORITHM);
    // 使用指定的AES加密模式和填充方式获取对应的加密器并初始化
    encryptionCipher = Cipher.getInstance(AES_TRANSFORMATION);
    encryptionCipher.init(Cipher.ENCRYPT_MODE, secretKeySpec);
    // 使用指定的AES加密模式和填充方式获取对应的解密器并初始化
    decryptionCipher = Cipher.getInstance(AES_TRANSFORMATION);
    decryptionCipher.init(Cipher.DECRYPT_MODE, secretKeySpec, new GCMParameterSpec(128, encryptionCipher.getIV()));
}

/**
 * 加密
 */
public static String encrypt(String data) throws Exception {
    byte[] dataInBytes = data.getBytes();
    // 加密数据
    byte[] encryptedBytes = encryptionCipher.doFinal(dataInBytes);
    return Base64.getEncoder().encodeToString(encryptedBytes);
}

/**
 * 解密
 */
public static String decrypt(String encryptedData) throws Exception {
    byte[] dataInBytes = Base64.getDecoder().decode(encryptedData);
    // 解密数据
    byte[] decryptedBytes = decryptionCipher.doFinal(dataInBytes);
    return new String(decryptedBytes, StandardCharsets.UTF_8);
}

public static void main(String[] args) throws Exception {
    String originalString = "Java学习 + 面试指南：javaguide.cn";
    init();
    String encryptedData = encrypt(originalString);
    String decryptedData = decrypt(encryptedData);
    System.out.println("Original String: " + originalString);
    System.out.println("AES Encrypted Data : " + encryptedData);
    System.out.println("AES Decrypted Data : " + decryptedData);
}
```

----------------------------------------

TITLE: Removing Duplicates from Collections in Java
DESCRIPTION: Demonstrates two methods for removing duplicates from collections: using Set and using List. Explains the time complexity differences between HashSet's contains() method and ArrayList's contains() method.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
// Set 去重代码示例
public static <T> Set<T> removeDuplicateBySet(List<T> data) {

    if (CollectionUtils.isEmpty(data)) {
        return new HashSet<>();
    }
    return new HashSet<>(data);
}

// List 去重代码示例
public static <T> List<T> removeDuplicateByList(List<T> data) {

    if (CollectionUtils.isEmpty(data)) {
        return new ArrayList<>();

    }
    List<T> result = new ArrayList<>(data.size());
    for (T current : data) {
        if (!result.contains(current)) {
            result.add(current);
        }
    }
    return result;
}
```

----------------------------------------

TITLE: Using Google Guava's Bloom Filter
DESCRIPTION: Example showing how to use the Bloom Filter implementation from Google's Guava library.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/bloom-filter.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
BloomFilter<Integer> filter = BloomFilter.create(
    Funnels.integerFunnel(),
    1500,
    0.01);
System.out.println(filter.mightContain(1));
System.out.println(filter.mightContain(2));
filter.put(1);
filter.put(2);
System.out.println(filter.mightContain(1));
System.out.println(filter.mightContain(2));
```

----------------------------------------

TITLE: Structured Concurrency Example
DESCRIPTION: Demonstrates the structured concurrency API for managing multiple concurrent tasks as a single unit of work.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java22-23.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
try (var scope = new StructuredTaskScope<Object>()) {
    // 使用fork方法派生线程来执行子任务
    Future<Integer> future1 = scope.fork(task1);
    Future<String> future2 = scope.fork(task2);
    // 等待线程完成
    scope.join();
    // 结果的处理可能包括处理或重新抛出异常
    ... process results/exceptions ...
} // close
```

----------------------------------------

TITLE: Implementing ThreadPoolExecutor execute() Method in Java
DESCRIPTION: Implementation of the execute() method in ThreadPoolExecutor, which handles task submission and thread creation logic for the thread pool.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-summary.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
private final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));

private static int workerCountOf(int c) {
    return c & CAPACITY;
}
//任务队列
private final BlockingQueue<Runnable> workQueue;

public void execute(Runnable command) {
    // 如果任务为null，则抛出异常。
    if (command == null)
        throw new NullPointerException();
    // ctl 中保存的线程池当前的一些状态信息
    int c = ctl.get();

    //  下面会涉及到 3 步 操作
    // 1.首先判断当前线程池中执行的任务数量是否小于 corePoolSize
    // 如果小于的话，通过addWorker(command, true)新建一个线程，并将任务(command)添加到该线程中；然后，启动该线程从而执行任务。
    if (workerCountOf(c) < corePoolSize) {
        if (addWorker(command, true))
            return;
        c = ctl.get();
    }
    // 2.如果当前执行的任务数量大于等于 corePoolSize 的时候就会走到这里，表明创建新的线程失败。
    // 通过 isRunning 方法判断线程池状态，线程池处于 RUNNING 状态并且队列可以加入任务，该任务才会被加入进去
    if (isRunning(c) && workQueue.offer(command)) {
        int recheck = ctl.get();
        // 再次获取线程池状态，如果线程池状态不是 RUNNING 状态就需要从任务队列中移除任务，并尝试判断线程是否全部执行完毕。同时执行拒绝策略。
        if (!isRunning(recheck) && remove(command))
            reject(command);
            // 如果当前工作线程数量为0，新创建一个线程并执行。
        else if (workerCountOf(recheck) == 0)
            addWorker(null, false);
    }
    //3. 通过addWorker(command, false)新建一个线程，并将任务(command)添加到该线程中；然后，启动该线程从而执行任务。
    // 传入 false 代表增加线程时判断当前线程数是否少于 maxPoolSize
    //如果addWorker(command, false)执行失败，则通过reject()执行相应的拒绝策略的内容。
    else if (!addWorker(command, false))
        reject(command);
}
```

----------------------------------------

TITLE: Static variable and method demonstration in Java
DESCRIPTION: This code snippet demonstrates the usage of static variables and methods in Java. It shows how to define static members and access them using the class name.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-keyword-summary.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
public class StaticBean {
    String name;
    //静态变量
    static int age;
    public StaticBean(String name) {
        this.name = name;
    }
    //静态方法
    static void sayHello() {
        System.out.println("Hello i am java");
    }
    @Override
    public String toString() {
        return "StaticBean{" +
                "name=" + name + ",age=" + age +
                "}";
    }
}
```

----------------------------------------

TITLE: Heuristic Cleaning Algorithm for ThreadLocalMap
DESCRIPTION: Implementation of the cleanSomeSlots method which performs a heuristic scan of the ThreadLocalMap to find and remove stale entries. This is an optimization to periodically clean unreferenced ThreadLocal objects.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
private boolean cleanSomeSlots(int i, int n) {
    boolean removed = false;
    Entry[] tab = table;
    int len = tab.length;
    do {
        i = nextIndex(i, len);
        Entry e = tab[i];
        if (e != null && e.get() == null) {
            n = len;
            removed = true;
            i = expungeStaleEntry(i);
        }
    } while ( (n >>>= 1) != 0);
    return removed;
}
```

----------------------------------------

TITLE: Finding Longest Palindromic Subsequence (Java)
DESCRIPTION: Implements a dynamic programming solution to find the length of the longest palindromic subsequence in a given string. It uses a 2D DP table to store lengths of palindromic subsequences for different substrings.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/string-algorithm-problems.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
class Solution {
    public int longestPalindromeSubseq(String s) {
        int len = s.length();
        int [][] dp = new int[len][len];
        for(int i = len - 1; i>=0; i--){
            dp[i][i] = 1;
            for(int j = i+1; j < len; j++){
                if(s.charAt(i) == s.charAt(j))
                    dp[i][j] = dp[i+1][j-1] + 2;
                else
                    dp[i][j] = Math.max(dp[i+1][j], dp[i][j-1]);
            }
        }
        return dp[0][len-1];
    }
}
```

----------------------------------------

TITLE: Creating and Using a Producer in RocketMQ
DESCRIPTION: Demonstrates the correct way to create and use a producer in RocketMQ, emphasizing the importance of reusing the producer instance for multiple messages.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/rocketmq-questions.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
Producer p = ProducerBuilder.build();
for (int i =0;i<n;i++){
    Message m= MessageBuilder.build();
    p.send(m);
 }
p.shutdown();
```

----------------------------------------

TITLE: Validating Parentheses Using Stack in Java
DESCRIPTION: Implements a function to check if a string of parentheses is valid using a stack data structure in Java.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/linear-data-structure.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public boolean isValid(String s){
    // 括号之间的对应规则
    HashMap<Character, Character> mappings = new HashMap<Character, Character>();
    mappings.put(')', '(');
    mappings.put('}', '{');
    mappings.put(']', '[');
    Stack<Character> stack = new Stack<Character>();
    char[] chars = s.toCharArray();
    for (int i = 0; i < chars.length; i++) {
        if (mappings.containsKey(chars[i])) {
            char topElement = stack.empty() ? '#' : stack.pop();
            if (topElement != mappings.get(chars[i])) {
                return false;
            }
        } else {
            stack.push(chars[i]);
        }
    }
    return stack.isEmpty();
}
```

----------------------------------------

TITLE: 使用AtomicInteger进行原子操作
DESCRIPTION: 展示了如何使用AtomicInteger类进行各种原子操作，包括获取和设置值、自增、自减、条件更新等。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/atomic-classes.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
AtomicInteger atomicInt = new AtomicInteger(0);

int tempValue = atomicInt.getAndSet(3);
System.out.println("tempValue: " + tempValue + "; atomicInt: " + atomicInt);

tempValue = atomicInt.getAndIncrement();
System.out.println("tempValue: " + tempValue + "; atomicInt: " + atomicInt);

tempValue = atomicInt.getAndAdd(5);
System.out.println("tempValue: " + tempValue + "; atomicInt: " + atomicInt);

boolean updateSuccess = atomicInt.compareAndSet(9, 10);
System.out.println("Update Success: " + updateSuccess + "; atomicInt: " + atomicInt);

int currentValue = atomicInt.get();
System.out.println("Current value: " + currentValue);

atomicInt.lazySet(15);
System.out.println("After lazySet, atomicInt: " + atomicInt);
```

----------------------------------------

TITLE: Demonstrating Scoped Values in Java
DESCRIPTION: This code snippet shows how to use scoped values to share immutable data within and between threads. It's more efficient than thread-local variables, especially when using many virtual threads.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java20.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
final static ScopedValue<...> V = new ScopedValue<>();

// In some method
ScopedValue.where(V, <value>)
           .run(() -> { ... V.get() ... call methods ... });

// In a method called directly or indirectly from the lambda expression
... V.get() ...
```

----------------------------------------

TITLE: Using HTTP Client API in Java 11
DESCRIPTION: Demonstrates how to use the standardized HTTP Client API for both synchronous and asynchronous HTTP requests using java.net.http package.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java11.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
var request = HttpRequest.newBuilder()
    .uri(URI.create("https://javastack.cn"))
    .GET()
    .build();
var client = HttpClient.newHttpClient();

// 同步
HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());
System.out.println(response.body());

// 异步
client.sendAsync(request, HttpResponse.BodyHandlers.ofString())
    .thenApply(HttpResponse::body)
    .thenAccept(System.out::println);
```

----------------------------------------

TITLE: Static inner class implementation of Singleton pattern in Java
DESCRIPTION: This code snippet shows how to implement the Singleton pattern using a static inner class in Java. It demonstrates lazy initialization and thread-safe instance creation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-keyword-summary.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
public class Singleton {
    //声明为 private 避免调用默认构造方法创建对象
    private Singleton() {
    }
   // 声明为 private 表明静态内部该类只能在该 Singleton 类中被访问
    private static class SingletonHolder {
        private static final Singleton INSTANCE = new Singleton();
    }
    public static Singleton getUniqueInstance() {
        return SingletonHolder.INSTANCE;
    }
}
```

----------------------------------------

TITLE: Common LinkedList Operations in Java
DESCRIPTION: Demonstrates various common operations on a LinkedList including adding elements, inserting at specific positions, getting and setting elements, removing elements, and clearing the list. It also shows how to get the size of the list.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
// 创建 LinkedList 对象
LinkedList<String> list = new LinkedList<>();

// 添加元素到链表末尾
list.add("apple");
list.add("banana");
list.add("pear");
System.out.println("链表内容：" + list);

// 在指定位置插入元素
list.add(1, "orange");
System.out.println("链表内容：" + list);

// 获取指定位置的元素
String fruit = list.get(2);
System.out.println("索引为 2 的元素：" + fruit);

// 修改指定位置的元素
list.set(3, "grape");
System.out.println("链表内容：" + list);

// 删除指定位置的元素
list.remove(0);
System.out.println("链表内容：" + list);

// 删除第一个出现的指定元素
list.remove("banana");
System.out.println("链表内容：" + list);

// 获取链表的长度
int size = list.size();
System.out.println("链表长度：" + size);

// 清空链表
list.clear();
System.out.println("清空后的链表：" + list);
```

----------------------------------------

TITLE: Get Operation in Java 7 ConcurrentHashMap
DESCRIPTION: This method retrieves a value from the ConcurrentHashMap based on the provided key. It calculates the key's position and traverses the linked list if necessary.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/concurrent-hash-map-source-code.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
public V get(Object key) {
    Segment<K,V> s; // manually integrate access methods to reduce overhead
    HashEntry<K,V>[] tab;
    int h = hash(key);
    long u = (((h >>> segmentShift) & segmentMask) << SSHIFT) + SBASE;
    // 计算得到 key 的存放位置
    if ((s = (Segment<K,V>)UNSAFE.getObjectVolatile(segments, u)) != null &&
        (tab = s.table) != null) {
        for (HashEntry<K,V> e = (HashEntry<K,V>) UNSAFE.getObjectVolatile
                 (tab, ((long)(((tab.length - 1) & h)) << TSHIFT) + TBASE);
             e != null; e = e.next) {
            // 如果是链表，遍历查找到相同 key 的 value。
            K k;
            if ((k = e.key) == key || (e.hash == h && key.equals(k)))
                return e.value;
        }
    }
    return null;
}
```

----------------------------------------

TITLE: Redis Hash类型模拟对象数据存储
DESCRIPTION: 展示了如何使用Hash类型存储和操作对象数据,包括HMSET、HEXISTS、HGET、HGETALL、HSET、HINCRBY等命令的使用。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_7

LANGUAGE: bash
CODE:
```
> HMSET userInfoKey name "guide" description "dev" age 24
OK
> HEXISTS userInfoKey name # 查看 key 对应的 value中指定的字段是否存在。
(integer) 1
> HGET userInfoKey name # 获取存储在哈希表中指定字段的值。
"guide"
> HGET userInfoKey age
"24"
> HGETALL userInfoKey # 获取在哈希表中指定 key 的所有字段和值
1) "name"
2) "guide"
3) "description"
4) "dev"
5) "age"
6) "24"
> HSET userInfoKey name "GuideGeGe"
> HGET userInfoKey name
"GuideGeGe"
> HINCRBY userInfoKey age 2
(integer) 26
```

----------------------------------------

TITLE: 使用Redis SETNX命令实现简易分布式锁
DESCRIPTION: 展示了如何使用Redis的SETNX和DEL命令来实现最基本的分布式锁获取和释放操作。SETNX命令只在key不存在时设置值，返回1表示获取锁成功，0表示失败。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
> SETNX lockKey uniqueValue
(integer) 1
> SETNX lockKey uniqueValue
(integer) 0
```

----------------------------------------

TITLE: Implementing Postorder Traversal for Binary Trees in Java
DESCRIPTION: A recursive implementation of postorder traversal for binary trees. The algorithm first recursively traverses the left subtree, then the right subtree, and finally processes the root node.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/tree.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
public void postOrder(TreeNode root){
	if(root == null){
		return;
	}
 postOrder(root.left);
	postOrder(root.right);
	system.out.println(root.data);
}
```

----------------------------------------

TITLE: Data Types in SQL
DESCRIPTION: Provides an overview of MySQL data types including numeric types, string types, date and time types, and enumeration and set types.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_5

LANGUAGE: SQL
CODE:
```
/* 数据类型（列类型） */ ------------------
1. 数值类型
-- a. 整型 ----------
    类型         字节     范围（有符号位）
    tinyint     1字节    -128 ~ 127      无符号位：0 ~ 255
    smallint    2字节    -32768 ~ 32767
    mediumint   3字节    -8388608 ~ 8388607
    int         4字节
    bigint      8字节
    int(M)  M表示总位数
    - 默认存在符号位，unsigned 属性修改
    - 显示宽度，如果某个数不够定义字段时设置的位数，则前面以0补填，zerofill 属性修改
        例：int(5)   插入一个数'123'，补填后为'00123'
    - 在满足要求的情况下，越小越好。
    - 1表示bool值真，0表示bool值假。MySQL没有布尔类型，通过整型0和1表示。常用tinyint(1)表示布尔型。
-- b. 浮点型 ----------
    类型             字节     范围
    float(单精度)     4字节
    double(双精度)    8字节
    浮点型既支持符号位 unsigned 属性，也支持显示宽度 zerofill 属性。
        不同于整型，前后均会补填0.
    定义浮点型时，需指定总位数和小数位数。
        float(M, D)     double(M, D)
        M表示总位数，D表示小数位数。
        M和D的大小会决定浮点数的范围。不同于整型的固定范围。
        M既表示总位数（不包括小数点和正负号），也表示显示宽度（所有显示符号均包括）。
        支持科学计数法表示。
        浮点数表示近似值。
-- c. 定点数 ----------
    decimal -- 可变长度
    decimal(M, D)   M也表示总位数，D表示小数位数。
    保存一个精确的数值，不会发生数据的改变，不同于浮点数的四舍五入。
    将浮点数转换为字符串来保存，每9位数字保存为4个字节。
2. 字符串类型
-- a. char, varchar ----------
    char    定长字符串，速度快，但浪费空间
    varchar 变长字符串，速度慢，但节省空间
    M表示能存储的最大长度，此长度是字符数，非字节数。
    不同的编码，所占用的空间不同。
    char,最多255个字符，与编码无关。
    varchar,最多65535字符，与编码有关。
    一条有效记录最大不能超过65535个字节。
        utf8 最大为21844个字符，gbk 最大为32766个字符，latin1 最大为65532个字符
    varchar 是变长的，需要利用存储空间保存 varchar 的长度，如果数据小于255个字节，则采用一个字节来保存长度，反之需要两个字节来保存。
    varchar 的最大有效长度由最大行大小和使用的字符集确定。
    最大有效长度是65532字节，因为在varchar存字符串时，第一个字节是空的，不存在任何数据，然后还需两个字节来存放字符串的长度，所以有效长度是65535-1-2=65532字节。
    例：若一个表定义为 CREATE TABLE tb(c1 int, c2 char(30), c3 varchar(N)) charset=utf8; 问N的最大值是多少？ 答：(65535-1-2-4-30*3)/3
-- b. blob, text ----------
    blob 二进制字符串（字节字符串）
        tinyblob, blob, mediumblob, longblob
    text 非二进制字符串（字符字符串）
        tinytext, text, mediumtext, longtext
    text 在定义时，不需要定义长度，也不会计算总长度。
    text 类型在定义时，不可给default值
-- c. binary, varbinary ----------
    类似于char和varchar，用于保存二进制字符串，也就是保存字节字符串而非字符字符串。
    char, varchar, text 对应 binary, varbinary, blob.
3. 日期时间类型
    一般用整型保存时间戳，因为PHP可以很方便的将时间戳进行格式化。
    datetime    8字节    日期及时间     1000-01-01 00:00:00 到 9999-12-31 23:59:59
    date        3字节    日期         1000-01-01 到 9999-12-31
    timestamp   4字节    时间戳        19700101000000 到 2038-01-19 03:14:07
    time        3字节    时间         -838:59:59 到 838:59:59
    year        1字节    年份         1901 - 2155
datetime    YYYY-MM-DD hh:mm:ss
timestamp   YY-MM-DD hh:mm:ss
            YYYYMMDDhhmmss
            YYMMDDhhmmss
            YYYYMMDDhhmmss
            YYMMDDhhmmss
date        YYYY-MM-DD
            YY-MM-DD
            YYYYMMDD
            YYMMDD
            YYYYMMDD
            YYMMDD
time        hh:mm:ss
            hhmmss
            hhmmss
year        YYYY
            YY
            YYYY
            YY
4. 枚举和集合
-- 枚举(enum) ----------
enum(val1, val2, val3...)
    在已知的值中进行单选。最大数量为65535.
    枚举值在保存时，以2个字节的整型(smallint)保存。每个枚举值，按保存的位置顺序，从1开始逐一递增。
    表现为字符串类型，存储却是整型。
    NULL值的索引是NULL。
    空字符串错误值的索引值是0。
-- 集合（set） ----------
set(val1, val2, val3...)
    create table tab ( gender set('男', '女', '无') );
    insert into tab values ('男, 女');
    最多可以有64个不同的成员。以bigint存储，共8个字节。采取位运算的形式。
    当创建表时，SET成员值的尾部空格将自动被删除。
```

----------------------------------------

TITLE: Java String Templates Basic Usage
DESCRIPTION: Example showing basic usage of String Templates in Java 21 with different template processors (STR, FMT, RAW).
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java21.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
String name = "Lokesh";

//STR
String message = STR."Greetings \{name}.";

//FMT
String message = FMT."Greetings %-12s\{name}.";

//RAW
StringTemplate st = RAW."Greetings \{name}.";
String message = STR.process(st);
```

----------------------------------------

TITLE: Implementing Common Object Class Methods in Java
DESCRIPTION: This code snippet demonstrates the implementation of common methods in the Object class, including getClass(), hashCode(), equals(), clone(), toString(), wait(), notify(), notifyAll(), and finalize().
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
/**
 * native 方法，用于返回当前运行时对象的 Class 对象，使用了 final 关键字修饰，故不允许子类重写。
 */
public final native Class<?> getClass()
/**
 * native 方法，用于返回对象的哈希码，主要使用在哈希表中，比如 JDK 中的HashMap。
 */
public native int hashCode()
/**
 * 用于比较 2 个对象的内存地址是否相等，String 类对该方法进行了重写以用于比较字符串的值是否相等。
 */
public boolean equals(Object obj)
/**
 * native 方法，用于创建并返回当前对象的一份拷贝。
 */
protected native Object clone() throws CloneNotSupportedException
/**
 * 返回类的名字实例的哈希码的 16 进制的字符串。建议 Object 所有的子类都重写这个方法。
 */
public String toString()
/**
 * native 方法，并且不能重写。唤醒一个在此对象监视器上等待的线程(监视器相当于就是锁的概念)。如果有多个线程在等待只会任意唤醒一个。
 */
public final native void notify()
/**
 * native 方法，并且不能重写。跟 notify 一样，唯一的区别就是会唤醒在此对象监视器上等待的所有线程，而不是一个线程。
 */
public final native void notifyAll()
/**
 * native方法，并且不能重写。暂停线程的执行。注意：sleep 方法没有释放锁，而 wait 方法释放了锁 ，timeout 是等待时间。
 */
public final native void wait(long timeout) throws InterruptedException
/**
 * 多了 nanos 参数，这个参数表示额外时间（以纳秒为单位，范围是 0-999999）。 所以超时的时间还需要加上 nanos 纳秒。。
 */
public final void wait(long timeout, int nanos) throws InterruptedException
/**
 * 跟之前的2个wait方法一样，只不过该方法一直等待，没有超时时间这个概念
 */
public final void wait() throws InterruptedException
/**
 * 实例被垃圾回收器回收的时候触发的操作
 */
protected void finalize() throws Throwable { }
```

----------------------------------------

TITLE: WebSocket Configuration in Spring Boot
DESCRIPTION: Configuration class to register WebSocket endpoints in Spring Boot application.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/web-real-time-message-push.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
@Configuration
public class WebSocketConfiguration {
    @Bean
    public ServerEndpointExporter serverEndpointExporter() {
        return new ServerEndpointExporter();
    }
}
```

----------------------------------------

TITLE: Non-Atomic Compound Operations Example
DESCRIPTION: Example demonstrating how compound operations on ConcurrentHashMap are not atomic by default, showing potential race conditions
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
// 线程 A
if (!map.containsKey(key)) {
map.put(key, value);
}
// 线程 B
if (!map.containsKey(key)) {
map.put(key, anotherValue);
}
```

----------------------------------------

TITLE: replaceStaleEntry Method for Handling Stale Entries in ThreadLocalMap
DESCRIPTION: This method replaces stale entries in the ThreadLocalMap. It performs backward and forward scanning to find and clean stale entries, handles key replacement, and optimizes entry positions to improve lookup performance.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
private void replaceStaleEntry(ThreadLocal<?> key, Object value,
                                       int staleSlot) {
    Entry[] tab = table;
    int len = tab.length;
    Entry e;

    int slotToExpunge = staleSlot;
    for (int i = prevIndex(staleSlot, len);
         (e = tab[i]) != null;
         i = prevIndex(i, len))

        if (e.get() == null)
            slotToExpunge = i;

    for (int i = nextIndex(staleSlot, len);
         (e = tab[i]) != null;
         i = nextIndex(i, len)) {

        ThreadLocal<?> k = e.get();

        if (k == key) {
            e.value = value;

            tab[i] = tab[staleSlot];
            tab[staleSlot] = e;

            if (slotToExpunge == staleSlot)
                slotToExpunge = i;
            cleanSomeSlots(expungeStaleEntry(slotToExpunge), len);
            return;
        }

        if (k == null && slotToExpunge == staleSlot)
            slotToExpunge = i;
    }

    tab[staleSlot].value = null;
    tab[staleSlot] = new Entry(key, value);

    if (slotToExpunge != staleSlot)
        cleanSomeSlots(expungeStaleEntry(slotToExpunge), len);
}
```

----------------------------------------

TITLE: String.intern() Method Usage and Examples
DESCRIPTION: This code demonstrates how the intern() method works with string objects. The method returns a reference to the canonical representation of the string from the string constant pool, either by returning an existing reference or adding one if it doesn't exist.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_20

LANGUAGE: java
CODE:
```
// s1 指向字符串常量池中的 "Java" 对象
String s1 = "Java";
// s2 也指向字符串常量池中的 "Java" 对象，和 s1 是同一个对象
String s2 = s1.intern();
// 在堆中创建一个新的 "Java" 对象，s3 指向它
String s3 = new String("Java");
// s4 指向字符串常量池中的 "Java" 对象，和 s1 是同一个对象
String s4 = s3.intern();
// s1 和 s2 指向的是同一个常量池中的对象
System.out.println(s1 == s2); // true
// s3 指向堆中的对象，s4 指向常量池中的对象，所以不同
System.out.println(s3 == s4); // false
// s1 和 s4 都指向常量池中的同一个对象
System.out.println(s1 == s4); // true
```

----------------------------------------

TITLE: Creating and Sending Cookies in Java Servlets
DESCRIPTION: This code demonstrates how to create a new Cookie object, set its expiration time, and add it to the HTTP response to be sent to the client. The example sets a cookie named "name" with a value, and configures it to expire after 24 hours.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/J2EE基础知识.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
Cookie c =new Cookie("name","value"); //创建Cookie
c.setMaxAge(60*60*24); //设置最大时效，此处设置的最大时效为一天
response.addCookie(c); //把Cookie放入到HTTP响应中
```

----------------------------------------

TITLE: Calculating Power Function with Binary Exponentiation in Java
DESCRIPTION: This code implements a power function using binary exponentiation (divide and conquer) to efficiently calculate base^exponent. It handles edge cases like negative exponents and zero base cases. The algorithm achieves O(log n) time complexity through recursive halving of the exponent.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
public class Solution {
      boolean invalidInput=false;
      public double Power(double base, int exponent) {
          //如果底数等于0并且指数小于0
          //由于base为double型，不能直接用==判断
        if(equal(base,0.0)&&exponent<0){
            invalidInput=true;
            return 0.0;
        }
        int absexponent=exponent;
         //如果指数小于0，将指数转正
        if(exponent<0)
            absexponent=-exponent;
         //getPower方法求出base的exponent次方。
        double res=getPower(base,absexponent);
         //如果指数小于0，所得结果为上面求的结果的倒数
        if(exponent<0)
            res=1.0/res;
        return res;
  }
    //比较两个double型变量是否相等的方法
    boolean equal(double num1,double num2){
        if(num1-num2>-0.000001&&num1-num2<0.000001)
            return true;
        else
            return false;
    }
    //求出b的e次方的方法
    double getPower(double b,int e){
        //如果指数为0，返回1
        if(e==0)
            return 1.0;
        //如果指数为1，返回b
        if(e==1)
            return b;
        //e>>1相等于e/2，这里就是求a^n =（a^n/2）*（a^n/2）
        double result=getPower(b,e>>1);
        result*=result;
        //如果指数n为奇数，则要再乘一次底数base
        if((e&1)==1)
            result*=b;
        return result;
    }
}
```

----------------------------------------

TITLE: AtomicInteger Implementation using CAS
DESCRIPTION: Core implementation of AtomicInteger class showing how Unsafe methods are used for atomic operations and field management
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/cas.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
private static final Unsafe unsafe = Unsafe.getUnsafe();
private static final long valueOffset;

static {
    try {
        valueOffset = unsafe.objectFieldOffset
            (AtomicInteger.class.getDeclaredField("value"));
    } catch (Exception ex) { throw new Error(ex); }
}
private volatile int value;

public final boolean compareAndSet(int expect, int update) {
    return unsafe.compareAndSwapInt(this, valueOffset, expect, update);
}

public final int getAndAdd(int delta) {
    return unsafe.getAndAddInt(this, valueOffset, delta);
}

public final int getAndIncrement() {
    return unsafe.getAndAddInt(this, valueOffset, 1);
}

public final int getAndDecrement() {
    return unsafe.getAndAddInt(this, valueOffset, -1);
}
```

----------------------------------------

TITLE: LinkedList Initialization Methods
DESCRIPTION: Constructor implementations for LinkedList, including empty constructor and collection-based initialization.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public LinkedList() {
}

public LinkedList(Collection<? extends E> c) {
    this();
    addAll(c);
}
```

----------------------------------------

TITLE: Using ExecutorService submit() Method with Future in Java
DESCRIPTION: Example of using the submit() method of ExecutorService to submit a task and obtain a Future object for handling the result.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-summary.md#2025-04-20_snippet_6

LANGUAGE: Java
CODE:
```
// 这里只是为了演示使用，推荐使用 `ThreadPoolExecutor` 构造方法来创建线程池。
ExecutorService executorService = Executors.newFixedThreadPool(3);

Future<String> submit = executorService.submit(() -> {
    try {
        Thread.sleep(5000L);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    return "abc";
});

String s = submit.get();
System.out.println(s);
executorService.shutdown();
```

----------------------------------------

TITLE: HashMap Node Class Implementation
DESCRIPTION: Basic node structure used in HashMap for storing key-value pairs and linking nodes in the bucket.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
static class Node<K,V> implements Map.Entry<K,V> {
    final int hash;
    final K key;
    V value;
    Node<K,V> next;
    Node(int hash, K key, V value, Node<K,V> next) {
        this.hash = hash;
        this.key = key;
        this.value = value;
        this.next = next;
    }
    public final K getKey()        { return key; }
    public final V getValue()      { return value; }
    public final String toString() { return key + "=" + value; }
    public final int hashCode() {
        return Objects.hashCode(key) ^ Objects.hashCode(value);
    }
    public final V setValue(V newValue) {
        V oldValue = value;
        value = newValue;
        return oldValue;
    }
    public final boolean equals(Object o) {
        if (o == this)
            return true;
        if (o instanceof Map.Entry) {
            Map.Entry<?,?> e = (Map.Entry<?,?>)o;
            if (Objects.equals(key, e.getKey()) &&
                Objects.equals(value, e.getValue()))
                return true;
        }
        return false;
    }
}
```

----------------------------------------

TITLE: 使用Redisson实现手动设置过期时间的分布式锁
DESCRIPTION: 展示了如何使用Redisson为分布式锁手动设置过期时间。此方式不会使用Watch Dog自动续期机制，锁到期会自动释放。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
// 手动给锁设置过期时间，不具备 Watch Dog 自动续期机制
lock.lock(10, TimeUnit.SECONDS);
```

----------------------------------------

TITLE: Implementing a Stack Using Array in Java
DESCRIPTION: Implements a basic stack data structure using an array in Java, including methods for push, pop, peek, isEmpty, and size.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/linear-data-structure.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
public class MyStack {
    private int[] storage;//存放栈中元素的数组
    private int capacity;//栈的容量
    private int count;//栈中元素数量
    private static final int GROW_FACTOR = 2;

    //不带初始容量的构造方法。默认容量为8
    public MyStack() {
        this.capacity = 8;
        this.storage=new int[8];
        this.count = 0;
    }

    //带初始容量的构造方法
    public MyStack(int initialCapacity) {
        if (initialCapacity < 1)
            throw new IllegalArgumentException("Capacity too small.");

        this.capacity = initialCapacity;
        this.storage = new int[initialCapacity];
        this.count = 0;
    }

    //入栈
    public void push(int value) {
        if (count == capacity) {
            ensureCapacity();
        }
        storage[count++] = value;
    }

    //确保容量大小
    private void ensureCapacity() {
        int newCapacity = capacity * GROW_FACTOR;
        storage = Arrays.copyOf(storage, newCapacity);
        capacity = newCapacity;
    }

    //返回栈顶元素并出栈
    private int pop() {
        if (count == 0)
            throw new IllegalArgumentException("Stack is empty.");
        count--;
        return storage[count];
    }

    //返回栈顶元素不出栈
    private int peek() {
        if (count == 0){
            throw new IllegalArgumentException("Stack is empty.");
        }else {
            return storage[count-1];
        }
    }

    //判断栈是否为空
    private boolean isEmpty() {
        return count == 0;
    }

    //返回栈中元素的个数
    private int size() {
        return count;
    }

}
```

----------------------------------------

TITLE: Consuming Messages with SimpleConsumer in RocketMQ
DESCRIPTION: Shows how to use SimpleConsumer to consume messages in RocketMQ, including setting up the consumer, receiving messages, and acknowledging consumption.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/rocketmq-questions.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
ClientServiceProvider provider = ClientServiceProvider.loadService();
String topic = "YourTopic";
FilterExpression filterExpression = new FilterExpression("YourFilterTag", FilterExpressionType.TAG);
SimpleConsumer simpleConsumer = provider.newSimpleConsumerBuilder()
        .setConsumerGroup("YourConsumerGroup")
        .setClientConfiguration(ClientConfiguration.newBuilder().setEndpoints("YourEndpoint").build())
        .setSubscriptionExpressions(Collections.singletonMap(topic, filterExpression))
        .setAwaitDuration(Duration.ofSeconds(1))
        .build();
try {
    List<MessageView> messageViewList = simpleConsumer.receive(10, Duration.ofSeconds(30));
    messageViewList.forEach(messageView -> {
        System.out.println(messageView);
        try {
            simpleConsumer.ack(messageView);
        } catch (ClientException e) {
            logger.error("Failed to ack message, messageId={}", messageView.getMessageId(), e);
        }
    });
} catch (ClientException e) {
    logger.error("Failed to receive message", e);
}
```

----------------------------------------

TITLE: AtomicStampedReference compareAndSet Implementation
DESCRIPTION: Implementation of compareAndSet in AtomicStampedReference class to solve the ABA problem using version stamps
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/cas.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
public boolean compareAndSet(V   expectedReference,
                             V   newReference,
                             int expectedStamp,
                             int newStamp) {
    Pair<V> current = pair;
    return
        expectedReference == current.reference &&
        expectedStamp == current.stamp &&
        ((newReference == current.reference &&
          newStamp == current.stamp) ||
         casPair(current, Pair.of(newReference, newStamp)));
}
```

----------------------------------------

TITLE: Testing CopyOnWriteArrayList Methods in Java
DESCRIPTION: A comprehensive test of various CopyOnWriteArrayList methods including add, get, remove, set, size, removeAll, and clear.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/copyonwritearraylist-source-code.md#2025-04-20_snippet_6

LANGUAGE: Java
CODE:
```
CopyOnWriteArrayList<String> list = new CopyOnWriteArrayList<>();

list.add("Java");
list.add("Python");
list.add("C++");
System.out.println("初始列表：" + list);

System.out.println("列表第二个元素为：" + list.get(1));

boolean result = list.remove("C++");
System.out.println("删除结果：" + result);
System.out.println("列表删除元素后为：" + list);

list.set(1, "Golang");
System.out.println("列表更新后为：" + list);

list.add(0, "PHP");
System.out.println("列表插入元素后为：" + list);

System.out.println("列表大小为：" + list.size());

result = list.removeAll(List.of("Java", "Golang"));
System.out.println("批量删除结果：" + result);
System.out.println("列表批量删除元素后为：" + list);

list.clear();
System.out.println("列表清空后为：" + list);
```

----------------------------------------

TITLE: Calculating Bracket Matching Depth (Java)
DESCRIPTION: Implements a method to calculate the depth of a valid bracket sequence. It keeps track of the current depth while iterating through the string and updates the maximum depth encountered.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/string-algorithm-problems.md#2025-04-20_snippet_6

LANGUAGE: Java
CODE:
```
import java.util.Scanner;

public class Main {
  public static void main(String[] args) {
    Scanner sc = new Scanner(System.in);
    String s = sc.nextLine();
    int cnt = 0, max = 0, i;
    for (i = 0; i < s.length(); ++i) {
      if (s.charAt(i) == '(')
        cnt++;
      else
        cnt--;
      max = Math.max(max, cnt);
    }
    sc.close();
    System.out.println(max);
  }
}
```

----------------------------------------

TITLE: Using Enhanced Switch Expressions in Java 14
DESCRIPTION: Demonstrates the use of switch expressions with lambda-like syntax and the yield keyword for returning values from switch blocks.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java14-15.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
String result = switch (day) {
            case "M", "W", "F" -> "MWF";
            case "T", "TH", "S" -> "TTS";
            default -> {
                if(day.isEmpty())
                    yield "Please insert a valid day.";
                else
                    yield "Looks like a Sunday.";
            }

        };
System.out.println(result);
```

----------------------------------------

TITLE: ConcurrentHashMap Parameter Constructor Implementation
DESCRIPTION: Parameterized constructor that initializes ConcurrentHashMap with specified initial capacity, load factor and concurrency level. Handles parameter validation and segment initialization.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/concurrent-hash-map-source-code.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
@SuppressWarnings("unchecked")
public ConcurrentHashMap(int initialCapacity,float loadFactor, int concurrencyLevel) {
    if (!(loadFactor > 0) || initialCapacity < 0 || concurrencyLevel <= 0)
        throw new IllegalArgumentException();
    if (concurrencyLevel > MAX_SEGMENTS)
        concurrencyLevel = MAX_SEGMENTS;
    int sshift = 0;
    int ssize = 1;
    while (ssize < concurrencyLevel) {
        ++sshift;
        ssize <<= 1;
    }
    this.segmentShift = 32 - sshift;
    this.segmentMask = ssize - 1;
    if (initialCapacity > MAXIMUM_CAPACITY)
        initialCapacity = MAXIMUM_CAPACITY;
    int c = initialCapacity / ssize;
    if (c * ssize < initialCapacity)
        ++c;
    int cap = MIN_SEGMENT_TABLE_CAPACITY;
    while (cap < c)
        cap <<= 1;
    Segment<K,V> s0 = new Segment<K,V>(loadFactor, (int)(cap * loadFactor),
                         (HashEntry<K,V>[])new HashEntry[cap]);
    Segment<K,V>[] ss = (Segment<K,V>[])new Segment[ssize];
    UNSAFE.putOrderedObject(ss, SBASE, s0);
    this.segments = ss;
}
```

----------------------------------------

TITLE: Reflection Operations Example
DESCRIPTION: Comprehensive example showing various reflection operations including accessing methods, fields, and invoking private members.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/reflection.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
package cn.javaguide;

import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;

public class Main {
    public static void main(String[] args) throws ClassNotFoundException, NoSuchMethodException, IllegalAccessException, InstantiationException, InvocationTargetException, NoSuchFieldException {
        /**
         * 获取 TargetObject 类的 Class 对象并且创建 TargetObject 类实例
         */
        Class<?> targetClass = Class.forName("cn.javaguide.TargetObject");
        TargetObject targetObject = (TargetObject) targetClass.newInstance();
        /**
         * 获取 TargetObject 类中定义的所有方法
         */
        Method[] methods = targetClass.getDeclaredMethods();
        for (Method method : methods) {
            System.out.println(method.getName());
        }

        /**
         * 获取指定方法并调用
         */
        Method publicMethod = targetClass.getDeclaredMethod("publicMethod",
                String.class);

        publicMethod.invoke(targetObject, "JavaGuide");

        /**
         * 获取指定参数并对参数进行修改
         */
        Field field = targetClass.getDeclaredField("value");
        //为了对类中的参数进行修改我们取消安全检查
        field.setAccessible(true);
        field.set(targetObject, "JavaGuide");

        /**
         * 调用 private 方法
         */
        Method privateMethod = targetClass.getDeclaredMethod("privateMethod");
        //为了调用private方法我们取消安全检查
        privateMethod.setAccessible(true);
        privateMethod.invoke(targetObject);
    }
}
```

----------------------------------------

TITLE: Merging Two Sorted Linked Lists in Java
DESCRIPTION: Recursive implementation to merge two sorted linked lists while maintaining the sorted order. Compares values of nodes and recursively builds the merged list.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/linkedlist-algorithm-problems.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
public class Solution {
  public ListNode Merge(ListNode list1, ListNode list2) {
    if (list1 == null) {
      return list2;
    }
    if (list2 == null) {
      return list1;
    }
    if (list1.val <= list2.val) {
      list1.next = Merge(list1.next, list2);
      return list1;
    } else {
      list2.next = Merge(list1, list2.next);
      return list2;
    }
  }
}
```

----------------------------------------

TITLE: 内部类访问外部类私有属性 (Java)
DESCRIPTION: 展示了内部类如何访问外部类的私有属性。通过反编译可以看到编译器生成了桥接方法来实现这一功能。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class OutterClass {
    private String userName;
    ......
    class InnerClass{
    ......
        public void printOut(){
            System.out.println("Username from OutterClass:"+userName);
        }
    }
}
```

----------------------------------------

TITLE: Writing to a File using FileOutputStream in Java
DESCRIPTION: Shows how to write byte data to a file using FileOutputStream.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-basis.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
try (FileOutputStream output = new FileOutputStream("output.txt")) {
    byte[] array = "JavaGuide".getBytes();
    output.write(array);
} catch (IOException e) {
    e.printStackTrace();
}
```

----------------------------------------

TITLE: Blocking Take Operation in ArrayBlockingQueue
DESCRIPTION: Implementation of blocking take operation that waits until elements are available in the queue before removing and returning an element.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
public E take() throws InterruptedException {
     final ReentrantLock lock = this.lock;
     lock.lockInterruptibly();
     try {
         while (count == 0)
             notEmpty.await();
         return dequeue();
     } finally {
         lock.unlock();
     }
}
```

----------------------------------------

TITLE: Implementing Inorder Traversal for Binary Trees in Java
DESCRIPTION: A recursive implementation of inorder traversal for binary trees. The algorithm first recursively traverses the left subtree, then processes the root node, followed by recursively traversing the right subtree.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/tree.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public void inOrder(TreeNode root){
	if(root == null){
		return;
	}
	inOrder(root.left);
	system.out.println(root.data);
	inOrder(root.right);
}
```

----------------------------------------

TITLE: Incorrect Thread Pool Creation in Java
DESCRIPTION: This code snippet demonstrates an incorrect way of creating a thread pool for each user request, which should be avoided to prevent resource wastage.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-best-practices.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
@GetMapping("wrong")
public String wrong() throws InterruptedException {
    // 自定义线程池
    ThreadPoolExecutor executor = new ThreadPoolExecutor(5,10,1L,TimeUnit.SECONDS,new ArrayBlockingQueue<>(100),new ThreadPoolExecutor.CallerRunsPolicy());

    //  处理任务
    executor.execute(() -> {
      // ......
    }
    return "OK";
}
```

----------------------------------------

TITLE: Blocking Put Operation in ArrayBlockingQueue
DESCRIPTION: Implementation of blocking put operation that waits until space is available in the queue before inserting an element.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
public void put(E e) throws InterruptedException {
    checkNotNull(e);
    final ReentrantLock lock = this.lock;
    lock.lockInterruptibly();
    try {
        while (count == items.length)
            notFull.await();
        enqueue(e);
    } finally {
        lock.unlock();
    }
}
```

----------------------------------------

TITLE: Demonstrating Volatile Non-Atomicity
DESCRIPTION: Example showing that volatile keyword cannot guarantee atomicity of compound operations
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public class VolatileAtomicityDemo {
    public volatile static int inc = 0;

    public void increase() {
        inc++;
    }

    public static void main(String[] args) throws InterruptedException {
        ExecutorService threadPool = Executors.newFixedThreadPool(5);
        VolatileAtomicityDemo volatileAtomicityDemo = new VolatileAtomicityDemo();
        for (int i = 0; i < 5; i++) {
            threadPool.execute(() -> {
                for (int j = 0; j < 500; j++) {
                    volatileAtomicityDemo.increase();
                }
            });
        }
        Thread.sleep(1500);
        System.out.println(inc);
        threadPool.shutdown();
    }
```

----------------------------------------

TITLE: Character Set and Encoding in SQL
DESCRIPTION: Explains how to view and set character sets and encodings for MySQL, databases, tables, and fields.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_4

LANGUAGE: SQL
CODE:
```
/* 字符集编码 */ ------------------
-- MySQL、数据库、表、字段均可设置编码
-- 数据编码与客户端编码不需一致
SHOW VARIABLES LIKE 'character_set_%'   -- 查看所有字符集编码项
    character_set_client        客户端向服务器发送数据时使用的编码
    character_set_results       服务器端将结果返回给客户端所使用的编码
    character_set_connection    连接层编码
SET 变量名 = 变量值
    SET character_set_client = gbk;
    SET character_set_results = gbk;
    SET character_set_connection = gbk;
SET NAMES GBK;  -- 相当于完成以上三个设置
-- 校对集
    校对集用以排序
    SHOW CHARACTER SET [LIKE 'pattern']/SHOW CHARSET [LIKE 'pattern']   查看所有字符集
    SHOW COLLATION [LIKE 'pattern']     查看所有校对集
    CHARSET 字符集编码     设置字符集编码
    COLLATE 校对集编码     设置校对集编码
```

----------------------------------------

TITLE: Adding Elements to CopyOnWriteArrayList in Java
DESCRIPTION: Implementation of the add() method in CopyOnWriteArrayList, demonstrating the Copy-On-Write strategy for thread-safe element insertion.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/copyonwritearraylist-source-code.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public boolean add(E e) {
    final ReentrantLock lock = this.lock;
    lock.lock();
    try {
        Object[] elements = getArray();
        int len = elements.length;
        Object[] newElements = Arrays.copyOf(elements, len + 1);
        newElements[len] = e;
        setArray(newElements);
        return true;
    } finally {
        lock.unlock();
    }
}
```

----------------------------------------

TITLE: Custom Thread Factory Implementation in Java
DESCRIPTION: This code snippet shows how to implement a custom ThreadFactory that sets meaningful thread names, which is useful for problem identification in thread pools.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-best-practices.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
import java.util.concurrent.ThreadFactory;
import java.util.concurrent.atomic.AtomicInteger;

/**
 * 线程工厂，它设置线程名称，有利于我们定位问题。
 */
public final class NamingThreadFactory implements ThreadFactory {

    private final AtomicInteger threadNum = new AtomicInteger();
    private final String name;

    /**
     * 创建一个带名字的线程池生产工厂
     */
    public NamingThreadFactory(String name) {
        this.name = name;
    }

    @Override
    public Thread newThread(Runnable r) {
        Thread t = new Thread(r);
        t.setName(name + " [#" + threadNum.incrementAndGet() + "]");
        return t;
    }
}
```

----------------------------------------

TITLE: Serializing Objects with ObjectOutputStream in Java
DESCRIPTION: Illustrates how to use ObjectOutputStream to write Java objects to an output stream (serialization).
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-basis.md#2025-04-20_snippet_6

LANGUAGE: Java
CODE:
```
ObjectOutputStream output = new ObjectOutputStream(new FileOutputStream("file.txt")
Person person = new Person("Guide哥", "JavaGuide作者");
output.writeObject(person);
```

----------------------------------------

TITLE: Efficient String Concatenation Using StringBuilder
DESCRIPTION: This code demonstrates the recommended way to concatenate strings in a loop by explicitly using a StringBuilder. This approach is more efficient as it reuses the same StringBuilder object for all iterations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_14

LANGUAGE: java
CODE:
```
String[] arr = {"he", "llo", "world"};
StringBuilder s = new StringBuilder();
for (String value : arr) {
    s.append(value);
}
System.out.println(s);
```

----------------------------------------

TITLE: Basic Database Transaction Syntax in MySQL
DESCRIPTION: SQL commands demonstrating the basic structure of a MySQL transaction. This shows how to start a transaction, execute multiple SQL statements, and commit the changes atomically.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_5

LANGUAGE: sql
CODE:
```
# 开启一个事务
START TRANSACTION;
# 多条 SQL 语句
SQL1,SQL2...
## 提交事务
COMMIT;
```

----------------------------------------

TITLE: Implementing Optimistic Locking with LongAdder in Java
DESCRIPTION: Shows how to use the LongAdder class from java.util.concurrent.atomic package to implement optimistic locking. LongAdder provides better performance than AtomicInteger and AtomicLong in high-concurrency scenarios.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/optimistic-lock-and-pessimistic-lock.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
// LongAdder 在高并发场景下会比 AtomicInteger 和 AtomicLong 的性能更好
// 代价就是会消耗更多的内存空间（空间换时间）
LongAdder sum = new LongAdder();
sum.increment();
```

----------------------------------------

TITLE: Setting Key Expiration in Redis
DESCRIPTION: This code demonstrates various ways to set expiration times for Redis keys using the EXPIRE command, SETEX command, and shows how to check remaining time with TTL.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_5

LANGUAGE: bash
CODE:
```
127.0.0.1:6379> expire key 60 # 数据在 60s 后过期
(integer) 1
127.0.0.1:6379> setex key 60 value # 数据在 60s 后过期 (setex:[set] + [ex]pire)
OK
127.0.0.1:6379> ttl key # 查看数据还有多久过期
(integer) 56
```

----------------------------------------

TITLE: Synchronized Method Example
DESCRIPTION: Demonstrates synchronized method reentrance using a simple class with two synchronized methods
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_13

LANGUAGE: java
CODE:
```
public class SynchronizedDemo {
    public synchronized void method1() {
        System.out.println("方法1");
        method2();
    }

    public synchronized void method2() {
        System.out.println("方法2");
    }
}
```

----------------------------------------

TITLE: Non-blocking Poll Operation in ArrayBlockingQueue
DESCRIPTION: Implementation of non-blocking poll operation that immediately returns null if the queue is empty instead of waiting.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_14

LANGUAGE: java
CODE:
```
public E poll() {
        final ReentrantLock lock = this.lock;
        lock.lock();
        try {
            return (count == 0) ? null : dequeue();
        } finally {
            lock.unlock();
        }
    }
```

----------------------------------------

TITLE: Creating ByteBuffer Instances in Java NIO
DESCRIPTION: Demonstrates two static methods to create ByteBuffer instances: allocate() for heap memory allocation and allocateDirect() for direct memory allocation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/nio-basis.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
// Allocate heap memory
public static ByteBuffer allocate(int capacity);
// Allocate direct memory
public static ByteBuffer allocateDirect(int capacity);
```

----------------------------------------

TITLE: Querying Transaction Isolation Level in MySQL
DESCRIPTION: This SQL snippet demonstrates how to check the current transaction isolation level in MySQL. It uses the @@tx_isolation system variable for MySQL versions prior to 8.0, and @@transaction_isolation for MySQL 8.0 and later.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_6

LANGUAGE: sql
CODE:
```
SELECT @@tx_isolation;
```

----------------------------------------

TITLE: Finding Longest Palindromic Substring (Java)
DESCRIPTION: Implements a method to find the longest palindromic substring in a given string. It uses the expand around center approach, checking both odd and even length palindromes for each character as the center.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/string-algorithm-problems.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
class Solution {
  private int index, len;

  public String longestPalindrome(String s) {
    if (s.length() < 2)
      return s;
    for (int i = 0; i < s.length() - 1; i++) {
      PalindromeHelper(s, i, i);
      PalindromeHelper(s, i, i + 1);
    }
    return s.substring(index, index + len);
  }

  public void PalindromeHelper(String s, int l, int r) {
    while (l >= 0 && r < s.length() && s.charAt(l) == s.charAt(r)) {
      l--;
      r++;
    }
    if (len < r - l - 1) {
      index = l + 1;
      len = r - l - 1;
    }
  }
}
```

----------------------------------------

TITLE: expungeStaleEntry Method for Probe-based Cleaning in ThreadLocalMap
DESCRIPTION: Implements probe-based cleaning of stale entries in ThreadLocalMap. It removes entries with null keys, rehashes and repositions valid entries to optimize their location, and returns the index where the scan stopped.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
private int expungeStaleEntry(int staleSlot) {
    Entry[] tab = table;
    int len = tab.length;

    tab[staleSlot].value = null;
    tab[staleSlot] = null;
    size--;

    Entry e;
    int i;
    for (i = nextIndex(staleSlot, len);
         (e = tab[i]) != null;
         i = nextIndex(i, len)) {
        ThreadLocal<?> k = e.get();
        if (k == null) {
            e.value = null;
            tab[i] = null;
            size--;
        } else {
            int h = k.threadLocalHashCode & (len - 1);
            if (h != i) {
                tab[i] = null;

                while (tab[h] != null)
                    h = nextIndex(h, len);
                tab[h] = e;
            }
        }
    }
    return i;
}
```

----------------------------------------

TITLE: Using Non-Blocking offer() and poll() Methods with ArrayBlockingQueue in Java
DESCRIPTION: Shows usage of non-blocking offer() and poll() methods with ArrayBlockingQueue. Demonstrates behavior when queue is full or empty.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
public class OfferPollExample {

    public static void main(String[] args) {
        // 创建一个大小为 3 的 ArrayBlockingQueue
        ArrayBlockingQueue<String> queue = new ArrayBlockingQueue<>(3);

        // 向队列中添加元素
        System.out.println(queue.offer("A"));
        System.out.println(queue.offer("B"));
        System.out.println(queue.offer("C"));

        // 尝试向队列中添加元素，但队列已满，返回 false
        System.out.println(queue.offer("D"));

        // 从队列中取出元素
        System.out.println(queue.poll());
        System.out.println(queue.poll());
        System.out.println(queue.poll());

        // 尝试从队列中取出元素，但队列已空，返回 null
        System.out.println(queue.poll());
    }

}
```

----------------------------------------

TITLE: Searching Element in Skip List in Java
DESCRIPTION: Implements the get method to search for an element in the skip list, traversing levels efficiently.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-skiplist.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
public Node get(int value) {
    Node p = h;
    for (int i = levelCount - 1; i >= 0; i--) {
        while (p.forwards[i] != null && p.forwards[i].data < value) {
            p = p.forwards[i];
        }
    }
    if (p.forwards[0] != null && p.forwards[0].data == value) {
        return p.forwards[0];
    }
    return null;
}
```

----------------------------------------

TITLE: Checking Collection Emptiness in Java
DESCRIPTION: Demonstrates the proper way to check if a collection is empty using the isEmpty() method instead of size() == 0. Explains why isEmpty() is preferred, especially for certain concurrent collections like ConcurrentLinkedQueue.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public boolean isEmpty() { return first() == null; }

Node<E> first() {
    restartFromHead:
    for (;;) {
        for (Node<E> h = head, p = h, q;;) {
            boolean hasItem = (p.item != null);
            if (hasItem || (q = p.next) == null) {  // 当前节点值不为空 或 到达队尾
                updateHead(h, p);  // 将head设置为p
                return hasItem ? p : null;
            }
            else if (p == q) continue restartFromHead;
            else p = q;  // p = p.next
        }
    }
}
```

----------------------------------------

TITLE: Implementing NTILE() Window Function for Data Bucketing in MySQL
DESCRIPTION: Demonstrates the use of NTILE() function to divide the result set into a specified number of approximately equal buckets, assigning a bucket number to each row.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_3

LANGUAGE: sql
CODE:
```
SELECT col1, col2, NTILE(4) OVER (ORDER BY col1) AS bucket
FROM table;
```

----------------------------------------

TITLE: Applying RANK() Window Function for Ranking in MySQL
DESCRIPTION: Shows the usage of the RANK() function to calculate the rank of each row within a result set, based on the ordering of a specified column.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_1

LANGUAGE: sql
CODE:
```
SELECT col1, col2, RANK() OVER (ORDER BY col1 DESC) AS ranking
FROM table;
```

----------------------------------------

TITLE: Implementing Runnable Interface for Thread Pool Tasks in Java
DESCRIPTION: This class implements the Runnable interface to define tasks that can be executed by the thread pool. It simulates a task that takes about 5 seconds to complete and logs the start and end times.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-summary.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
import java.util.Date;

/**
 * 这是一个简单的Runnable类，需要大约5秒钟来执行其任务。
 * @author shuang.kou
 */
public class MyRunnable implements Runnable {

    private String command;

    public MyRunnable(String s) {
        this.command = s;
    }

    @Override
    public void run() {
        System.out.println(Thread.currentThread().getName() + " Start. Time = " + new Date());
        processCommand();
        System.out.println(Thread.currentThread().getName() + " End. Time = " + new Date());
    }

    private void processCommand() {
        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

    @Override
    public String toString() {
        return this.command;
    }
}
```

----------------------------------------

TITLE: Implementing AbstractStringBuilder in Java
DESCRIPTION: This code snippet shows the implementation of the AbstractStringBuilder class, which is the parent class of StringBuilder and StringBuffer, demonstrating the mutable nature of these classes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
abstract class AbstractStringBuilder implements Appendable, CharSequence {
    char[] value;
    public AbstractStringBuilder append(String str) {
        if (str == null)
            return appendNull();
        int len = str.length();
        ensureCapacityInternal(count + len);
        str.getChars(0, len, value, count);
        count += len;
        return this;
    }
    //...
}
```

----------------------------------------

TITLE: AOP Logging Aspect Implementation
DESCRIPTION: Implementation of logging aspect using Spring AOP with pointcut and around advice
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/ioc-and-aop.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
@Component
@Aspect
public class LogAspect {
  @Pointcut("@annotation(cn.javaguide.annotation.Log)")
  public void webLog() {
  }

  @Around("webLog()")
  public Object doAround(ProceedingJoinPoint joinPoint) throws Throwable {
    // 省略具体的处理逻辑
  }
}
```

----------------------------------------

TITLE: Implementing Fibonacci Sequence with Iteration in Java
DESCRIPTION: This code implements the Fibonacci sequence calculation using an iterative approach to avoid stack overflow issues that would occur with recursion. The solution has O(n) time complexity and O(1) space complexity as it only stores the previous two values in the sequence.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
int Fibonacci(int number) {
    if (number <= 0) {
        return 0;
    }
    if (number == 1 || number == 2) {
        return 1;
    }
    int first = 1, second = 1, third = 0;
    for (int i = 3; i <= number; i++) {
        third = first + second;
        first = second;
        second = third;
    }
    return third;
}
```

----------------------------------------

TITLE: 使用Lua脚本安全释放Redis分布式锁
DESCRIPTION: 通过Lua脚本实现安全释放Redis分布式锁，通过比较锁的value值来确保只释放自己的锁，避免锁被错误释放的问题。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_2

LANGUAGE: lua
CODE:
```
// 释放锁时，先比较锁对应的 value 值是否相等，避免锁的误释放
if redis.call("get",KEYS[1]) == ARGV[1] then
    return redis.call("del",KEYS[1])
else
    return 0
end
```

----------------------------------------

TITLE: Demonstrating Local and Instance Variables in Java
DESCRIPTION: A simple Java class showing the difference between instance variables and local variables in terms of memory allocation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-intro.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
public class Person {
    int a = 1;

    public void doSomething() {
        int b = 2;
    }
}
```

----------------------------------------

TITLE: Unsafe getAndAddInt Implementation
DESCRIPTION: Implementation of getAndAddInt method in Unsafe class showing the spin-lock mechanism used for atomic operations
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/cas.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public final int getAndAddInt(Object o, long offset, int delta) {
    int v;
    do {
        v = getIntVolatile(o, offset);
    } while (!compareAndSwapInt(o, offset, v, v + delta));
    return v;
}
```

----------------------------------------

TITLE: CAS Operations in Unsafe Class
DESCRIPTION: Native CompareAndSwap methods provided by Unsafe class for atomic operations on different data types
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
public final native boolean compareAndSwapObject(Object o, long offset,  Object expected, Object update);

public final native boolean compareAndSwapInt(Object o, long offset, int expected,int update);

public final native boolean compareAndSwapLong(Object o, long offset, long expected, long update);
```

----------------------------------------

TITLE: LinkedList Element Removal Operations
DESCRIPTION: Implementation of various remove methods to delete elements from different positions in the LinkedList.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
public E removeFirst() {
    final Node<E> f = first;
    if (f == null)
        throw new NoSuchElementException();
    return unlinkFirst(f);
}

public E removeLast() {
    final Node<E> l = last;
    if (l == null)
        throw new NoSuchElementException();
    return unlinkLast(l);
}

public boolean remove(Object o) {
    if (o == null) {
        for (Node<E> x = first; x != null; x = x.next) {
            if (x.item == null) {
                unlink(x);
                return true;
            }
        }
    } else {
        for (Node<E> x = first; x != null; x = x.next) {
            if (o.equals(x.item)) {
                unlink(x);
                return true;
            }
        }
    }
    return false;
}
```

----------------------------------------

TITLE: Implementing DelayedTask Class
DESCRIPTION: Custom implementation of Delayed interface for creating delayed tasks with execution time and task logic.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/delayqueue-source-code.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class DelayedTask implements Delayed {
    private long executeTime;
    private Runnable task;

    public DelayedTask(long delay, Runnable task) {
        this.executeTime = System.currentTimeMillis() + delay;
        this.task = task;
    }

    @Override
    public long getDelay(TimeUnit unit) {
        return unit.convert(executeTime - System.currentTimeMillis(), TimeUnit.MILLISECONDS);
    }

    @Override
    public int compareTo(Delayed o) {
        return Long.compare(this.executeTime, ((DelayedTask) o).executeTime);
    }

    public void execute() {
        task.run();
    }
}
```

----------------------------------------

TITLE: Data Migration Using INSERT SELECT in SQL
DESCRIPTION: Shows how to copy historical exam records from one table to another based on a year condition using INSERT SELECT statement.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_1

LANGUAGE: SQL
CODE:
```
INSERT INTO exam_record_before_2021 (uid, exam_id, start_time, submit_time, score)
SELECT uid,exam_id,start_time,submit_time,score
FROM exam_record
WHERE YEAR(submit_time) < 2021;
```

----------------------------------------

TITLE: Hash Function Implementation in JDK 1.8
DESCRIPTION: Implementation of the hash function in HashMap for JDK 1.8. Uses XOR operation between hashCode and its 16-bit right shift to generate final hash value.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
static final int hash(Object key) {
  int h;
  return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
}
```

----------------------------------------

TITLE: Demonstrating Float Precision Loss in Java
DESCRIPTION: Example showing how float calculations can lead to precision loss when working with decimal numbers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/bigdecimal.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
float a = 2.0f - 1.9f;
float b = 1.8f - 1.7f;
System.out.println(a);// 0.100000024
System.out.println(b);// 0.099999905
System.out.println(a == b);// false
```

----------------------------------------

TITLE: Observer Pattern in Spring's Event-Driven Model
DESCRIPTION: Implementation of the Observer pattern in Spring's event-driven model with three key components: the event (DemoEvent), the listener (DemoListener), and the publisher (DemoPublisher). This pattern is used for decoupling code in Spring applications.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-design-patterns-summary.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
// 定义一个事件,继承自ApplicationEvent并且写相应的构造函数
public class DemoEvent extends ApplicationEvent{
    private static final long serialVersionUID = 1L;

    private String message;

    public DemoEvent(Object source,String message){
        super(source);
        this.message = message;
    }

    public String getMessage() {
         return message;
          }


// 定义一个事件监听者,实现ApplicationListener接口，重写 onApplicationEvent() 方法；
@Component
public class DemoListener implements ApplicationListener<DemoEvent>{

    //使用onApplicationEvent接收消息
    @Override
    public void onApplicationEvent(DemoEvent event) {
        String msg = event.getMessage();
        System.out.println("接收到的信息是："+msg);
    }

}
// 发布事件，可以通过ApplicationEventPublisher  的 publishEvent() 方法发布消息。
@Component
public class DemoPublisher {

    @Autowired
    ApplicationContext applicationContext;

    public void publish(String message){
        //发布事件
        applicationContext.publishEvent(new DemoEvent(this, message));
    }
}
```

----------------------------------------

TITLE: Removing Nth Node from End of List in Java
DESCRIPTION: Two implementations for removing the nth node from end: 1) Two-pass solution using dummy node 2) One-pass solution using two pointers n nodes apart.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/linkedlist-algorithm-problems.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
public class Solution {
  public ListNode removeNthFromEnd(ListNode head, int n) {
    // 哑结点，哑结点用来简化某些极端情况，例如列表中只含有一个结点，或需要删除列表的头部
    ListNode dummy = new ListNode(0);
    // 哑结点指向头结点
    dummy.next = head;
    // 保存链表长度
    int length = 0;
    ListNode len = head;
    while (len != null) {
      length++;
      len = len.next;
    }
    length = length - n;
    ListNode target = dummy;
    // 找到 L-n 位置的节点
    while (length > 0) {
      target = target.next;
      length--;
    }
    // 把第 (L - n)个结点的 next 指针重新链接至第 (L - n + 2)个结点
    target.next = target.next.next;
    return dummy.next;
  }
}
```

LANGUAGE: java
CODE:
```
public class Solution {
  public ListNode removeNthFromEnd(ListNode head, int n) {

    ListNode dummy = new ListNode(0);
    dummy.next = head;
    // 声明两个指向头结点的节点
    ListNode node1 = dummy, node2 = dummy;

    // node1 节点先跑，node1节点 跑到第 n 个节点的时候,node2 节点开始跑
    // 当node1 节点跑到最后一个节点时，node2 节点所在的位置就是第 （L-n ） 个节点，也就是倒数第 n+1（L代表总链表长度）
    while (node1 != null) {
      node1 = node1.next;
      if (n < 1 && node1 != null) {
        node2 = node2.next;
      }
      n--;
    }

    node2.next = node2.next.next;

    return dummy.next;

  }
}
```

----------------------------------------

TITLE: resize Method for Growing ThreadLocalMap in Java
DESCRIPTION: Implements the table resizing operation for ThreadLocalMap. It doubles the table size, rehashes all valid entries into the new table, skips stale entries, and updates the threshold for future resizing.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
private void resize() {
    Entry[] oldTab = table;
    int oldLen = oldTab.length;
    int newLen = oldLen * 2;
    Entry[] newTab = new Entry[newLen];
    int count = 0;

    for (int j = 0; j < oldLen; ++j) {
        Entry e = oldTab[j];
        if (e != null) {
            ThreadLocal<?> k = e.get();
            if (k == null) {
                e.value = null;
            } else {
                int h = k.threadLocalHashCode & (newLen - 1);
                while (newTab[h] != null)
                    h = nextIndex(h, newLen);
                newTab[h] = e;
                count++;
            }
        }
    }

    setThreshold(newLen);
    size = count;
    table = newTab;
}
```

----------------------------------------

TITLE: Using ExecutorService submit() Method with Timeout in Java
DESCRIPTION: Example of using the submit() method of ExecutorService with a timeout to handle long-running tasks.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-summary.md#2025-04-20_snippet_7

LANGUAGE: Java
CODE:
```
ExecutorService executorService = Executors.newFixedThreadPool(3);

Future<String> submit = executorService.submit(() -> {
    try {
        Thread.sleep(5000L);
    } catch (InterruptedException e) {
        e.printStackTrace();
    }
    return "abc";
});

String s = submit.get(3, TimeUnit.SECONDS);
System.out.println(s);
executorService.shutdown();
```

----------------------------------------

TITLE: Implementing WebSocket Server in Spring Boot
DESCRIPTION: WebSocket server implementation using @ServerEndpoint annotation to handle WebSocket connections, messages and sessions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/web-real-time-message-push.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
@Component
@Slf4j
@ServerEndpoint("/websocket/{userId}")
public class WebSocketServer {
    private Session session;
    private static final CopyOnWriteArraySet<WebSocketServer> webSockets = new CopyOnWriteArraySet<>();
    private static final Map<String, Session> sessionPool = new HashMap<String, Session>();
    
    @OnOpen
    public void onOpen(Session session, @PathParam(value = "userId") String userId) {
        try {
            this.session = session;
            webSockets.add(this);
            sessionPool.put(userId, session);
            log.info("websocket消息: 有新的连接，总数为:" + webSockets.size());
        } catch (Exception e) {
        }
    }
    
    @OnMessage
    public void onMessage(String message) {
        log.info("websocket消息: 收到客户端消息:" + message);
    }
    
    public void sendOneMessage(String userId, String message) {
        Session session = sessionPool.get(userId);
        if (session != null && session.isOpen()) {
            try {
                log.info("websocket消: 单点消息:" + message);
                session.getAsyncRemote().sendText(message);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
}
```

----------------------------------------

TITLE: Implementing Switch Pattern Matching in Java
DESCRIPTION: This code shows how switch pattern matching can be used to simplify type checking and casting in switch statements, making the code more concise and readable.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java20.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
static String formatterPatternSwitch(Object o) {
    return switch (o) {
        case Integer i -> String.format("int %d", i);
        case Long l    -> String.format("long %d", l);
        case Double d  -> String.format("double %f", d);
        case String s  -> String.format("String %s", s);
        default        -> o.toString();
    };
}
```

----------------------------------------

TITLE: Adding Elements to ArrayList in Java
DESCRIPTION: This snippet shows the add method of ArrayList, which appends an element to the end of the list. It demonstrates how ArrayList ensures capacity before adding an element and performs the actual addition.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
/**
* 将指定的元素追加到此列表的末尾。
*/
public boolean add(E e) {
    // 加元素之前，先调用ensureCapacityInternal方法
    ensureCapacityInternal(size + 1);  // Increments modCount!!
    // 这里看到ArrayList添加元素的实质就相当于为数组赋值
    elementData[size++] = e;
    return true;
}
```

----------------------------------------

TITLE: StampedLock Core Locking Methods
DESCRIPTION: Implementation of the three main locking mechanisms in StampedLock: writeLock, readLock, and optimistic read.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_17

LANGUAGE: java
CODE:
```
// 写锁
public long writeLock() {
    long s, next;  // bypass acquireWrite in fully unlocked case only
    return ((((s = state) & ABITS) == 0L &&
             U.compareAndSwapLong(this, STATE, s, next = s + WBIT)) ?
            next : acquireWrite(false, 0L));
}
// 读锁
public long readLock() {
    long s = state, next;  // bypass acquireRead on common uncontended case
    return ((whead == wtail && (s & ABITS) < RFULL &&
             U.compareAndSwapLong(this, STATE, s, next = s + RUNIT)) ?
            next : acquireRead(false, 0L));
}
// 乐观读
public long tryOptimisticRead() {
    long s;
    return (((s = state) & WBIT) == 0L) ? (s & SBITS) : 0L;
}
```

----------------------------------------

TITLE: Implementing ThreadPoolExecutor addWorker() Method in Java
DESCRIPTION: Implementation of the addWorker() method in ThreadPoolExecutor, which handles creating and starting new worker threads in the thread pool.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-summary.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
// 全局锁，并发操作必备
private final ReentrantLock mainLock = new ReentrantLock();
// 跟踪线程池的最大大小，只有在持有全局锁mainLock的前提下才能访问此集合
private int largestPoolSize;
// 工作线程集合，存放线程池中所有的（活跃的）工作线程，只有在持有全局锁mainLock的前提下才能访问此集合
private final HashSet<Worker> workers = new HashSet<>();
//获取线程池状态
private static int runStateOf(int c)     { return c & ~CAPACITY; }
//判断线程池的状态是否为 Running
private static boolean isRunning(int c) {
    return c < SHUTDOWN;
}


/**
 * 添加新的工作线程到线程池
 * @param firstTask 要执行
 * @param core参数为true的话表示使用线程池的基本大小，为false使用线程池最大大小
 * @return 添加成功就返回true否则返回false
 */
private boolean addWorker(Runnable firstTask, boolean core) {
    retry:
    for (;;) {
        //这两句用来获取线程池的状态
        int c = ctl.get();
        int rs = runStateOf(c);

        // Check if queue empty only if necessary.
        if (rs >= SHUTDOWN &&
            ! (rs == SHUTDOWN &&
               firstTask == null &&
               ! workQueue.isEmpty()))
            return false;

        for (;;) {
           //获取线程池中工作的线程的数量
            int wc = workerCountOf(c);
            // core参数为false的话表明队列也满了，线程池大小变为 maximumPoolSize
            if (wc >= CAPACITY ||
                wc >= (core ? corePoolSize : maximumPoolSize))
                return false;
           //原子操作将workcount的数量加1
            if (compareAndIncrementWorkerCount(c))
                break retry;
            // 如果线程的状态改变了就再次执行上述操作
            c = ctl.get();
            if (runStateOf(c) != rs)
                continue retry;
            // else CAS failed due to workerCount change; retry inner loop
        }
    }
    // 标记工作线程是否启动成功
    boolean workerStarted = false;
    // 标记工作线程是否创建成功
    boolean workerAdded = false;
    Worker w = null;
    try {

        w = new Worker(firstTask);
        final Thread t = w.thread;
        if (t != null) {
          // 加锁
            final ReentrantLock mainLock = this.mainLock;
            mainLock.lock();
            try {
               //获取线程池状态
                int rs = runStateOf(ctl.get());
               //rs < SHUTDOWN 如果线程池状态依然为RUNNING,并且线程的状态是存活的话，就会将工作线程添加到工作线程集合中
              //(rs=SHUTDOWN && firstTask == null)如果线程池状态小于STOP，也就是RUNNING或者SHUTDOWN状态下，同时传入的任务实例firstTask为null，则需要添加到工作线程集合和启动新的Worker
               // firstTask == null证明只新建线程而不执行任务
                if (rs < SHUTDOWN ||
                    (rs == SHUTDOWN && firstTask == null)) {
                    if (t.isAlive()) // precheck that t is startable
                        throw new IllegalThreadStateException();
                    workers.add(w);
                   //更新当前工作线程的最大容量
                    int s = workers.size();
                    if (s > largestPoolSize)
                        largestPoolSize = s;
                  // 工作线程是否启动成功
                    workerAdded = true;
                }
            } finally {
                // 释放锁
                mainLock.unlock();
            }
            //// 如果成功添加工作线程，则调用Worker内部的线程实例t的Thread#start()方法启动真实的线程实例
            if (workerAdded) {
                t.start();
              /// 标记线程启动成功
                workerStarted = true;
            }
        }
    } finally {
       // 线程启动失败，需要从工作线程中移除对应的Worker
        if (! workerStarted)
            addWorkerFailed(w);
    }
    return workerStarted;
}
```

----------------------------------------

TITLE: Pattern Matching with instanceof and switch in Java 23
DESCRIPTION: Demonstrates the extended pattern matching capabilities for primitive types in instanceof and switch statements, which now support byte, short, char, int, long, float, double, and boolean.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java22-23.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
// 传统写法
if (i >= -128 && i <= 127) {
    byte b = (byte)i;
}

// 使用 instanceof
if (i instanceof byte b) {
    // Use b
}
```

----------------------------------------

TITLE: Using ApplicationContext Factory Pattern in Spring
DESCRIPTION: Example of using Spring's ApplicationContext implementation of the Factory pattern to create a bean object. This demonstrates the FileSystemXmlApplicationContext implementation to load context definition from an XML file in the file system.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-design-patterns-summary.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.FileSystemXmlApplicationContext;

public class App {
  public static void main(String[] args) {
    ApplicationContext context = new FileSystemXmlApplicationContext(
        "C:/work/IOC Containers/springframework.applicationcontext/src/main/resources/bean-factory-config.xml");

    HelloApplicationContext obj = (HelloApplicationContext) context.getBean("helloApplicationContext");
    obj.getMsg();
  }
}
```

----------------------------------------

TITLE: Implementing SHA-256 Hashing Algorithm in Java
DESCRIPTION: A Java implementation of the SHA-256 hashing algorithm without salt. This code creates a SHA-256 hash of a string and converts the result to a lowercase hexadecimal string. SHA-256 provides better security than MD5 with longer hash values and stronger collision resistance.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/security/encryption-algorithms.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
String originalString = "Java学习 + 面试指南：javaguide.cn";
// 创建SHA-256摘要对象
MessageDigest messageDigest = MessageDigest.getInstance("SHA-256");
messageDigest.update(originalString.getBytes());
// 计算哈希值
byte[] result = messageDigest.digest();
// 将哈希值转换为十六进制字符串
String hexString = new HexBinaryAdapter().marshal(result);
System.out.println("Original String: " + originalString);
System.out.println("SHA-256 Hash: " + hexString.toLowerCase());
```

----------------------------------------

TITLE: HashMap Class Attributes Definition
DESCRIPTION: Core attributes and constants defined in HashMap class including capacity, load factor and tree conversion thresholds.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public class HashMap<K,V> extends AbstractMap<K,V> implements Map<K,V>, Cloneable, Serializable {
    private static final long serialVersionUID = 362498820763181265L;
    static final int DEFAULT_INITIAL_CAPACITY = 1 << 4;
    static final int MAXIMUM_CAPACITY = 1 << 30;
    static final float DEFAULT_LOAD_FACTOR = 0.75f;
    static final int TREEIFY_THRESHOLD = 8;
    static final int UNTREEIFY_THRESHOLD = 6;
    static final int MIN_TREEIFY_CAPACITY = 64;
    transient Node<k,v>[] table;
    transient Set<map.entry<k,v>> entrySet;
    transient int size;
    transient int modCount;
    int threshold;
    final float loadFactor;
}
```

----------------------------------------

TITLE: 使用Curator获取和更新节点数据
DESCRIPTION: 展示如何获取节点数据内容以及如何更新节点的数据内容。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_22

LANGUAGE: java
CODE:
```
zkClient.create().creatingParentsIfNeeded().withMode(CreateMode.EPHEMERAL).forPath("/node1/00001","java".getBytes());
zkClient.getData().forPath("/node1/00001");//获取节点的数据内容
zkClient.setData().forPath("/node1/00001","c++".getBytes());//更新节点数据内容
```

----------------------------------------

TITLE: Demonstrating Integer Caching in Java
DESCRIPTION: This code snippet shows how Integer objects are cached for values between -128 and 127, resulting in the same object being returned for these values.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public static Integer valueOf(int i) {
    if (i >= IntegerCache.low && i <= IntegerCache.high)
        return IntegerCache.cache[i + (-IntegerCache.low)];
    return new Integer(i);
}
private static class IntegerCache {
    static final int low = -128;
    static final int high;
    static {
        // high value may be configured by property
        int h = 127;
    }
}
```

----------------------------------------

TITLE: Testing Eden Space Memory Allocation in Java
DESCRIPTION: Code example demonstrating memory allocation in Eden space of JVM heap with specific allocation size to test garbage collection behavior.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-garbage-collection.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class GCTest {
  public static void main(String[] args) {
    byte[] allocation1, allocation2;
    allocation1 = new byte[30900*1024];
  }
}
```

----------------------------------------

TITLE: MySQL EXPLAIN Example with Subquery
DESCRIPTION: Demonstrates a practical example of using EXPLAIN to analyze a SELECT query with a subquery, showing how MySQL processes nested queries and uses indexes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-query-execution-plan.md#2025-04-20_snippet_1

LANGUAGE: sql
CODE:
```
explain SELECT * FROM dept_emp WHERE emp_no IN (SELECT emp_no FROM dept_emp GROUP BY emp_no HAVING COUNT(emp_no)>1);
```

----------------------------------------

TITLE: Table Operations in SQL
DESCRIPTION: Explains SQL commands for table operations including creating, modifying, and deleting tables, as well as table options and structure modifications.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_2

LANGUAGE: SQL
CODE:
```
/* 表的操作  */
-- 创建表
    CREATE [TEMPORARY] TABLE[ IF NOT EXISTS] [库名.]表名 ( 表的结构定义 )[ 表选项]
        每个字段必须有数据类型
        最后一个字段后不能有逗号
        TEMPORARY 临时表，会话结束时表自动消失
        对于字段的定义：
            字段名 数据类型 [NOT NULL | NULL] [DEFAULT default_value] [AUTO_INCREMENT] [UNIQUE [KEY] | [PRIMARY] KEY] [COMMENT 'string']
-- 表选项
    -- 字符集
        CHARSET = charset_name
        如果表没有设定，则使用数据库字符集
    -- 存储引擎
        ENGINE = engine_name
        表在管理数据时采用的不同的数据结构，结构不同会导致处理方式、提供的特性操作等不同
        常见的引擎：InnoDB MyISAM Memory/Heap BDB Merge Example CSV MaxDB Archive
        不同的引擎在保存表的结构和数据时采用不同的方式
        MyISAM表文件含义：.frm表定义，.MYD表数据，.MYI表索引
        InnoDB表文件含义：.frm表定义，表空间数据和日志文件
        SHOW ENGINES -- 显示存储引擎的状态信息
        SHOW ENGINE 引擎名 {LOGS|STATUS} -- 显示存储引擎的日志或状态信息
    -- 自增起始数
    	AUTO_INCREMENT = 行数
    -- 数据文件目录
        DATA DIRECTORY = '目录'
    -- 索引文件目录
        INDEX DIRECTORY = '目录'
    -- 表注释
        COMMENT = 'string'
    -- 分区选项
        PARTITION BY ... (详细见手册)
-- 查看所有表
    SHOW TABLES[ LIKE 'pattern']
    SHOW TABLES FROM  库名
-- 查看表结构
    SHOW CREATE TABLE 表名 （信息更详细）
    DESC 表名 / DESCRIBE 表名 / EXPLAIN 表名 / SHOW COLUMNS FROM 表名 [LIKE 'PATTERN']
    SHOW TABLE STATUS [FROM db_name] [LIKE 'pattern']
-- 修改表
    -- 修改表本身的选项
        ALTER TABLE 表名 表的选项
        eg: ALTER TABLE 表名 ENGINE=MYISAM;
    -- 对表进行重命名
        RENAME TABLE 原表名 TO 新表名
        RENAME TABLE 原表名 TO 库名.表名 （可将表移动到另一个数据库）
        -- RENAME可以交换两个表名
    -- 修改表的字段机构（13.1.2. ALTER TABLE语法）
        ALTER TABLE 表名 操作名
        -- 操作名
            ADD[ COLUMN] 字段定义       -- 增加字段
                AFTER 字段名          -- 表示增加在该字段名后面
                FIRST               -- 表示增加在第一个
            ADD PRIMARY KEY(字段名)   -- 创建主键
            ADD UNIQUE [索引名] (字段名)-- 创建唯一索引
            ADD INDEX [索引名] (字段名) -- 创建普通索引
            DROP[ COLUMN] 字段名      -- 删除字段
            MODIFY[ COLUMN] 字段名 字段属性     -- 支持对字段属性进行修改，不能修改字段名(所有原有属性也需写上)
            CHANGE[ COLUMN] 原字段名 新字段名 字段属性      -- 支持对字段名修改
            DROP PRIMARY KEY    -- 删除主键(删除主键前需删除其AUTO_INCREMENT属性)
            DROP INDEX 索引名 -- 删除索引
            DROP FOREIGN KEY 外键    -- 删除外键
-- 删除表
    DROP TABLE[ IF EXISTS] 表名 ...
-- 清空表数据
    TRUNCATE [TABLE] 表名
-- 复制表结构
    CREATE TABLE 表名 LIKE 要复制的表名
-- 复制表结构和数据
    CREATE TABLE 表名 [AS] SELECT * FROM 要复制的表名
-- 检查表是否有错误
    CHECK TABLE tbl_name [, tbl_name] ... [option] ...
-- 优化表
    OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...
-- 修复表
    REPAIR [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ... [QUICK] [EXTENDED] [USE_FRM]
-- 分析表
    ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...
```

----------------------------------------

TITLE: Creating Compound Index in MongoDB
DESCRIPTION: Example of creating a compound index on the gender and user_name fields in a MongoDB collection.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mongodb/mongodb-questions-02.md#2025-04-20_snippet_3

LANGUAGE: SQL
CODE:
```
db.users.ensureIndex({gender:1,user_name:1})
```

----------------------------------------

TITLE: Referencing Managed Dependencies in Child Modules
DESCRIPTION: Demonstrates how to reference dependencies in child modules that are defined in the parent's dependencyManagement section. This allows omitting version numbers in child modules.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_3

LANGUAGE: xml
CODE:
```
<dependencies>
  <dependency>
    <groupId>org.junit.jupiter</groupId>
    <artifactId>junit-jupiter</artifactId>
  </dependency>
</dependencies>
```

----------------------------------------

TITLE: Analyzing Java Thread Information using JMX
DESCRIPTION: This code snippet demonstrates how to use Java Management Extensions (JMX) to obtain information about threads in a Java program. It retrieves thread details such as thread ID and name for all running threads.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-01.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class MultiThread {
	public static void main(String[] args) {
		// 获取 Java 线程管理 MXBean
	ThreadMXBean threadMXBean = ManagementFactory.getThreadMXBean();
		// 不需要获取同步的 monitor 和 synchronizer 信息，仅获取线程和线程堆栈信息
		ThreadInfo[] threadInfos = threadMXBean.dumpAllThreads(false, false);
		// 遍历线程信息，仅打印线程 ID 和线程名称信息
		for (ThreadInfo threadInfo : threadInfos) {
			System.out.println("[" + threadInfo.getThreadId() + "] " + threadInfo.getThreadName());
		}
	}
}
```

----------------------------------------

TITLE: Reversing a Linked List in Java
DESCRIPTION: This algorithm reverses a linked list by iteratively changing pointer directions. It uses three pointers to track the current node, previous node, and next node during traversal. The solution has O(n) time complexity and O(1) space complexity as it performs the reversal in-place.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
/*
public class ListNode {
    int val;
    ListNode next = null;

    ListNode(int val) {
        this.val = val;
    }
}*/
public class Solution {
    public ListNode ReverseList(ListNode head) {
       ListNode next = null;
       ListNode pre = null;
        while (head != null) {
              //保存要反转到头来的那个节点
               next = head.next;
               //要反转的那个节点指向已经反转的上一个节点
               head.next = pre;
               //上一个已经反转到头部的节点
               pre = head;
               //一直向链表尾走
               head = next;
        }
        return pre;
    }
}
```

----------------------------------------

TITLE: 使用AtomicIntegerArray进行数组元素的原子操作
DESCRIPTION: 演示了如何使用AtomicIntegerArray类对整数数组进行原子操作，包括获取和设置元素值、自增、添加等。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/atomic-classes.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
int[] nums = {1, 2, 3, 4, 5, 6};
AtomicIntegerArray atomicArray = new AtomicIntegerArray(nums);

System.out.println("Initial values in AtomicIntegerArray:");
for (int j = 0; j < nums.length; j++) {
    System.out.print("Index " + j + ": " + atomicArray.get(j) + " ");
}

int tempValue = atomicArray.getAndSet(0, 2);
System.out.println("\nAfter getAndSet(0, 2):");
System.out.println("Returned value: " + tempValue);
for (int j = 0; j < atomicArray.length(); j++) {
    System.out.print("Index " + j + ": " + atomicArray.get(j) + " ");
}

tempValue = atomicArray.getAndIncrement(0);
System.out.println("\nAfter getAndIncrement(0):");
System.out.println("Returned value: " + tempValue);
for (int j = 0; j < atomicArray.length(); j++) {
    System.out.print("Index " + j + ": " + atomicArray.get(j) + " ");
}

tempValue = atomicArray.getAndAdd(0, 5);
System.out.println("\nAfter getAndAdd(0, 5):");
System.out.println("Returned value: " + tempValue);
for (int j = 0; j < atomicArray.length(); j++) {
    System.out.print("Index " + j + ": " + atomicArray.get(j) + " ");
}
```

----------------------------------------

TITLE: Writing Characters to a File with FileWriter in Java
DESCRIPTION: Shows how to write character data to a file using FileWriter.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-basis.md#2025-04-20_snippet_8

LANGUAGE: Java
CODE:
```
try (Writer output = new FileWriter("output.txt")) {
    output.write("你好，我是Guide。");
} catch (IOException e) {
    e.printStackTrace();
}
```

----------------------------------------

TITLE: Implementing MD5 Hashing Algorithm in Java
DESCRIPTION: A Java implementation of the MD5 hashing algorithm without salt. This code creates an MD5 hash of a string and converts the result to a lowercase hexadecimal string. Note that MD5 is not recommended for security-sensitive applications due to its vulnerabilities.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/security/encryption-algorithms.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
String originalString = "Java学习 + 面试指南：javaguide.cn";
// 创建MD5摘要对象
MessageDigest messageDigest = MessageDigest.getInstance("MD5");
messageDigest.update(originalString.getBytes(StandardCharsets.UTF_8));
// 计算哈希值
byte[] result = messageDigest.digest();
// 将哈希值转换为十六进制字符串
String hexString = new HexBinaryAdapter().marshal(result);
System.out.println("Original String: " + originalString);
System.out.println("MD5 Hash: " + hexString.toLowerCase());
```

----------------------------------------

TITLE: Applying Shared and Exclusive Locks in MySQL Queries
DESCRIPTION: These SQL snippets show how to explicitly apply shared (S) and exclusive (X) locks in MySQL queries. It includes examples for both MySQL 5.7 and 8.0 versions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_7

LANGUAGE: sql
CODE:
```
# Shared lock (MySQL 5.7 and 8.0)
SELECT ... LOCK IN SHARE MODE;
# Shared lock (MySQL 8.0)
SELECT ... FOR SHARE;
# Exclusive lock
SELECT ... FOR UPDATE;
```

----------------------------------------

TITLE: LinkedList Element Retrieval Methods
DESCRIPTION: Methods for accessing elements from the LinkedList, including first, last, and indexed element retrieval.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
public E getFirst() {
    final Node<E> f = first;
    if (f == null)
        throw new NoSuchElementException();
    return f.item;
}

public E getLast() {
    final Node<E> l = last;
    if (l == null)
        throw new NoSuchElementException();
    return l.item;
}

public E get(int index) {
    checkElementIndex(index);
    return node(index).item;
}
```

----------------------------------------

TITLE: 使用AtomicReference进行引用类型的原子操作
DESCRIPTION: 展示了如何使用AtomicReference类对引用类型进行原子操作，包括获取和设置引用、条件更新等。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/atomic-classes.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
AtomicReference<Person> ar = new AtomicReference<>(new Person("SnailClimb", 22));

System.out.println("Initial Person: " + ar.get().toString());

Person updatePerson = new Person("Daisy", 20);
ar.compareAndSet(ar.get(), updatePerson);

System.out.println("Updated Person: " + ar.get().toString());

Person anotherUpdatePerson = new Person("John", 30);
boolean isUpdated = ar.compareAndSet(updatePerson, anotherUpdatePerson);

System.out.println("Second Update Success: " + isUpdated);
System.out.println("Final Person: " + ar.get().toString());
```

----------------------------------------

TITLE: Removing Elements from LinkedList using Iterator in Java
DESCRIPTION: Shows how to use an iterator to remove elements from a LinkedList. It demonstrates the use of the removeIf method and provides an example of removing null elements.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
LinkedList<String> list = new LinkedList<>();
list.add("apple");
list.add(null);
list.add("banana");

//  Collection 接口的 removeIf 方法底层依然是基于迭代器
list.removeIf(Objects::isNull);

for (String fruit : list) {
    System.out.println(fruit);
}
```

----------------------------------------

TITLE: Loading Service Implementations in Java
DESCRIPTION: Demonstrates the load methods of ServiceLoader, including overloaded versions and the use of thread context classloader.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/spi.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
public static <S> ServiceLoader<S> load(Class<S> service) {
    ClassLoader cl = Thread.currentThread().getContextClassLoader();
    return ServiceLoader.load(service, cl);
}

public static <S> ServiceLoader<S> load(Class<S> service,
                                        ClassLoader loader) {
    return new ServiceLoader<>(service, loader);
}

private ServiceLoader(Class<S> svc, ClassLoader cl) {
    service = Objects.requireNonNull(svc, "Service interface cannot be null");
    loader = (cl == null) ? ClassLoader.getSystemClassLoader() : cl;
    acc = (System.getSecurityManager() != null) ? AccessController.getContext() : null;
    reload();
}

public void reload() {
    providers.clear();
    lookupIterator = new LazyIterator(service, loader);
}
```

----------------------------------------

TITLE: Custom Implementation of ServiceLoader in Java
DESCRIPTION: Provides a simplified custom implementation of ServiceLoader to demonstrate the core concepts and flow of the SPI mechanism.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/spi.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
package edu.jiangxuan.up.service;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.lang.reflect.Constructor;
import java.net.URL;
import java.net.URLConnection;
import java.util.ArrayList;
import java.util.Enumeration;
import java.util.List;

public class MyServiceLoader<S> {

    // 对应的接口 Class 模板
    private final Class<S> service;

    // 对应实现类的 可以有多个，用 List 进行封装
    private final List<S> providers = new ArrayList<>();

    // 类加载器
    private final ClassLoader classLoader;

    // 暴露给外部使用的方法，通过调用这个方法可以开始加载自己定制的实现流程。
    public static <S> MyServiceLoader<S> load(Class<S> service) {
        return new MyServiceLoader<>(service);
    }

    // 构造方法私有化
    private MyServiceLoader(Class<S> service) {
        this.service = service;
        this.classLoader = Thread.currentThread().getContextClassLoader();
        doLoad();
    }

    // 关键方法，加载具体实现类的逻辑
    private void doLoad() {
        try {
            // 读取所有 jar 包里面 META-INF/services 包下面的文件，这个文件名就是接口名，然后文件里面的内容就是具体的实现类的路径加全类名
            Enumeration<URL> urls = classLoader.getResources("META-INF/services/" + service.getName());
            // 挨个遍历取到的文件
            while (urls.hasMoreElements()) {
                // 取出当前的文件
                URL url = urls.nextElement();
                System.out.println("File = " + url.getPath());
                // 建立链接
                URLConnection urlConnection = url.openConnection();
                urlConnection.setUseCaches(false);
                // 获取文件输入流
                InputStream inputStream = urlConnection.getInputStream();
                // 从文件输入流获取缓存
                BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream));
                // 从文件内容里面得到实现类的全类名
                String className = bufferedReader.readLine();

                while (className != null) {
                    // 通过反射拿到实现类的实例
                    Class<?> clazz = Class.forName(className, false, classLoader);
                    // 如果声明的接口跟这个具体的实现类是属于同一类型，（可以理解为Java的一种多态，接口跟实现类、父类和子类等等这种关系。）则构造实例
                    if (service.isAssignableFrom(clazz)) {
                        Constructor<? extends S> constructor = (Constructor<? extends S>) clazz.getConstructor();
                        S instance = constructor.newInstance();
                        // 把当前构造的实例对象添加到 Provider的列表里面
                        providers.add(instance);
                    }
                    // 继续读取下一行的实现类，可以有多个实现类，只需要换行就可以了。
                    className = bufferedReader.readLine();
                }
            }
        } catch (Exception e) {
            System.out.println("读取文件异常。。。");
        }
    }

    // 返回spi接口对应的具体实现类列表
    public List<S> getProviders() {
        return providers;
    }
}
```

----------------------------------------

TITLE: Implementing LoggerService for SPI Management in Java
DESCRIPTION: Creates the LoggerService class to manage SPI implementations and provide functionality to service consumers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/spi.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
package edu.jiangxuan.up.spi;

import java.util.ArrayList;
import java.util.List;
import java.util.ServiceLoader;

public class LoggerService {
    private static final LoggerService SERVICE = new LoggerService();

    private final Logger logger;

    private final List<Logger> loggerList;

    private LoggerService() {
        ServiceLoader<Logger> loader = ServiceLoader.load(Logger.class);
        List<Logger> list = new ArrayList<>();
        for (Logger log : loader) {
            list.add(log);
        }
        // LoggerList is all ServiceProviders
        loggerList = list;
        if (!list.isEmpty()) {
            // Logger only takes one
            logger = list.get(0);
        } else {
            logger = null;
        }
    }

    public static LoggerService getService() {
        return SERVICE;
    }

    public void info(String msg) {
        if (logger == null) {
            System.out.println("info: No Logger service provider found");
        } else {
            logger.info(msg);
        }
    }

    public void debug(String msg) {
        if (loggerList.isEmpty()) {
            System.out.println("debug: No Logger service provider found");
        }
        loggerList.forEach(log -> log.debug(msg));
    }
}
```

----------------------------------------

TITLE: Adding Elements to HashSet in Java
DESCRIPTION: Shows the implementation of the add method in HashSet, which internally uses HashMap to store elements and check for duplicates.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
// Returns: true if this set did not already contain the specified element
// 返回值：当 set 中没有包含 add 的元素时返回真
public boolean add(E e) {
        return map.put(e, PRESENT)==null;
}
```

----------------------------------------

TITLE: Value Passing with Primitive Types in Java
DESCRIPTION: Demonstrates how Java handles primitive type parameters through value passing, showing that changes to parameters inside methods don't affect the original variables.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/why-there-only-value-passing-in-java.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public static void main(String[] args) {
    int num1 = 10;
    int num2 = 20;
    swap(num1, num2);
    System.out.println("num1 = " + num1);
    System.out.println("num2 = " + num2);
}

public static void swap(int a, int b) {
    int temp = a;
    a = b;
    b = temp;
    System.out.println("a = " + a);
    System.out.println("b = " + b);
}
```

----------------------------------------

TITLE: Configuring Maven Profiles for Different Environments
DESCRIPTION: Shows how to configure Maven profiles for different environments (development and production). This allows building the project with environment-specific settings.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_4

LANGUAGE: xml
CODE:
```
<profiles>
  <profile>
    <id>development</id>
    <activation>
      <activeByDefault>true</activeByDefault>
    </activation>
    <properties>
      <environment>dev</environment>
    </properties>
  </profile>
  <profile>
    <id>production</id>
    <properties>
      <environment>prod</environment>
    </properties>
  </profile>
</profiles>
```

----------------------------------------

TITLE: Performance Comparison Between Virtual and Platform Threads
DESCRIPTION: Performance test comparing virtual threads with platform threads, measuring thread count and processing time for identical tasks.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/virtual-thread.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
public class VirtualThreadTest {
    static List<Integer> list = new ArrayList<>();
    public static void main(String[] args) {
        // 开启线程 统计平台线程数
        ScheduledExecutorService scheduledExecutorService = Executors.newScheduledThreadPool(1);
        scheduledExecutorService.scheduleAtFixedRate(() -> {
            ThreadMXBean threadBean = ManagementFactory.getThreadMXBean();
            ThreadInfo[] threadInfo = threadBean.dumpAllThreads(false, false);
            updateMaxThreadNum(threadInfo.length);
        }, 10, 10, TimeUnit.MILLISECONDS);

        long start = System.currentTimeMillis();
        // 虚拟线程
        ExecutorService executor =  Executors.newVirtualThreadPerTaskExecutor();
        // 使用平台线程
        // ExecutorService executor =  Executors.newFixedThreadPool(200);
        for (int i = 0; i < 10000; i++) {
            executor.submit(() -> {
                try {
                    // 线程睡眠 0.5 s，模拟业务处理
                    TimeUnit.MILLISECONDS.sleep(500);
                } catch (InterruptedException ignored) {
                }
            });
        }
        executor.close();
        System.out.println("max：" + list.get(0) + " platform thread/os thread");
        System.out.printf("totalMillis：%dms\n", System.currentTimeMillis() - start);


    }
    // 更新创建的平台最大线程数
    private static void updateMaxThreadNum(int num) {
        if (list.isEmpty()) {
            list.add(num);
        } else {
            Integer integer = list.get(0);
            if (num > integer) {
                list.add(0, num);
            }
        }
    }
}
```

----------------------------------------

TITLE: Using DelayQueue Example
DESCRIPTION: Example showing how to use DelayQueue to schedule and execute delayed tasks in order of their execution time.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/delayqueue-source-code.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
DelayQueue<DelayedTask> delayQueue = new DelayQueue<>();

delayQueue.add(new DelayedTask(2000, () -> System.out.println("Task 2")));
delayQueue.add(new DelayedTask(1000, () -> System.out.println("Task 1")));
delayQueue.add(new DelayedTask(3000, () -> System.out.println("Task 3")));

while (!delayQueue.isEmpty()) {
  DelayedTask task = delayQueue.take();
  if (task != null) {
    task.execute();
  }
}
```

----------------------------------------

TITLE: Defining Sealed Classes in Java 15
DESCRIPTION: Shows how to use sealed classes to restrict which classes can inherit from them, providing more control over class hierarchies.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java14-15.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
public abstract sealed class Person
    permits Employee, Manager {

    //...
}
```

LANGUAGE: java
CODE:
```
public final class Employee extends Person {
}

public non-sealed class Manager extends Person {
}
```

----------------------------------------

TITLE: Method Implementation with AOP
DESCRIPTION: Example showing simplified method implementation using AOP logging annotation
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/ioc-and-aop.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
@Log(description = "method1",methodType = MethodType.INSERT)
public CommonResponse<Object> method1() {
      // 业务逻辑
      xxService.method1();
      // 省略具体的业务处理逻辑
      return CommonResponse.success();
}
```

----------------------------------------

TITLE: Timed Poll Operation in ArrayBlockingQueue
DESCRIPTION: Implementation of poll operation that waits up to a specified timeout for elements to become available.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_19

LANGUAGE: java
CODE:
```
public E poll(long timeout, TimeUnit unit) throws InterruptedException {
        long nanos = unit.toNanos(timeout);
        final ReentrantLock lock = this.lock;
        lock.lockInterruptibly();
        try {
            while (count == 0) {
                if (nanos <= 0)
                    return null;
                nanos = notEmpty.awaitNanos(nanos);
            }
            return dequeue();
        } finally {
            lock.unlock();
        }
    }
```

----------------------------------------

TITLE: Reading File Data with FileChannel in Java NIO
DESCRIPTION: Demonstrates how to use FileChannel to read data from a file into a ByteBuffer. This example shows the basic steps of creating a channel, allocating a buffer, and reading data.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/nio-basis.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
RandomAccessFile reader = new RandomAccessFile("/Users/guide/Documents/test_read.in", "r"))
FileChannel channel = reader.getChannel();
ByteBuffer buffer = ByteBuffer.allocate(1024);
channel.read(buffer);
```

----------------------------------------

TITLE: Demonstrating 'this' keyword usage in Java
DESCRIPTION: This code snippet shows how to use the 'this' keyword to reference the current instance of a class in Java. It demonstrates accessing instance variables and calling methods using 'this'.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-keyword-summary.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
class Manager {
    Employees[] employees;
    void manageEmployees() {
        int totalEmp = this.employees.length;
        System.out.println("Total employees: " + totalEmp);
        this.report();
    }
    void report() { }
}
```

----------------------------------------

TITLE: Using DataInputStream for Reading Primitive Data Types in Java
DESCRIPTION: Illustrates how to use DataInputStream to read specific primitive data types from a file.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-basis.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
FileInputStream fileInputStream = new FileInputStream("input.txt");
DataInputStream dataInputStream = new DataInputStream(fileInputStream);
dataInputStream.readBoolean();
dataInputStream.readInt();
dataInputStream.readUTF();
```

----------------------------------------

TITLE: Using drainTo() Method with ArrayBlockingQueue in Java
DESCRIPTION: Demonstrates the use of drainTo() method to transfer all elements from an ArrayBlockingQueue to a List in a single operation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
public class DrainToExample {

    public static void main(String[] args) {
        // 创建一个大小为 5 的 ArrayBlockingQueue
        ArrayBlockingQueue<Integer> queue = new ArrayBlockingQueue<>(5);

        // 向队列中添加元素
        queue.add(1);
        queue.add(2);
        queue.add(3);
        queue.add(4);
        queue.add(5);

        // 创建一个 List，用于存储从队列中取出的元素
        List<Integer> list = new ArrayList<>();

        // 从队列中取出所有元素，并添加到 List 中
        queue.drainTo(list);

        // 输出 List 中的元素
        System.out.println(list);
    }

}
```

----------------------------------------

TITLE: Writing Primitive Data Types with DataOutputStream in Java
DESCRIPTION: Demonstrates how to use DataOutputStream to write specific primitive data types to a file.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-basis.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
FileOutputStream fileOutputStream = new FileOutputStream("out.txt");
DataOutputStream dataOutputStream = new DataOutputStream(fileOutputStream);
dataOutputStream.writeBoolean(true);
dataOutputStream.writeByte(1);
```

----------------------------------------

TITLE: Implementing Element Existence Check in ArrayBlockingQueue in Java
DESCRIPTION: This code shows the implementation of the contains(Object o) method in ArrayBlockingQueue which checks if a specified element exists in the queue. It uses a ReentrantLock for thread safety and traverses the internal array from takeIndex to putIndex to find the element.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_20

LANGUAGE: java
CODE:
```
public boolean contains(Object o) {
    //若目标元素为空，则直接返回 false
    if (o == null) return false;
    //获取当前队列的元素数组
    final Object[] items = this.items;
    //加锁
    final ReentrantLock lock = this.lock;
    lock.lock();
    try {
        // 如果队列非空
        if (count > 0) {
            final int putIndex = this.putIndex;
            //从队列头部开始遍历
            int i = takeIndex;
            do {
                if (o.equals(items[i]))
                    return true;
                if (++i == items.length)
                    i = 0;
            } while (i != putIndex);
        }
        return false;
    } finally {
        //释放锁
        lock.unlock();
    }
}
```

----------------------------------------

TITLE: Using EXPLAIN to Analyze SQL Query Performance in MySQL
DESCRIPTION: This SQL snippet shows how to use the EXPLAIN command to analyze the execution plan of a SELECT query in MySQL. It demonstrates the output format and various columns returned by EXPLAIN.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_9

LANGUAGE: sql
CODE:
```
EXPLAIN SELECT `score`,`name` FROM `cus_order` ORDER BY `score` DESC;
```

----------------------------------------

TITLE: Implementing Iterator for ServiceLoader in Java
DESCRIPTION: Shows the implementation of the iterator method in ServiceLoader, which allows iteration over service providers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/spi.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
public Iterator<S> iterator() {
    return new Iterator<S>() {

        Iterator<Map.Entry<String, S>> knownProviders
                = providers.entrySet().iterator();

        public boolean hasNext() {
            if (knownProviders.hasNext())
                return true;
            return lookupIterator.hasNext(); // 调用 LazyIterator
        }

        public S next() {
            if (knownProviders.hasNext())
                return knownProviders.next().getValue();
            return lookupIterator.next(); // 调用 LazyIterator
        }

        public void remove() {
            throw new UnsupportedOperationException();
        }

    };
}
```

----------------------------------------

TITLE: Basic MySQL Operations in SQL
DESCRIPTION: Demonstrates basic MySQL operations including starting the service, connecting to the server, and showing system information.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_0

LANGUAGE: SQL
CODE:
```
/* Windows服务 */
-- 启动 MySQL
			net start mysql
-- 创建Windows服务
				sc create mysql binPath= mysqld_bin_path(注意：等号与值之间有空格)
/* 连接与断开服务器 */
-- 连接 MySQL
				mysql -h 地址 -P 端口 -u 用户名 -p 密码
-- 显示哪些线程正在运行
				SHOW PROCESSLIST
-- 显示系统变量信息
				SHOW VARIABLES
```

----------------------------------------

TITLE: Java ClassFile Structure Definition
DESCRIPTION: Definition of the ClassFile structure that specifies the format of .class files according to the Java Virtual Machine specification. It includes all major components like magic number, version numbers, constant pool, access flags, fields, methods and attributes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/class-file-structure.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
ClassFile {
    u4             magic; //Class 文件的标志
    u2             minor_version;//Class 的小版本号
    u2             major_version;//Class 的大版本号
    u2             constant_pool_count;//常量池的数量
    cp_info        constant_pool[constant_pool_count-1];//常量池
    u2             access_flags;//Class 的访问标记
    u2             this_class;//当前类
    u2             super_class;//父类
    u2             interfaces_count;//接口数量
    u2             interfaces[interfaces_count];//一个类可以实现多个接口
    u2             fields_count;//字段数量
    field_info     fields[fields_count];//一个类可以有多个字段
    u2             methods_count;//方法数量
    method_info    methods[methods_count];//一个类可以有个多个方法
    u2             attributes_count;//此类的属性表中的属性数
    attribute_info attributes[attributes_count];//属性表集合
}
```

----------------------------------------

TITLE: Handling Out of Memory Errors in Java
DESCRIPTION: Configures JVM behavior when encountering OutOfMemoryErrors, including heap dump generation and custom actions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-parameters-intro.md#2025-04-20_snippet_7

LANGUAGE: bash
CODE:
```
-XX:+HeapDumpOnOutOfMemoryError
-XX:HeapDumpPath=./java_pid<pid>.hprof
-XX:OnOutOfMemoryError="< cmd args >;< cmd args >"
-XX:+UseGCOverheadLimit
```

----------------------------------------

TITLE: Using BigDecimal for Precise Floating-Point Calculations in Java
DESCRIPTION: This example shows how to use BigDecimal to perform precise floating-point calculations without losing precision.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_6

LANGUAGE: Java
CODE:
```
BigDecimal a = new BigDecimal("1.0");
BigDecimal b = new BigDecimal("1.00");
BigDecimal c = new BigDecimal("0.8");

BigDecimal x = a.subtract(c);
BigDecimal y = b.subtract(c);

System.out.println(x); /* 0.2 */
System.out.println(y); /* 0.20 */
// 比较内容，不是比较值
System.out.println(Objects.equals(x, y)); /* false */
// 比较值相等用相等compareTo，相等返回0
System.out.println(0 == x.compareTo(y)); /* true */
```

----------------------------------------

TITLE: AtomicStampedReference compareAndSet Implementation
DESCRIPTION: Implementation of compareAndSet in AtomicStampedReference to solve ABA problem using version stamps.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
public boolean compareAndSet(V   expectedReference,
                             V   newReference,
                             int expectedStamp,
                             int newStamp) {
    Pair<V> current = pair;
    return
        expectedReference == current.reference &&
        expectedStamp == current.stamp &&
        ((newReference == current.reference &&
          newStamp == current.stamp) ||
         casPair(current, Pair.of(newReference, newStamp)));
}
```

----------------------------------------

TITLE: Implementing FIRST_VALUE() and LAST_VALUE() Window Functions in MySQL
DESCRIPTION: Shows how to use FIRST_VALUE() and LAST_VALUE() functions to retrieve the first and last values within a window of rows, respectively.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_6

LANGUAGE: sql
CODE:
```
SELECT col1, col2, FIRST_VALUE(col2) OVER (PARTITION BY col1 ORDER BY col2) AS first_val,
                 LAST_VALUE(col2) OVER (PARTITION BY col1 ORDER BY col2) AS last_val
FROM table;
```

----------------------------------------

TITLE: Accessing ClassLoader in Java
DESCRIPTION: Demonstrates how to access and print the class loader hierarchy for a given class.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/classloader.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class PrintClassLoaderTree {

    public static void main(String[] args) {

        ClassLoader classLoader = PrintClassLoaderTree.class.getClassLoader();

        StringBuilder split = new StringBuilder("|--");
        boolean needContinue = true;
        while (needContinue){
            System.out.println(split.toString() + classLoader);
            if(classLoader == null){
                needContinue = false;
            }else{
                classLoader = classLoader.getParent();
                split.insert(0, "\t");
            }
        }
    }

}
```

----------------------------------------

TITLE: Deleting Element from Skip List in Java
DESCRIPTION: Implements the delete method to remove an element from the skip list, updating pointers and adjusting levels as needed.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-skiplist.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
public void delete(int value) {
    Node p = h;
    Node[] updateArr = new Node[levelCount];
    for (int i = levelCount - 1; i >= 0; i--) {
        while (p.forwards[i] != null && p.forwards[i].data < value) {
            p = p.forwards[i];
        }
        updateArr[i] = p;
    }
    if (p.forwards[0] != null && p.forwards[0].data == value) {
        for (int i = levelCount - 1; i >= 0; i--) {
            if (updateArr[i].forwards[i] != null && updateArr[i].forwards[i].data == value) {
                updateArr[i].forwards[i] = updateArr[i].forwards[i].forwards[i];
            }
        }
    }
    while (levelCount > 1 && h.forwards[levelCount - 1] == null) {
        levelCount--;
    }
}
```

----------------------------------------

TITLE: Retryable Topic Configuration with Dead Letter Queue
DESCRIPTION: Configuration for retryable topic with retry attempts, backoff delays, and DLQ support
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/kafka-questions-01.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
@RetryableTopic(
        attempts = "5",
        backoff = @Backoff(delay = 100, maxDelay = 1000)
)
@KafkaListener(topics = {KafkaConst.TEST_TOPIC}, groupId = "apple")
private void customer(String message) {
    log.info("kafka customer:{}", message);
    Integer n = Integer.parseInt(message);
    if (n % 5 == 0) {
        throw new RuntimeException();
    }
    System.out.println(n);
}
```

----------------------------------------

TITLE: Getting Thread Context ClassLoader in Spring
DESCRIPTION: Example showing how Spring framework retrieves the thread context class loader to handle class loading across different classloader hierarchies.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/classloader.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
cl = Thread.currentThread().getContextClassLoader();
```

----------------------------------------

TITLE: Implementing Preorder Traversal for Binary Trees in Java
DESCRIPTION: A recursive implementation of preorder traversal for binary trees. The algorithm first processes the root node, then recursively traverses the left subtree, followed by the right subtree.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/tree.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public void preOrder(TreeNode root){
	if(root == null){
		return;
	}
	system.out.println(root.data);
	preOrder(root.left);
	preOrder(root.right);
}
```

----------------------------------------

TITLE: Implementing Heap Sort in Java
DESCRIPTION: Java implementation of the Heap Sort algorithm, including methods for building a max heap, heapifying, and the main sorting function.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/10-classical-sorting-algorithms.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
static int heapLen;

private static void swap(int[] arr, int i, int j) {
    int tmp = arr[i];
    arr[i] = arr[j];
    arr[j] = tmp;
}

private static void buildMaxHeap(int[] arr) {
    for (int i = arr.length / 2 - 1; i >= 0; i--) {
        heapify(arr, i);
    }
}

private static void heapify(int[] arr, int i) {
    int left = 2 * i + 1;
    int right = 2 * i + 2;
    int largest = i;
    if (right < heapLen && arr[right] > arr[largest]) {
        largest = right;
    }
    if (left < heapLen && arr[left] > arr[largest]) {
        largest = left;
    }
    if (largest != i) {
        swap(arr, largest, i);
        heapify(arr, largest);
    }
}

public static int[] heapSort(int[] arr) {
    heapLen = arr.length;
    buildMaxHeap(arr);
    for (int i = arr.length - 1; i > 0; i--) {
        swap(arr, 0, i);
        heapLen -= 1;
        heapify(arr, 0);
    }
    return arr;
}
```

----------------------------------------

TITLE: Method Override Example with Inheritance
DESCRIPTION: Example showing method overriding in inheritance hierarchy with return type covariance.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_18

LANGUAGE: java
CODE:
```
public class Hero {
    public String name() {
        return "超级英雄";
    }
}
public class SuperMan extends Hero{
    @Override
    public String name() {
        return "超人";
    }
    public Hero hero() {
        return new Hero();
    }
}

public class SuperSuperMan extends SuperMan {
    @Override
    public String name() {
        return "超级超级英雄";
    }

    @Override
    public SuperMan hero() {
        return new SuperMan();
    }
}
```

----------------------------------------

TITLE: Java 9 Immutable Collections Creation
DESCRIPTION: Shows how to create immutable collections using new factory methods List.of(), Set.of(), and Map.of().
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java9.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
List.of("Java", "C++");
Set.of("Java", "C++");
Map.of("Java", 1, "C++", 2);
```

----------------------------------------

TITLE: Solving Variable Frog Jump Problem with Bit Manipulation in Java
DESCRIPTION: This code solves the enhanced frog jump problem where the frog can jump any number of steps from 1 to n. The mathematical pattern results in 2^(n-1), which is efficiently implemented using bit shift operation for O(1) time complexity.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
int JumpFloorII(int number) {
    return 1 << --number;//2^(number-1)用位移操作进行，更快
}
```

----------------------------------------

TITLE: Insertion Order Traversal with LinkedHashMap
DESCRIPTION: Demonstrates how LinkedHashMap maintains insertion order when iterating through elements, unlike regular HashMap.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedhashmap-source-code.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
HashMap < String, String > map = new LinkedHashMap < > ();
map.put("a", "2");
map.put("g", "3");
map.put("r", "1");
map.put("e", "23");

for (Map.Entry < String, String > entry: map.entrySet()) {
    System.out.println(entry.getKey() + ":" + entry.getValue());
}
```

----------------------------------------

TITLE: Ranking Top 3 Scores for Each Exam Category in MySQL
DESCRIPTION: Complex query to find the top 3 scores for each exam category, considering tiebreakers like minimum score and user ID. Uses window functions and subqueries.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_7

LANGUAGE: sql
CODE:
```
SELECT tag,
       UID,
       ranking
FROM
  (SELECT b.tag AS tag,
          a.uid AS UID,
          ROW_NUMBER() OVER (PARTITION BY b.tag
                             ORDER BY b.tag,
                                      max(a.score) DESC,
                                      min(a.score) DESC,
                                      a.uid DESC) AS ranking
   FROM exam_record a
   LEFT JOIN examination_info b ON a.exam_id = b.exam_id
   GROUP BY b.tag,
            a.uid) t
WHERE ranking <= 3
```

----------------------------------------

TITLE: Initializing HashMap with Custom Initial Capacity in Java
DESCRIPTION: Shows the constructors of HashMap that allow specifying an initial capacity. The tableSizeFor method ensures the capacity is always a power of 2.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
    public HashMap(int initialCapacity, float loadFactor) {
        if (initialCapacity < 0)
            throw new IllegalArgumentException("Illegal initial capacity: " +
                                               initialCapacity);
        if (initialCapacity > MAXIMUM_CAPACITY)
            initialCapacity = MAXIMUM_CAPACITY;
        if (loadFactor <= 0 || Float.isNaN(loadFactor))
            throw new IllegalArgumentException("Illegal load factor: " +
                                               loadFactor);
        this.loadFactor = loadFactor;
        this.threshold = tableSizeFor(initialCapacity);
    }
     public HashMap(int initialCapacity) {
        this(initialCapacity, DEFAULT_LOAD_FACTOR);
    }
```

----------------------------------------

TITLE: Implementing File System Monitoring with Observer Pattern in Java NIO
DESCRIPTION: This snippet illustrates how to use WatchService to monitor file system events, showcasing the Observer pattern in Java NIO.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-design-patterns.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
WatchService watchService = FileSystems.getDefault().newWatchService();

Path path = Paths.get("workingDirectory");
WatchKey watchKey = path.register(
watchService, StandardWatchEventKinds...);
```

----------------------------------------

TITLE: Defining Buffer Class in Java NIO
DESCRIPTION: Shows the structure of the Buffer class with its four key member variables: mark, position, limit, and capacity. These variables define the state and boundaries of the buffer.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/nio-basis.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public abstract class Buffer {
    // Invariants: mark <= position <= limit <= capacity
    private int mark = -1;
    private int position = 0;
    private int limit;
    private int capacity;
}
```

----------------------------------------

TITLE: Converting String to Integer (Java)
DESCRIPTION: Implements a method to convert a string representation of an integer to its numeric value without using built-in parsing functions. It handles positive and negative numbers and returns 0 for invalid inputs.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/string-algorithm-problems.md#2025-04-20_snippet_7

LANGUAGE: Java
CODE:
```
public class Main {

  public static int StrToInt(String str) {
    if (str.length() == 0)
      return 0;
    char[] chars = str.toCharArray();
    int flag = 0;
    if (chars[0] == '+')
      flag = 1;
    else if (chars[0] == '-')
      flag = 2;
    int start = flag > 0 ? 1 : 0;
    int res = 0;
    for (int i = start; i < chars.length; i++) {
      if (Character.isDigit(chars[i])) {
        int temp = chars[i] - '0';
        res = res * 10 + temp;
      } else {
        return 0;
      }
    }
   return flag != 2 ? res : -res;
  }

  public static void main(String[] args) {
    String s = "-12312312";
    System.out.println("使用库函数转换：" + Integer.valueOf(s));
    int res = Main.StrToInt(s);
    System.out.println("使用自己写的方法转换：" + res);
  }
}
```

----------------------------------------

TITLE: Consuming Transaction Messages with Idempotency Check in Java
DESCRIPTION: This class implements a RocketMQ message listener to consume transaction messages. It performs idempotency checks using Redis and updates the transaction status after processing.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/rocketmq-questions.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
@Service
@RocketMQMessageListener(topic = MQDestination.TOPIC, selectorExpression = MQDestination.TAG_ADD_VIEW_HISTORY, consumerGroup = MQDestination.TAG_ADD_VIEW_HISTORY)
public class ConsumerAddViewHistory implements RocketMQListener<Message> {
    @Override
    public void onMessage(Message message) {
        // Implementation details omitted for brevity
    }
}
```

----------------------------------------

TITLE: Reading File Content with BufferedInputStream in Java
DESCRIPTION: Shows how to read all bytes from a file using BufferedInputStream and convert them to a String.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-basis.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
BufferedInputStream bufferedInputStream = new BufferedInputStream(new FileInputStream("input.txt"));
String result = new String(bufferedInputStream.readAllBytes());
System.out.println(result);
```

----------------------------------------

TITLE: Foreign Function & Memory API Usage Example
DESCRIPTION: Demonstrates using the Foreign Function & Memory API to call the C library's radixsort function to sort an array of strings. Shows memory allocation, data copying between heap and off-heap, and external function invocation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java19.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
// 1. 在C库路径上查找外部函数
Linker linker = Linker.nativeLinker();
SymbolLookup stdlib = linker.defaultLookup();
MethodHandle radixSort = linker.downcallHandle(
                             stdlib.lookup("radixsort"), ...);
// 2. 分配堆上内存以存储四个字符串
String[] javaStrings   = { "mouse", "cat", "dog", "car" };
// 3. 分配堆外内存以存储四个指针
SegmentAllocator allocator = implicitAllocator();
MemorySegment offHeap  = allocator.allocateArray(ValueLayout.ADDRESS, javaStrings.length);
// 4. 将字符串从堆上复制到堆外
for (int i = 0; i < javaStrings.length; i++) {
    // 在堆外分配一个字符串，然后存储指向它的指针
    MemorySegment cString = allocator.allocateUtf8String(javaStrings[i]);
    offHeap.setAtIndex(ValueLayout.ADDRESS, i, cString);
}
// 5. 通过调用外部函数对堆外数据进行排序
radixSort.invoke(offHeap, javaStrings.length, MemoryAddress.NULL, '\0');
// 6. 将(重新排序的)字符串从堆外复制到堆上
for (int i = 0; i < javaStrings.length; i++) {
    MemoryAddress cStringPtr = offHeap.getAtIndex(ValueLayout.ADDRESS, i);
    javaStrings[i] = cStringPtr.getUtf8String(0);
}
assert Arrays.equals(javaStrings, new String[] {"car", "cat", "dog", "mouse"});  // true
```

----------------------------------------

TITLE: Sorting TreeMap with Custom Comparator in Java
DESCRIPTION: Demonstrates how to use a custom Comparator to sort a TreeMap based on a specific field of the key objects. In this case, Person objects are sorted by age.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
public class Person {
    private Integer age;

    public Person(Integer age) {
        this.age = age;
    }

    public Integer getAge() {
        return age;
    }


    public static void main(String[] args) {
        TreeMap<Person, String> treeMap = new TreeMap<>(new Comparator<Person>() {
            @Override
            public int compare(Person person1, Person person2) {
                int num = person1.getAge() - person2.getAge();
                return Integer.compare(num, 0);
            }
        });
        treeMap.put(new Person(3), "person1");
        treeMap.put(new Person(18), "person2");
        treeMap.put(new Person(35), "person3");
        treeMap.put(new Person(16), "person4");
        treeMap.entrySet().stream().forEach(personStringEntry -> {
            System.out.println(personStringEntry.getValue());
        });
    }
}
```

----------------------------------------

TITLE: Redis Expiration Cycle Constants Definition
DESCRIPTION: This code shows Redis internal constants that control the expiration cycle behavior, including cycle duration, CPU usage percentage, and acceptable stale key percentage that determines when Redis makes extra efforts to clean up.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_8

LANGUAGE: c
CODE:
```
#define ACTIVE_EXPIRE_CYCLE_FAST_DURATION 1000 /* Microseconds. */
#define ACTIVE_EXPIRE_CYCLE_SLOW_TIME_PERC 25 /* Max % of CPU to use. */
#define ACTIVE_EXPIRE_CYCLE_ACCEPTABLE_STALE 10 /* % of stale keys after which
                                                   we do extra efforts. */
```

----------------------------------------

TITLE: Implementing Method Overloading in MyBatis Mapper Interface
DESCRIPTION: Demonstrates how to implement method overloading in a MyBatis Mapper interface. The example shows two methods with the same name but different parameter signatures.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/mybatis/mybatis-interview.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
/**
 * Mapper接口里面方法重载
 */
public interface StuMapper {

 List<Student> getAllStu();

 List<Student> getAllStu(@Param("id") Integer id);
}
```

----------------------------------------

TITLE: Query Complete Exam Submissions for Last Three Months
DESCRIPTION: SQL query to find users who have completed all their exams in their last three months of activity. Returns the count of completed exams ordered by completion count and user ID in descending order.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_10

LANGUAGE: sql
CODE:
```
SELECT UID,
       count(score) exam_complete_cnt
FROM
  (SELECT *, DENSE_RANK() OVER (PARTITION BY UID
                             ORDER BY date_format(start_time, '%Y%m') DESC) dr
   FROM exam_record) t1
WHERE dr <= 3
GROUP BY UID
HAVING count(dr)= count(score)
ORDER BY exam_complete_cnt DESC,
         UID DESC
```

----------------------------------------

TITLE: Pattern Matching for instanceof in Java 17
DESCRIPTION: Shows the improved pattern matching syntax for instanceof operations, eliminating the need for explicit casting.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java17.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
// Old code
if (o instanceof String) {
    String s = (String)o;
    ... use s ...
}

// New code
if (o instanceof String s) {
    ... use s ...
}
```

----------------------------------------

TITLE: Searching in a 2D Sorted Matrix in Java
DESCRIPTION: This algorithm efficiently searches for a target value in a 2D matrix where each row and column is sorted. By starting from the bottom-left corner and moving up or right based on comparisons, it achieves O(m+n) time complexity where m and n are the dimensions of the matrix.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
public boolean Find(int target, int [][] array) {
    //基本思路从左下角开始找，这样速度最快
    int row = array.length-1;//行
    int column = 0;//列
    //当行数大于0，当前列数小于总列数时循环条件成立
    while((row >= 0)&& (column< array[0].length)){
        if(array[row][column] > target){
            row--;
        }else if(array[row][column] < target){
            column++;
        }else{
            return true;
        }
    }
    return false;
}
```

----------------------------------------

TITLE: Implementing Buffered Input Stream with Decorator Pattern in Java
DESCRIPTION: This snippet demonstrates how to use BufferedInputStream to enhance FileInputStream functionality, showcasing the Decorator pattern in Java IO.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-design-patterns.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
try (BufferedInputStream bis = new BufferedInputStream(new FileInputStream("input.txt"))) {
    int content;
    long skip = bis.skip(2);
    while ((content = bis.read()) != -1) {
        System.out.print((char) content);
    }
} catch (IOException e) {
    e.printStackTrace();
}
```

----------------------------------------

TITLE: Advanced String Templates Usage
DESCRIPTION: Examples demonstrating advanced usage of String Templates including expressions, calculations, and multi-line templates.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java21.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
int x = 10, y = 20;
String s = STR."\{x} + \{y} = \{x + y}";  //"10 + 20 = 30"

String time = STR."The current time is \{
    //sample comment - current time in HH:mm:ss
    DateTimeFormatter
      .ofPattern("HH:mm:ss")
      .format(LocalTime.now())
  }.";
```

----------------------------------------

TITLE: Testing Java SPI Implementation
DESCRIPTION: Creates a test class to demonstrate the usage of the Java SPI mechanism with the logger implementation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/spi.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
package edu.jiangxuan.up.service;

import edu.jiangxuan.up.spi.LoggerService;

public class TestJavaSPI {
    public static void main(String[] args) {
        LoggerService loggerService = LoggerService.getService();
        loggerService.info("Hello");
        loggerService.debug("Testing Java SPI mechanism");
    }
}
```

----------------------------------------

TITLE: Java 9 Stream API Enhancements
DESCRIPTION: Shows new Stream methods including ofNullable(), takeWhile(), dropWhile(), and iterate().
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java9.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
Stream<String> stringStream = Stream.ofNullable("Java");
System.out.println(stringStream.count());// 1
Stream<String> nullStream = Stream.ofNullable(null);
System.out.println(nullStream.count());//0

List<Integer> integerList = List.of(11, 33, 66, 8, 9, 13);
integerList.stream().takeWhile(x -> x < 50).forEach(System.out::println);// 11 33

List<Integer> integerList2 = List.of(11, 33, 66, 8, 9, 13);
integerList2.stream().dropWhile(x -> x < 50).forEach(System.out::println);// 66 8 9 13
```

----------------------------------------

TITLE: Synchronized Method Implementation Example
DESCRIPTION: Example showing synchronized method implementation for bytecode analysis.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
public class SynchronizedDemo2 {
    public synchronized void method() {
        System.out.println("synchronized 方法");
    }
}
```

----------------------------------------

TITLE: Asynchronous Message Sending in Kafka using Spring Boot
DESCRIPTION: Shows how to send a message to a Kafka topic asynchronously with a callback function using Spring Boot's KafkaTemplate.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/kafka-questions-01.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
ListenableFuture<SendResult<String, Object>> future = kafkaTemplate.send(topic, o);
future.addCallback(result -> logger.info("生产者成功发送消息到topic:{} partition:{}的消息", result.getRecordMetadata().topic(), result.getRecordMetadata().partition()),
        ex -> logger.error("生产者发送消失败，原因：{}", ex.getMessage()));
```

----------------------------------------

TITLE: Remove Operation in ArrayBlockingQueue
DESCRIPTION: Implementation of remove operation that throws an exception if the queue is empty instead of returning null.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_16

LANGUAGE: java
CODE:
```
public E remove() {
        E x = poll();
        if (x != null)
            return x;
        else
            throw new NoSuchElementException();
    }
```

----------------------------------------

TITLE: Converting Between MySQL Date Formats and Unix Timestamps
DESCRIPTION: SQL queries demonstrating how to convert between MySQL date strings and Unix timestamps (seconds since epoch).
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/some-thoughts-on-database-storage-time.md#2025-04-20_snippet_5

LANGUAGE: SQL
CODE:
```
-- Convert date string to Unix timestamp (seconds)
SELECT UNIX_TIMESTAMP('2020-01-11 09:53:32');

-- Convert Unix timestamp (seconds) to date string
SELECT FROM_UNIXTIME(1578707612);
```

----------------------------------------

TITLE: Null Handling in Switch Statements in Java 17
DESCRIPTION: Shows the improved null handling capabilities in switch statements with direct null case support.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java17.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
// Old code
static void testFooBar(String s) {
    if (s == null) {
        System.out.println("oops!");
        return;
    }
    switch (s) {
        case "Foo", "Bar" -> System.out.println("Great");
        default           -> System.out.println("Ok");
    }
}

// New code
static void testFooBar(String s) {
    switch (s) {
        case null         -> System.out.println("Oops");
        case "Foo", "Bar" -> System.out.println("Great");
        default           -> System.out.println("Ok");
    }
}
```

----------------------------------------

TITLE: Adding Element to Skip List in Java
DESCRIPTION: Implements the add method to insert a new element into the skip list, updating necessary pointers and levels.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-skiplist.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
public void add(int value) {
    int level = randomLevel();
    Node newNode = new Node();
    newNode.data = value;
    newNode.maxLevel = level;
    Node[] maxOfMinArr = new Node[level];
    for (int i = 0; i < level; i++) {
        maxOfMinArr[i] = h;
    }
    Node p = h;
    for (int i = level - 1; i >= 0; i--) {
        while (p.forwards[i] != null && p.forwards[i].data < value) {
            p = p.forwards[i];
        }
        maxOfMinArr[i] = p;
    }
    for (int i = 0; i < level; i++) {
        newNode.forwards[i] = maxOfMinArr[i].forwards[i];
        maxOfMinArr[i].forwards[i] = newNode;
    }
    if (levelCount < level) {
        levelCount = level;
    }
}
```

----------------------------------------

TITLE: Mentioning ArrayBlockingQueue and LinkedBlockingQueue classes in Java
DESCRIPTION: This snippet introduces the ArrayBlockingQueue and LinkedBlockingQueue classes from the Java concurrent package. These classes are mentioned as part of a comparison of their features and implementation details.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-01.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
ArrayBlockingQueue
```

LANGUAGE: Java
CODE:
```
LinkedBlockingQueue
```

----------------------------------------

TITLE: Implementing LeastActiveLoadBalance in Dubbo (Java)
DESCRIPTION: This code snippet shows the implementation of the LeastActiveLoadBalance algorithm in Dubbo. It selects the invoker with the least active requests, falling back to RandomLoadBalance if multiple invokers have the same least active count.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/rpc/dubbo.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class LeastActiveLoadBalance extends AbstractLoadBalance {

    public static final String NAME = "leastactive";

    @Override
    protected <T> Invoker<T> doSelect(List<Invoker<T>> invokers, URL url, Invocation invocation) {
        int length = invokers.size();
        int leastActive = -1;
        int leastCount = 0;
        int[] leastIndexes = new int[length];
        int[] weights = new int[length];
        int totalWeight = 0;
        int firstWeight = 0;
        boolean sameWeight = true;
        // This for loop finds the invoker with the least active requests
        for (int i = 0; i < length; i++) {
            Invoker<T> invoker = invokers.get(i);
            int active = RpcStatus.getStatus(invoker.getUrl(), invocation.getMethodName()).getActive();
            int afterWarmup = getWeight(invoker, invocation);
            weights[i] = afterWarmup;
            if (leastActive == -1 || active < leastActive) {
                leastActive = active;
                leastCount = 1;
                leastIndexes[0] = i;
                totalWeight = afterWarmup;
                firstWeight = afterWarmup;
                sameWeight = true;
            } else if (active == leastActive) {
                leastIndexes[leastCount++] = i;
                totalWeight += afterWarmup;
                if (sameWeight && afterWarmup != firstWeight) {
                    sameWeight = false;
                }
            }
        }
       // If only one invoker has the least active count, return it
        if (leastCount == 1) {
            return invokers.get(leastIndexes[0]);
        }
        // If multiple invokers have the same least active count but different weights,
        // use RandomLoadBalance logic
        if (!sameWeight && totalWeight > 0) {
            int offsetWeight = ThreadLocalRandom.current().nextInt(totalWeight);
            for (int i = 0; i < leastCount; i++) {
                int leastIndex = leastIndexes[i];
                offsetWeight -= weights[leastIndex];
                if (offsetWeight < 0) {
                    return invokers.get(leastIndex);
                }
            }
        }
        return invokers.get(leastIndexes[ThreadLocalRandom.current().nextInt(leastCount)]);
    }
}
```

----------------------------------------

TITLE: Demonstrating ThreadLocal Usage in Java
DESCRIPTION: Example code showing how to use ThreadLocal to create thread-local variables and access them.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public class ThreadLocalTest {
    private List<String> messages = Lists.newArrayList();

    public static final ThreadLocal<ThreadLocalTest> holder = ThreadLocal.withInitial(ThreadLocalTest::new);

    public static void add(String message) {
        holder.get().messages.add(message);
    }

    public static List<String> clear() {
        List<String> messages = holder.get().messages;
        holder.remove();

        System.out.println("size: " + holder.get().messages.size());
        return messages;
    }

    public static void main(String[] args) {
        ThreadLocalTest.add("一枝花算不算浪漫");
        System.out.println(holder.get().messages);
        ThreadLocalTest.clear();
    }
}
```

----------------------------------------

TITLE: Implementing Logback as SPI Service Provider in Java
DESCRIPTION: Creates the Logback class as a concrete implementation of the Logger interface for the SPI mechanism.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/spi.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
package edu.jiangxuan.up.spi.service;

import edu.jiangxuan.up.spi.Logger;

public class Logback implements Logger {
    @Override
    public void info(String s) {
        System.out.println("Logback info log: " + s);
    }

    @Override
    public void debug(String s) {
        System.out.println("Logback debug log: " + s);
    }
}
```

----------------------------------------

TITLE: Implementing a Generic Method in Java
DESCRIPTION: This code snippet shows how to define and use a generic method in Java, which can work with arrays of any type.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_8

LANGUAGE: Java
CODE:
```
public static < E > void printArray( E[] inputArray )
{
     for ( E element : inputArray ){
        System.out.printf( "%s ", element );
     }
     System.out.println();
}

// Usage
Integer[] intArray = { 1, 2, 3 };
String[] stringArray = { "Hello", "World" };
printArray( intArray  );
printArray( stringArray  );
```

----------------------------------------

TITLE: Executing an UPDATE Statement in MySQL
DESCRIPTION: Example of an UPDATE statement that changes the age of a student named 'Zhang San' to 19. This statement demonstrates how data modification operations work in MySQL, involving both redo log and binlog for transaction safety.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/how-sql-executed-in-mysql.md#2025-04-20_snippet_1

LANGUAGE: sql
CODE:
```
update tb_student A set A.age='19' where A.name=' 张三 ';
```

----------------------------------------

TITLE: Executing a SELECT Query in MySQL
DESCRIPTION: Example of a basic SELECT query that retrieves records of students who are 18 years old and named 'Zhang San'. This query demonstrates a typical read operation that would pass through MySQL's execution process.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/how-sql-executed-in-mysql.md#2025-04-20_snippet_0

LANGUAGE: sql
CODE:
```
select * from tb_student  A where A.age='18' and A.name=' 张三 ';
```

----------------------------------------

TITLE: Removing Elements from CopyOnWriteArrayList in Java
DESCRIPTION: Implementation of the remove() method in CopyOnWriteArrayList, showing the thread-safe element removal process.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/copyonwritearraylist-source-code.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
public E remove(int index) {
    final ReentrantLock lock = this.lock;
    lock.lock();
    try {
        Object[] elements = getArray();
        int len = elements.length;
        E oldValue = get(elements, index);
        int numMoved = len - index - 1;
        if (numMoved == 0)
            setArray(Arrays.copyOf(elements, len - 1));
        else {
            Object[] newElements = new Object[len - 1];
            System.arraycopy(elements, 0, newElements, 0, index);
            System.arraycopy(elements, index + 1, newElements, index,
                             numMoved);
            setArray(newElements);
        }
        return oldValue;
    } finally {
        lock.unlock();
    }
}
```

----------------------------------------

TITLE: Deserializing Objects with ObjectInputStream in Java
DESCRIPTION: Demonstrates how to use ObjectInputStream to read Java objects from an input stream (deserialization).
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-basis.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
ObjectInputStream input = new ObjectInputStream(new FileInputStream("object.data"));
MyClass object = (MyClass) input.readObject();
input.close();
```

----------------------------------------

TITLE: Retrieving Entries from ThreadLocalMap in Java
DESCRIPTION: Implementation of the getEntry method in ThreadLocalMap, showing how ThreadLocal retrieves values from its internal map, handling both direct hits and cases requiring additional searching after hash collisions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
private Entry getEntry(ThreadLocal<?> key) {
    int i = key.threadLocalHashCode & (table.length - 1);
    Entry e = table[i];
    if (e != null && e.get() == key)
        return e;
    else
        return getEntryAfterMiss(key, i, e);
}

private Entry getEntryAfterMiss(ThreadLocal<?> key, int i, Entry e) {
    Entry[] tab = table;
    int len = tab.length;

    while (e != null) {
        ThreadLocal<?> k = e.get();
        if (k == key)
            return e;
        if (k == null)
            expungeStaleEntry(i);
        else
            i = nextIndex(i, len);
        e = tab[i];
    }
    return null;
}
```

----------------------------------------

TITLE: Implementing Counting Sort in Java
DESCRIPTION: Java implementation of the Counting Sort algorithm, including methods for finding min/max values and the main sorting function.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/10-classical-sorting-algorithms.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
private static int[] getMinAndMax(int[] arr) {
    int maxValue = arr[0];
    int minValue = arr[0];
    for (int i = 0; i < arr.length; i++) {
        if (arr[i] > maxValue) {
            maxValue = arr[i];
        } else if (arr[i] < minValue) {
            minValue = arr[i];
        }
    }
    return new int[] { minValue, maxValue };
}

public static int[] countingSort(int[] arr) {
    if (arr.length < 2) {
        return arr;
    }
    int[] extremum = getMinAndMax(arr);
    int minValue = extremum[0];
    int maxValue = extremum[1];
    int[] countArr = new int[maxValue - minValue + 1];
    int[] result = new int[arr.length];

    for (int i = 0; i < arr.length; i++) {
        countArr[arr[i] - minValue] += 1;
    }
    for (int i = 1; i < countArr.length; i++) {
        countArr[i] += countArr[i - 1];
    }
    for (int i = arr.length - 1; i >= 0; i--) {
        int idx = countArr[arr[i] - minValue] - 1;
        result[idx] = arr[i];
        countArr[arr[i] - minValue] -= 1;
    }
    return result;
}
```

----------------------------------------

TITLE: Implementing String Class in Java
DESCRIPTION: This code snippet shows the implementation of the String class, demonstrating its immutable nature due to the use of final keyword for the char array.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
public final class String implements java.io.Serializable, Comparable<String>, CharSequence {
    private final char value[];
  //...
}
```

----------------------------------------

TITLE: After Node Removal Implementation in LinkedHashMap
DESCRIPTION: Demonstrates how LinkedHashMap handles node removal by updating the double-linked list pointers and maintaining list integrity.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedhashmap-source-code.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
void afterNodeRemoval(Node<K,V> e) { // unlink
    LinkedHashMap.Entry<K,V> p =
        (LinkedHashMap.Entry<K,V>)e, b = p.before, a = p.after;
    p.before = p.after = null;
    if (b == null)
        head = a;
    else
        b.after = a;
    if (a == null)
        tail = b;
    else
        a.before = b;
}
```

----------------------------------------

TITLE: Ensuring Capacity in ArrayList in Java
DESCRIPTION: These methods are responsible for ensuring that the ArrayList has sufficient capacity to accommodate new elements. They calculate the required capacity and trigger growth if necessary.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_6

LANGUAGE: Java
CODE:
```
// 根据给定的最小容量和当前数组元素来计算所需容量。
private static int calculateCapacity(Object[] elementData, int minCapacity) {
    // 如果当前数组元素为空数组（初始情况），返回默认容量和最小容量中的较大值作为所需容量
    if (elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
        return Math.max(DEFAULT_CAPACITY, minCapacity);
    }
    // 否则直接返回最小容量
    return minCapacity;
}

// 确保内部容量达到指定的最小容量。
private void ensureCapacityInternal(int minCapacity) {
    ensureExplicitCapacity(calculateCapacity(elementData, minCapacity));
}

//判断是否需要扩容
private void ensureExplicitCapacity(int minCapacity) {
    modCount++;
    //判断当前数组容量是否足以存储minCapacity个元素
    if (minCapacity - elementData.length > 0)
        //调用grow方法进行扩容
        grow(minCapacity);
}
```

----------------------------------------

TITLE: Node Removal Operation in LinkedHashMap
DESCRIPTION: Shows the implementation of removeNode method and afterNodeRemoval operation in LinkedHashMap for maintaining the double-linked list structure during element removal.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedhashmap-source-code.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
final Node<K,V> removeNode(int hash, Object key, Object value,
                               boolean matchValue, boolean movable) {
        //略
            if (node != null && (!matchValue || (v = node.value) == value ||
                                 (value != null && value.equals(v)))) {
                if (node instanceof TreeNode)
                    ((TreeNode<K,V>)node).removeTreeNode(this, tab, movable);
                else if (node == p)
                    tab[index] = node.next;
                else
                    p.next = node.next;
                ++modCount;
                --size;
                afterNodeRemoval(node);
                return node;
            }
        }
        return null;
    }
//空实现
void afterNodeRemoval(Node<K,V> p) { }
```

----------------------------------------

TITLE: Forcing Read Operations to Master Database using Sharding-JDBC
DESCRIPTION: Example showing how to force read operations to be routed to the master database using Sharding-JDBC's HintManager to avoid master-slave replication lag issues.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/read-and-write-separation-and-library-subtable.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
HintManager hintManager = HintManager.getInstance();
hintManager.setMasterRouteOnly();
// Continue with JDBC operations
```

----------------------------------------

TITLE: String Concatenation Behavior with Variables vs Constants
DESCRIPTION: This code demonstrates how string concatenation behaves differently with variables versus string literals. String literals are combined at compile time (constant folding), while variables are combined at runtime using StringBuilder.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_21

LANGUAGE: java
CODE:
```
String str1 = "str";
String str2 = "ing";
String str3 = "str" + "ing";
String str4 = str1 + str2;
String str5 = "string";
System.out.println(str3 == str4);//false
System.out.println(str3 == str5);//true
System.out.println(str4 == str5);//false
```

----------------------------------------

TITLE: Using Text Blocks in Java 14
DESCRIPTION: Demonstrates the use of text blocks with new escape characters (\ and \s) for line continuation and single space insertion.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java14-15.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
String str = "凡心所向，素履所往，生如逆旅，一苇以航。";

String str2 = """
        凡心所向，素履所往， \
        生如逆旅，一苇以航。""";
System.out.println(str2);// 凡心所向，素履所往， 生如逆旅，一苇以航。
String text = """
        java
        c++\sphp
        """;
System.out.println(text);
//输出：
java
c++ php
```

----------------------------------------

TITLE: Reading Characters from a File with FileReader in Java
DESCRIPTION: Demonstrates how to read character data from a file using FileReader, including skipping characters.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-basis.md#2025-04-20_snippet_7

LANGUAGE: Java
CODE:
```
try (FileReader fileReader = new FileReader("input.txt");) {
    int content;
    long skip = fileReader.skip(3);
    System.out.println("The actual number of bytes skipped:" + skip);
    System.out.print("The content read from file:");
    while ((content = fileReader.read()) != -1) {
        System.out.print((char) content);
    }
} catch (IOException e) {
    e.printStackTrace();
}
```

----------------------------------------

TITLE: Thread Thread.init Method for InheritableThreadLocal
DESCRIPTION: Implementation of the Thread initialization method that copies InheritableThreadLocal values from parent thread to child thread, showing how thread inheritance is technically implemented in Java.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_13

LANGUAGE: java
CODE:
```
private void init(ThreadGroup g, Runnable target, String name,
                      long stackSize, AccessControlContext acc,
                      boolean inheritThreadLocals) {
    if (name == null) {
        throw new NullPointerException("name cannot be null");
    }

    if (inheritThreadLocals && parent.inheritableThreadLocals != null)
        this.inheritableThreadLocals =
            ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);
    this.stackSize = stackSize;
    tid = nextThreadID();
}
```

----------------------------------------

TITLE: Multiple Memory Allocations Test in Java
DESCRIPTION: Example showing multiple byte array allocations to demonstrate memory allocation patterns and garbage collection triggers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-garbage-collection.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class GCTest {

  public static void main(String[] args) {
    byte[] allocation1, allocation2,allocation3,allocation4,allocation5;
    allocation1 = new byte[32000*1024];
    allocation2 = new byte[1000*1024];
    allocation3 = new byte[1000*1024];
    allocation4 = new byte[1000*1024];
    allocation5 = new byte[1000*1024];
  }
}
```

----------------------------------------

TITLE: Performance Test Without ensureCapacity in Java
DESCRIPTION: A performance test measuring the time required to add a large number of elements to an ArrayList without using the ensureCapacity method, resulting in multiple capacity increases.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_16

LANGUAGE: java
CODE:
```
public class EnsureCapacityTest {
  public static void main(String[] args) {
    ArrayList<Object> list = new ArrayList<Object>();
    final int N = 10000000;
    long startTime = System.currentTimeMillis();
    for (int i = 0; i < N; i++) {
      list.add(i);
    }
    long endTime = System.currentTimeMillis();
    System.out.println("使用ensureCapacity方法前："+(endTime - startTime));

  }
}
```

----------------------------------------

TITLE: Applying Adapter Pattern with InputStreamReader in Java
DESCRIPTION: This code example shows how InputStreamReader acts as an adapter between byte streams and character streams, demonstrating the Adapter pattern in Java IO.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/io-design-patterns.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
InputStreamReader isr = new InputStreamReader(new FileInputStream(fileName), "UTF-8");
BufferedReader bufferedReader = new BufferedReader(isr);
```

----------------------------------------

TITLE: Java 9 Process API Example
DESCRIPTION: Shows how to use the new Process API to get information about the current process.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java9.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
// 获取当前正在运行的 JVM 的进程
ProcessHandle currentProcess = ProcessHandle.current();
// 输出进程的 id
System.out.println(currentProcess.pid());
// 输出进程的信息
System.out.println(currentProcess.info());
```

----------------------------------------

TITLE: Java 9 Try-With-Resources Enhancement
DESCRIPTION: Demonstrates the enhanced try-with-resources feature that supports effectively final variables.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java9.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
final Scanner scanner = new Scanner(new File("testRead.txt"));
PrintWriter writer = new PrintWriter(new File("testWrite.txt"))
try (scanner;writer) {
    // omitted
}
```

----------------------------------------

TITLE: Implementing Parents Delegation Model in Java
DESCRIPTION: Shows the implementation of the parents delegation model in the loadClass method of ClassLoader.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/classloader.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
protected Class<?> loadClass(String name, boolean resolve)
    throws ClassNotFoundException
{
    synchronized (getClassLoadingLock(name)) {
        //首先，检查该类是否已经加载过
        Class c = findLoadedClass(name);
        if (c == null) {
            //如果 c 为 null，则说明该类没有被加载过
            long t0 = System.nanoTime();
            try {
                if (parent != null) {
                    //当父类的加载器不为空，则通过父类的loadClass来加载该类
                    c = parent.loadClass(name, false);
                } else {
                    //当父类的加载器为空，则调用启动类加载器来加载该类
                    c = findBootstrapClassOrNull(name);
                }
            } catch (ClassNotFoundException e) {
                //非空父类的类加载器无法找到相应的类，则抛出异常
            }

            if (c == null) {
                //当父类加载器无法加载时，则调用findClass方法来加载该类
                //用户可通过覆写该方法，来自定义类加载器
                long t1 = System.nanoTime();
                c = findClass(name);

                //用于统计类加载器相关的信息
                sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);
                sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);
                sun.misc.PerfCounter.getFindClasses().increment();
            }
        }
        if (resolve) {
            //对类进行link操作
            resolveClass(c);
        }
        return c;
    }
}
```

----------------------------------------

TITLE: Number Formatting in Java 12
DESCRIPTION: Demonstrates the new compact number formatting capability using NumberFormat class.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java12-13.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
NumberFormat fmt = NumberFormat.getCompactNumberInstance(Locale.US, NumberFormat.Style.SHORT);
String result = fmt.format(1000);
System.out.println(result);
```

----------------------------------------

TITLE: Calculating Average Active Days and Monthly Active Users
DESCRIPTION: This query calculates the average active days and monthly active users (MAU) for each month in 2021. It uses date formatting, distinct counts, and grouping to derive these metrics from the exam_record table.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_6

LANGUAGE: SQL
CODE:
```
SELECT DATE_FORMAT(submit_time, '%Y%m') MONTH,
                                        round(count(DISTINCT UID, DATE_FORMAT(submit_time, '%Y%m%d')) / count(DISTINCT UID), 2) avg_active_days,
                                        COUNT(DISTINCT UID) mau
FROM exam_record
WHERE YEAR (submit_time) = 2021
GROUP BY MONTH
```

----------------------------------------

TITLE: Calculating Power of Two Size for HashMap Capacity in Java
DESCRIPTION: The tableSizeFor method ensures that the HashMap capacity is always a power of 2. It uses bitwise operations to find the nearest power of 2 greater than or equal to the given capacity.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
/**
 * Returns a power of two size for the given target capacity.
 */
static final int tableSizeFor(int cap) {
    int n = cap - 1;
    n |= n >>> 1;
    n |= n >>> 2;
    n |= n >>> 4;
    n |= n >>> 8;
    n |= n >>> 16;
    return (n < 0) ? 1 : (n >= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;
}
```

----------------------------------------

TITLE: Redis List类型实现栈操作
DESCRIPTION: 展示了如何使用RPUSH和RPOP命令实现栈的压栈和出栈操作。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_5

LANGUAGE: bash
CODE:
```
> RPUSH myList2 value1 value2 value3
(integer) 3
> RPOP myList2 # 将 list的最右边的元素取出
"value3"
```

----------------------------------------

TITLE: Simplified Main Method Declaration
DESCRIPTION: Shows the new simplified main method declaration syntax introduced in Java 23, making it more approachable for beginners.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java22-23.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
// Traditional way
public class HelloWorld {
    public static void main(String[] args) {
        System.out.println("Hello, World!");
    }
}

// New simplified way
void main() {
   System.out.println("Hello, World!");
}
```

----------------------------------------

TITLE: Using var Keyword for Local Variable Type Inference in Java 10
DESCRIPTION: Demonstrates the usage of var keyword for local variable type inference introduced in Java 10. Shows valid use cases including object creation, collections, and for loops.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java10.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
var id = 0;
var codefx = new URL("https://mp.weixin.qq.com/");
var list = new ArrayList<>();
var list = List.of(1, 2, 3);
var map = new HashMap<String, String>();
var p = Paths.of("src/test/java/Java9FeaturesTest.java");
var numbers = List.of("a", "b", "c");
for (var n : list)
    System.out.print(n+ " ");
```

----------------------------------------

TITLE: Template Method Pattern Implementation
DESCRIPTION: Example of the Template Method pattern where a base abstract class defines the skeleton of an algorithm, deferring some steps to subclasses. This demonstrates how Spring's JdbcTemplate and HibernateTemplate are designed.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-design-patterns-summary.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public abstract class Template {
    //这是我们的模板方法
    public final void TemplateMethod(){
        PrimitiveOperation1();
        PrimitiveOperation2();
        PrimitiveOperation3();
    }

    protected void  PrimitiveOperation1(){
        //当前类实现
    }

    //被子类实现的方法
    protected abstract void PrimitiveOperation2();
    protected abstract void PrimitiveOperation3();

}
public class TemplateImpl extends Template {

    @Override
    public void PrimitiveOperation2() {
        //当前类实现
    }

    @Override
    public void PrimitiveOperation3() {
        //当前类实现
    }
}
```

----------------------------------------

TITLE: Replacing Spaces in a String (Java)
DESCRIPTION: Two methods to replace spaces in a string with '%20': one using character iteration and StringBuilder, and another using String.replaceAll() method. The first method manually checks and replaces spaces, while the second uses a regex to replace all whitespace.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/string-algorithm-problems.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public class Solution {

  public static String replaceSpace(StringBuffer str) {
    int length = str.length();
    StringBuffer result = new StringBuffer();
    for (int i = 0; i < length; i++) {
      char b = str.charAt(i);
      if (String.valueOf(b).equals(" ")) {
        result.append("%20");
      } else {
        result.append(b);
      }
    }
    return result.toString();
  }

  public static String replaceSpace2(StringBuffer str) {
    return str.toString().replaceAll("\\s", "%20");
  }
}
```

----------------------------------------

TITLE: Triggering Class Initialization in Java
DESCRIPTION: Example of using reflection to trigger class initialization. This is one of the six scenarios that force a class to be initialized.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/class-loading-process.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
Class.forName("...");
```

LANGUAGE: Java
CODE:
```
newInstance();
```

----------------------------------------

TITLE: InheritableThreadLocal Usage Example
DESCRIPTION: A demonstration of how InheritableThreadLocal differs from ThreadLocal by allowing child threads to inherit values from their parent thread, showing both the inherited and non-inherited behavior.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_12

LANGUAGE: java
CODE:
```
public class InheritableThreadLocalDemo {
    public static void main(String[] args) {
        ThreadLocal<String> ThreadLocal = new ThreadLocal<>();
        ThreadLocal<String> inheritableThreadLocal = new InheritableThreadLocal<>();
        ThreadLocal.set("父类数据:threadLocal");
        inheritableThreadLocal.set("父类数据:inheritableThreadLocal");

        new Thread(new Runnable() {
            @Override
            public void run() {
                System.out.println("子线程获取父类ThreadLocal数据：" + ThreadLocal.get());
                System.out.println("子线程获取父类inheritableThreadLocal数据：" + inheritableThreadLocal.get());
            }
        }).start();
    }
}
```

----------------------------------------

TITLE: Traditional Java String Concatenation Methods
DESCRIPTION: Different ways to concatenate strings in Java before String Templates feature, including concatenation operator, String.format(), MessageFormat, and StringBuilder.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java21.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
//concatenation
message = "Greetings " + name + "!";

//String.format()
message = String.format("Greetings %s!", name);  //concatenation

//MessageFormat
message = new MessageFormat("Greetings {0}!").format(name);

//StringBuilder
message = new StringBuilder().append("Greetings ").append(name).append("!").toString();
```

----------------------------------------

TITLE: Implementing Memory-Mapped File I/O in Java
DESCRIPTION: This code snippet demonstrates how to use memory-mapped file I/O in Java using FileChannel and MappedByteBuffer for improved performance.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/rocketmq-questions.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
FileChannel fileChannel = new RandomAccessFile("test.txt", "rw").getChannel();
MappedByteBuffer mappedByteBuffer = fileChannel.map(FileChannel.MapMode.READ_WRITE, 0, fileChannel.size());
```

----------------------------------------

TITLE: Generating Random Level for Skip List Node in Java
DESCRIPTION: Implements a method to randomly generate the level for a new node in the skip list, ensuring proper level distribution.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-skiplist.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
private int randomLevel() {
    int level = 1;
    while (Math.random() > PROB && level < MAX_LEVEL) {
        ++level;
    }
    return level;
}
```

----------------------------------------

TITLE: Implementing Producer-Consumer Pattern with ArrayBlockingQueue in Java
DESCRIPTION: Demonstrates using ArrayBlockingQueue for a producer-consumer scenario. Uses put() and take() methods for blocking operations, and a CountDownLatch for synchronization.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public class ProducerConsumerExample {

    public static void main(String[] args) throws InterruptedException {

        // 创建一个大小为 5 的 ArrayBlockingQueue
        ArrayBlockingQueue<Integer> queue = new ArrayBlockingQueue<>(5);

        // 创建生产者线程
        Thread producer = new Thread(() -> {
            try {
                for (int i = 1; i <= 10; i++) {
                    // 向队列中添加元素，如果队列已满则阻塞等待
                    queue.put(i);
                    System.out.println("生产者添加元素：" + i);
                }
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

        });

        CountDownLatch countDownLatch = new CountDownLatch(1);

        // 创建消费者线程
        Thread consumer = new Thread(() -> {
            try {
                int count = 0;
                while (true) {

                    // 从队列中取出元素，如果队列为空则阻塞等待
                    int element = queue.take();
                    System.out.println("消费者取出元素：" + element);
                    ++count;
                    if (count == 10) {
                        break;
                    }
                }

                countDownLatch.countDown();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

        });

        // 启动线程
        producer.start();
        consumer.start();

        // 等待线程结束
        producer.join();
        consumer.join();

        countDownLatch.await();

        producer.interrupt();
        consumer.interrupt();
    }

}
```

----------------------------------------

TITLE: Character Caching Implementation in Java
DESCRIPTION: This code demonstrates how Character objects are cached for values between 0 and 127, improving performance for frequently used characters.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public static Character valueOf(char c) {
    if (c <= 127) { // must cache
      return CharacterCache.cache[(int)c];
    }
    return new Character(c);
}

private static class CharacterCache {
    private CharacterCache(){}
    static final Character cache[] = new Character[127 + 1];
    static {
        for (int i = 0; i < cache.length; i++)
            cache[i] = new Character((char)i);
    }

}
```

----------------------------------------

TITLE: Put Operation in HashMap with LinkedHashMap Hooks
DESCRIPTION: Shows the putVal implementation in HashMap that includes hooks for LinkedHashMap's custom behavior through afterNodeAccess and afterNodeInsertion.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedhashmap-source-code.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) {
          //略
            if (e != null) { 
                V oldValue = e.value;
                if (!onlyIfAbsent || oldValue == null)
                    e.value = value;
                afterNodeAccess(e);
                return oldValue;
            }
        }
        ++modCount;
        if (++size > threshold)
            resize();
        afterNodeInsertion(evict);
        return null;
    }
```

----------------------------------------

TITLE: Basic Kafka Producer Message Sending
DESCRIPTION: Example of sending multiple messages to a Kafka topic using KafkaTemplate
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/kafka-questions-01.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
for (int i = 0; i < 10; i++) {
   kafkaTemplate.send(KafkaConst.TEST_TOPIC, String.valueOf(i))
}
```

----------------------------------------

TITLE: Deleting Records with TRUNCATE in SQL
DESCRIPTION: Demonstrates how to delete all records from exam_record table while resetting the auto-increment primary key using TRUNCATE command.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_7

LANGUAGE: SQL
CODE:
```
TRUNCATE exam_record;
```

----------------------------------------

TITLE: Querying Redis Maxmemory Configuration
DESCRIPTION: Command to check the configured maximum memory limit in Redis using the config get command.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_11

LANGUAGE: bash
CODE:
```
> config get maxmemory
maxmemory
0
```

----------------------------------------

TITLE: Rehashing in Java 7 ConcurrentHashMap
DESCRIPTION: This method handles the rehashing process when the ConcurrentHashMap needs to expand. It creates a new table with double the capacity and redistributes the existing entries.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/concurrent-hash-map-source-code.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
private void rehash(HashEntry<K,V> node) {
    HashEntry<K,V>[] oldTable = table;
    // 老容量
    int oldCapacity = oldTable.length;
    // 新容量，扩大两倍
    int newCapacity = oldCapacity << 1;
    // 新的扩容阀值
    threshold = (int)(newCapacity * loadFactor);
    // 创建新的数组
    HashEntry<K,V>[] newTable = (HashEntry<K,V>[]) new HashEntry[newCapacity];
    // 新的掩码，默认2扩容后是4，-1是3，二进制就是11。
    int sizeMask = newCapacity - 1;
    for (int i = 0; i < oldCapacity ; i++) {
        // 遍历老数组
        HashEntry<K,V> e = oldTable[i];
        if (e != null) {
            HashEntry<K,V> next = e.next;
            // 计算新的位置，新的位置只可能是不变或者是老的位置+老的容量。
            int idx = e.hash & sizeMask;
            if (next == null)   //  Single node on list
                // 如果当前位置还不是链表，只是一个元素，直接赋值
                newTable[idx] = e;
            else { // Reuse consecutive sequence at same slot
                // 如果是链表了
                HashEntry<K,V> lastRun = e;
                int lastIdx = idx;
                // 新的位置只可能是不变或者是老的位置+老的容量。
                // 遍历结束后，lastRun 后面的元素位置都是相同的
                for (HashEntry<K,V> last = next; last != null; last = last.next) {
                    int k = last.hash & sizeMask;
                    if (k != lastIdx) {
                        lastIdx = k;
                        lastRun = last;
                    }
                }
                // ，lastRun 后面的元素位置都是相同的，直接作为链表赋值到新位置。
                newTable[lastIdx] = lastRun;
                // Clone remaining nodes
                for (HashEntry<K,V> p = e; p != lastRun; p = p.next) {
                    // 遍历剩余元素，头插法到指定 k 位置。
                    V v = p.value;
                    int h = p.hash;
                    int k = h & sizeMask;
                    HashEntry<K,V> n = newTable[k];
                    newTable[k] = new HashEntry<K,V>(h, p.key, v, n);
                }
            }
        }
    }
    // 头插法插入新的节点
    int nodeIndex = node.hash & sizeMask; // add the new node
    node.setNext(newTable[nodeIndex]);
    newTable[nodeIndex] = node;
    table = newTable;
}
```

----------------------------------------

TITLE: Testing Stack Implementation in Java
DESCRIPTION: Demonstrates usage and testing of the custom MyStack implementation in Java.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/linear-data-structure.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
MyStack myStack = new MyStack(3);
myStack.push(1);
myStack.push(2);
myStack.push(3);
myStack.push(4);
myStack.push(5);
myStack.push(6);
myStack.push(7);
myStack.push(8);
System.out.println(myStack.peek());//8
System.out.println(myStack.size());//8
for (int i = 0; i < 8; i++) {
    System.out.println(myStack.pop());
}
System.out.println(myStack.isEmpty());//true
myStack.pop();//报错：java.lang.IllegalArgumentException: Stack is empty.
```

----------------------------------------

TITLE: Null Object Pattern for ConcurrentHashMap
DESCRIPTION: Implementation of a static null object to use as a replacement for null values in ConcurrentHashMap since it doesn't support null keys or values
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
public static final Object NULL = new Object();
```

----------------------------------------

TITLE: Synchronized Method Examples
DESCRIPTION: Examples of using synchronized keyword on instance methods, static methods and code blocks.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
synchronized void method() {
    //业务代码
}

synchronized static void method() {
    //业务代码
}

synchronized(this) {
    //业务代码
}
```

----------------------------------------

TITLE: Defining Runnable Interface in Java
DESCRIPTION: Definition of the Runnable interface in Java, which represents a task that can be executed by a thread.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-summary.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
@FunctionalInterface
public interface Runnable {
   /**
    * 被线程执行，没有返回值也无法抛出异常
    */
    public abstract void run();
}
```

----------------------------------------

TITLE: String Enhancement Methods in Java 12
DESCRIPTION: Demonstrates the new indent() and transform() methods added to String class for text manipulation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java12-13.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
String text = "Java";
// 缩进 4 格
text = text.indent(4);
System.out.println(text);
text = text.indent(-10);
System.out.println(text);
```

----------------------------------------

TITLE: Element Enqueuing in ArrayBlockingQueue
DESCRIPTION: Internal method to add an element to the queue and signal waiting consumers that the queue is not empty.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
private void enqueue(E x) {
    final Object[] items = this.items;
    items[putIndex] = x;
    if (++putIndex == items.length)
        putIndex = 0;
    count++;
    notEmpty.signal();
}
```

----------------------------------------

TITLE: Student Grade Classification Example with CASE WHEN
DESCRIPTION: A practical example showing how to use CASE WHEN THEN to classify student scores into different grade categories based on score ranges.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_11

LANGUAGE: SQL
CODE:
```
SELECT score,
    CASE
        WHEN score >= 90 THEN '优秀'
        WHEN score >= 80 THEN '良好'
        WHEN score >= 60 THEN '及格'
        ELSE '不及格'
    END AS grade
FROM student_scores;
```

----------------------------------------

TITLE: 为Redis分布式锁设置过期时间
DESCRIPTION: 使用SET命令的扩展选项为Redis分布式锁设置过期时间，防止锁长时间未释放导致的资源阻塞问题。EX表示过期时间（秒），NX表示仅在key不存在时才设置。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_3

LANGUAGE: bash
CODE:
```
127.0.0.1:6379> SET lockKey uniqueValue EX 3 NX
OK
```

----------------------------------------

TITLE: Structured Concurrency Basic Usage Example
DESCRIPTION: Shows how to use StructuredTaskScope for handling concurrent tasks in a structured way. The example demonstrates forking tasks, joining threads, and processing results.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java19.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
try (var scope = new StructuredTaskScope<Object>()) {
    // 使用fork方法派生线程来执行子任务
    Future<Integer> future1 = scope.fork(task1);
    Future<String> future2 = scope.fork(task2);
    // 等待线程完成
    scope.join();
    // 结果的处理可能包括处理或重新抛出异常
    ... process results/exceptions ...
} // close
```

----------------------------------------

TITLE: RpcStatus Class for Tracking Active Requests in Dubbo (Java)
DESCRIPTION: This snippet shows the RpcStatus class used by Dubbo to track active requests for each method of a service provider. It uses a ConcurrentMap to store the active request count for each URL and method combination.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/rpc/dubbo.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class RpcStatus {

    private static final ConcurrentMap<String, ConcurrentMap<String, RpcStatus>> METHOD_STATISTICS =
            new ConcurrentHashMap<String, ConcurrentMap<String, RpcStatus>>();

   public static RpcStatus getStatus(URL url, String methodName) {
        String uri = url.toIdentityString();
        ConcurrentMap<String, RpcStatus> map = METHOD_STATISTICS.computeIfAbsent(uri, k -> new ConcurrentHashMap<>());
        return map.computeIfAbsent(methodName, k -> new RpcStatus());
    }
    public int getActive() {
        return active.get();
    }

}
```

----------------------------------------

TITLE: Sending Transaction Message for Adding User View History in Java
DESCRIPTION: This code snippet demonstrates how to send a transaction message using RocketMQ for adding user view history. It uses a Function interface to encapsulate the business logic and passes it as a parameter to the message sending method.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/rocketmq-questions.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
@PostMapping("/add")
@ApiOperation("添加用户浏览记录")
public Result<TransactionSendResult> add(Long userId, Long forecastLogId) {

        // 函数式编程:浏览记录入库
        Function<String, Boolean> function = transactionId -> viewHistoryHandler.addViewHistory(transactionId, userId, forecastLogId);

        Map<String, Long> hashMap = new HashMap<>();
        hashMap.put("userId", userId);
        hashMap.put("forecastLogId", forecastLogId);
        String jsonString = JSON.toJSONString(hashMap);

        // 发送事务消息;将本地的事务操作,用函数Function接口接收,作为一个参数传入到方法中
        TransactionSendResult transactionSendResult = mqProducerService.sendTransactionMessage(jsonString, MQDestination.TAG_ADD_VIEW_HISTORY, function);
        return Result.success(transactionSendResult);
}
```

----------------------------------------

TITLE: Thread Safety Improvements using Synchronization
DESCRIPTION: Different approaches to make the increment operation thread-safe using synchronized, AtomicInteger and ReentrantLock
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
public synchronized void increase() {
    inc++;
}

public AtomicInteger inc = new AtomicInteger();

public void increase() {
    inc.getAndIncrement();
}

Lock lock = new ReentrantLock();
public void increase() {
    lock.lock();
    try {
        inc++;
    } finally {
        lock.unlock();
    }
}
```

----------------------------------------

TITLE: Static and non-static code block execution in Java
DESCRIPTION: This code snippet demonstrates the execution order of static and non-static code blocks in Java. It shows how static blocks are executed before non-static blocks and constructors.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-keyword-summary.md#2025-04-20_snippet_6

LANGUAGE: Java
CODE:
```
public class Test {
    public Test() {
        System.out.print("默认构造方法！--");
    }
    //非静态代码块
    {
        System.out.print("非静态代码块！--");
    }
    //静态代码块
    static {
        System.out.print("静态代码块！--");
    }
    private static void test() {
        System.out.print("静态方法中的内容! --");
        {
            System.out.print("静态方法中的代码块！--");
        }
    }
    public static void main(String[] args) {
        Test test = new Test();
        Test.test();//静态代码块！--静态方法中的内容! --静态方法中的代码块！--
    }
}
```

----------------------------------------

TITLE: Time Complexity of Linked List Operations in Java
DESCRIPTION: Shows the time complexity of basic operations (access, insert, delete) on linked lists in Java.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/linear-data-structure.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
假如链表中有n个元素。
访问：O（n）//访问特定位置的元素
插入删除：O（1）//必须要要知道插入元素的位置
```

----------------------------------------

TITLE: Element Dequeuing in ArrayBlockingQueue
DESCRIPTION: Internal method to remove and return an element from the queue and signal waiting producers that the queue is not full.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_12

LANGUAGE: java
CODE:
```
private E dequeue() {
  final Object[] items = this.items;
  @SuppressWarnings("unchecked")
  E x = (E) items[takeIndex];
  items[takeIndex] = null;
  if (++takeIndex == items.length)
      takeIndex = 0;
  count--;
  if (itrs != null)
      itrs.elementDequeued();
  notFull.signal();
  return x;
}
```

----------------------------------------

TITLE: 事务外部修改WATCH监视的键
DESCRIPTION: 展示了在WATCH命令监视键后，如果在同一会话的事务外部修改了该键，随后的事务将无法执行成功。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-02.md#2025-04-20_snippet_4

LANGUAGE: bash
CODE:
```
> SET PROJECT "JavaGuide"
OK
> WATCH PROJECT
OK
> SET PROJECT "JavaGuide2"
OK
> MULTI
OK
> GET USER
QUEUED
> EXEC
(nil)
```

----------------------------------------

TITLE: Defining Static Members in Non-Static Inner Classes in Java 16
DESCRIPTION: This code snippet demonstrates the new ability to define non-constant static members in non-static inner classes, which was introduced in Java 16.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java16.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public class Outer {
  class Inner {
    static int age;
  }
}
```

----------------------------------------

TITLE: 接口方法类型示例
DESCRIPTION: 展示Java 8及以上版本中接口支持的不同方法类型:default方法、static方法和private方法
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
public interface MyInterface {
    // default 方法
    default void defaultMethod() {
        commonMethod();
    }

    // static 方法
    static void staticMethod() {
        commonMethod();
    }

    // 私有静态方法，可以被 static 和 default 方法调用
    private static void commonMethod() {
        System.out.println("This is a private method used internally.");
    }

      // 实例私有方法，只能被 default 方法调用。
    private void instanceCommonMethod() {
        System.out.println("This is a private instance method used internally.");
    }
}
```

----------------------------------------

TITLE: Java DeadLock Implementation
DESCRIPTION: Example code demonstrating a deadlock situation between two threads using synchronized resources
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jdk-monitoring-and-troubleshooting-tools.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class DeadLockDemo {
    private static Object resource1 = new Object();//资源 1
    private static Object resource2 = new Object();//资源 2

    public static void main(String[] args) {
        new Thread(() -> {
            synchronized (resource1) {
                System.out.println(Thread.currentThread() + "get resource1");
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(Thread.currentThread() + "waiting get resource2");
                synchronized (resource2) {
                    System.out.println(Thread.currentThread() + "get resource2");
                }
            }
        }, "线程 1").start();

        new Thread(() -> {
            synchronized (resource2) {
                System.out.println(Thread.currentThread() + "get resource2");
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(Thread.currentThread() + "waiting get resource1");
                synchronized (resource1) {
                    System.out.println(Thread.currentThread() + "get resource1");
                }
            }
        }, "线程 2").start();
    }
}
```

----------------------------------------

TITLE: Calculating Truncated Average Score for SQL Hard Exams (Proper Approach)
DESCRIPTION: A more comprehensive SQL query that calculates the truncated average for hard SQL exams. This implementation uses subqueries to properly identify the SQL hard exam by its tag and difficulty rather than hardcoding the exam ID.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_1

LANGUAGE: SQL
CODE:
```
SELECT tag,
       difficulty,
       ROUND(AVG(score), 1) clip_avg_score
FROM examination_info info
INNER JOIN exam_record record
WHERE info.exam_id = record.exam_id
  AND record.exam_id =
    (SELECT examination_info.exam_id
     FROM examination_info
     WHERE tag = 'SQL'
       AND difficulty = 'hard' )
  AND record.score NOT IN
    (SELECT MAX(score)
     FROM exam_record
     WHERE exam_id =
         (SELECT examination_info.exam_id
          FROM examination_info
          WHERE tag = 'SQL'
            AND difficulty = 'hard' )
     UNION ALL SELECT MIN(score)
     FROM exam_record
     WHERE exam_id =
         (SELECT examination_info.exam_id
          FROM examination_info
          WHERE tag = 'SQL'
            AND difficulty = 'hard' ) )
```

----------------------------------------

TITLE: Hashing Function for HashMap in Java
DESCRIPTION: The hash method used in HashMap to compute the hash code of keys. It applies a bitwise XOR operation to spread the influence of higher bits.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
    static final int hash(Object key) {
      int h;
      // key.hashCode()：返回散列值也就是hashcode
      // ^：按位异或
      // >>>:无符号右移，忽略符号位，空位都以0补齐
      return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
  }
```

----------------------------------------

TITLE: Depicting Leader Election Process in ZooKeeper
DESCRIPTION: Diagram illustrating the leader election process in ZooKeeper using temporary nodes and watchers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-plus.md#2025-04-20_snippet_2

LANGUAGE: markdown
CODE:
```
![选主](https://oss.javaguide.cn/p3-juejin/00468757fb8f4f51875f645fbb7b25a2~tplv-k3u1fbpfcp-zoom-1.jpeg)
```

----------------------------------------

TITLE: Creating a Table with Auto-Increment Primary Key in MySQL
DESCRIPTION: This SQL snippet demonstrates how to create a table with an auto-increment primary key in MySQL. It includes the table definition with ID as the auto-increment field and a unique key on the 'stub' column.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_8

LANGUAGE: sql
CODE:
```
CREATE TABLE `sequence_id` (
  `id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT,
  `stub` CHAR(10) NOT NULL DEFAULT '',
  PRIMARY KEY (`id`),
  UNIQUE KEY `stub` (`stub`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

----------------------------------------

TITLE: 使用AtomicStampedReference进行带版本号的引用类型原子操作
DESCRIPTION: 演示了如何使用AtomicStampedReference类对带有版本号的引用类型进行原子操作，可用于解决ABA问题。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/atomic-classes.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
AtomicStampedReference<String> asr = new AtomicStampedReference<>("SnailClimb", 1);

int[] initialStamp = new int[1];
String initialRef = asr.get(initialStamp);
System.out.println("Initial Reference: " + initialRef + ", Initial Stamp: " + initialStamp[0]);

int oldStamp = initialStamp[0];
String oldRef = initialRef;
String newRef = "Daisy";
int newStamp = oldStamp + 1;

boolean isUpdated = asr.compareAndSet(oldRef, newRef, oldStamp, newStamp);
System.out.println("Update Success: " + isUpdated);

int[] updatedStamp = new int[1];
String updatedRef = asr.get(updatedStamp);
System.out.println("Updated Reference: " + updatedRef + ", Updated Stamp: " + updatedStamp[0]);

boolean isUpdatedWithWrongStamp = asr.compareAndSet(newRef, "John", oldStamp, newStamp + 1);
System.out.println("Update with Wrong Stamp Success: " + isUpdatedWithWrongStamp);

int[] finalStamp = new int[1];
String finalRef = asr.get(finalStamp);
System.out.println("Final Reference: " + finalRef + ", Final Stamp: " + finalStamp[0]);
```

----------------------------------------

TITLE: Atomic Compound Operations Solutions
DESCRIPTION: Examples of using atomic compound operations putIfAbsent and computeIfAbsent to ensure thread safety
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
// 线程 A
map.putIfAbsent(key, value);
// 线程 B
map.putIfAbsent(key, anotherValue);
```

LANGUAGE: java
CODE:
```
// 线程 A
map.computeIfAbsent(key, k -> value);
// 线程 B
map.computeIfAbsent(key, k -> anotherValue);
```

----------------------------------------

TITLE: Implementing String Class with byte[] in Java 9+
DESCRIPTION: This code snippet shows the implementation of the String class in Java 9 and later versions, where the internal representation has changed from char[] to byte[] for memory efficiency.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
public final class String implements java.io.Serializable,Comparable<String>, CharSequence {
    // @Stable 注解表示变量最多被修改一次，称为"稳定的"。
    @Stable
    private final byte[] value;
}
```

----------------------------------------

TITLE: Using EXPLAIN Command for SQL Analysis
DESCRIPTION: Example showing EXPLAIN command usage for analyzing query execution plans and index usage. This is a key tool for SQL performance optimization.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_10

LANGUAGE: sql
CODE:
```
EXPLAIN
```

----------------------------------------

TITLE: 查询Redis进程内存交换信息
DESCRIPTION: 使用cat命令查看特定进程的内存映射信息，并通过grep过滤出与内存交换相关的行。这个命令用于检查Redis进程是否发生了内存交换。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-common-blocking-problems-summary.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
cat /proc/4476/smaps | grep Swap
```

----------------------------------------

TITLE: Using Record Patterns with instanceof in Java
DESCRIPTION: This code demonstrates the use of record patterns with instanceof to destructure and extract data from record classes more conveniently.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java20.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
record Shape(String type, long unit){}

Shape circle = new Shape("Circle", 10);
if (circle instanceof Shape(String type, long unit)) {
  System.out.println("Area of " + type + " is : " + Math.PI * Math.pow(unit, 2));
}
```

----------------------------------------

TITLE: Copying File Content Using BufferedInputStream and BufferedOutputStream with Try-with-Resources
DESCRIPTION: This code snippet demonstrates how to use multiple resources in a try-with-resources statement to copy content from one file to another using BufferedInputStream and BufferedOutputStream.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
try (BufferedInputStream bin = new BufferedInputStream(new FileInputStream(new File("test.txt")));
     BufferedOutputStream bout = new BufferedOutputStream(new FileOutputStream(new File("out.txt")))) {
    int b;
    while ((b = bin.read()) != -1) {
        bout.write(b);
    }
}
catch (IOException e) {
    e.printStackTrace();
}
```

----------------------------------------

TITLE: Performance Test With ensureCapacity in Java
DESCRIPTION: A performance test measuring the time required to add a large number of elements to an ArrayList after pre-allocating capacity using the ensureCapacity method to avoid incremental resizing.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_17

LANGUAGE: java
CODE:
```
public class EnsureCapacityTest {
    public static void main(String[] args) {
        ArrayList<Object> list = new ArrayList<Object>();
        final int N = 10000000;
        long startTime1 = System.currentTimeMillis();
        list.ensureCapacity(N);
        for (int i = 0; i < N; i++) {
            list.add(i);
        }
        long endTime1 = System.currentTimeMillis();
        System.out.println("使用ensureCapacity方法后："+(endTime1 - startTime1));
    }
}
```

----------------------------------------

TITLE: Vector API Computation Examples
DESCRIPTION: Demonstrates scalar and vector computation implementations using the Vector API in Java 18, showing performance improvements for array operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java18.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
void scalarComputation(float[] a, float[] b, float[] c) {
   for (int i = 0; i < a.length; i++) {
        c[i] = (a[i] * a[i] + b[i] * b[i]) * -1.0f;
   }
}
```

LANGUAGE: java
CODE:
```
static final VectorSpecies<Float> SPECIES = FloatVector.SPECIES_PREFERRED;

void vectorComputation(float[] a, float[] b, float[] c) {
    int i = 0;
    int upperBound = SPECIES.loopBound(a.length);
    for (; i < upperBound; i += SPECIES.length()) {
        // FloatVector va, vb, vc;
        var va = FloatVector.fromArray(SPECIES, a, i);
        var vb = FloatVector.fromArray(SPECIES, b, i);
        var vc = va.mul(va)
                   .add(vb.mul(vb))
                   .neg();
        vc.intoArray(c, i);
    }
    for (; i < a.length; i++) {
        c[i] = (a[i] * a[i] + b[i] * b[i]) * -1.0f;
    }
}
```

----------------------------------------

TITLE: Initializing CopyOnWriteArrayList in Java
DESCRIPTION: Different constructors for initializing a CopyOnWriteArrayList, including empty list, from existing collection, and from array.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/copyonwritearraylist-source-code.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public CopyOnWriteArrayList() {
    setArray(new Object[0]);
}

public CopyOnWriteArrayList(Collection<? extends E> c) {
    Object[] elements;
    if (c.getClass() == CopyOnWriteArrayList.class)
        elements = ((CopyOnWriteArrayList<?>)c).getArray();
    else {
        elements = c.toArray();
        if (elements.getClass() != Object[].class)
            elements = Arrays.copyOf(elements, elements.length, Object[].class);
    }
    setArray(elements);
}

public CopyOnWriteArrayList(E[] toCopyIn) {
    setArray(Arrays.copyOf(toCopyIn, toCopyIn.length, Object[].class));
}
```

----------------------------------------

TITLE: Analyzing Monthly and Daily Question Practice Counts
DESCRIPTION: This query analyzes the monthly total and daily average question practice counts for 2021. It uses date functions to format months, calculate days in each month, and provides a summary for the entire year using UNION ALL.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_7

LANGUAGE: SQL
CODE:
```
SELECT DATE_FORMAT(submit_time, '%Y%m') submit_month,
       count(question_id) month_q_cnt,
       ROUND(COUNT(question_id) / DAY (LAST_DAY(submit_time)), 3) avg_day_q_cnt
FROM practice_record
WHERE DATE_FORMAT(submit_time, '%Y') = '2021'
GROUP BY submit_month
UNION ALL
SELECT '2021汇总' AS submit_month,
       count(question_id) month_q_cnt,
       ROUND(COUNT(question_id) / 31, 3) avg_day_q_cnt
FROM practice_record
WHERE DATE_FORMAT(submit_time, '%Y') = '2021'
ORDER BY submit_month
```

----------------------------------------

TITLE: Finding Algorithm Users Who Completed Tests on Registration Day
DESCRIPTION: Complex SQL query to find algorithm job candidates who completed algorithm tests on their registration day, with pagination showing the third page of results ordered by max score.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_7

LANGUAGE: SQL
CODE:
```
SELECT t1.uid,
       LEVEL,
       register_time,
       max(score) AS max_score
FROM exam_record t
JOIN examination_info USING (exam_id)
JOIN user_info t1 ON t.uid = t1.uid
AND date(t.submit_time) = date(t1.register_time)
WHERE job = '算法'
  AND tag = '算法'
GROUP BY t1.uid,
         LEVEL,
         register_time
ORDER BY max_score DESC
LIMIT 6,3
```

----------------------------------------

TITLE: Comparing Local and Remote Function Calls in RPC
DESCRIPTION: These code snippets illustrate the difference between calling a local function and a remote function using RPC. The syntax is similar, demonstrating how RPC aims to make remote calls feel like local ones.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/rpc/http&rpc.md#2025-04-20_snippet_1

LANGUAGE: ini
CODE:
```
res = localFunc(req)
```

LANGUAGE: ini
CODE:
```
res = remoteFunc(req)
```

----------------------------------------

TITLE: Add Operation in ArrayBlockingQueue
DESCRIPTION: Implementation of add operation that throws an exception if the queue is full instead of returning false.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_15

LANGUAGE: java
CODE:
```
public boolean add(E e) {
        return super.add(e);
    }

public boolean add(E e) {
        if (offer(e))
            return true;
        else
            throw new IllegalStateException("Queue full");
    }
```

----------------------------------------

TITLE: Docker Compose Down Command Options
DESCRIPTION: Commands for stopping and removing containers, networks, and volumes created by 'docker-compose up' with various options for targeting specific services or just stopping without removal.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_9

LANGUAGE: bash
CODE:
```
# 在当前目录下寻找 docker-compose.yml 文件
# 根据其中定义移除启动的所有容器，网络和卷。
docker-compose down
# 停止容器但不移除
docker-compose down --stop
# 指定要停止和移除的特定服务，而不是停止和移除所有服务
# 可以同时指定多个服务，用空格分隔。
docker-compose down service_name
```

----------------------------------------

TITLE: Inefficient String Concatenation in Loops with '+' Operator
DESCRIPTION: This code shows the inefficient way of concatenating strings in a loop using the '+' operator. This approach creates a new StringBuilder object on each iteration, which is inefficient for memory usage and performance.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_13

LANGUAGE: java
CODE:
```
String[] arr = {"he", "llo", "world"};
String s = "";
for (int i = 0; i < arr.length; i++) {
    s += arr[i];
}
System.out.println(s);
```

----------------------------------------

TITLE: Implementing Bucket Sort in Java
DESCRIPTION: Java implementation of the Bucket Sort algorithm, including methods for finding min/max values and the main sorting function.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/10-classical-sorting-algorithms.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
private static int[] getMinAndMax(List<Integer> arr) {
    int maxValue = arr.get(0);
    int minValue = arr.get(0);
    for (int i : arr) {
        if (i > maxValue) {
            maxValue = i;
        } else if (i < minValue) {
            minValue = i;
        }
    }
    return new int[] { minValue, maxValue };
}

public static List<Integer> bucketSort(List<Integer> arr, int bucket_size) {
    if (arr.size() < 2 || bucket_size == 0) {
        return arr;
    }
    int[] extremum = getMinAndMax(arr);
    int minValue = extremum[0];
    int maxValue = extremum[1];
    int bucket_cnt = (maxValue - minValue) / bucket_size + 1;
    List<List<Integer>> buckets = new ArrayList<>();
    for (int i = 0; i < bucket_cnt; i++) {
        buckets.add(new ArrayList<Integer>());
    }
    for (int element : arr) {
        int idx = (element - minValue) / bucket_size;
        buckets.get(idx).add(element);
    }
    for (int i = 0; i < buckets.size(); i++) {
        if (buckets.get(i).size() > 1) {
            buckets.set(i, sort(buckets.get(i), bucket_size / 2));
        }
    }
    ArrayList<Integer> result = new ArrayList<>();
    for (List<Integer> bucket : buckets) {
        for (int element : bucket) {
            result.add(element);
        }
    }
    return result;
}
```

----------------------------------------

TITLE: SelectImports Method Implementation for Auto-Configuration
DESCRIPTION: Implementation of the selectImports method that determines which auto-configuration classes should be loaded into the IoC container.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-boot-auto-assembly-principles.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
private static final String[] NO_IMPORTS = new String[0];

public String[] selectImports(AnnotationMetadata annotationMetadata) {
        // <1>.判断自动装配开关是否打开
        if (!this.isEnabled(annotationMetadata)) {
            return NO_IMPORTS;
        } else {
          //<2>.获取所有需要装配的bean
            AutoConfigurationMetadata autoConfigurationMetadata = AutoConfigurationMetadataLoader.loadMetadata(this.beanClassLoader);
            AutoConfigurationImportSelector.AutoConfigurationEntry autoConfigurationEntry = this.getAutoConfigurationEntry(autoConfigurationMetadata, annotationMetadata);
            return StringUtils.toStringArray(autoConfigurationEntry.getConfigurations());
        }
    }
```

----------------------------------------

TITLE: Implementing Fibonacci Sequence with Recursion in Java
DESCRIPTION: This code implements the Fibonacci sequence calculation using recursion. While simple to understand, this approach has exponential time complexity O(2^n) due to repeated calculations, making it inefficient for larger inputs.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public int Fibonacci(int n) {
    if (n <= 0) {
        return 0;
    }
    if (n == 1||n==2) {
        return 1;
    }

    return Fibonacci(n - 2) + Fibonacci(n - 1);
}
```

----------------------------------------

TITLE: Demonstrating Enhanced Null Pointer Exception in Java 14
DESCRIPTION: Shows how Java 14 provides more detailed information in null pointer exceptions when using the -XX:+ShowCodeDetailsInExceptionMessages JVM parameter.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java14-15.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
a.b.c.i = 99; // 假设这段代码会发生空指针
```

LANGUAGE: java
CODE:
```
Exception in thread "main" java.lang.NullPointerException
    at NullPointerExample.main(NullPointerExample.java:5)
```

LANGUAGE: java
CODE:
```
Exception in thread "main" java.lang.NullPointerException:
        Cannot read field 'c' because 'a.b' is null.
    at Prog.main(Prog.java:5)
```

----------------------------------------

TITLE: LinkedList Iterator Implementation in Java
DESCRIPTION: Shows the core implementation of LinkedList's bidirectional iterator (ListItr). It includes key fields used for tracking the current position and detecting concurrent modifications.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
// 双向迭代器
private class ListItr implements ListIterator<E> {
    // 表示上一次调用 next() 或 previous() 方法时经过的节点；
    private Node<E> lastReturned;
    // 表示下一个要遍历的节点；
    private Node<E> next;
    // 表示下一个要遍历的节点的下标，也就是当前节点的后继节点的下标；
    private int nextIndex;
    // 表示当前遍历期望的修改计数值，用于和 LinkedList 的 modCount 比较，判断链表是否被其他线程修改过。
    private int expectedModCount = modCount;
    …………
}
```

----------------------------------------

TITLE: Forward Iteration Methods in LinkedList Iterator in Java
DESCRIPTION: Explains the implementation of hasNext() and next() methods in LinkedList's iterator for forward traversal. These methods check for the next element and return it while updating internal pointers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
// 判断还有没有下一个节点
public boolean hasNext() {
    // 判断下一个节点的下标是否小于链表的大小，如果是则表示还有下一个元素可以遍历
    return nextIndex < size;
}
// 获取下一个节点
public E next() {
    // 检查在迭代过程中链表是否被修改过
    checkForComodification();
    // 判断是否还有下一个节点可以遍历，如果没有则抛出 NoSuchElementException 异常
    if (!hasNext())
        throw new NoSuchElementException();
    // 将 lastReturned 指向当前节点
    lastReturned = next;
    // 将 next 指向下一个节点
    next = next.next;
    nextIndex++;
    return lastReturned.item;
}
```

----------------------------------------

TITLE: Implementing ThreadLocal's Hash Algorithm in Java
DESCRIPTION: Code snippet showing the hash calculation used in ThreadLocalMap to determine the index for storing values.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
public class ThreadLocal<T> {
    private final int threadLocalHashCode = nextHashCode();

    private static AtomicInteger nextHashCode = new AtomicInteger();

    private static final int HASH_INCREMENT = 0x61c88647;

    private static int nextHashCode() {
        return nextHashCode.getAndAdd(HASH_INCREMENT);
    }

    static class ThreadLocalMap {
        ThreadLocalMap(ThreadLocal<?> firstKey, Object firstValue) {
            table = new Entry[INITIAL_CAPACITY];
            int i = firstKey.threadLocalHashCode & (INITIAL_CAPACITY - 1);

            table[i] = new Entry(firstKey, firstValue);
            size = 1;
            setThreshold(INITIAL_CAPACITY);
        }
    }
}
```

----------------------------------------

TITLE: Defining Future Interface in Java
DESCRIPTION: Core Future interface definition showing the main methods for handling asynchronous tasks including cancellation, status checks and result retrieval.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/completablefuture-intro.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public interface Future<V> {
    boolean cancel(boolean mayInterruptIfRunning);
    boolean isCancelled();
    boolean isDone();
    V get() throws InterruptedException, ExecutionException;
    V get(long timeout, TimeUnit unit)
        throws InterruptedException, ExecutionException, TimeoutException
}
```

----------------------------------------

TITLE: Enhanced String Methods in Java 11
DESCRIPTION: Shows new String handling methods introduced in Java 11 including isBlank(), strip(), stripLeading(), stripTrailing(), repeat(), and lines().
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java11.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
//判断字符串是否为空
" ".isBlank();//true
//去除字符串首尾空格
" Java ".strip();// "Java"
//去除字符串首部空格
" Java ".stripLeading();   // "Java "
//去除字符串尾部空格
" Java ".stripTrailing();  // " Java"
//重复字符串多少次
"Java".repeat(3);             // "JavaJavaJava"
//返回由行终止符分隔的字符串集合。
"A\nB\nC".lines().count();    // 3
"A\nB\nC".lines().collect(Collectors.toList());
```

----------------------------------------

TITLE: Traversing LinkedList using for-each loop in Java
DESCRIPTION: Demonstrates how to use a for-each loop to iterate over elements in a LinkedList. This method is recommended as it's eventually converted to an iterator form.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
LinkedList<String> list = new LinkedList<>();
list.add("apple");
list.add("banana");
list.add("pear");

for (String fruit : list) {
    System.out.println(fruit);
}
```

----------------------------------------

TITLE: Implementing AbstractStringBuilder with byte[] in Java 9+
DESCRIPTION: This code snippet shows the implementation of the AbstractStringBuilder class in Java 9 and later versions, where the internal representation has changed from char[] to byte[] for memory efficiency.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
abstract class AbstractStringBuilder implements Appendable, CharSequence {
    byte[] value;

}
```

----------------------------------------

TITLE: Circular Reference Example in Java
DESCRIPTION: Code demonstrating circular reference between objects to explain limitations of reference counting garbage collection.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-garbage-collection.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public class ReferenceCountingGc {
    Object instance = null;
    public static void main(String[] args) {
        ReferenceCountingGc objA = new ReferenceCountingGc();
        ReferenceCountingGc objB = new ReferenceCountingGc();
        objA.instance = objB;
        objB.instance = objA;
        objA = null;
        objB = null;
    }
}
```

----------------------------------------

TITLE: Demonstrating Maven Standard Directory Structure
DESCRIPTION: Shows the standard Maven project directory structure that maintains consistency across projects. This structure includes source code, resources, and test directories that Maven recognizes by default.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_0

LANGUAGE: groovy
CODE:
```
src/
  main/
    java/
    resources/
  test/
    java/
    resources/
pom.xml
```

----------------------------------------

TITLE: Creating String Objects with 'new String()' and Bytecode Analysis
DESCRIPTION: This code and its bytecode analysis shows how new String() creates objects in memory. When using 'new String("abc")', either 1 or 2 objects may be created depending on whether "abc" already exists in the string constant pool.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_16

LANGUAGE: java
CODE:
```
String s1 = new String("abc");
```

----------------------------------------

TITLE: Implementing Hidden Form Fields for Session Tracking in HTML
DESCRIPTION: This snippet demonstrates how to use hidden form fields to maintain session state across page requests. This method is especially useful when cookies are disabled in the client browser.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/J2EE基础知识.md#2025-04-20_snippet_4

LANGUAGE: html
CODE:
```
<input type="hidden" name="session" value="..." />
```

----------------------------------------

TITLE: Markdown Documentation of Big Data Projects
DESCRIPTION: Overview of major open source big data processing frameworks and their core functionalities including Spark for unified analytics, Flink for stream processing, HBase for distributed storage, Flume for log aggregation, and Storm for real-time computation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/open-source-project/big-data.md#2025-04-20_snippet_0

LANGUAGE: markdown
CODE:
```
---
title: Java 优质开源大数据项目
category: 开源项目
icon: big-data
---

- **[Spark](https://github.com/apache/spark)** :Spark 是用于大规模数据处理的统一分析引擎。
- **[Flink](https://github.com/apache/flink "flink")**：Apache Flink 是一个框架和分布式处理引擎，用于在*无边界和有边界*数据流上进行有状态的计算。Flink 能在所有常见集群环境中运行，并能以内存速度和任意规模进行计算。
- **[HBase](https://hbase.apache.org/)**：HBase – Hadoop Database，是一个高可靠性、高性能、面向列、可伸缩的分布式存储系统，利用 HBase 技术可在廉价 PC Server 上搭建起大规模结构化存储集群。
- **[Flume](https://flume.apache.org/)** :Apache Flume 是一个分布式的、可靠的、可用的，从多种不同的源收集、聚集、移动大量日志数据到集中数据存储的系统。
- **[Storm](https://storm.apache.org/)** : 一个分布式，高容错的实时计算系统。
```

----------------------------------------

TITLE: Using Custom Docker Compose File Names
DESCRIPTION: Command showing how to specify a custom filename for Docker Compose configuration using the -f parameter, allowing for environment-specific configurations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_8

LANGUAGE: bash
CODE:
```
docker-compose -f docker-compose.prod.yml up
```

----------------------------------------

TITLE: 封装示例 - Student类
DESCRIPTION: 展示封装原则的实现,通过private属性和public访问方法来控制对象状态的访问
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
public class Student {
    private int id;//id属性私有化
    private String name;//name属性私有化

    //获取id的方法
    public int getId() {
        return id;
    }

    //设置id的方法
    public void setId(int id) {
        this.id = id;
    }

    //获取name的方法
    public String getName() {
        return name;
    }

    //设置name的方法
    public void setName(String name) {
        this.name = name;
    }
}
```

----------------------------------------

TITLE: Defining Logger SPI Interface in Java
DESCRIPTION: Defines the Logger interface as the Service Provider Interface (SPI) that service providers will implement.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/spi.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
package edu.jiangxuan.up.spi;

public interface Logger {
    void info(String msg);
    void debug(String msg);
}
```

----------------------------------------

TITLE: Backward Iteration Methods in LinkedList Iterator in Java
DESCRIPTION: Demonstrates the implementation of hasPrevious() and previous() methods in LinkedList's iterator for backward traversal. These methods check for the previous element and return it while updating internal pointers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
// 判断是否还有前一个节点
public boolean hasPrevious() {
    return nextIndex > 0;
}

// 获取前一个节点
public E previous() {
    // 检查是否在迭代过程中链表被修改
    checkForComodification();
    // 如果没有前一个节点，则抛出异常
    if (!hasPrevious())
        throw new NoSuchElementException();
    // 将 lastReturned 和 next 指针指向上一个节点
    lastReturned = next = (next == null) ? last : next.prev;
    nextIndex--;
    return lastReturned.item;
}
```

----------------------------------------

TITLE: Defining a Custom java.lang.String Class (Invalid Example)
DESCRIPTION: An example showing an attempt to define a custom String class in the java.lang package, which will fail due to the class loader's delegation model.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-intro.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
package java.lang;
public class String {
    public static void main(String[] args) {
        System.out.println();
    }
}
```

----------------------------------------

TITLE: Enabling MySQL Query Cache via SQL Commands
DESCRIPTION: SQL commands to dynamically enable MySQL query cache. These global settings activate the query cache and set its size without requiring a server restart.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_3

LANGUAGE: properties
CODE:
```
set global  query_cache_type=1;
set global  query_cache_size=600000;
```

----------------------------------------

TITLE: RocketMQ Transaction Message Listener Implementation in Java
DESCRIPTION: This class implements the RocketMQLocalTransactionListener interface to handle local transaction execution and transaction status checks for RocketMQ transaction messages.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/rocketmq-questions.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
@Slf4j
@RocketMQTransactionListener
public class TransactionMsgListener implements RocketMQLocalTransactionListener {

    @Autowired
    private RedisService redisService;

    @Override
    public RocketMQLocalTransactionState executeLocalTransaction(Message message, Object o) {
        // Implementation details omitted for brevity
    }

    @Override
    public RocketMQLocalTransactionState checkLocalTransaction(Message message) {
        // Implementation details omitted for brevity
    }
}
```

----------------------------------------

TITLE: Querying Incomplete Exams and User Performance in SQL
DESCRIPTION: This SQL query analyzes exam records to find users with more than one incomplete exam in 2021. It calculates incomplete and complete exam counts, and concatenates exam details including date and tag.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_8

LANGUAGE: SQL
CODE:
```
SELECT a.uid,
       SUM(CASE
               WHEN a.submit_time IS NULL THEN 1
           END) AS incomplete_cnt,
       SUM(CASE
               WHEN a.submit_time IS NOT NULL THEN 1
           END) AS complete_cnt,
       GROUP_CONCAT(DISTINCT CONCAT(DATE_FORMAT(a.start_time, '%Y-%m-%d'), ':', b.tag)
                    ORDER BY start_time SEPARATOR ";") AS detail
FROM exam_record a
LEFT JOIN examination_info b ON a.exam_id = b.exam_id
WHERE YEAR (a.start_time)= 2021
GROUP BY a.uid
HAVING incomplete_cnt > 1
AND complete_cnt >= 1
AND incomplete_cnt < 5
ORDER BY incomplete_cnt DESC
```

----------------------------------------

TITLE: Using DENSE_RANK() Window Function in MySQL
DESCRIPTION: Illustrates how to use the DENSE_RANK() function to calculate rankings while preserving the same rank for tied values, unlike RANK() which leaves gaps.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_2

LANGUAGE: sql
CODE:
```
SELECT col1, col2, DENSE_RANK() OVER (ORDER BY col1 DESC) AS ranking
FROM table;
```

----------------------------------------

TITLE: Testing Bloom Filter with Strings
DESCRIPTION: Example code demonstrating how to test the custom Bloom Filter implementation with string values.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/bloom-filter.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
String value1 = "https://javaguide.cn/";
String value2 = "https://github.com/Snailclimb";
MyBloomFilter filter = new MyBloomFilter();
System.out.println(filter.contains(value1));
System.out.println(filter.contains(value2));
filter.add(value1);
filter.add(value2);
System.out.println(filter.contains(value1));
System.out.println(filter.contains(value2));
```

----------------------------------------

TITLE: Static Constants and Methods Example
DESCRIPTION: Demonstration of static constants and methods usage in a Java class.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_16

LANGUAGE: java
CODE:
```
public class Example {
    // 定义一个字符型常量
    public static final char LETTER_A = 'A';

    // 定义一个字符串常量
    public static final String GREETING_MESSAGE = "Hello, world!";

    public static void main(String[] args) {
        // 输出字符型常量的值
        System.out.println("字符型常量的值为：" + LETTER_A);

        // 输出字符串常量的值
        System.out.println("字符串常量的值为：" + GREETING_MESSAGE);
    }
}
```

----------------------------------------

TITLE: HashMap Constructors Implementation
DESCRIPTION: Various constructor implementations of HashMap including default, copy, and parameterized constructors.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
public HashMap() {
    this.loadFactor = DEFAULT_LOAD_FACTOR;
}

public HashMap(Map<? extends K, ? extends V> m) {
    this.loadFactor = DEFAULT_LOAD_FACTOR;
    putMapEntries(m, false);
}

public HashMap(int initialCapacity) {
    this(initialCapacity, DEFAULT_LOAD_FACTOR);
}

public HashMap(int initialCapacity, float loadFactor) {
    if (initialCapacity < 0)
        throw new IllegalArgumentException("Illegal initial capacity: " + initialCapacity);
    if (initialCapacity > MAXIMUM_CAPACITY)
        initialCapacity = MAXIMUM_CAPACITY;
    if (loadFactor <= 0 || Float.isNaN(loadFactor))
        throw new IllegalArgumentException("Illegal load factor: " + loadFactor);
    this.loadFactor = loadFactor;
    this.threshold = tableSizeFor(initialCapacity);
}
```

----------------------------------------

TITLE: Configuring jacoco-maven-plugin for Code Coverage in Maven
DESCRIPTION: This snippet demonstrates how to configure the jacoco-maven-plugin in a Maven project to generate code coverage reports. The plugin is executed during the test phase with two main goals: prepare-agent for instrumentation and report for generating the coverage report.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-core-concepts.md#2025-04-20_snippet_4

LANGUAGE: xml
CODE:
```
<build>
  <plugins>
    <plugin>
      <groupId>org.jacoco</groupId>
      <artifactId>jacoco-maven-plugin</artifactId>
      <version>0.8.8</version>
      <executions>
        <execution>
          <goals>
            <goal>prepare-agent</goal>
          </goals>
        </execution>
        <execution>
          <id>generate-code-coverage-report</id>
          <phase>test</phase>
          <goals>
            <goal>report</goal>
          </goals>
        </execution>
      </executions>
    </plugin>
  </plugins>
</build>
```

----------------------------------------

TITLE: Testing SQL Queries with Implicit Conversion in MySQL
DESCRIPTION: Four SQL queries demonstrating different scenarios of implicit type conversion and their impact on index usage and query performance.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/index-invalidation-caused-by-implicit-conversion.md#2025-04-20_snippet_1

LANGUAGE: SQL
CODE:
```
1: SELECT * FROM `test1` WHERE num1 = 10000;
2: SELECT * FROM `test1` WHERE num1 = '10000';
3: SELECT * FROM `test1` WHERE num2 = 10000;
4: SELECT * FROM `test1` WHERE num2 = '10000';
```

----------------------------------------

TITLE: Demonstrating Lambda Expression in Java
DESCRIPTION: Shows a simple lambda expression for iterating over a list. The code is then decompiled to illustrate how lambda expressions are implemented using JVM's lambda-related APIs.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
public static void main(String... args) {
    List<String> strList = ImmutableList.of("Hollis", "公众号：Hollis", "博客：www.hollischuang.com");

    strList.forEach( s -> { System.out.println(s); } );
}
```

LANGUAGE: java
CODE:
```
public static /* varargs */ void main(String ... args) {
    ImmutableList strList = ImmutableList.of((Object)"Hollis", (Object)"\u516c\u4f17\u53f7\uff1aHollis", (Object)"\u535a\u5ba2\uff1awww.hollischuang.com");
    strList.forEach((Consumer<String>)LambdaMetafactory.metafactory(null, null, null, (Ljava/lang/Object;)V, lambda$main$0(java.lang.String ), (Ljava/lang/String;)V)());
}

private static /* synthetic */ void lambda$main$0(String s) {
    System.out.println(s);
}
```

----------------------------------------

TITLE: Demonstrating Character and String Constants in Java
DESCRIPTION: Example showing the difference between character and string constants, including their memory usage via a practical code example.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
public class StringExample {
    // 字符型常量
    public static final char LETTER_A = 'A';

    // 字符串常量
    public static final String GREETING_MESSAGE = "Hello, world!";
    public static void main(String[] args) {
        System.out.println("字符型常量占用的字节数为："+Character.BYTES);
        System.out.println("字符串常量占用的字节数为："+GREETING_MESSAGE.getBytes().length);
    }
}
```

----------------------------------------

TITLE: 事务内部修改WATCH监视的键
DESCRIPTION: 演示了在同一会话中，如果被WATCH监视的键在事务内部被修改，事务仍然可以成功执行的情况。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-02.md#2025-04-20_snippet_3

LANGUAGE: bash
CODE:
```
> SET PROJECT "JavaGuide"
OK
> WATCH PROJECT
OK
> MULTI
OK
> SET PROJECT "JavaGuide1"
QUEUED
> SET PROJECT "JavaGuide2"
QUEUED
> SET PROJECT "JavaGuide3"
QUEUED
> EXEC
1) OK
2) OK
3) OK
127.0.0.1:6379> GET PROJECT
"JavaGuide3"
```

----------------------------------------

TITLE: ApplicationListener Interface Definition
DESCRIPTION: Interface definition for ApplicationListener in Spring's event mechanism. This functional interface defines the onApplicationEvent method that needs to be implemented by event listeners to handle ApplicationEvent objects.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-design-patterns-summary.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
package org.springframework.context;
import java.util.EventListener;
@FunctionalInterface
public interface ApplicationListener<E extends ApplicationEvent> extends EventListener {
    void onApplicationEvent(E var1);
}
```

----------------------------------------

TITLE: Map get Method Implementation with Error Handling
DESCRIPTION: Shows the implementation of the get method that is used to retrieve parameter values from the parameter map in MyBatis. It throws a BindingException when a parameter is not found.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/mybatis/mybatis-interview.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
public V get(Object key) {
  if (!super.containsKey(key)) {
    throw new BindingException("Parameter '" + key + "' not found. Available parameters are " + keySet());
  }
  return super.get(key);
}
```

----------------------------------------

TITLE: Demonstrating Autoboxing and Unboxing in Java
DESCRIPTION: This code example illustrates autoboxing (converting primitive to wrapper) and unboxing (converting wrapper to primitive) operations in Java.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
Integer i = 10;  //装箱
int n = i;   //拆箱
```

----------------------------------------

TITLE: CASE WHEN Syntax Example in SQL
DESCRIPTION: Demonstrates the basic syntax structure of CASE WHEN THEN statements in SQL, showing how to create conditional logic for returning different results based on specified conditions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_10

LANGUAGE: SQL
CODE:
```
CASE
    WHEN condition1 THEN result1
    WHEN condition2 THEN result2
    ...
    ELSE result
END
```

----------------------------------------

TITLE: Using Enhanced Pseudo-Random Number Generator in Java 17
DESCRIPTION: Demonstrates how to use the new RandomGeneratorFactory to create and use enhanced pseudo-random number generators with custom algorithms and seeds.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java17.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
RandomGeneratorFactory<RandomGenerator> l128X256MixRandom = RandomGeneratorFactory.of("L128X256MixRandom");
// 使用时间戳作为随机数种子
RandomGenerator randomGenerator = l128X256MixRandom.create(System.currentTimeMillis());
// 生成随机数
randomGenerator.nextInt(10);
```

----------------------------------------

TITLE: Using EdDSA Digital Signature Algorithm in Java 15
DESCRIPTION: Demonstrates the use of the new Edwards-Curve Digital Signature Algorithm (EdDSA) for digital signatures, which offers improved security and performance.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java14-15.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
KeyPairGenerator kpg = KeyPairGenerator.getInstance("Ed25519");
KeyPair kp = kpg.generateKeyPair();

byte[] msg = "test_string".getBytes(StandardCharsets.UTF_8);

Signature sig = Signature.getInstance("Ed25519");
sig.initSign(kp.getPrivate());
sig.update(msg);
byte[] s = sig.sign();

String encodedString = Base64.getEncoder().encodeToString(s);
System.out.println(encodedString);
```

----------------------------------------

TITLE: Redis String类型的批量设置命令
DESCRIPTION: 展示了如何使用MSET和MGET命令批量设置和获取多个key-value对。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
> MSET key1 value1 key2 value2
OK
> MGET key1 key2 # 批量获取多个 key 对应的 value
1) "value1"
2) "value2"
```

----------------------------------------

TITLE: Complex Lambda Expression with Filtering in Java
DESCRIPTION: Demonstrates a more complex use of lambda expressions involving stream filtering and collection. The decompiled version shows how multiple lambda expressions are implemented.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
public static void main(String... args) {
    List<String> strList = ImmutableList.of("Hollis", "公众号：Hollis", "博客：www.hollischuang.com");

    List HollisList = strList.stream().filter(string -> string.contains("Hollis")).collect(Collectors.toList());

    HollisList.forEach( s -> { System.out.println(s); } );
}
```

LANGUAGE: java
CODE:
```
public static /* varargs */ void main(String ... args) {
    ImmutableList strList = ImmutableList.of((Object)"Hollis", (Object)"\u516c\u4f17\u53f7\uff1aHollis", (Object)"\u535a\u5ba2\uff1awww.hollischuang.com");
    List<Object> HollisList = strList.stream().filter((Predicate<String>)LambdaMetafactory.metafactory(null, null, null, (Ljava/lang/Object;)Z, lambda$main$0(java.lang.String ), (Ljava/lang/String;)Z)()).collect(Collectors.toList());
    HollisList.forEach((Consumer<Object>)LambdaMetafactory.metafactory(null, null, null, (Ljava/lang/Object;)V, lambda$main$1(java.lang.Object ), (Ljava/lang/Object;)V)());
}

private static /* synthetic */ void lambda$main$1(Object s) {
    System.out.println(s);
}

private static /* synthetic */ boolean lambda$main$0(String string) {
    return string.contains("Hollis");
}
```

----------------------------------------

TITLE: Target Class for Reflection Operations
DESCRIPTION: Sample class demonstrating various members that will be accessed using reflection, including private fields and methods.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/reflection.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
package cn.javaguide;

public class TargetObject {
    private String value;

    public TargetObject() {
        value = "JavaGuide";
    }

    public void publicMethod(String s) {
        System.out.println("I love " + s);
    }

    private void privateMethod() {
        System.out.println("value is " + value);
    }
}
```

----------------------------------------

TITLE: Object Reference Parameter Passing in Java
DESCRIPTION: Demonstrates how object references are passed by value in Java using a Person class example.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/why-there-only-value-passing-in-java.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
public class Person {
    private String name;
   // 省略构造函数、Getter&Setter方法
}

public static void main(String[] args) {
    Person xiaoZhang = new Person("小张");
    Person xiaoLi = new Person("小李");
    swap(xiaoZhang, xiaoLi);
    System.out.println("xiaoZhang:" + xiaoZhang.getName());
    System.out.println("xiaoLi:" + xiaoLi.getName());
}

public static void swap(Person person1, Person person2) {
    Person temp = person1;
    person1 = person2;
    person2 = temp;
    System.out.println("person1:" + person1.getName());
    System.out.println("person2:" + person2.getName());
}
```

----------------------------------------

TITLE: Basic MongoDB Aggregation Query
DESCRIPTION: Example showing MongoDB aggregation pipeline with $match and $group stages. The query first filters orders with status 'A' and then groups by customer ID to calculate total amount per customer.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mongodb/mongodb-questions-01.md#2025-04-20_snippet_0

LANGUAGE: SQL
CODE:
```
db.orders.aggregate([
   # 第一阶段：$match阶段按status字段过滤文档，并将status等于"A"的文档传递到下一阶段。
    { $match: { status: "A" } },
  # 第二阶段：$group阶段按cust_id字段将文档分组，以计算每个cust_id唯一值的金额总和。
    { $group: { _id: "$cust_id", total: { $sum: "$amount" } } }
])
```

----------------------------------------

TITLE: Primitive Array Conversion Issue Example
DESCRIPTION: Demonstrates the issue when converting primitive type arrays using Arrays.asList(), where the array itself becomes the single element.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
int[] myArray = {1, 2, 3};
List myList = Arrays.asList(myArray);
System.out.println(myList.size());//1
System.out.println(myList.get(0));//数组地址值
System.out.println(myList.get(1));//报错：ArrayIndexOutOfBoundsException
int[] array = (int[]) myList.get(0);
System.out.println(array[0]);//1
```

----------------------------------------

TITLE: GetAutoConfigurationEntry Method Implementation
DESCRIPTION: Detailed implementation of the getAutoConfigurationEntry method that handles the loading of auto-configuration classes with filtering and exclusions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-boot-auto-assembly-principles.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
private static final AutoConfigurationEntry EMPTY_ENTRY = new AutoConfigurationEntry();

AutoConfigurationEntry getAutoConfigurationEntry(AutoConfigurationMetadata autoConfigurationMetadata, AnnotationMetadata annotationMetadata) {
        //<1>.
        if (!this.isEnabled(annotationMetadata)) {
            return EMPTY_ENTRY;
        } else {
            //<2>.
            AnnotationAttributes attributes = this.getAttributes(annotationMetadata);
            //<3>.
            List<String> configurations = this.getCandidateConfigurations(annotationMetadata, attributes);
            //<4>.
            configurations = this.removeDuplicates(configurations);
            Set<String> exclusions = this.getExclusions(annotationMetadata, attributes);
            this.checkExcludedClasses(configurations, exclusions);
            configurations.removeAll(exclusions);
            configurations = this.filter(configurations, autoConfigurationMetadata);
            this.fireAutoConfigurationImportEvents(configurations, exclusions);
            return new AutoConfigurationImportSelector.AutoConfigurationEntry(configurations, exclusions);
        }
    }
```

----------------------------------------

TITLE: Switch Expression with yield in Java 13
DESCRIPTION: Demonstrates the new yield keyword usage in switch expressions for returning values.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java12-13.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
private static String descLanguage(String name) {
        return switch (name) {
            case "Java": yield "object-oriented, platform independent and secured";
            case "Ruby": yield "a programmer's best friend";
            default: yield name +" is a good language";
        };
}
```

----------------------------------------

TITLE: Java 9 Interface Private Methods
DESCRIPTION: Example of private method declaration in interfaces, a new feature in Java 9.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java9.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public interface MyInterface {
    private void methodPrivate(){
    }
}
```

----------------------------------------

TITLE: Pattern Matching for switch in Java 17
DESCRIPTION: Demonstrates the new pattern matching capabilities in switch expressions, allowing type checks and automatic casting.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java17.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
// Old code
static String formatter(Object o) {
    String formatted = "unknown";
    if (o instanceof Integer i) {
        formatted = String.format("int %d", i);
    } else if (o instanceof Long l) {
        formatted = String.format("long %d", l);
    } else if (o instanceof Double d) {
        formatted = String.format("double %f", d);
    } else if (o instanceof String s) {
        formatted = String.format("String %s", s);
    }
    return formatted;
}

// New code
static String formatterPatternSwitch(Object o) {
    return switch (o) {
        case Integer i -> String.format("int %d", i);
        case Long l    -> String.format("long %d", l);
        case Double d  -> String.format("double %f", d);
        case String s  -> String.format("String %s", s);
        default        -> o.toString();
    };
}
```

----------------------------------------

TITLE: ApplicationEventPublisher Interface Definition
DESCRIPTION: Interface definition for ApplicationEventPublisher in Spring's event mechanism. This interface provides methods to publish application events to listeners, which is a key component of Spring's observer pattern implementation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-design-patterns-summary.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
@FunctionalInterface
public interface ApplicationEventPublisher {
    default void publishEvent(ApplicationEvent event) {
        this.publishEvent((Object)event);
    }

    void publishEvent(Object var1);
}
```

----------------------------------------

TITLE: Checking Default Storage Engine
DESCRIPTION: Demonstrates how to check the default storage engine in MySQL using a system variable query.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_1

LANGUAGE: sql
CODE:
```
SHOW VARIABLES LIKE '%storage_engine%';
```

----------------------------------------

TITLE: ArrayList Null Value Demonstration in Java
DESCRIPTION: Shows how ArrayList can store null values along with regular objects, though it's not recommended practice.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-01.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
ArrayList<String> listOfStrings = new ArrayList<>();
listOfStrings.add(null);
listOfStrings.add("java");
System.out.println(listOfStrings);
```

----------------------------------------

TITLE: Failed Field Name with Dollar Prefix in MongoDB vs DocumentDB
DESCRIPTION: Example demonstrating how MongoDB and Amazon DocumentDB handle differently when inserting a document with a dollar sign prefix in field names. MongoDB allows it while DocumentDB returns an error.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mongodb/mongodb-questions-01.md#2025-04-20_snippet_2

LANGUAGE: shell
CODE:
```
rs0:PRIMARY< db.foo.insert({"a":{"$a":1}})
```

LANGUAGE: shell
CODE:
```
WriteResult({ "nInserted" : 1 })
```

LANGUAGE: shell
CODE:
```
WriteResult({
  "nInserted" : 0,
  "writeError" : {
    "code" : 2,
    "errmsg" : "Document can't have $ prefix field names: $a"
  }
})
```

----------------------------------------

TITLE: Showing Cluster Management with ZooKeeper
DESCRIPTION: Diagram demonstrating how ZooKeeper can be used for cluster management, using temporary nodes to represent machines and watchers for monitoring.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-plus.md#2025-04-20_snippet_3

LANGUAGE: markdown
CODE:
```
![集群管理](https://oss.javaguide.cn/p3-juejin/f3d70709f10f4fa6b09125a56a976fda~tplv-k3u1fbpfcp-zoom-1.jpeg)
```

----------------------------------------

TITLE: Checking Element Existence in CopyOnWriteArrayList in Java
DESCRIPTION: Implementation of contains() and containsAll() methods in CopyOnWriteArrayList for checking element existence.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/copyonwritearraylist-source-code.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
public boolean contains(Object o) {
    Object[] elements = getArray();
    return indexOf(o, elements, 0, elements.length) >= 0;
}

public boolean containsAll(Collection<?> c) {
    Object[] elements = getArray();
    int len = elements.length;
    for (Object e : c) {
        if (indexOf(e, elements, 0, len) < 0)
            return false;
    }
    return true;
}
```

----------------------------------------

TITLE: 查询Redis进程号
DESCRIPTION: 使用redis-cli命令查询Redis服务器的进程ID。这个命令连接到端口6383的Redis实例，获取服务器信息，并通过grep过滤出进程ID。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-common-blocking-problems-summary.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
redis-cli -p 6383 info server | grep process_id
```

----------------------------------------

TITLE: Initializing ArrayBlockingQueue Constructor
DESCRIPTION: Core constructor for ArrayBlockingQueue that initializes the queue with specified capacity and fairness policy. Creates the underlying array and lock conditions for controlling producer-consumer flow.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
public ArrayBlockingQueue(int capacity, boolean fair) {
  if (capacity <= 0)
      throw new IllegalArgumentException();
  this.items = new Object[capacity];
  lock = new ReentrantLock(fair);
  notEmpty = lock.newCondition();
  notFull =  lock.newCondition();
}
```

----------------------------------------

TITLE: Calculating Truncated Average Using Common Table Expression (CTE)
DESCRIPTION: SQL query using a WITH clause (Common Table Expression) to calculate the truncated average score for hard SQL exams. This approach improves code readability by creating a temporary result set that eliminates redundant subqueries.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_2

LANGUAGE: SQL
CODE:
```
WITH t1 AS
  (SELECT record.*,
          info.tag,
          info.difficulty
   FROM exam_record record
   INNER JOIN examination_info info ON record.exam_id = info.exam_id
   WHERE info.tag = "SQL"
     AND info.difficulty = "hard" )
SELECT tag,
       difficulty,
       ROUND(AVG(score), 1)
FROM t1
WHERE score NOT IN
    (SELECT max(score)
     FROM t1
     UNION SELECT min(score)
     FROM t1)
```

----------------------------------------

TITLE: Text Block Usage in Java 13
DESCRIPTION: Demonstrates the new text block feature for better multiline string handling using triple quotes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java12-13.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
String json = """
                {
                    "name":"mkyong",
                    "age":38
                }
                """;
```

----------------------------------------

TITLE: 添加Curator依赖
DESCRIPTION: 在Maven项目中添加Curator框架的依赖，包括curator-framework和curator-recipes两个主要模块。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_12

LANGUAGE: xml
CODE:
```
<dependency>
    <groupId>org.apache.curator</groupId>
    <artifactId>curator-framework</artifactId>
    <version>4.2.0</version>
</dependency>
<dependency>
    <groupId>org.apache.curator</groupId>
    <artifactId>curator-recipes</artifactId>
    <version>4.2.0</version>
</dependency>
```

----------------------------------------

TITLE: Java try-with-resources实现 (Java)
DESCRIPTION: 展示了Java 7引入的try-with-resources语法,用于自动关闭资源。反编译代码显示编译器自动添加了资源关闭的操作。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
public static void main(String... args) {
    try (BufferedReader br = new BufferedReader(new FileReader("d:\\ hollischuang.xml"))) {
        String line;
        while ((line = br.readLine()) != null) {
            System.out.println(line);
        }
    } catch (IOException e) {
        // handle exception
    }
}
```

----------------------------------------

TITLE: Sequenced Collections Examples
DESCRIPTION: Examples showing usage of new Sequenced Collections API with ArrayList and LinkedHashSet.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java21.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
ArrayList<Integer> arrayList = new ArrayList<>();

arrayList.add(1);   // List contains: [1]

arrayList.addFirst(0);  // List contains: [0, 1]
arrayList.addLast(2);   // List contains: [0, 1, 2]

Integer firstElement = arrayList.getFirst();  // 0
Integer lastElement = arrayList.getLast();  // 2

List<Integer> reversed = arrayList.reversed();
System.out.println(reversed); // Prints [2, 1, 0]
```

----------------------------------------

TITLE: Demonstrating Autoboxing Behavior in Java
DESCRIPTION: Illustrates the behavior of autoboxing for Integer objects, showing how the == operator behaves differently for values within and outside the cached range (-128 to 127).
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
public static void main(String[] args) {
    Integer a = 1000;
    Integer b = 1000;
    Integer c = 100;
    Integer d = 100;
    System.out.println("a == b is " + (a == b));
    System.out.println(("c == d is " + (c == d)));
}
```

----------------------------------------

TITLE: Counting Unique Page Views with HyperLogLog
DESCRIPTION: This code demonstrates using the PFCOUNT command to get an approximate count of unique users who have viewed a specific page, leveraging HyperLogLog's space efficiency for cardinality estimation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_4

LANGUAGE: bash
CODE:
```
PFCOUNT PAGE_1:UV
```

----------------------------------------

TITLE: AutoConfigurationImportSelector Class Hierarchy Implementation in Java
DESCRIPTION: Shows the inheritance hierarchy of AutoConfigurationImportSelector class including its implemented interfaces for handling auto-configuration imports.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-boot-auto-assembly-principles.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class AutoConfigurationImportSelector implements DeferredImportSelector, BeanClassLoaderAware, ResourceLoaderAware, BeanFactoryAware, EnvironmentAware, Ordered {

}

public interface DeferredImportSelector extends ImportSelector {

}

public interface ImportSelector {
    String[] selectImports(AnnotationMetadata var1);
}
```

----------------------------------------

TITLE: Defining Callable Interface in Java
DESCRIPTION: Definition of the Callable interface in Java, which represents a task that returns a result and may throw an exception.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-summary.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
@FunctionalInterface
public interface Callable<V> {
    /**
     * 计算结果，或在无法这样做时抛出异常。
     * @return 计算得出的结果
     * @throws 如果无法计算结果，则抛出异常
     */
    V call() throws Exception;
}
```

----------------------------------------

TITLE: Basic Docker Container Operations
DESCRIPTION: Core Docker commands for running and managing containers, including port mapping and container status checks.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_8

LANGUAGE: shell
CODE:
```
docker run tomcat:8.0-jre8
docker pull tomcat:8.0-jre8
docker run -p 8080:8080 tomcat:8.0-jre8
docker run -d -p 8080:8080 --name tomcat01 tomcat:8.0-jre8
```

----------------------------------------

TITLE: Optional Enhancement in Java 11
DESCRIPTION: Demonstrates the new isEmpty() method added to Optional class for checking if an Optional object is empty.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java11.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
var op = Optional.empty();
System.out.println(op.isEmpty());//判断指定的 Optional 对象是否为空
```

----------------------------------------

TITLE: Basic Method Implementation without AOP
DESCRIPTION: Example showing repetitive logging code without using AOP, demonstrating the need for cross-cutting concerns separation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/ioc-and-aop.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public CommonResponse<Object> method1() {
      // 业务逻辑
      xxService.method1();
      // 省略具体的业务处理逻辑
      // 日志记录
      ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();
      HttpServletRequest request = attributes.getRequest();
      // 省略记录日志的具体逻辑 如：获取各种信息，写入数据库等操作...
      return CommonResponse.success();
}
```

----------------------------------------

TITLE: Finding Exams with Large Time Difference Between 2nd Fastest and 2nd Slowest in MySQL
DESCRIPTION: Complex query to identify exams where the time difference between the 2nd fastest and 2nd slowest completion times is greater than half the exam duration. Uses window functions and subqueries.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_8

LANGUAGE: sql
CODE:
```
SELECT a.exam_id,
       b.duration,
       b.release_time
FROM
  (SELECT exam_id,
          row_number() OVER (PARTITION BY exam_id
                             ORDER BY timestampdiff(SECOND, start_time, submit_time) DESC) rn1,
          row_number() OVER (PARTITION BY exam_id
                            ORDER BY timestampdiff(SECOND, start_time, submit_time) ASC) rn2,
                                              timestampdiff(SECOND, start_time, submit_time) timex
   FROM exam_record
   WHERE score IS NOT NULL ) a
INNER JOIN examination_info b ON a.exam_id = b.exam_id
GROUP BY a.exam_id
HAVING (max(IF (rn1 = 2, a.timex, 0))- max(IF (rn2 = 2, a.timex, 0)))/ 60 > b.duration / 2
ORDER BY a.exam_id DESC
```

----------------------------------------

TITLE: Batch Inserting Data with INSERT...SELECT in MySQL
DESCRIPTION: Demonstration of how batch inserts with INSERT...SELECT affect auto-increment value allocation using MySQL's doubling strategy.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-auto-increment-primary-key-continuous.md#2025-04-20_snippet_5

LANGUAGE: sql
CODE:
```
insert into test_pk2(a,b) select a,b from test_pk
```

----------------------------------------

TITLE: 使用Curator创建临时节点
DESCRIPTION: 创建一个临时节点，临时节点在会话结束后会被自动删除。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_17

LANGUAGE: java
CODE:
```
zkClient.create().creatingParentsIfNeeded().withMode(CreateMode.EPHEMERAL).forPath("/node1/00001");
```

----------------------------------------

TITLE: Creating a Table with DATETIME and TIMESTAMP Columns in MySQL
DESCRIPTION: SQL code to create a table named 'time_zone_test' with an auto-incrementing ID, a DATETIME column, and a TIMESTAMP column that automatically updates on insert or update.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/some-thoughts-on-database-storage-time.md#2025-04-20_snippet_0

LANGUAGE: SQL
CODE:
```
CREATE TABLE `time_zone_test` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `date_time` datetime DEFAULT NULL,
  `time_stamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
```

----------------------------------------

TITLE: Arrays.asList() Source Implementation
DESCRIPTION: Shows the JDK source code implementation of the asList method, which returns a fixed-size list backed by the specified array.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
/**
  *返回由指定数组支持的固定大小的列表。此方法作为基于数组和基于集合的API之间的桥梁，
  * 与 Collection.toArray()结合使用。返回的List是可序列化并实现RandomAccess接口。
  */
public static <T> List<T> asList(T... a) {
    return new ArrayList<>(a);
}
```

----------------------------------------

TITLE: DelayQueue Core Member Variables
DESCRIPTION: Definition of key member variables in DelayQueue including lock, priority queue, leader thread, and condition.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/delayqueue-source-code.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
private final transient ReentrantLock lock = new ReentrantLock();
private final PriorityQueue<E> q = new PriorityQueue<E>();
private Thread leader = null;
private final Condition available = lock.newCondition();
```

----------------------------------------

TITLE: Revoking Specific MySQL Permissions
DESCRIPTION: Example of removing SELECT and INSERT permissions from a MySQL user.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_17

LANGUAGE: sql
CODE:
```
REVOKE SELECT, INSERT ON *.* FROM myuser;
```

----------------------------------------

TITLE: Enabling GC Logging in Java
DESCRIPTION: Configures various GC logging options to help analyze garbage collection behavior and performance.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-parameters-intro.md#2025-04-20_snippet_6

LANGUAGE: bash
CODE:
```
-XX:+PrintGCDetails
-XX:+PrintGCDateStamps
-XX:+PrintTenuringDistribution
-XX:+PrintHeapAtGC
-XX:+PrintReferenceGC
-XX:+PrintGCApplicationStoppedTime
-XX:+PrintSafepointStatistics
-XX:PrintSafepointStatisticsCount=1
-Xloggc:/path/to/gc-%t.log
-XX:+UseGCLogFileRotation
-XX:NumberOfGCLogFiles=14
-XX:GCLogFileSize=50M
```

----------------------------------------

TITLE: AbstractQueue add() Method Implementation in Java
DESCRIPTION: Shows the implementation of the add() method in AbstractQueue, which relies on the offer() method to be implemented by subclasses.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
public boolean add(E e) {
  if (offer(e))
      return true;
  else
      throw new IllegalStateException("Queue full");
}
```

----------------------------------------

TITLE: Demonstrating Unique Key Conflict with Auto-Increment Values in MySQL
DESCRIPTION: Example showing how a unique key constraint violation affects auto-increment values, even when the insert fails.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-auto-increment-primary-key-continuous.md#2025-04-20_snippet_2

LANGUAGE: sql
CODE:
```
insert into test_pk values(null, 1, 1)
```

----------------------------------------

TITLE: Java for-each循环实现 (Java)
DESCRIPTION: 展示了Java中for-each循环的使用。反编译代码揭示其实际是使用普通for循环和迭代器来实现的。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
public static void main(String... args) {
    String[] strs = {"Hollis", "公众号：Hollis", "博客：www.hollischuang.com"};
    for (String s : strs) {
        System.out.println(s);
    }
    List<String> strList = ImmutableList.of("Hollis", "公众号：Hollis", "博客：www.hollischuang.com");
    for (String s : strList) {
        System.out.println(s);
    }
}
```

----------------------------------------

TITLE: HashMap TreeNode Class Implementation
DESCRIPTION: Tree node structure used in HashMap when a bucket is converted to a Red-Black tree.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
static final class TreeNode<K,V> extends LinkedHashMap.Entry<K,V> {
    TreeNode<K,V> parent;
    TreeNode<K,V> left;
    TreeNode<K,V> right;
    TreeNode<K,V> prev;
    boolean red;
    TreeNode(int hash, K key, V val, Node<K,V> next) {
        super(hash, key, val, next);
    }
    final TreeNode<K,V> root() {
        for (TreeNode<K,V> r = this, p;;) {
            if ((p = r.parent) == null)
                return r;
            r = p;
       }
}
```

----------------------------------------

TITLE: Peek Operation in ArrayBlockingQueue
DESCRIPTION: Implementation of peek operation that returns the head element without removing it, or null if the queue is empty.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_17

LANGUAGE: java
CODE:
```
public E peek() {
        final ReentrantLock lock = this.lock;
        lock.lock();
        try {
            return itemAt(takeIndex);
        } finally {
            lock.unlock();
        }
    }

@SuppressWarnings("unchecked")
final E itemAt(int i) {
    return (E) items[i];
}
```

----------------------------------------

TITLE: Entry Node Implementation in LinkedHashMap
DESCRIPTION: Shows the implementation of Entry node class that extends HashMap.Node and adds before/after pointers for double-linked list functionality.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedhashmap-source-code.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
static class Entry<K,V> extends HashMap.Node<K,V> {
        Entry<K,V> before, after;
        Entry(int hash, K key, V value, Node<K,V> next) {
            super(hash, key, value, next);
        }
    }
```

----------------------------------------

TITLE: Listing and Modifying Linux Environment Variables
DESCRIPTION: Commands for listing all environment variables, displaying specific environment variable values, and modifying environment variables using the export command.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/operating-system/linux-intro.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
# 列出当前的环境变量值
export -p
```

LANGUAGE: bash
CODE:
```
# 输出当前的PATH环境变量的值
echo $PATH
# 输出当前的HOME环境变量的值
echo $HOME
```

LANGUAGE: bash
CODE:
```
export CLASSPATH=./JAVA_HOME/lib;$JAVA_HOME/jre/lib
```

----------------------------------------

TITLE: Using Simple Web Server in Java 18
DESCRIPTION: Demonstrates how to start a simple static web server using the jwebserver command introduced in Java 18.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java18.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
$ jwebserver
Binding to loopback by default. For all interfaces use "-b 0.0.0.0" or "-b ::".
Serving /cwd and subdirectories on 127.0.0.1 port 8000
URL: http://127.0.0.1:8000/
```

----------------------------------------

TITLE: GitHub Actions Workflow for Maven Projects
DESCRIPTION: Example GitHub Actions workflow configuration for continuous integration of Maven projects. This workflow automates building and testing the project on every push to the repository.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_8

LANGUAGE: groovy
CODE:
```
name: Java CI with Maven

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Set up JDK 11
      uses: actions/setup-java@v2
      with:
        java-version: '11'
        distribution: 'adopt'

    - name: Build with Maven
      run: ./mvnw clean install
```

----------------------------------------

TITLE: Finding Longest Palindrome in String (Java)
DESCRIPTION: Implements a method to find the length of the longest palindrome that can be built with characters from a given string. It uses a HashSet to count character occurrences and determine the maximum length of a palindrome.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/string-algorithm-problems.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
class Solution {
  public  int longestPalindrome(String s) {
    if (s.length() == 0)
      return 0;
    HashSet<Character> hashset = new HashSet<Character>();
    char[] chars = s.toCharArray();
    int count = 0;
    for (int i = 0; i < chars.length; i++) {
      if (!hashset.contains(chars[i])) {
        hashset.add(chars[i]);
      } else {
        hashset.remove(chars[i]);
        count++;
      }
    }
    return hashset.isEmpty() ? count * 2 : count * 2 + 1;
  }
}
```

----------------------------------------

TITLE: Using Unsafe Memory Barriers in Java
DESCRIPTION: Example showing the native memory barrier methods provided by Unsafe class to prevent instruction reordering
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public native void loadFence();
public native void storeFence();
public native void fullFence();
```

----------------------------------------

TITLE: Demonstrating Generics Overloading Issue in Java
DESCRIPTION: Illustrates a compilation error that occurs when trying to overload methods with different generic type parameters. This is due to type erasure causing the method signatures to become identical.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
public class GenericTypes {

    public static void method(List<String> list) {
        System.out.println("invoke method(List<String> list)");
    }

    public static void method(List<Integer> list) {
        System.out.println("invoke method(List<Integer> list)");
    }
}
```

----------------------------------------

TITLE: DELETE with Ordering and Limit
DESCRIPTION: Shows how to delete specific number of records based on multiple conditions with ordering.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_6

LANGUAGE: SQL
CODE:
```
DELETE FROM exam_record WHERE submit_time IS null OR TIMESTAMPDIFF(MINUTE, start_time, submit_time) < 5
ORDER BY start_time
LIMIT 3
```

----------------------------------------

TITLE: Setting Initial Value for Static Variables in Java
DESCRIPTION: Example showing how static variables are initialized during the preparation phase of class loading. The initial value is typically set to the default value of the data type, unless the variable is marked as final.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/class-loading-process.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public static int value = 111;
```

LANGUAGE: Java
CODE:
```
public static final int value = 111;
```

----------------------------------------

TITLE: Complete Solution using Common Table Expressions (CTEs)
DESCRIPTION: Full SQL solution using CTEs to determine which condition applies and then display the appropriate results based on whether any level 0 user has more than 2 incomplete exams.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_3

LANGUAGE: sql
CODE:
```
WITH host_user AS
  (SELECT ui.uid UID
   FROM user_info ui
   LEFT JOIN exam_record er ON ui.uid = er.uid
   WHERE ui.uid IN
       (SELECT ui.uid
        FROM user_info ui
        LEFT JOIN exam_record er ON ui.uid = er.uid
        WHERE er.submit_time IS NULL
          AND ui.LEVEL = 0 )
   GROUP BY ui.uid
   HAVING sum(IF (er.submit_time IS NULL, 1, 0))> 2),
     tt1 AS
  (SELECT tmp1.uid UID,
                   sum(IF (er.submit_time IS NULL
                           AND er.start_time IS NOT NULL, 1, 0)) incomplete_cnt,
                   round(sum(IF (er.submit_time IS NULL
                                 AND er.start_time IS NOT NULL, 1, 0))/ count(tmp1.uid), 3) incomplete_rate
   FROM
     (SELECT DISTINCT ui.uid
      FROM user_info ui
      LEFT JOIN exam_record er ON ui.uid = er.uid
      WHERE er.submit_time IS NULL
        AND ui.LEVEL = 0 ) tmp1
   LEFT JOIN exam_record er ON tmp1.uid = er.uid
   GROUP BY tmp1.uid
   ORDER BY incomplete_rate),
     tt2 AS
  (SELECT ui.uid UID,
                 sum(CASE
                         WHEN er.submit_time IS NULL
                              AND er.start_time IS NOT NULL THEN 1
                         ELSE 0
                     END) incomplete_cnt,
                 round(sum(IF (er.submit_time IS NULL
                               AND er.start_time IS NOT NULL, 1, 0))/ count(ui.uid), 3) incomplete_rate
   FROM user_info ui
   JOIN exam_record er ON ui.uid = er.uid
   GROUP BY ui.uid
   ORDER BY incomplete_rate)
  (SELECT tt1.*
   FROM tt1
   LEFT JOIN
     (SELECT UID
      FROM host_user) t1 ON 1 = 1
   WHERE t1.uid IS NOT NULL )
UNION ALL
  (SELECT tt2.*
   FROM tt2
   LEFT JOIN
     (SELECT UID
      FROM host_user) t2 ON 1 = 1
   WHERE t2.uid IS NULL)
```

----------------------------------------

TITLE: Multiple Range Request Example
DESCRIPTION: Demonstrates how to request multiple byte ranges in a single HTTP request.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/network/http1.0-vs-http1.1.md#2025-04-20_snippet_3

LANGUAGE: bash
CODE:
```
GET /path/to/resource HTTP/1.1
Host: example.com
Range: bytes=0-499,1000-1499
```

----------------------------------------

TITLE: Validating Stack Sequences
DESCRIPTION: Algorithm to verify if a given sequence could be a valid stack pop sequence based on the push sequence. Uses auxiliary stack to simulate push/pop operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_15

LANGUAGE: java
CODE:
```
import java.util.ArrayList;
import java.util.Stack;

public class Solution {
    public boolean IsPopOrder(int [] pushA,int [] popA) {
        if(pushA.length == 0 || popA.length == 0)
            return false;
        Stack<Integer> s = new Stack<Integer>();
        int popIndex = 0;
        for(int i = 0; i< pushA.length;i++){
            s.push(pushA[i]);
            while(!s.empty() &&s.peek() == popA[popIndex]){
                s.pop();
                popIndex++;
            }
        }
        return s.empty();
    }
}
```

----------------------------------------

TITLE: Configuring Custom Load Balancer in Spring Cloud
DESCRIPTION: Example of configuring a custom RandomLoadBalancer in Spring Cloud Load Balancer.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/load-balancing.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class CustomLoadBalancerConfiguration {

    @Bean
    ReactorLoadBalancer<ServiceInstance> randomLoadBalancer(Environment environment,
            LoadBalancerClientFactory loadBalancerClientFactory) {
        String name = environment.getProperty(LoadBalancerClientFactory.PROPERTY_NAME);
        return new RandomLoadBalancer(loadBalancerClientFactory
                .getLazyProvider(name, ServiceInstanceListSupplier.class),
                name);
    }
}
```

----------------------------------------

TITLE: Range Request Example in HTTP 1.1
DESCRIPTION: Shows how to request specific byte ranges of a file using HTTP 1.1's range request feature.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/network/http1.0-vs-http1.1.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
# 获取一个文件的前 1024 个字节
GET /z4d4kWk.jpg HTTP/1.1
Host: i.imgur.com
Range: bytes=0-1023
```

----------------------------------------

TITLE: Querying Minimum Score Above Average for SQL Exams
DESCRIPTION: This SQL query finds the minimum score that is not less than the average score for SQL exams. It joins the exam_record and examination_info tables, filters for SQL exams, calculates the average score, and then finds the minimum score above this average.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_5

LANGUAGE: SQL
CODE:
```
SELECT MIN(score) AS min_score_over_avg
FROM examination_info info
INNER JOIN exam_record record
WHERE info.exam_id = record.exam_id
  AND tag= 'SQL'
  AND score >=
    (SELECT ROUND(AVG(score), 1)
     FROM examination_info info
     INNER JOIN exam_record record
     WHERE info.exam_id = record.exam_id
       AND tag= 'SQL' )
```

----------------------------------------

TITLE: Implementing Custom Job Handler with XXL-JOB
DESCRIPTION: An example of implementing a custom job handler by extending IJobHandler class in XXL-JOB. This implementation requires annotating the class with @JobHandler and implementing the execute method to define custom task execution logic.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/schedule-task.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
@JobHandler(value="myApiJobHandler")
@Component
public class MyApiJobHandler extends IJobHandler {

    @Override
    public ReturnT<String> execute(String param) throws Exception {
        //......
        return ReturnT.SUCCESS;
    }
}
```

----------------------------------------

TITLE: Example of Member Variables and Local Variables in Java
DESCRIPTION: This class demonstrates the differences between member variables and local variables in Java, including their scope, lifetime, and initialization.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_8

LANGUAGE: Java
CODE:
```
public class VariableExample {

    // 成员变量
    private String name;
    private int age;

    // 方法中的局部变量
    public void method() {
        int num1 = 10; // 栈中分配的局部变量
        String str = "Hello, world!"; // 栈中分配的局部变量
        System.out.println(num1);
        System.out.println(str);
    }

    // 带参数的方法中的局部变量
    public void method2(int num2) {
        int sum = num2 + 10; // 栈中分配的局部变量
        System.out.println(sum);
    }

    // 构造方法中的局部变量
    public VariableExample(String name, int age) {
        this.name = name; // 对成员变量进行赋值
        this.age = age; // 对成员变量进行赋值
        int num3 = 20; // 栈中分配的局部变量
        String str2 = "Hello, " + this.name + "!"; // 栈中分配的局部变量
        System.out.println(num3);
        System.out.println(str2);
    }
}
```

----------------------------------------

TITLE: Access Order Traversal with LinkedHashMap
DESCRIPTION: Shows how to configure LinkedHashMap to maintain access order by setting accessOrder to true in constructor.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedhashmap-source-code.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
LinkedHashMap<Integer, String> map = new LinkedHashMap<>(16, 0.75f, true);
map.put(1, "one");
map.put(2, "two");
map.put(3, "three");
map.put(4, "four");
map.put(5, "five");
//访问元素2,该元素会被移动至链表末端
map.get(2);
//访问元素3,该元素会被移动至链表末端
map.get(3);
for (Map.Entry<Integer, String> entry : map.entrySet()) {
    System.out.println(entry.getKey() + " : " + entry.getValue());
}
```

----------------------------------------

TITLE: LinkedList Node Class Definition
DESCRIPTION: Definition of the private Node class used to represent elements in the LinkedList. Each node contains the element value and references to previous and next nodes in the list.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
private static class Node<E> {
    E item;
    Node<E> next;
    Node<E> prev;

    Node(Node<E> prev, E element, Node<E> next) {
        this.item = element;
        this.next = next;
        this.prev = prev;
    }
}
```

----------------------------------------

TITLE: Complex UPDATE with Date Conditions
DESCRIPTION: Updates incomplete exam records before a specific date by setting default completion time and score.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_4

LANGUAGE: SQL
CODE:
```
UPDATE exam_record SET submit_time = '2099-01-01 00:00:00', score = 0 WHERE DATE(start_time) < "2021-09-01" AND submit_time IS null
```

----------------------------------------

TITLE: JConsole Remote Connection Properties
DESCRIPTION: Configuration properties needed to enable remote JMX monitoring with JConsole
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jdk-monitoring-and-troubleshooting-tools.md#2025-04-20_snippet_2

LANGUAGE: properties
CODE:
```
-Djava.rmi.server.hostname=外网访问 ip 地址
-Dcom.sun.management.jmxremote.port=60001   //监控的端口号
-Dcom.sun.management.jmxremote.authenticate=false   //关闭认证
-Dcom.sun.management.jmxremote.ssl=false
```

----------------------------------------

TITLE: Creating Annotation-Based Job Handlers in XXL-JOB
DESCRIPTION: A simple example showing how to define a job handler using the @XxlJob annotation in XXL-JOB. This approach is more concise than extending IJobHandler and provides the same functionality for task execution.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/schedule-task.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
@XxlJob("myAnnotationJobHandler")
public ReturnT<String> myAnnotationJobHandler(String param) throws Exception {
  //......
  return ReturnT.SUCCESS;
}
```

----------------------------------------

TITLE: Adding WebSocket Dependencies in Spring Boot
DESCRIPTION: Maven dependency configuration to add WebSocket support in a Spring Boot application.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/web-real-time-message-push.md#2025-04-20_snippet_0

LANGUAGE: xml
CODE:
```
<!-- 引入websocket -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-websocket</artifactId>
</dependency>
```

----------------------------------------

TITLE: Column Constraints in SQL
DESCRIPTION: Explains various column constraints in MySQL including PRIMARY KEY, UNIQUE, NULL, DEFAULT, AUTO_INCREMENT, COMMENT, and FOREIGN KEY.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_6

LANGUAGE: SQL
CODE:
```
/* 列属性（列约束） */ ------------------
1. PRIMARY 主键
    - 能唯一标识记录的字段，可以作为主键。
    - 一个表只能有一个主键。
    - 主键具有唯一性。
    - 声明字段时，用 primary key 标识。
        也可以在字段列表之后声明
            例：create table tab ( id int, stu varchar(10), primary key (id));
    - 主键字段的值不能为null。
    - 主键可以由多个字段共同组成。此时需要在字段列表后声明的方法。
        例：create table tab ( id int, stu varchar(10), age int, primary key (stu, age));
2. UNIQUE 唯一索引（唯一约束）
    使得某字段的值也不能重复。
3. NULL 约束
    null不是数据类型，是列的一个属性。
    表示当前列是否可以为null，表示什么都没有。
    null, 允许为空。默认。
    not null, 不允许为空。
    insert into tab values (null, 'val');
        -- 此时表示将第一个字段的值设为null, 取决于该字段是否允许为null
4. DEFAULT 默认值属性
    当前字段的默认值。
    insert into tab values (default, 'val');    -- 此时表示强制使用默认值。
    create table tab ( add_time timestamp default current_timestamp );
        -- 表示将当前时间的时间戳设为默认值。
        current_date, current_time
5. AUTO_INCREMENT 自动增长约束
    自动增长必须为索引（主键或unique）
    只能存在一个字段为自动增长。
    默认为1开始自动增长。可以通过表属性 auto_increment = x进行设置，或 alter table tbl auto_increment = x;
6. COMMENT 注释
    例：create table tab ( id int ) comment '注释内容';
7. FOREIGN KEY 外键约束
    用于限制主表与从表数据完整性。
    alter table t1 add constraint `t1_t2_fk` foreign key (t1_id) references t2(id);
        -- 将表t1的t1_id外键关联到表t2的id字段。
        -- 每个外键都有一个名字，可以通过 constraint 指定
    存在外键的表，称之为从表（子表），外键指向的表，称之为主表（父表）。
    作用：保持数据一致性，完整性，主要目的是控制存储在外键表（从表）中的数据。
    MySQL中，可以对InnoDB引擎使用外键约束：
    语法：
    foreign key (外键字段） references 主表名 (关联字段) [主表记录删除时的动作] [主表记录更新时的动作]
    此时需要检测一个从表的外键需要约束为主表的已存在的值。外键在没有关联的情况下，可以设置为null.前提是该外键列，没有not null。
    可以不指定主表记录更改或更新时的动作，那么此时主表的操作被拒绝。
    如果指定了 on update 或 on delete：在删除或更新时，有如下几个操作可以选择：
    1. cascade，级联操作。主表数据被更新（主键值更新），从表也被更新（外键值更新）。主表记录被删除，从表相关记录也被删除。
    2. set null，设置为null。主表数据被更新（主键值更新），从表的外键被设置为null。主表记录被删除，从表相关记录外键被设置成null。但注意，要求该外键列，没有not null属性约束。
    3. restrict，拒绝父表删除和更新。
    注意，外键只被InnoDB存储引擎所支持。其他引擎是不支持的。
```

----------------------------------------

TITLE: Array Parameter Passing in Java
DESCRIPTION: Shows how Java passes array references by value, allowing modification of array elements within methods.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/why-there-only-value-passing-in-java.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
public static void main(String[] args) {
    int[] arr = { 1, 2, 3, 4, 5 };
    System.out.println(arr[0]);
    change(arr);
    System.out.println(arr[0]);
}

public static void change(int[] array) {
    // 将数组的第一个元素变为0
    array[0] = 0;
}
```

----------------------------------------

TITLE: Configuring Route Predicates in Spring Cloud Gateway
DESCRIPTION: This YAML snippet demonstrates how to configure route predicates in Spring Cloud Gateway. It shows two route rules with predicates that match specific URL patterns.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/spring-cloud-gateway-questions.md#2025-04-20_snippet_0

LANGUAGE: yaml
CODE:
```
spring:
  cloud:
    gateway:
      routes:
        - id: route_thirdparty
          uri: lb://passjava-thirdparty
          predicates:
            - Path=/api/thirdparty/**
        - id: route_member
          uri: lb://passjava-member
          predicates:
            - Path=/api/member/**
```

----------------------------------------

TITLE: 使用Redis DEL命令释放分布式锁
DESCRIPTION: 展示了如何使用Redis的DEL命令删除锁对应的key来释放分布式锁。返回1表示释放成功。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
> DEL lockKey
(integer) 1
```

----------------------------------------

TITLE: Monthly Exam Submission Count Query
DESCRIPTION: SQL query to calculate monthly exam submission counts and cumulative totals per exam. Uses window functions to compute running totals grouped by exam_id and formatted by month.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_12

LANGUAGE: sql
CODE:
```
SELECT exam_id,
       date_format(start_time, '%Y%m') AS start_month,
       count(*) AS month_cnt,
       sum(count(*)) OVER (PARTITION BY exam_id
                           ORDER BY date_format(start_time, '%Y%m')) AS cum_exam_cnt
FROM exam_record
GROUP BY exam_id,
         start_month
```

----------------------------------------

TITLE: Managing Docker Volumes with Basic Commands
DESCRIPTION: Basic commands for creating, listing, inspecting, and removing Docker volumes. These commands allow users to manage persistent data storage areas for Docker containers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_5

LANGUAGE: bash
CODE:
```
# 创建一个数据卷
docker volume create my-vol
# 查看所有的数据卷
docker volume ls
# 查看数据卷的具体信息
docker inspect web
# 删除指定的数据卷
docker volume rm my-vol
```

----------------------------------------

TITLE: Optional orElseThrow Usage in Java 10
DESCRIPTION: Shows how to use the new orElseThrow() method in Optional class to throw custom exceptions when value is not present.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java10.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
Optional.ofNullable(cache.getIfPresent(key))
        .orElseThrow(() -> new PrestoException(NOT_FOUND, "Missing entry found for key: " + key));
```

----------------------------------------

TITLE: Runtime-Determined Final String Values and Concatenation
DESCRIPTION: This code demonstrates that even with 'final' variables, if the value is determined at runtime rather than compile time, the compiler cannot perform constant folding optimization for string concatenation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_23

LANGUAGE: java
CODE:
```
final String str1 = "str";
final String str2 = getStr();
String c = "str" + "ing";// 常量池中的对象
String d = str1 + str2; // 在堆上创建的新的对象
System.out.println(c == d);// false
public static String getStr() {
      return "ing";
}
```

----------------------------------------

TITLE: Disabling Query Cache for Specific SQL Queries
DESCRIPTION: SQL example showing how to disable caching for a specific query using the sql_no_cache directive, ensuring the query result is always executed and not retrieved from cache.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_4

LANGUAGE: sql
CODE:
```
SELECT sql_no_cache COUNT(*) FROM usr;
```

----------------------------------------

TITLE: Redis String类型实现计数器
DESCRIPTION: 展示了如何使用INCR和DECR命令实现计数器功能。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_2

LANGUAGE: bash
CODE:
```
> SET number 1
OK
> INCR number # 将 key 中储存的数字值增一
(integer) 2
> GET number
"2"
> DECR number # 将 key 中储存的数字值减一
(integer) 1
> GET number
"1"
```

----------------------------------------

TITLE: Demonstrating Hash Function Calculation for Index
DESCRIPTION: Shows how hash functions are used to calculate index positions in a hash table. This illustrates the core mechanism behind hash-based indexing, where a hash function processes a key to determine the storage index.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-index.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
hash = hashfunc(key)
index = hash % array_size
```

----------------------------------------

TITLE: Implementation of System.arraycopy() Native Method in Java
DESCRIPTION: The native System.arraycopy() method provides efficient array copying with flexible source and destination positions. This is a core method used by ArrayList for array manipulation operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
    // 我们发现 arraycopy 是一个 native 方法,接下来我们解释一下各个参数的具体意义
    /**
    *   复制数组
    * @param src 源数组
    * @param srcPos 源数组中的起始位置
    * @param dest 目标数组
    * @param destPos 目标数组中的起始位置
    * @param length 要复制的数组元素的数量
    */
    public static native void arraycopy(Object src,  int  srcPos,
                                        Object dest, int destPos,
                                        int length);
```

----------------------------------------

TITLE: Collections Utility Class Sort Operations
DESCRIPTION: Common sorting operations provided by the Collections utility class for manipulating Lists
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_12

LANGUAGE: java
CODE:
```
void reverse(List list)//反转
void shuffle(List list)//随机排序
void sort(List list)//按自然排序的升序排序
void sort(List list, Comparator c)//定制排序，由Comparator控制排序逻辑
void swap(List list, int i , int j)//交换两个索引位置的元素
void rotate(List list, int distance)//旋转。当distance为正数时，将list后distance个元素整体移到前面。当distance为负数时，将 list的前distance个元素整体移到后面
```

----------------------------------------

TITLE: Counting Exam Statistics Using Subqueries
DESCRIPTION: SQL query that calculates various exam statistics including total attempts, completed attempts, and unique completed exams. This solution uses subqueries with COUNT functions to separate different counting requirements.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_4

LANGUAGE: SQL
CODE:
```
SELECT
	count(*) total_pv,
	( SELECT count(*) FROM exam_record WHERE submit_time IS NOT NULL ) complete_pv,
	( SELECT COUNT( DISTINCT exam_id, score IS NOT NULL OR NULL ) FROM exam_record ) complete_exam_cnt
FROM
	exam_record
```

----------------------------------------

TITLE: 使用MULTI、EXEC和DISCARD执行Redis事务
DESCRIPTION: 展示了Redis事务的基本操作流程，包括事务开始(MULTI)、命令入队和执行事务(EXEC)，以及取消事务(DISCARD)的示例。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-02.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
> MULTI
OK
> SET PROJECT "JavaGuide"
QUEUED
> GET PROJECT
QUEUED
> EXEC
1) OK
2) "JavaGuide"
```

----------------------------------------

TITLE: Basic MySQL EXPLAIN Command Usage
DESCRIPTION: Shows the basic syntax for using the EXPLAIN command to analyze SELECT queries in MySQL.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-query-execution-plan.md#2025-04-20_snippet_0

LANGUAGE: sql
CODE:
```
EXPLAIN + SELECT 查询语句；
```

----------------------------------------

TITLE: Reading Cookies from Client Request in Java Servlets
DESCRIPTION: This code shows how to retrieve cookies from an HTTP request, search for a specific cookie by name, and access its value. It iterates through all cookies in the request to find the one with the specified name.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/J2EE基础知识.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
String name ="name";
Cookie[]cookies =request.getCookies();
if(cookies !=null){
   for(int i= 0;i<cookies.length;i++){
    Cookie cookie =cookies[i];
    if(name.equals(cookis.getName()))
    //something is here.
    //you can get the value
    cookie.getValue();

   }
 }

```

----------------------------------------

TITLE: Calculating Incomplete Rates for All Users - Second Condition Query
DESCRIPTION: Query to calculate incomplete exam counts and rates for all users with exam records when there is no level 0 user with more than 2 incomplete exams.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_2

LANGUAGE: sql
CODE:
```
SELECT
	ui.uid uid,
	sum( CASE WHEN er.submit_time IS NULL AND er.start_time IS NOT NULL THEN 1 ELSE 0 END ) incomplete_cnt,
	round(
		sum(
		IF
		( er.submit_time IS NULL AND er.start_time IS NOT NULL, 1, 0 ))/ count( ui.uid ),
		3
	) incomplete_rate
FROM
	user_info ui
	JOIN exam_record er ON ui.uid = er.uid
GROUP BY
	ui.uid
ORDER BY
	incomplete_rate
```

----------------------------------------

TITLE: String Concatenation Optimization with Final Variables
DESCRIPTION: This code demonstrates how using 'final' with string variables enables compile-time optimization. Final string variables are treated as constants, allowing the compiler to perform constant folding for string concatenation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_22

LANGUAGE: java
CODE:
```
final String str1 = "str";
final String str2 = "ing";
// 下面两个表达式其实是等价的
String c = "str" + "ing";// 常量池中的对象
String d = str1 + str2; // 常量池中的对象
System.out.println(c == d);// true
```

----------------------------------------

TITLE: Configuring Maven Dependency in XML
DESCRIPTION: Example showing how to configure a dependency for EasyExcel library in Maven pom.xml file using coordinates like groupId, artifactId and version.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-core-concepts.md#2025-04-20_snippet_0

LANGUAGE: xml
CODE:
```
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>easyexcel</artifactId>
    <version>3.1.1</version>
</dependency>
```

----------------------------------------

TITLE: MongoDB Document Structure Example
DESCRIPTION: Example of a MongoDB document structure from a users collection showing various field types.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mongodb/mongodb-questions-02.md#2025-04-20_snippet_5

LANGUAGE: JSON
CODE:
```
{
   "_id": ObjectId("53402597d852426020000002"),
   "contact": "987654321",
   "dob": "01-01-1991",
   "gender": "M",
   "name": "Tom Benzamin",
   "user_name": "tombenzamin"
}
```

----------------------------------------

TITLE: Basic Docker Commands
DESCRIPTION: Essential Docker commands for checking Docker version, listing images and containers, and cleaning up unused images.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
docker version # 查看docker版本
docker images # 查看所有已下载镜像，等价于：docker image ls 命令
docker container ls # 查看所有容器
docker ps #查看正在运行的容器
docker image prune # 清理临时的、没有被使用的镜像文件。-a, --all: 删除所有没有用的镜像，而不仅仅是临时文件；
```

----------------------------------------

TITLE: Editing Environment Variable Configuration Files
DESCRIPTION: Commands for editing environment variable configuration files and applying changes to make them take effect immediately.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/operating-system/linux-intro.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
vim ~/.bash_profile
```

LANGUAGE: bash
CODE:
```
source /etc/profile
```

----------------------------------------

TITLE: Activating Maven Profiles via Command Line
DESCRIPTION: Shows the command to activate a specific Maven profile (production in this example) during the build process using the -P flag.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_5

LANGUAGE: bash
CODE:
```
mvn clean install -P production
```

----------------------------------------

TITLE: Performance Comparison Test between HashMap and LinkedHashMap
DESCRIPTION: A benchmark test comparing insertion and iteration performance between HashMap and LinkedHashMap with 10 million entries.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedhashmap-source-code.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
int count = 1000_0000;
Map<Integer, Integer> hashMap = new HashMap<>();
Map<Integer, Integer> linkedHashMap = new LinkedHashMap<>();

long start, end;

start = System.currentTimeMillis();
for (int i = 0; i < count; i++) {
    hashMap.put(ThreadLocalRandom.current().nextInt(1, count), ThreadLocalRandom.current().nextInt(0, count));
}
end = System.currentTimeMillis();
System.out.println("map time putVal: " + (end - start));

start = System.currentTimeMillis();
for (int i = 0; i < count; i++) {
    linkedHashMap.put(ThreadLocalRandom.current().nextInt(1, count), ThreadLocalRandom.current().nextInt(0, count));
}
end = System.currentTimeMillis();
System.out.println("linkedHashMap putVal time: " + (end - start));

start = System.currentTimeMillis();
long num = 0;
for (Integer v : hashMap.values()) {
    num = num + v;
}
end = System.currentTimeMillis();
System.out.println("map get time: " + (end - start));

start = System.currentTimeMillis();
for (Integer v : linkedHashMap.values()) {
    num = num + v;
}
end = System.currentTimeMillis();
System.out.println("linkedHashMap get time: " + (end - start));
System.out.println(num);
```

----------------------------------------

TITLE: Array vs ArrayList Usage Example in Java
DESCRIPTION: Demonstrates the key differences between using a traditional Array versus ArrayList in Java, showing initialization, modification and deletion operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-01.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
 // 初始化一个 String 类型的数组
 String[] stringArr = new String[]{"hello", "world", "!"};
 // 修改数组元素的值
 stringArr[0] = "goodbye";
 System.out.println(Arrays.toString(stringArr));// [goodbye, world, !]
 // 删除数组中的元素，需要手动移动后面的元素
 for (int i = 0; i < stringArr.length - 1; i++) {
     stringArr[i] = stringArr[i + 1];
 }
 stringArr[stringArr.length - 1] = null;
 System.out.println(Arrays.toString(stringArr));// [world, !, null]
```

LANGUAGE: java
CODE:
```
// 初始化一个 String 类型的 ArrayList
 ArrayList<String> stringList = new ArrayList<>(Arrays.asList("hello", "world", "!"));
// 添加元素到 ArrayList 中
 stringList.add("goodbye");
 System.out.println(stringList);// [hello, world, !, goodbye]
 // 修改 ArrayList 中的元素
 stringList.set(0, "hi");
 System.out.println(stringList);// [hi, world, !, goodbye]
 // 删除 ArrayList 中的元素
 stringList.remove(0);
 System.out.println(stringList); // [world, !, goodbye]
```

----------------------------------------

TITLE: Variable Length Arguments Example
DESCRIPTION: Demonstration of variable length arguments and method overloading resolution in Java.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_19

LANGUAGE: java
CODE:
```
public class VariableLengthArgument {

    public static void printVariable(String... args) {
        for (String s : args) {
            System.out.println(s);
        }
    }

    public static void printVariable(String arg1, String arg2) {
        System.out.println(arg1 + arg2);
    }

    public static void main(String[] args) {
        printVariable("a", "b");
        printVariable("a", "b", "c", "d");
    }
}
```

----------------------------------------

TITLE: Using Arrays.copyOf() in ArrayList toArray() Method
DESCRIPTION: This code snippet shows how ArrayList uses Arrays.copyOf() in its toArray() method to return a properly sized array containing all elements from the list.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_13

LANGUAGE: java
CODE:
```
   /**
     以正确的顺序返回一个包含此列表中所有元素的数组（从第一个到最后一个元素）; 返回的数组的运行时类型是指定数组的运行时类型。
     */
    public Object[] toArray() {
    //elementData：要复制的数组；size：要复制的长度
        return Arrays.copyOf(elementData, size);
    }
```

----------------------------------------

TITLE: Java条件编译实现 (Java)
DESCRIPTION: 展示了Java中如何通过final变量和if语句实现条件编译。编译器会根据条件的真假直接消除不执行的代码块。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
public class ConditionalCompilation {
    public static void main(String[] args) {
        final boolean DEBUG = true;
        if(DEBUG) {
            System.out.println("Hello, DEBUG!");
        }

        final boolean ONLINE = false;

        if(ONLINE){
            System.out.println("Hello, ONLINE!");
        }
    }
}
```

----------------------------------------

TITLE: Creating Test Table and Generating Data in MySQL
DESCRIPTION: SQL code to create a test table with various data types and indexes, along with a stored procedure to generate 10 million rows of test data.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/index-invalidation-caused-by-implicit-conversion.md#2025-04-20_snippet_0

LANGUAGE: SQL
CODE:
```
-- 创建测试数据表
DROP TABLE IF EXISTS test1;
CREATE TABLE `test1` (
    `id` int(11) NOT NULL,
    `num1` int(11) NOT NULL DEFAULT '0',
    `num2` varchar(11) NOT NULL DEFAULT '',
    `type1` int(4) NOT NULL DEFAULT '0',
    `type2` int(4) NOT NULL DEFAULT '0',
    `str1` varchar(100) NOT NULL DEFAULT '',
    `str2` varchar(100) DEFAULT NULL,
    PRIMARY KEY (`id`),
    KEY `num1` (`num1`),
    KEY `num2` (`num2`),
    KEY `type1` (`type1`),
    KEY `str1` (`str1`),
    KEY `str2` (`str2`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- 创建存储过程
DROP PROCEDURE IF EXISTS pre_test1;
DELIMITER //
CREATE PROCEDURE `pre_test1`()
BEGIN
    DECLARE i INT DEFAULT 0;
    SET autocommit = 0;
    WHILE i < 10000000 DO
        SET i = i + 1;
        SET @str1 = SUBSTRING(MD5(RAND()),1,20);
        -- 每100条数据str2产生一个null值
        IF i % 100 = 0 THEN
            SET @str2 = NULL;
        ELSE
            SET @str2 = @str1;
        END IF;
        INSERT INTO test1 (`id`, `num1`, `num2`,
        `type1`, `type2`, `str1`, `str2`)
        VALUES (CONCAT('', i), CONCAT('', i),
        CONCAT('', i), i%5, i%5, @str1, @str2);
        -- 事务优化，每一万条数据提交一次事务
        IF i % 10000 = 0 THEN
            COMMIT;
        END IF;
    END WHILE;
END;
// DELIMITER ;

-- 执行存储过程
CALL pre_test1();
```

----------------------------------------

TITLE: MySQL Update Statement Example
DESCRIPTION: Example SQL update statement used to demonstrate transaction logging behavior when updating a record's value from 0 to 1.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-logs.md#2025-04-20_snippet_3

LANGUAGE: sql
CODE:
```
update T set c=1 where id=2
```

----------------------------------------

TITLE: Synchronized Implementation Example
DESCRIPTION: Example showing synchronized block implementation for analysis through bytecode.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
public class SynchronizedDemo {
    public void method() {
        synchronized (this) {
            System.out.println("synchronized 代码块");
        }
    }
}
```

----------------------------------------

TITLE: 使用Curator连接ZooKeeper
DESCRIPTION: 使用CuratorFrameworkFactory创建ZooKeeper客户端并连接服务器，设置重试策略和连接参数。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_13

LANGUAGE: java
CODE:
```
private static final int BASE_SLEEP_TIME = 1000;
private static final int MAX_RETRIES = 3;

// Retry strategy. Retry 3 times, and will increase the sleep time between retries.
RetryPolicy retryPolicy = new ExponentialBackoffRetry(BASE_SLEEP_TIME, MAX_RETRIES);
CuratorFramework zkClient = CuratorFrameworkFactory.builder()
    // the server to connect to (can be a server list)
    .connectString("127.0.0.1:2181")
    .retryPolicy(retryPolicy)
    .build();
zkClient.start();
```

----------------------------------------

TITLE: 对象和引用相等性比较示例
DESCRIPTION: 演示如何比较字符串对象的引用相等(==)和内容相等(equals)
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
String str1 = "hello";
String str2 = new String("hello");
String str3 = "hello";
// 使用 == 比较字符串的引用相等
System.out.println(str1 == str2);
System.out.println(str1 == str3);
// 使用 equals 方法比较字符串的相等
System.out.println(str1.equals(str2));
System.out.println(str1.equals(str3));
```

----------------------------------------

TITLE: Complete SQL Solution for User Activity Analysis
DESCRIPTION: The complete SQL solution that combines exam and practice activity data, filters for level 6/7 users, and calculates various activity metrics including total active months, 2021 active days, and activity breakdown by type.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_14

LANGUAGE: SQL
CODE:
```
SELECT user_info.uid,
       count(DISTINCT act_month) AS act_month_total,
       count(DISTINCT CASE
                          WHEN YEAR (act_time)= '2021' THEN act_day
                      END) AS act_days_2021,
       count(DISTINCT CASE
                          WHEN YEAR (act_time)= '2021'
                               AND tag = 'exam' THEN act_day
                      END) AS act_days_2021_exam,
       count(DISTINCT CASE
                          WHEN YEAR (act_time)= '2021'
                               AND tag = 'question' THEN act_day
                      END) AS act_days_2021_question
FROM
  (SELECT UID,
          exam_id AS ans_id,
          start_time AS act_time,
          date_format(start_time, '%Y%m') AS act_month,
          date_format(start_time, '%Y%m%d') AS act_day,
          'exam' AS tag
   FROM exam_record
   UNION ALL SELECT UID,
                    question_id AS ans_id,
                    submit_time AS act_time,
                    date_format(submit_time, '%Y%m') AS act_month,
                    date_format(submit_time, '%Y%m%d') AS act_day,
                    'question' AS tag
   FROM practice_record) total
RIGHT JOIN user_info ON total.uid = user_info.uid
WHERE user_info.LEVEL IN (6,
                          7)
GROUP BY user_info.uid
ORDER BY act_month_total DESC,
         act_days_2021 DESC
```

----------------------------------------

TITLE: Forward Request Implementation in Java Servlet
DESCRIPTION: Demonstrates how to forward a request to another resource (login_success.jsp) using RequestDispatcher in a Servlet.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/J2EE基础知识.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
request.getRequestDispatcher("login_success.jsp").forward(request, response);
```

----------------------------------------

TITLE: Monthly User Activity Analysis Query
DESCRIPTION: Complex SQL query to analyze monthly user activity including new users, active users, and cumulative statistics. Uses subqueries and window functions to track first-time users and calculate running totals.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_13

LANGUAGE: sql
CODE:
```
SELECT
	start_month,
	mau,
	month_add_uv,
	max( month_add_uv ) over ( ORDER BY start_month ),
	sum( month_add_uv ) over ( ORDER BY start_month )
FROM
	(
	SELECT
		date_format( a.start_time, '%Y%m' ) AS start_month,
		count( DISTINCT a.uid ) AS mau,
		count( DISTINCT b.uid ) AS month_add_uv
	FROM
		exam_record a
		LEFT JOIN (
         SELECT uid, min( date_format( start_time, '%Y%m' )) AS first_month FROM exam_record GROUP BY uid ) b ON date_format( a.start_time, '%Y%m' ) = b.first_month
	GROUP BY
		start_month
	) main
ORDER BY
	start_month
```

----------------------------------------

TITLE: Retrieving Elements from CopyOnWriteArrayList in Java
DESCRIPTION: Implementation of the get() method in CopyOnWriteArrayList, showing the lock-free read operation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/copyonwritearraylist-source-code.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
private transient volatile Object[] array;

public E get(int index) {
    return get(getArray(), index);
}

final Object[] getArray() {
    return array;
}

private E get(Object[] a, int index) {
    return (E) a[index];
}
```

----------------------------------------

TITLE: Demonstrating Parameters in Java Methods
DESCRIPTION: Shows the difference between formal and actual parameters in Java method calls using a simple string example.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/why-there-only-value-passing-in-java.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
String hello = "Hello!";
// hello 为实参
sayHello(hello);
// str 为形参
void sayHello(String str) {
    System.out.println(str);
}
```

----------------------------------------

TITLE: Maven Dependency Exclusion Example
DESCRIPTION: Example showing how to exclude a transitive dependency using the exclusions tag to resolve version conflicts.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-core-concepts.md#2025-04-20_snippet_2

LANGUAGE: xml
CODE:
```
<dependency>
    ......
    <exclusions>
      <exclusion>
        <artifactId>x</artifactId>
        <groupId>org.apache.x</groupId>
      </exclusion>
    </exclusions>
</dependency>
```

----------------------------------------

TITLE: Markdown Image Link to JavaGuide Knowledge Planet
DESCRIPTION: A Markdown formatted image link that displays the JavaGuide knowledge planet logo and links to more information about the platform. Uses an image hosted on oss.javaguide.cn.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/snippets/article-header.snippet.md#2025-04-20_snippet_0

LANGUAGE: markdown
CODE:
```
[![JavaGuide官方知识星球](https://oss.javaguide.cn/xingqiu/xingqiu.png)](../about-the-author/zhishixingqiu-two-years.md)
```

----------------------------------------

TITLE: Floating-Point Precision Loss Example in Java
DESCRIPTION: This code snippet demonstrates the precision loss that can occur when performing floating-point arithmetic in Java.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
float a = 2.0f - 1.9f;
float b = 1.8f - 1.7f;
System.out.printf("%.9f",a);// 0.100000024
System.out.println(b);// 0.099999905
System.out.println(a == b);// false
```

----------------------------------------

TITLE: 定义内部类 (Java)
DESCRIPTION: 展示了如何在Java中定义外部类和内部类。内部类可以访问外部类的私有属性。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class OutterClass {
    private String userName;

    public String getUserName() {
        return userName;
    }

    public void setUserName(String userName) {
        this.userName = userName;
    }

    public static void main(String[] args) {

    }

    class InnerClass{
        private String name;

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }
    }
}
```

----------------------------------------

TITLE: Multipart Byte Ranges Response
DESCRIPTION: Shows server response format when returning multiple byte ranges with appropriate content type and boundaries.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/network/http1.0-vs-http1.1.md#2025-04-20_snippet_4

LANGUAGE: bash
CODE:
```
HTTP/1.1 206 Partial Content
Content-Type: multipart/byteranges; boundary=3d6b6a416f9b5
Content-Length: 376

--3d6b6a416f9b5
Content-Type: application/octet-stream
Content-Range: bytes 0-99/2000

(第 0 到 99 字节的数据块)

--3d6b6a416f9b5
Content-Type: application/octet-stream
Content-Range: bytes 500-599/2000

(第 500 到 599 字节的数据块)

--3d6b6a416f9b5
Content-Type: application/octet-stream
Content-Range: bytes 1000-1099/2000

(第 1000 到 1099 字节的数据块)

--3d6b6a416f9b5--
```

----------------------------------------

TITLE: SQL Range Query Example for Index Comparison
DESCRIPTION: Demonstrates a simple SQL range query that highlights the limitations of hash indexes. This example shows why B+ trees are preferred for range-based queries in MySQL, as hash indexes cannot efficiently handle range operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-index.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
SELECT * FROM tb1 WHERE id < 500;
```

----------------------------------------

TITLE: Using instanceof Pattern Matching in Java 16
DESCRIPTION: This code snippet shows the new instanceof pattern matching feature in Java 16. It demonstrates how to use the pattern variable directly without explicit casting.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java16.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
// Old code
if (o instanceof String) {
    String s = (String)o;
    ... use s ...
}

// New code
if (o instanceof String s) {
    ... use s ...
}
```

----------------------------------------

TITLE: Checking JVM Memory Statistics in Java
DESCRIPTION: Code to print maximum memory, free memory, and total memory available to the JVM runtime.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-intro.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
System.out.println("Xmx=" + Runtime.getRuntime().maxMemory() / 1024.0 / 1024 + "M");    //系统的最大空间
System.out.println("free mem=" + Runtime.getRuntime().freeMemory() / 1024.0 / 1024 + "M");  //系统的空闲空间
System.out.println("total mem=" + Runtime.getRuntime().totalMemory() / 1024.0 / 1024 + "M");  //当前可用的总空间
```

----------------------------------------

TITLE: SQL 基本语法示例
DESCRIPTION: 展示了SQL语句的一行写法和多行写法
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_0

LANGUAGE: sql
CODE:
```
UPDATE user SET username='robot', password='robot' WHERE username = 'root';

UPDATE user
SET username='robot', password='robot'
WHERE username = 'root';
```

----------------------------------------

TITLE: Bytecode Instructions for String Object Creation
DESCRIPTION: This bytecode shows the detailed instructions executed when creating a new String object with a string literal. It demonstrates how JVM handles string creation, including checking and potentially adding the literal to the constant pool.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_17

LANGUAGE: java
CODE:
```
// 在堆内存中分配一个尚未初始化的 String 对象。
// #2 是常量池中的一个符号引用，指向 java/lang/String 类。
// 在类加载的解析阶段，这个符号引用会被解析成直接引用，即指向实际的 java/lang/String 类。
0 new #2 <java/lang/String>
// 复制栈顶的 String 对象引用，为后续的构造函数调用做准备。
// 此时操作数栈中有两个相同的对象引用：一个用于传递给构造函数，另一个用于保持对新对象的引用，后续将其存储到局部变量表。
3 dup
// JVM 先检查字符串常量池中是否存在 "abc"。
// 如果常量池中已存在 "abc"，则直接返回该字符串的引用；
// 如果常量池中不存在 "abc"，则 JVM 会在常量池中创建该字符串字面量并返回它的引用。
// 这个引用被压入操作数栈，用作构造函数的参数。
4 ldc #3 <abc>
// 调用构造方法，使用从常量池中加载的 "abc" 初始化堆中的 String 对象
// 新的 String 对象将包含与常量池中的 "abc" 相同的内容，但它是一个独立的对象，存储于堆中。
6 invokespecial #4 <java/lang/String.<init> : (Ljava/lang/String;)V>
// 将堆中的 String 对象引用存储到局部变量表
9 astore_1
// 返回，结束方法
10 return
```

----------------------------------------

TITLE: Remove Method Implementation in LinkedList Iterator in Java
DESCRIPTION: Explains the implementation of the remove() method in LinkedList's iterator. This method removes the last returned element from the list and updates the iterator's state accordingly.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/linkedlist-source-code.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
// 从列表中删除上次被返回的元素
public void remove() {
    // 检查是否在迭代过程中链表被修改
    checkForComodification();
    // 如果上次返回的节点为空，则抛出异常
    if (lastReturned == null)
        throw new IllegalStateException();

    // 获取当前节点的下一个节点
    Node<E> lastNext = lastReturned.next;
    // 从链表中删除上次返回的节点
    unlink(lastReturned);
    // 修改指针
    if (next == lastReturned)
        next = lastNext;
    else
        nextIndex--;
    // 将上次返回的节点引用置为 null，方便 GC 回收
    lastReturned = null;
    expectedModCount++;
}
```

----------------------------------------

TITLE: ArrayList ensureCapacity Method Implementation in Java
DESCRIPTION: The ensureCapacity method allows users to increase an ArrayList's capacity explicitly to minimize the number of incremental reallocations. This method is provided for optimization purposes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_15

LANGUAGE: java
CODE:
```
    /**
    如有必要，增加此 ArrayList 实例的容量，以确保它至少可以容纳由minimum capacity参数指定的元素数。
     *
     * @param   minCapacity   所需的最小容量
     */
    public void ensureCapacity(int minCapacity) {
        int minExpand = (elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA)
            // any size if not default element table
            ? 0
            // larger than default for default empty table. It's already
            // supposed to be at default size.
            : DEFAULT_CAPACITY;

        if (minCapacity > minExpand) {
            ensureExplicitCapacity(minCapacity);
        }
    }
```

----------------------------------------

TITLE: Demonstrating 'super' keyword usage in Java
DESCRIPTION: This code snippet illustrates how to use the 'super' keyword to access parent class members from a child class in Java. It shows accessing a parent class variable and calling a parent class method.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-keyword-summary.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public class Super {
    protected int number;
    protected showNumber() {
        System.out.println("number = " + number);
    }
}
public class Sub extends Super {
    void bar() {
        super.number = 10;
        super.showNumber();
    }
}
```

----------------------------------------

TITLE: 查看ZooKeeper节点状态
DESCRIPTION: 使用stat命令查看节点node1的详细状态信息。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_9

LANGUAGE: shell
CODE:
```
[zk: 127.0.0.1:2181(CONNECTED) 10] stat /node1
cZxid = 0x47
ctime = Sun Jan 20 10:22:59 CST 2019
mZxid = 0x47
mtime = Sun Jan 20 10:22:59 CST 2019
pZxid = 0x4a
cversion = 1
dataVersion = 0
aclVersion = 0
ephemeralOwner = 0x0
dataLength = 11
numChildren = 1
```

----------------------------------------

TITLE: Guava Library Array Conversion
DESCRIPTION: Shows array to list conversion using Google Guava library's ImmutableList and Lists utility classes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
List<String> il = ImmutableList.of("string", "elements");  // from varargs
List<String> il = ImmutableList.copyOf(aStringArray);      // from array
```

----------------------------------------

TITLE: Creating Dynamic XML Query for Method Overloading Support
DESCRIPTION: Illustrates how to use dynamic SQL in XML mapping files to support method overloading in MyBatis. The <where> and <if> tags conditionally include filtering based on parameter presence.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/mybatis/mybatis-interview.md#2025-04-20_snippet_2

LANGUAGE: xml
CODE:
```
<select id="getAllStu" resultType="com.pojo.Student">
  select * from student
  <where>
    <if test="id != null">
      id = #{id}
    </if>
  </where>
</select>
```

----------------------------------------

TITLE: MongoDB Aggregation Pipeline Format
DESCRIPTION: Shows the basic structure for using aggregation pipeline operators in MongoDB's aggregate method
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mongodb/mongodb-questions-01.md#2025-04-20_snippet_1

LANGUAGE: SQL
CODE:
```
db.collection.aggregate( [ { 阶段操作符：表述 }, { 阶段操作符：表述 }, ... ] )
```

----------------------------------------

TITLE: Constructing LinkedBlockingQueue in Java
DESCRIPTION: Shows two constructors for LinkedBlockingQueue: one creating an unbounded queue and another creating a bounded queue with a specified capacity.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-collections.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public LinkedBlockingQueue() {
    this(Integer.MAX_VALUE);
}

public LinkedBlockingQueue(int capacity) {
    if (capacity <= 0) throw new IllegalArgumentException();
    this.capacity = capacity;
    last = head = new Node<E>(null);
}
```

----------------------------------------

TITLE: Kafka Consumer with Error Simulation
DESCRIPTION: Consumer implementation that deliberately throws an exception for every 5th message to demonstrate retry behavior
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/kafka-questions-01.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
@KafkaListener(topics = {KafkaConst.TEST_TOPIC},groupId = "apple")
private void customer(String message) throws InterruptedException {
    log.info("kafka customer:{}",message);
    Integer n = Integer.parseInt(message);
    if (n%5==0){
        throw new  RuntimeException();
    }
}
```

----------------------------------------

TITLE: MySQL SQL Programming Fundamentals
DESCRIPTION: Covers core SQL programming concepts including local/global variables, control structures, built-in functions and stored functions. Includes extensive function reference for numeric, date/time and string operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_7

LANGUAGE: sql
CODE:
```
/* SQL编程 */ ------------------
--// 局部变量 ----------
-- 变量声明
    declare var_name[,...] type [default value]
    这个语句被用来声明局部变量。要给变量提供一个默认值，请包含一个default子句。值可以被指定为一个表达式，不需要为一个常数。如果没有default子句，初始值为null。
[...truncated for brevity...]
```

----------------------------------------

TITLE: Large Memory Allocation Test
DESCRIPTION: Code showing the allocation of a larger byte array (10MB) and its effect on memory statistics.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-intro.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
byte[] b = new byte[10 * 1024 * 1024];
System.out.println("分配了10M空间给数组");
System.out.println("Xmx=" + Runtime.getRuntime().maxMemory() / 1024.0 / 1024 + "M");
System.out.println("free mem=" + Runtime.getRuntime().freeMemory() / 1024.0 / 1024 + "M");
System.out.println("total mem=" + Runtime.getRuntime().totalMemory() / 1024.0 / 1024 + "M");
```

----------------------------------------

TITLE: Adding User View History Business Logic in Java
DESCRIPTION: This method handles the business logic for adding user view history. It saves the view history, creates a transaction record, and stores it in Redis or a database.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/rocketmq-questions.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
@Component
public class ViewHistoryHandler {

    @Autowired
    private IViewHistoryService viewHistoryService;

    @Autowired
    private IMqTransactionService mqTransactionService;

    @Autowired
    private RedisService redisService;

    @Transactional
    public Boolean addViewHistory(String transactionId, Long userId, Long forecastLogId) {
        // Implementation details omitted for brevity
    }
}
```

----------------------------------------

TITLE: Configuring MySQL Query Cache in my.cnf
DESCRIPTION: Configuration settings for enabling MySQL query cache in my.cnf file. These properties activate the query cache and set its size to approximately 600KB.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_2

LANGUAGE: properties
CODE:
```
query_cache_type=1
query_cache_size=600000
```

----------------------------------------

TITLE: 使用WATCH监视键值变化控制事务执行
DESCRIPTION: 展示了如何使用WATCH命令监视键值的变化，当被监视的键在事务执行前被其他客户端修改时，事务会失败。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-02.md#2025-04-20_snippet_2

LANGUAGE: bash
CODE:
```
# 客户端 1
> SET PROJECT "RustGuide"
OK
> WATCH PROJECT
OK
> MULTI
OK
> SET PROJECT "JavaGuide"
QUEUED

# 客户端 2
# 在客户端 1 执行 EXEC 命令提交事务之前修改 PROJECT 的值
> SET PROJECT "GoGuide"

# 客户端 1
# 修改失败，因为 PROJECT 的值被客户端2修改了
> EXEC
(nil)
> GET PROJECT
"GoGuide"
```

----------------------------------------

TITLE: Querying MySQL Query Cache Configuration Variables
DESCRIPTION: This SQL command displays all system variables related to query cache in MySQL. The command shows whether query cache is supported and its current configuration settings.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-query-cache.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
mysql> show variables like '%query_cache%';
+------------------------------+---------+
| Variable_name                | Value   |
+------------------------------+---------+
| have_query_cache             | YES     |
| query_cache_limit            | 1048576 |
| query_cache_min_res_unit     | 4096    |
| query_cache_size             | 599040  |
| query_cache_type             | ON      |
| query_cache_wlock_invalidate | OFF     |
+------------------------------+---------+
6 rows in set (0.02 sec)
```

----------------------------------------

TITLE: Implementing equals() Method in String Class
DESCRIPTION: This code snippet shows the implementation of the equals() method in the String class, which compares the content of two String objects.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
public boolean equals(Object anObject) {
    if (this == anObject) {
        return true;
    }
    if (anObject instanceof String) {
        String anotherString = (String)anObject;
        int n = value.length;
        if (n == anotherString.value.length) {
            char v1[] = value;
            char v2[] = anotherString.value;
            int i = 0;
            while (n-- != 0) {
                if (v1[i] != v2[i])
                    return false;
                i++;
            }
            return true;
        }
    }
    return false;
}
```

----------------------------------------

TITLE: Redis Set类型的基本操作
DESCRIPTION: 展示了Set类型的基本操作,包括SADD、SMEMBERS、SCARD、SISMEMBER等命令的使用。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_8

LANGUAGE: bash
CODE:
```
> SADD mySet value1 value2
(integer) 2
> SADD mySet value1 # 不允许有重复元素，因此添加失败
(integer) 0
> SMEMBERS mySet
1) "value1"
2) "value2"
> SCARD mySet
(integer) 2
> SISMEMBER mySet value1
(integer) 1
> SADD mySet2 value2 value3
(integer) 2
```

----------------------------------------

TITLE: Demonstrating Shared Static Variables in Generic Classes in Java
DESCRIPTION: Shows how static variables in generic classes are shared across all instances, regardless of the type parameter. This is due to type erasure causing all instances to share the same bytecode.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_10

LANGUAGE: java
CODE:
```
public class StaticTest{
    public static void main(String[] args){
        GT<Integer> gti = new GT<Integer>();
        gti.var=1;
        GT<String> gts = new GT<String>();
        gts.var=2;
        System.out.println(gti.var);
    }
}
class GT<T>{
    public static int var=0;
    public void nothing(T x){}
}
```

----------------------------------------

TITLE: Defining ServiceLoader Class Structure in Java
DESCRIPTION: Shows the basic structure of the ServiceLoader class, highlighting that it's final and implements Iterable interface.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/spi.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
public final class ServiceLoader<S> implements Iterable<S>{ xxx...}
```

----------------------------------------

TITLE: Implementing ClassLoader Security Check in JDK 8
DESCRIPTION: Source code of ClassLoader's preDefineClass method that performs security checks before defining classes. It prevents loading malicious core Java classes by validating package names and throwing SecurityException for unauthorized 'java.' package definitions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/classloader.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
private ProtectionDomain preDefineClass(String name,
                                            ProtectionDomain pd)
    {
        // 检查类名是否合法
        if (!checkName(name)) {
            throw new NoClassDefFoundError("IllegalName: " + name);
        }

        // 防止在 "java.*" 包中定义类。
        // 此检查对于安全性至关重要，因为它可以防止恶意代码替换核心 Java 类。
        // JDK 9 利用平台类加载器增强了 preDefineClass 方法的安全性
        if ((name != null) && name.startsWith("java.")) {
            throw new SecurityException
                ("禁止的包名: " +
                 name.substring(0, name.lastIndexOf('.')));
        }

         // 如果未指定 ProtectionDomain，则使用默认域（defaultDomain）。
        if (pd == null) {
            pd = defaultDomain;
        }

        if (name != null) {
            checkCerts(name, pd.getCodeSource());
        }

        return pd;
    }
```

----------------------------------------

TITLE: Unsupported Operation Example
DESCRIPTION: Shows how modification operations on Arrays.asList() result throw UnsupportedOperationException.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
List myList = Arrays.asList(1, 2, 3);
myList.add(4);//运行时报错：UnsupportedOperationException
myList.remove(1);//运行时报错：UnsupportedOperationException
myList.clear();//运行时报错：UnsupportedOperationException
```

----------------------------------------

TITLE: Demonstrating System.exit() in Try-Catch-Finally Blocks in Java
DESCRIPTION: This code snippet shows that the finally block is not executed when System.exit() is called in the catch block, terminating the Java Virtual Machine.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
try {
    System.out.println("Try to do something");
    throw new RuntimeException("RuntimeException");
} catch (Exception e) {
    System.out.println("Catch Exception -> " + e.getMessage());
    // 终止当前正在运行的Java虚拟机
    System.exit(1);
} finally {
    System.out.println("Finally");
}
```

----------------------------------------

TITLE: Custom Error Handler Implementation
DESCRIPTION: Extended DefaultErrorHandler implementation for custom error handling and alerting
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/kafka-questions-01.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
@Slf4j
public class DelErrorHandler extends DefaultErrorHandler {

    public DelErrorHandler(FixedBackOff backOff) {
        super(null,backOff);
    }

    @Override
    public void handleRemaining(Exception thrownException, List<ConsumerRecord<?, ?>> records, Consumer<?, ?> consumer, MessageListenerContainer container) {
        super.handleRemaining(thrownException, records, consumer, container);
        log.info("重试多次失败");
        // 自定义操作
    }
}
```

----------------------------------------

TITLE: Docker Compose File Basic Structure Example
DESCRIPTION: Example of a Docker Compose YAML file structure showing version declaration, service definitions with various configuration options, and optional volume and network configurations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_6

LANGUAGE: yaml
CODE:
```
version: "3.8" # 定义版本， 表示当前使用的 docker-compose 语法的版本
services: # 服务，可以存在多个
    servicename1: # 服务名字，它也是内部 bridge 网络可以使用的 DNS name，如果不是集群模式相当于 docker run 的时候指定的一个名称，
   #集群（Swarm）模式是多个容器的逻辑抽象
        image: # 镜像的名字
        command: # 可选，如果设置，则会覆盖默认镜像里的 CMD 命令
        environment: # 可选，等价于 docker container run 里的 --env 选项设置环境变量
        volumes: # 可选，等价于 docker container run 里的 -v 选项 绑定数据卷
        networks: # 可选，等价于 docker container run 里的 --network 选项指定网络
        ports: # 可选，等价于 docker container run 里的 -p 选项指定端口映射
        restart: # 可选，控制容器的重启策略
        build: #构建目录
        depends_on: #服务依赖配置
    servicename2:
        image:
        command:
        networks:
    	ports:
    servicename3:
    #...
volumes: # 可选，需要创建的数据卷，类似 docker volume create
  db_data:
networks: # 可选，等价于 docker network create
```

----------------------------------------

TITLE: Custom Kafka Listener Container Factory Configuration
DESCRIPTION: Configuration for custom retry attempts and intervals using FixedBackOff
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/kafka-questions-01.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
@Bean
public KafkaListenerContainerFactory kafkaListenerContainerFactory(ConsumerFactory<String, String> consumerFactory) {
    ConcurrentKafkaListenerContainerFactory factory = new ConcurrentKafkaListenerContainerFactory();
    // 自定义重试时间间隔以及次数
    FixedBackOff fixedBackOff = new FixedBackOff(1000, 5);
    factory.setCommonErrorHandler(new DefaultErrorHandler(fixedBackOff));
    factory.setConsumerFactory(consumerFactory);
    return factory;
}
```

----------------------------------------

TITLE: Multiple Method Overloading in PersonDao Interface
DESCRIPTION: Shows more complex overloading with multiple parameters in a MyBatis Mapper interface. Three method variations are provided: no parameters, one parameter, and two parameters.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/mybatis/mybatis-interview.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
Person queryById();

Person queryById(@Param("id") Long id);

Person queryById(@Param("id") Long id, @Param("name") String name);
```

----------------------------------------

TITLE: 更新ZooKeeper节点数据
DESCRIPTION: 使用set命令更新节点node1的数据内容为"set node1"。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_5

LANGUAGE: shell
CODE:
```
[zk: 127.0.0.1:2181(CONNECTED) 11] set /node1 "set node1"
```

----------------------------------------

TITLE: Zuul Rate Limiting Dependencies
DESCRIPTION: Maven dependencies required to implement rate limiting in Zuul using spring-cloud-zuul-ratelimit library
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/api-gateway.md#2025-04-20_snippet_0

LANGUAGE: xml
CODE:
```
<dependency>
  <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-starter-netflix-zuul</artifactId>
</dependency>
<dependency>
    <groupId>com.marcosbarbero.cloud</groupId>
    <artifactId>spring-cloud-zuul-ratelimit</artifactId>
    <version>2.2.0.RELEASE</version>
</dependency>
```

----------------------------------------

TITLE: Calculating Power Function Using Simple Multiplication in Java
DESCRIPTION: An alternative implementation of the power function using iterative multiplication. This method has O(n) time complexity where n is the absolute value of the exponent, making it less efficient than binary exponentiation for large exponents.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
// 使用累乘
public double powerAnother(double base, int exponent) {
    double result = 1.0;
    for (int i = 0; i < Math.abs(exponent); i++) {
        result *= base;
    }
    if (exponent >= 0)
        return result;
    else
        return 1 / result;
}
```

----------------------------------------

TITLE: Demonstrating String Interpolation with ${} in SQL Queries
DESCRIPTION: Shows how to use ${} for dynamic column sorting in MyBatis. The orderCols parameter is directly interpolated into the SQL statement, allowing flexible sorting by any column combination.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/mybatis/mybatis-interview.md#2025-04-20_snippet_0

LANGUAGE: sql
CODE:
```
select * from users order by ${orderCols}
```

----------------------------------------

TITLE: Exploring ThreadLocal GC Behavior in Java
DESCRIPTION: Code demonstrating how to inspect ThreadLocal's internal state after garbage collection using reflection.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public class ThreadLocalDemo {

    public static void main(String[] args) throws NoSuchFieldException, IllegalAccessException, InterruptedException {
        Thread t = new Thread(()->test("abc",false));
        t.start();
        t.join();
        System.out.println("--gc后--");
        Thread t2 = new Thread(() -> test("def", true));
        t2.start();
        t2.join();
    }

    private static void test(String s,boolean isGC)  {
        try {
            new ThreadLocal<>().set(s);
            if (isGC) {
                System.gc();
            }
            Thread t = Thread.currentThread();
            Class<? extends Thread> clz = t.getClass();
            Field field = clz.getDeclaredField("threadLocals");
            field.setAccessible(true);
            Object ThreadLocalMap = field.get(t);
            Class<?> tlmClass = ThreadLocalMap.getClass();
            Field tableField = tlmClass.getDeclaredField("table");
            tableField.setAccessible(true);
            Object[] arr = (Object[]) tableField.get(ThreadLocalMap);
            for (Object o : arr) {
                if (o != null) {
                    Class<?> entryClass = o.getClass();
                    Field valueField = entryClass.getDeclaredField("value");
                    Field referenceField = entryClass.getSuperclass().getSuperclass().getDeclaredField("referent");
                    valueField.setAccessible(true);
                    referenceField.setAccessible(true);
                    System.out.println(String.format("弱引用key:%s,值:%s", referenceField.get(o), valueField.get(o)));
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

----------------------------------------

TITLE: Collections Synchronization Methods
DESCRIPTION: Thread-safe collection wrapper methods provided by Collections utility class (not recommended for use)
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_14

LANGUAGE: java
CODE:
```
synchronizedCollection(Collection<T>  c) //返回指定 collection 支持的同步（线程安全的）collection。
synchronizedList(List<T> list)//返回指定列表支持的同步（线程安全的）List。
synchronizedMap(Map<K,V> m) //返回由指定映射支持的同步（线程安全的）Map。
synchronizedSet(Set<T> s) //返回指定 set 支持的同步（线程安全的）set。
```

----------------------------------------

TITLE: Adding Null Values to ArrayList Example in Java
DESCRIPTION: Demonstrates how ArrayList can store null values along with regular objects, though it's not recommended for maintainability reasons.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
ArrayList<String> listOfStrings = new ArrayList<>();
listOfStrings.add(null);
listOfStrings.add("java");
System.out.println(listOfStrings);
```

----------------------------------------

TITLE: Implementing LazyIterator in ServiceLoader for Java
DESCRIPTION: Demonstrates the implementation of LazyIterator, which handles the lazy loading of service providers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/spi.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
public boolean hasNext() {
    if (acc == null) {
        return hasNextService();
    } else {
        PrivilegedAction<Boolean> action = new PrivilegedAction<Boolean>() {
            public Boolean run() {
                return hasNextService();
            }
        };
        return AccessController.doPrivileged(action, acc);
    }
}

private boolean hasNextService() {
    if (nextName != null) {
        return true;
    }
    if (configs == null) {
        try {
            //通过PREFIX（META-INF/services/）和类名 获取对应的配置文件，得到具体的实现类
            String fullName = PREFIX + service.getName();
            if (loader == null)
                configs = ClassLoader.getSystemResources(fullName);
            else
                configs = loader.getResources(fullName);
        } catch (IOException x) {
            fail(service, "Error locating configuration files", x);
        }
    }
    while ((pending == null) || !pending.hasNext()) {
        if (!configs.hasMoreElements()) {
            return false;
        }
        pending = parse(service, configs.nextElement());
    }
    nextName = pending.next();
    return true;
}


public S next() {
    if (acc == null) {
        return nextService();
    } else {
        PrivilegedAction<S> action = new PrivilegedAction<S>() {
            public S run() {
                return nextService();
            }
        };
        return AccessController.doPrivileged(action, acc);
    }
}

private S nextService() {
    if (!hasNextService())
        throw new NoSuchElementException();
    String cn = nextName;
    nextName = null;
    Class<?> c = null;
    try {
        c = Class.forName(cn, false, loader);
    } catch (ClassNotFoundException x) {
        fail(service,
                "Provider " + cn + " not found");
    }
    if (!service.isAssignableFrom(c)) {
        fail(service,
                "Provider " + cn + " not a subtype");
    }
    try {
        S p = service.cast(c.newInstance());
        providers.put(cn, p);
        return p;
    } catch (Throwable x) {
        fail(service,
                "Provider " + cn + " could not be instantiated",
                x);
    }
    throw new Error();          // This cannot happen
}
```

----------------------------------------

TITLE: SQL Query Cache Control with SELECT Options
DESCRIPTION: Example SQL queries showing how to explicitly control query caching behavior using SQL_CACHE and SQL_NO_CACHE hints. These hints override the global query cache settings for specific queries.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-query-cache.md#2025-04-20_snippet_4

LANGUAGE: sql
CODE:
```
SELECT SQL_CACHE id, name FROM customer;# 会缓存
SELECT SQL_NO_CACHE id, name FROM customer;# 不会缓存
```

----------------------------------------

TITLE: SQL Name Query Using Covering Index
DESCRIPTION: Example query that demonstrates a covering index scenario where no table lookup is needed. The index itself contains all the data required for the query, eliminating the need for additional lookups.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-index.md#2025-04-20_snippet_2

LANGUAGE: sql
CODE:
```
SELECT name FROM table WHERE name='guang19';
```

----------------------------------------

TITLE: ContextAccessor getProperty Method Implementation
DESCRIPTION: Shows the implementation of the getProperty method in DynamicContext.ContextAccessor class, which is responsible for retrieving property values for dynamic SQL conditions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/mybatis/mybatis-interview.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
public Object getProperty(Map context, Object target, Object name) {
  Map map = (Map) target;

  Object result = map.get(name);
  if (map.containsKey(name) || result != null) {
    return result;
  }

  Object parameterObject = map.get(PARAMETER_OBJECT_KEY);
  if (parameterObject instanceof Map) {
    return ((Map)parameterObject).get(name);
  }

  return null;
}
```

----------------------------------------

TITLE: Enhanced Switch Expression in Java 12
DESCRIPTION: Shows the new lambda-style switch expression syntax that eliminates the need for break statements.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java12-13.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
switch (day) {
    case MONDAY, FRIDAY, SUNDAY -> System.out.println(6);
    case TUESDAY                -> System.out.println(7);
    case THURSDAY, SATURDAY     -> System.out.println(8);
    case WEDNESDAY              -> System.out.println(9);
}
```

----------------------------------------

TITLE: rehash Method for Resizing ThreadLocalMap
DESCRIPTION: Handles the resizing operations in ThreadLocalMap. It first performs a full cleanup of stale entries and then decides whether to resize the table based on the occupancy threshold.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
private void rehash() {
    expungeStaleEntries();

    if (size >= threshold - threshold / 4)
        resize();
}

private void expungeStaleEntries() {
    Entry[] tab = table;
    int len = tab.length;
    for (int j = 0; j < len; j++) {
        Entry e = tab[j];
        if (e != null && e.get() == null)
            expungeStaleEntry(j);
    }
}
```

----------------------------------------

TITLE: SQL Update和Delete语句
DESCRIPTION: 展示了更新和删除数据的基本语法
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_3

LANGUAGE: sql
CODE:
```
UPDATE user
SET username='robot', password='robot'
WHERE username = 'root';

DELETE FROM user
WHERE username = 'robot';

TRUNCATE TABLE user;
```

----------------------------------------

TITLE: Acquiring Reentrant Lock in Curator
DESCRIPTION: Shows the acquire method of InterProcessMutex that gets a reentrant mutex lock until successful. Throws IOException if connection is lost during lock acquisition.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
@Override
public void acquire() throws Exception {
  if (!internalLock(-1, null)) {
    throw new IOException("Lost connection while trying to acquire lock: " + basePath);
  }
}
```

----------------------------------------

TITLE: Illustrating Service Registry with ZooKeeper
DESCRIPTION: Diagram showing how ZooKeeper can be used as a service registry, with service providers registering themselves and consumers discovering services.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-plus.md#2025-04-20_snippet_4

LANGUAGE: markdown
CODE:
```
![注册中心](https://oss.javaguide.cn/p3-juejin/469cebf9670740d1a6711fe54db70e05~tplv-k3u1fbpfcp-zoom-1.jpeg)
```

----------------------------------------

TITLE: Default ArrayBlockingQueue Constructor
DESCRIPTION: Simple constructor that defaults to using non-fair locks by calling the main constructor with false for fairness.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
public ArrayBlockingQueue(int capacity) {
        this(capacity, false);
    }
```

----------------------------------------

TITLE: Defining Delayed Interface in Java
DESCRIPTION: Interface definition for Delayed that must be implemented by elements stored in DelayQueue. Requires implementation of getDelay() method.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/delayqueue-source-code.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public interface Delayed extends Comparable<Delayed> {
    long getDelay(TimeUnit unit);
}
```

----------------------------------------

TITLE: Redis List类型的范围查询和长度获取
DESCRIPTION: 展示了如何使用LRANGE命令查询List的元素范围,以及使用LLEN命令获取List的长度。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_6

LANGUAGE: bash
CODE:
```
> RPUSH myList value1 value2 value3
(integer) 3
> LRANGE myList 0 1
1) "value1"
2) "value2"
> LRANGE myList 0 -1
1) "value1"
2) "value2"
3) "value3"
> LLEN myList
(integer) 3
```

----------------------------------------

TITLE: Redis Set类型的集合运算
DESCRIPTION: 展示了Set类型的集合运算,包括求交集、并集和差集的操作。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_9

LANGUAGE: bash
CODE:
```
> SINTERSTORE mySet3 mySet mySet2
(integer) 1
> SMEMBERS mySet3
1) "value2"
> SUNION mySet mySet2
1) "value3"
2) "value2"
3) "value1"
> SDIFF mySet mySet2 # 差集是由所有属于 mySet 但不属于 A 的元素组成的集合
1) "value1"
```

----------------------------------------

TITLE: Enabling AOF Persistence in Redis
DESCRIPTION: Configuration command to enable AOF (Append Only File) persistence mode in Redis.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-persistence.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
appendonly yes
```

----------------------------------------

TITLE: Container Monitoring and Interaction
DESCRIPTION: Commands for viewing container logs, processes and executing commands inside containers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_10

LANGUAGE: shell
CODE:
```
docker logs 289cc00dc5ed
docker logs -f 289cc00dc5ed
docker logs -ft 289cc00dc5ed
docker top 289cc00dc5ed
docker exec -it 289cc00dc5ed bash
```

----------------------------------------

TITLE: Static vs Instance Method Example
DESCRIPTION: Example demonstrating the difference between static and instance methods in Java.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_17

LANGUAGE: java
CODE:
```
public class Person {
    public void method() {
      //......
    }

    public static void staicMethod(){
      //......
    }
    public static void main(String[] args) {
        Person person = new Person();
        // 调用实例方法
        person.method();
        // 调用静态方法
        Person.staicMethod()
    }
}
```

----------------------------------------

TITLE: Dynamic XML Mapping for Method Overloading Support
DESCRIPTION: Demonstrates an XML mapping that supports multiple overloaded methods using dynamic SQL conditions. The query includes multiple conditional filters that activate based on parameter availability.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/mybatis/mybatis-interview.md#2025-04-20_snippet_4

LANGUAGE: xml
CODE:
```
<select id="queryById" resultMap="PersonMap">
    select
      id, name, age, address
    from person
    <where>
        <if test="id != null">
            id = #{id}
        </if>
        <if test="name != null and name != ''">
            name = #{name}
        </if>
    </where>
    limit 1
</select>
```

----------------------------------------

TITLE: Demonstrating Return Statement Behavior in Try-Finally Blocks in Java
DESCRIPTION: This code snippet illustrates how return statements in try and finally blocks interact. It shows that a return statement in the finally block will override a return statement in the try block.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public static void main(String[] args) {
    System.out.println(f(2));
}

public static int f(int value) {
    try {
        return value * value;
    } finally {
        if (value == 2) {
            return 0;
        }
    }
}
```

----------------------------------------

TITLE: Redis Bloom Filter Commands
DESCRIPTION: Example commands showing how to use Bloom Filter functionality in Redis.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/bloom-filter.md#2025-04-20_snippet_3

LANGUAGE: shell
CODE:
```
127.0.0.1:6379> BF.ADD myFilter java
(integer) 1
127.0.0.1:6379> BF.ADD myFilter javaguide
(integer) 1
127.0.0.1:6379> BF.EXISTS myFilter java
(integer) 1
127.0.0.1:6379> BF.EXISTS myFilter javaguide
(integer) 1
127.0.0.1:6379> BF.EXISTS myFilter github
(integer) 0
```

----------------------------------------

TITLE: 使用Docker下载ZooKeeper镜像
DESCRIPTION: 通过Docker命令拉取ZooKeeper 3.5.8版本的镜像。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_0

LANGUAGE: shell
CODE:
```
docker pull zookeeper:3.5.8
```

----------------------------------------

TITLE: Main类的面向过程实现示例
DESCRIPTION: 展示使用面向过程方式计算圆的面积和周长,直接在主方法中进行计算
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class Main {
    public static void main(String[] args) {
        // 定义圆的半径
        double radius = 3.0;

        // 计算圆的面积和周长
        double area = Math.PI * radius * radius;
        double perimeter = 2 * Math.PI * radius;

        // 输出圆的面积和周长
        System.out.println("圆的面积为：" + area);
        System.out.println("圆的周长为：" + perimeter);
    }
}
```

----------------------------------------

TITLE: Class File API Usage Example
DESCRIPTION: Shows how to use the new Class File API for parsing and modifying Java class files, demonstrating the removal of debug methods from a class.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java22-23.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
ClassFile cf = ClassFile.of();
// 解析字节数组为 ClassModel
ClassModel classModel = cf.parse(bytes);

// 构建新的类文件，移除以 "debug" 开头的所有方法
byte[] newBytes = cf.build(classModel.thisClass().asSymbol(),
        classBuilder -> {
            for (ClassElement ce : classModel) {
                if (!(ce instanceof MethodModel mm
                        && mm.methodName().stringValue().startsWith("debug"))) {
                    classBuilder.with(ce);
                }
            }
        });
```

----------------------------------------

TITLE: Replacing Spaces in a String with Special Characters in Java (Regular Method)
DESCRIPTION: This method replaces spaces in a string with "%20" by iterating through each character and appending the appropriate replacement. It has O(n) time complexity and uses a StringBuffer for efficient string manipulation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
public String replaceSpace(StringBuffer str) {
    StringBuffer out = new StringBuffer();
    for (int i = 0; i < str.toString().length(); i++) {
        char b = str.charAt(i);
        if(String.valueOf(b).equals(" ")){
            out.append("%20");
        }else{
            out.append(b);
        }
    }
    return out.toString();
}
```

----------------------------------------

TITLE: SQL子查询示例
DESCRIPTION: 展示了嵌套子查询的用法
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_6

LANGUAGE: sql
CODE:
```
SELECT cust_name, cust_contact
FROM customers
WHERE cust_id IN (SELECT cust_id
                  FROM orders
                  WHERE order_num IN (SELECT order_num
                                      FROM orderitems
                                      WHERE prod_id = 'RGAN01'));
```

----------------------------------------

TITLE: Configuring Old-to-Young Generation Ratio in Java
DESCRIPTION: Sets the ratio of old generation to young generation memory using -XX:NewRatio. The example sets a 2:1 ratio of old to young generation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-parameters-intro.md#2025-04-20_snippet_3

LANGUAGE: bash
CODE:
```
-XX:NewRatio=2
```

----------------------------------------

TITLE: MySQL Miscellaneous Operations
DESCRIPTION: Various MySQL operations including identifier naming conventions, comments, wildcards and command line specifics.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_11

LANGUAGE: sql
CODE:
```
/* 杂项 */ ------------------
1. 可用反引号（`）为标识符（库名、表名、字段名、索引、别名）包裹，以避免与关键字重名！中文也可以作为标识符！
[...truncated for brevity...]
```

----------------------------------------

TITLE: Generating Maven Wrapper Files
DESCRIPTION: Command to generate Maven Wrapper files in a project. Maven Wrapper allows running Maven builds without requiring Maven to be pre-installed on the system.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_7

LANGUAGE: bash
CODE:
```
mvn wrapper:wrapper
```

----------------------------------------

TITLE: Constant Variable Declaration in Java
DESCRIPTION: This example demonstrates how to declare a constant variable in Java using the static and final keywords.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_10

LANGUAGE: Java
CODE:
```
public class ConstantVariableExample {
    // 常量
    public static final int constantVar = 0;
}
```

----------------------------------------

TITLE: Collection-based ArrayBlockingQueue Constructor
DESCRIPTION: Constructor that initializes queue with elements from a collection while maintaining capacity and fairness settings.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
public ArrayBlockingQueue(int capacity, boolean fair,
                              Collection<? extends E> c) {
  this(capacity, fair);

  final ReentrantLock lock = this.lock;
  lock.lock();
  try {
      int i = 0;
      try {
          for (E e : c) {
              checkNotNull(e);
              items[i++] = e;
          }
      } catch (ArrayIndexOutOfBoundsException ex) {
          throw new IllegalArgumentException();
      }
      count = i;
      putIndex = (i == capacity) ? 0 : i;
  } finally {
      lock.unlock();
  }
}
```

----------------------------------------

TITLE: SQL Field Selection Best Practice
DESCRIPTION: Example demonstrating the recommended practice of selecting specific fields instead of using SELECT *. This improves query performance by reducing unnecessary data retrieval.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_11

LANGUAGE: sql
CODE:
```
SELECT *
```

----------------------------------------

TITLE: 运行ZooKeeper Docker容器
DESCRIPTION: 使用Docker运行ZooKeeper容器，并将2181端口映射到主机。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_1

LANGUAGE: shell
CODE:
```
docker run -d --name zookeeper -p 2181:2181 zookeeper:3.5.8
```

----------------------------------------

TITLE: nextIndex and prevIndex Methods for Circular Table Traversal in Java
DESCRIPTION: Helper methods used for traversing the ThreadLocalMap table in a circular fashion. nextIndex increments the index and wraps around to 0 when reaching the end, while prevIndex decrements and wraps to the end when reaching 0.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
private static int nextIndex(int i, int len) {
    return ((i + 1 < len) ? i + 1 : 0);
}

private static int prevIndex(int i, int len) {
    return ((i - 1 >= 0) ? i - 1 : len - 1);
}
```

----------------------------------------

TITLE: Adding User IDs to HyperLogLog for Page View Tracking
DESCRIPTION: This code shows how to use the PFADD command to add user IDs to a HyperLogLog data structure for tracking unique page views (UV) efficiently with minimal memory usage.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_3

LANGUAGE: bash
CODE:
```
PFADD PAGE_1:UV USER1 USER2 ...... USERn
```

----------------------------------------

TITLE: Creating a Table with Auto-Increment Primary Key in MySQL
DESCRIPTION: Example of creating a table with an auto-increment primary key and inserting data to demonstrate how auto-increment values work in MySQL.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-auto-increment-primary-key-continuous.md#2025-04-20_snippet_0

LANGUAGE: sql
CODE:
```
insert into test_pk values(null, 1, 1)
```

----------------------------------------

TITLE: Specifying Heap Memory Sizes in Java
DESCRIPTION: Sets the initial (-Xms) and maximum (-Xmx) heap sizes for the JVM. The example allocates a minimum of 2GB and maximum of 5GB heap memory.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-parameters-intro.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
-Xms2G -Xmx5G
```

----------------------------------------

TITLE: Unsafe getAndAddInt Implementation
DESCRIPTION: Implementation of getAndAddInt method in Unsafe class showing CAS operation with retry loop.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
public final int getAndAddInt(Object o, long offset, int delta) {
    int v;
    do {
        v = getIntVolatile(o, offset);
    } while (!compareAndSwapInt(o, offset, v, v + delta));
    return v;
}
```

----------------------------------------

TITLE: Using LEAD() and LAG() Window Functions in MySQL
DESCRIPTION: Demonstrates the use of LEAD() and LAG() functions to access data from subsequent and previous rows respectively within a result set.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_5

LANGUAGE: sql
CODE:
```
SELECT col1, col2, LEAD(col1, 1) OVER (ORDER BY col1) AS next_col1,
                 LAG(col1, 1) OVER (ORDER BY col1) AS prev_col1
FROM table;
```

----------------------------------------

TITLE: Synchronous Message Sending in Kafka using Spring Boot
DESCRIPTION: Demonstrates how to send a message to a Kafka topic synchronously and check the result using Spring Boot's KafkaTemplate.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/message-queue/kafka-questions-01.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
SendResult<String, Object> sendResult = kafkaTemplate.send(topic, o).get();
if (sendResult.getRecordMetadata() != null) {
  logger.info("生产者成功发送消息到" + sendResult.getProducerRecord().topic() + "-> " + sendRe
              sult.getProducerRecord().value().toString());
}
```

----------------------------------------

TITLE: Calculating Maximum Time Window Between Consecutive Exam Attempts in MySQL
DESCRIPTION: Complex query to find the maximum time window between consecutive exam attempts for users who attempted exams on at least two days in 2021. Uses window functions, subqueries, and date calculations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_9

LANGUAGE: sql
CODE:
```
SELECT UID,
       max(datediff(next_time, start_time)) + 1 AS days_window,
       round(count(start_time)/(datediff(max(start_time), min(start_time))+ 1) * (max(datediff(next_time, start_time))+ 1), 2) AS avg_exam_cnt
FROM
  (SELECT UID,
          start_time,
          lead(start_time, 1) OVER (PARTITION BY UID
                                    ORDER BY start_time) AS next_time
   FROM exam_record
   WHERE YEAR (start_time) = '2021' ) a
GROUP BY UID
HAVING count(DISTINCT date(start_time)) > 1
ORDER BY days_window DESC,
         avg_exam_cnt DESC
```

----------------------------------------

TITLE: Setting Fixed Young Generation Size in Java
DESCRIPTION: Uses -Xmn to set a fixed size for the young generation memory. The example allocates 256MB to the young generation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-parameters-intro.md#2025-04-20_snippet_2

LANGUAGE: bash
CODE:
```
-Xmn256m
```

----------------------------------------

TITLE: Dynamic CDS Archive Commands
DESCRIPTION: Shows the command line syntax for using dynamic class data sharing archives in Java 13.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java12-13.md#2025-04-20_snippet_5

LANGUAGE: bash
CODE:
```
java -XX:ArchiveClassesAtExit=my_app_cds.jsa -cp my_app.jar
java -XX:SharedArchiveFile=my_app_cds.jsa -cp my_app.jar
```

----------------------------------------

TITLE: Circle类的面向对象实现示例
DESCRIPTION: 展示使用面向对象方式计算圆的面积和周长,通过Circle类封装数据和行为
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public class Circle {
    // 定义圆的半径
    private double radius;

    // 构造函数
    public Circle(double radius) {
        this.radius = radius;
    }

    // 计算圆的面积
    public double getArea() {
        return Math.PI * radius * radius;
    }

    // 计算圆的周长
    public double getPerimeter() {
        return 2 * Math.PI * radius;
    }

    public static void main(String[] args) {
        // 创建一个半径为3的圆
        Circle circle = new Circle(3.0);

        // 输出圆的面积和周长
        System.out.println("圆的面积为：" + circle.getArea());
        System.out.println("圆的周长为：" + circle.getPerimeter());
    }
}
```

----------------------------------------

TITLE: Time Complexity of Array Operations in Java
DESCRIPTION: Demonstrates the time complexity of basic operations (access, insert, delete) on arrays in Java.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/data-structure/linear-data-structure.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
假如数组的长度为 n。
访问：O（1）//访问特定位置的元素
插入：O（n ）//最坏的情况发生在插入发生在数组的首部并需要移动所有元素时
删除：O（n）//最坏的情况发生在删除数组的开头发生并需要移动第一元素后面所有的元素时
```

----------------------------------------

TITLE: SQL GROUP BY分组查询
DESCRIPTION: 展示了分组查询和Having过滤的用法
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_5

LANGUAGE: sql
CODE:
```
SELECT cust_name, COUNT(cust_address) AS addr_num
FROM Customers GROUP BY cust_name;

SELECT cust_name, COUNT(cust_address) AS addr_num
FROM Customers GROUP BY cust_name
ORDER BY cust_name DESC;

SELECT cust_name, COUNT(*) AS NumberOfOrders
FROM Customers
WHERE cust_email IS NOT NULL
GROUP BY cust_name
HAVING COUNT(*) > 1;
```

----------------------------------------

TITLE: Files Comparison in Java 12
DESCRIPTION: Shows usage of the new mismatch() method for comparing two files and finding the first mismatching position.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java12-13.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
Path filePath1 = Files.createTempFile("file1", ".txt");
Path filePath2 = Files.createTempFile("file2", ".txt");
Files.writeString(filePath1, "Java 12 Article");
Files.writeString(filePath2, "Java 12 Article");

long mismatch = Files.mismatch(filePath1, filePath2);
assertEquals(-1, mismatch);
```

----------------------------------------

TITLE: Checking Current Redis Eviction Policy
DESCRIPTION: Command to check the current memory eviction policy configuration in Redis.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_13

LANGUAGE: bash
CODE:
```
> config get maxmemory-policy
maxmemory-policy
noeviction
```

----------------------------------------

TITLE: Illustrating Cache Penetration Concept in Markdown
DESCRIPTION: This markdown snippet includes an image link to illustrate the concept of cache penetration in Redis.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-02.md#2025-04-20_snippet_7

LANGUAGE: markdown
CODE:
```
![缓存穿透](https://oss.javaguide.cn/github/javaguide/database/redis/redis-cache-penetration.png)
```

----------------------------------------

TITLE: Multi-file Java Program Structure
DESCRIPTION: Example showing how Java 22 supports multi-file program execution without explicit compilation, with separate files for the main class and helper class.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java22-23.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
// Prog.java
class Prog {
    public static void main(String[] args) { Helper.run(); }
}

// Helper.java
class Helper {
    static void run() { System.out.println("Hello!"); }
}
```

----------------------------------------

TITLE: Full Maven Dependency Configuration Example
DESCRIPTION: Complete example of Maven dependency configuration including optional elements like type, scope, optional flag and exclusions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-core-concepts.md#2025-04-20_snippet_1

LANGUAGE: xml
CODE:
```
<project>
    <dependencies>
        <dependency>
            <groupId></groupId>
            <artifactId></artifactId>
            <version></version>
            <type>...</type>
            <scope>...</scope>
            <optional>...</optional>
            <exclusions>
                <exclusion>
                  <groupId>...</groupId>
                  <artifactId>...</artifactId>
                </exclusion>
          </exclusions>
        </dependency>
      </dependencies>
</project>
```

----------------------------------------

TITLE: Java断言实现 (Java)
DESCRIPTION: 展示了Java中断言的使用方法。反编译代码揭示断言的底层实现是通过if语句和AssertionError实现的。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
public class AssertTest {
    public static void main(String args[]) {
        int a = 1;
        int b = 1;
        assert a == b;
        System.out.println("公众号：Hollis");
        assert a != b : "Hollis";
        System.out.println("博客：www.hollischuang.com");
    }
}
```

----------------------------------------

TITLE: Boolean Value Caching in Java
DESCRIPTION: This snippet shows how Boolean values are cached, always returning the same TRUE or FALSE instance for performance optimization.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
public static Boolean valueOf(boolean b) {
    return (b ? TRUE : FALSE);
}
```

----------------------------------------

TITLE: Defining Skip List Node Structure in Java
DESCRIPTION: Defines the Node class for a skip list, with data, forward pointers, and maximum level. Sets constants for maximum level and default values.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-skiplist.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
private static final int MAX_LEVEL = 16;

class Node {
    private int data = -1;
    private Node[] forwards = new Node[MAX_LEVEL];
    private int maxLevel = 0;
}
```

----------------------------------------

TITLE: REPLACE INTO Statement for Handling Duplicate Keys
DESCRIPTION: Demonstrates using REPLACE INTO to insert or update exam information, handling potential duplicate key conflicts automatically.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_2

LANGUAGE: SQL
CODE:
```
REPLACE INTO examination_info VALUES
 (NULL, 9003, "SQL", "hard", 90, "2021-01-01 00:00:00");
```

----------------------------------------

TITLE: Basic Array to List Conversion using Arrays.asList()
DESCRIPTION: Demonstrates the basic usage of Arrays.asList() to convert an array to a List. Shows both direct array conversion and inline element creation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
String[] myArray = {"Apple", "Banana", "Orange"};
List<String> myList = Arrays.asList(myArray);
//上面两个语句等价于下面一条语句
List<String> myList = Arrays.asList("Apple","Banana", "Orange");
```

----------------------------------------

TITLE: Reordering Array Elements with Odd Numbers Before Even Numbers in Java
DESCRIPTION: This algorithm reorders an array so that all odd numbers appear before even numbers while maintaining their relative order. It uses an auxiliary array and counts odd numbers first, which results in O(n) time complexity and O(n) space complexity.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
public class Solution {
    public void reOrderArray(int [] array) {
        //如果数组长度等于0或者等于1，什么都不做直接返回
        if(array.length==0||array.length==1)
            return;
        //oddCount：保存奇数个数
        //oddBegin：奇数从数组头部开始添加
        int oddCount=0,oddBegin=0;
        //新建一个数组
        int[] newArray=new int[array.length];
        //计算出（数组中的奇数个数）开始添加元素
        for(int i=0;i<array.length;i++){
            if((array[i]&1)==1) oddCount++;
        }
        for(int i=0;i<array.length;i++){
            //如果数为基数新数组从头开始添加元素
            //如果为偶数就从oddCount（数组中的奇数个数）开始添加元素
            if((array[i]&1)==1)
                newArray[oddBegin++]=array[i];
            else newArray[oddCount++]=array[i];
        }
        for(int i=0;i<array.length;i++){
            array[i]=newArray[i];
        }
    }
}
```

----------------------------------------

TITLE: Hash Function Implementation in JDK 1.7
DESCRIPTION: Legacy hash function implementation from JDK 1.7 that uses multiple bit shifts and XOR operations for hash computation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
static int hash(int h) {
    h ^= (h >>> 20) ^ (h >>> 12);
    return h ^ (h >>> 7) ^ (h >>> 4);
}
```

----------------------------------------

TITLE: 降低系统使用swap优先级
DESCRIPTION: 通过修改/proc/sys/vm/swappiness文件来降低系统使用swap的优先级。这个命令将swappiness值设置为10，有助于减少Redis进程发生内存交换的可能性。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-common-blocking-problems-summary.md#2025-04-20_snippet_2

LANGUAGE: bash
CODE:
```
echo 10 > /proc/sys/vm/swappiness
```

----------------------------------------

TITLE: Referencing Integer.MAX_VALUE constant in Java
DESCRIPTION: This snippet mentions the Integer.MAX_VALUE constant in the context of describing the default capacity of LinkedBlockingQueue. It's used to explain that LinkedBlockingQueue can be unbounded by default.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-01.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
Integer.MAX_VALUE
```

----------------------------------------

TITLE: Defining a Record Class in Java 14
DESCRIPTION: Shows how to use the record keyword to define a data class with automatically generated constructor, accessors, toString(), hashCode(), and equals() methods.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java14-15.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
final class Rectangle implements Shape {
    final double length;
    final double width;

    public Rectangle(double length, double width) {
        this.length = length;
        this.width = width;
    }

    double length() { return length; }
    double width() { return width; }
}
```

LANGUAGE: java
CODE:
```
record Rectangle(float length, float width) { }
```

----------------------------------------

TITLE: Configuring Metaspace Size in Java
DESCRIPTION: Sets the initial and maximum sizes for Metaspace using -XX:MetaspaceSize and -XX:MaxMetaspaceSize.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-parameters-intro.md#2025-04-20_snippet_4

LANGUAGE: bash
CODE:
```
-XX:MetaspaceSize=N
-XX:MaxMetaspaceSize=N
```

----------------------------------------

TITLE: Calculating Truncated Average Using Mathematical Formula
DESCRIPTION: SQL query that calculates the truncated average score for hard SQL exams using a mathematical approach. This solution uses the formula (sum - max - min)/(count - 2) to directly compute the average without filtering out specific scores.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_3

LANGUAGE: SQL
CODE:
```
SELECT info.tag,
       info.difficulty,
       ROUND((SUM(record.score)- MIN(record.score)- MAX(record.score)) / (COUNT(record.score)- 2), 1) AS clip_avg_score
FROM examination_info info,
     exam_record record
WHERE info.exam_id = record.exam_id
  AND info.tag = "SQL"
  AND info.difficulty = "hard";
```

----------------------------------------

TITLE: Demonstrating Integer Synchronization Issue in Java
DESCRIPTION: This code snippet demonstrates a common mistake when using Integer objects in synchronized blocks. The synchronization is ineffective because each increment operation creates a new Integer object with a different hashcode.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java16.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public void inc(Integer count) {
    for (int i = 0; i < 10; i++) {
        new Thread(() -> {
            synchronized (count) {
                count++;
            }
        }).start();
    }
}
```

----------------------------------------

TITLE: Arrays.copyOf() Method Implementation in Java
DESCRIPTION: The Arrays.copyOf() method creates a new array of the specified length and copies elements from the original array. It internally uses System.arraycopy() for the actual copying operation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_12

LANGUAGE: java
CODE:
```
    public static int[] copyOf(int[] original, int newLength) {
      // 申请一个新的数组
        int[] copy = new int[newLength];
  // 调用System.arraycopy,将源数组中的数据进行拷贝,并返回新的数组
        System.arraycopy(original, 0, copy, 0,
                         Math.min(original.length, newLength));
        return copy;
    }
```

----------------------------------------

TITLE: Method Types in Java - With Return and Parameters
DESCRIPTION: Example of a method that both accepts parameters and returns a value.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_15

LANGUAGE: java
CODE:
```
public int f4(int a, int b) {
    return a * b;
}
```

----------------------------------------

TITLE: Partial Content Response in HTTP 1.1
DESCRIPTION: Example of server response to a range request showing the Content-Range and Content-Length headers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/network/http1.0-vs-http1.1.md#2025-04-20_snippet_2

LANGUAGE: bash
CODE:
```
HTTP/1.1 206 Partial Content
Content-Range: bytes 0-1023/146515
Content-Length: 1024
…
（二进制内容）
```

----------------------------------------

TITLE: Creating a Similar Table Structure for Batch Insert Testing in MySQL
DESCRIPTION: Creating a table with the same structure as an existing one to demonstrate batch insert auto-increment behavior.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-auto-increment-primary-key-continuous.md#2025-04-20_snippet_4

LANGUAGE: sql
CODE:
```
create table test_pk2 like test_pk
```

----------------------------------------

TITLE: Calculating Truncated Average Score for SQL Hard Exams (Direct Approach)
DESCRIPTION: SQL query that calculates the truncated average (removing one highest and one lowest score) for hard SQL exams. This approach directly identifies the high difficulty SQL exam with ID 9001 and explicitly excludes the maximum and minimum scores using NOT IN with UNION ALL.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_0

LANGUAGE: SQL
CODE:
```
SELECT tag, difficulty, ROUND(AVG(score), 1) clip_avg_score
	FROM examination_info info  INNER JOIN exam_record record
		WHERE info.exam_id = record.exam_id
			AND  record.exam_id = 9001
				AND record.score NOT IN(
					SELECT MAX(score)
						FROM exam_record
							WHERE exam_id = 9001
								UNION ALL
					SELECT MIN(score)
						FROM exam_record
							WHERE exam_id = 9001
				)
```

----------------------------------------

TITLE: Referencing lock objects in LinkedBlockingQueue implementation
DESCRIPTION: This snippet mentions the putLock and takeLock objects used in the LinkedBlockingQueue implementation. These locks are used to separate the locking mechanisms for producers and consumers, reducing lock contention.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-01.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
putLock
```

LANGUAGE: Java
CODE:
```
takeLock
```

----------------------------------------

TITLE: Fixing Malformed Examination Records
DESCRIPTION: SQL query to extract and separate incorrectly combined tag, difficulty, and duration values into their proper columns.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_9

LANGUAGE: sql
CODE:
```
SELECT
	exam_id,
	substring_index( tag, ',', 1 ) tag,
	substring_index( substring_index( tag, ',', 2 ), ',',- 1 ) difficulty,
	substring_index( tag, ',',- 1 ) duration
FROM
	examination_info
WHERE
	difficulty = ''
```

----------------------------------------

TITLE: MySQL Cursor Example
DESCRIPTION: Shows how to use a cursor to process result sets row by row within a stored procedure.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_21

LANGUAGE: sql
CODE:
```
DELIMITER $
CREATE  PROCEDURE getTotal()
BEGIN
    DECLARE total INT;
    -- 创建接收游标数据的变量
    DECLARE sid INT;
    DECLARE sname VARCHAR(10);
    -- 创建总数变量
    DECLARE sage INT;
    -- 创建结束标志变量
    DECLARE done INT DEFAULT false;
    -- 创建游标
    DECLARE cur CURSOR FOR SELECT id,name,age from cursor_table where age>30;
    -- 指定游标循环结束时的返回值
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = true;
    SET total = 0;
    OPEN cur;
    FETCH cur INTO sid, sname, sage;
    WHILE(NOT done)
    DO
        SET total = total + 1;
        FETCH cur INTO sid, sname, sage;
    END WHILE;

    CLOSE cur;
    SELECT total;
END $
DELIMITER ;

-- 调用存储过程
call getTotal();
```

----------------------------------------

TITLE: Using explain() for MongoDB Query Analysis
DESCRIPTION: Example of using the explain() method to analyze MongoDB query execution paths and determine if indexes are being used effectively.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mongodb/mongodb-questions-02.md#2025-04-20_snippet_2

LANGUAGE: SQL
CODE:
```
db.s2.find().sort({"score": -1, "userid": 1}).explain()
```

----------------------------------------

TITLE: Lock Conversion Methods in StampedLock
DESCRIPTION: Method signatures showing how different lock types can be converted in StampedLock.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_16

LANGUAGE: java
CODE:
```
long tryConvertToWriteLock(long stamp){}
long tryConvertToReadLock(long stamp){}
long tryConvertToOptimisticRead(long stamp){}
```

----------------------------------------

TITLE: Creating and Querying with MongoDB Indexes
DESCRIPTION: Examples of MongoDB index creation and query operations that leverage indexes, including compound index creation and understanding how sort operations work with indexes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mongodb/mongodb-questions-02.md#2025-04-20_snippet_0

LANGUAGE: SQL
CODE:
```
db.s2.find().sort({"userid": 1, "score": -1})
db.s2.find().sort({"userid": -1, "score": 1})
```

----------------------------------------

TITLE: MySQL User and Permissions Management
DESCRIPTION: Comprehensive guide for managing MySQL users and permissions, including user creation, password management, privilege assignment and revocation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_9

LANGUAGE: sql
CODE:
```
/* 用户和权限管理 */ ------------------
-- root密码重置
1. 停止MySQL服务
2.  [Linux] /usr/local/mysql/bin/safe_mysqld --skip-grant-tables &
[...truncated for brevity...]
```

----------------------------------------

TITLE: JPS Command Examples in PowerShell
DESCRIPTION: Examples of using jps command to list Java processes and their properties
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jdk-monitoring-and-troubleshooting-tools.md#2025-04-20_snippet_0

LANGUAGE: powershell
CODE:
```
C:\Users\SnailClimb>jps
7360 NettyClient2
17396
7972 Launcher
16504 Jps
17340 NettyServer
```

----------------------------------------

TITLE: Computing Concurrent Users Example
DESCRIPTION: Formula example showing how to calculate concurrent users and QPS from DAU metrics
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-availability/performance-test.md#2025-04-20_snippet_0

LANGUAGE: text
CODE:
```
Average concurrent users = DAU(12M) * Average daily usage time(1 hour, 3600s) / Seconds in a day(86400) = 12M/24 = 500K

Actual concurrent users (accounting for low traffic periods) = DAU(12M) * Average daily usage time(1 hour, 3600s) / (Seconds in day - Low traffic period of 8 hours) = 12M/16 = 750K

Peak concurrent users = Average concurrent users * 6 = 3M

QPS = Actual concurrent users/RT = 750K/0.5 = 1.5M/s
```

----------------------------------------

TITLE: Defining Property Variables for Dependency Versions
DESCRIPTION: Demonstrates using the properties section in POM files to define dependency version variables, making it easier to update versions in a single location.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-best-practices.md#2025-04-20_snippet_6

LANGUAGE: xml
CODE:
```
<properties>
  <junit.version>5.7.0</junit.version>
  <mockito.version>3.9.0</mockito.version>
</properties>
```

----------------------------------------

TITLE: Creating MySQL User Account
DESCRIPTION: Demonstrates how to create a new MySQL user account with password.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_12

LANGUAGE: sql
CODE:
```
CREATE USER myuser IDENTIFIED BY 'mypassword';
```

----------------------------------------

TITLE: Docker Data Volume Configuration
DESCRIPTION: Commands for setting up and managing Docker data volumes for persistent storage.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_12

LANGUAGE: shell
CODE:
```
docker run -d -p 8080:8080 --name tomcat01 -v /opt/apps:/usr/local/tomcat/webapps tomcat:8.0-jre8
docker run -d -p 8080:8080 --name tomcat01 -v aa:/usr/local/tomcat/webapps tomcat:8.0-jre8
```

----------------------------------------

TITLE: Calculating Incomplete Rates for Level 0 Users - First Condition Query
DESCRIPTION: Query to calculate incomplete exam counts and rates for level 0 users when there exists at least one level 0 user with more than 2 incomplete exams.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_1

LANGUAGE: sql
CODE:
```
SELECT
	tmp1.uid uid,
	sum(
	IF
	( er.submit_time IS NULL AND er.start_time IS NOT NULL, 1, 0 )) incomplete_cnt,
	round(
		sum(
		IF
		( er.submit_time IS NULL AND er.start_time IS NOT NULL, 1, 0 ))/ count( tmp1.uid ),
		3
	) incomplete_rate
FROM
	(
	SELECT DISTINCT
		ui.uid
	FROM
		user_info ui
		LEFT JOIN exam_record er ON ui.uid = er.uid
	WHERE
		er.submit_time IS NULL
		AND ui.LEVEL = 0
	) tmp1
	LEFT JOIN exam_record er ON tmp1.uid = er.uid
GROUP BY
	tmp1.uid
ORDER BY
	incomplete_rate
```

----------------------------------------

TITLE: Finding Earliest Registered Users
DESCRIPTION: Simple SQL query to find the top 3 earliest registered users based on registration timestamp.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_6

LANGUAGE: SQL
CODE:
```
SELECT uid, nick_name, register_time
    FROM user_info
    ORDER BY register_time
    LIMIT 3
```

----------------------------------------

TITLE: MySQL Stored Procedures Implementation
DESCRIPTION: Details the creation and usage of stored procedures in MySQL, including parameter types (IN/OUT/INOUT) and procedure body syntax.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_8

LANGUAGE: sql
CODE:
```
/* 存储过程 */ ------------------
存储过程是一段可执行性代码的集合。相比函数，更偏向于业务逻辑。
调用：CALL 过程名
[...truncated for brevity...]
```

----------------------------------------

TITLE: IP Address Storage Comparison Example
DESCRIPTION: Example showing the difference between signed and unsigned integers for storing IP addresses.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-high-performance-optimization-specification-recommendations.md#2025-04-20_snippet_0

LANGUAGE: sql
CODE:
```
SIGNED INT -2147483648~2147483647
UNSIGNED INT 0~4294967295
```

----------------------------------------

TITLE: Analyzing Score Grade Distribution by User Level
DESCRIPTION: SQL query to calculate the distribution of exam score grades (Excellent/Good/Average/Poor) across different user levels. Uses case statements for grade classification and joins user_info with exam_record tables.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_5

LANGUAGE: SQL
CODE:
```
SELECT a.LEVEL,
       a.score_grade,
       ROUND(a.cur_count / b.total_num, 3) AS ratio
FROM
  (SELECT b.LEVEL AS LEVEL,
          (CASE
               WHEN a.score >= 90 THEN '优'
               WHEN a.score < 90
                    AND a.score >= 75 THEN '良'
               WHEN a.score < 75
                    AND a.score >= 60 THEN '中'
               ELSE '差'
           END) AS score_grade,
          count(1) AS cur_count
   FROM exam_record a
   LEFT JOIN user_info b ON a.uid = b.uid
   WHERE a.submit_time IS NOT NULL
   GROUP BY b.LEVEL,
            score_grade) a
LEFT JOIN
  (SELECT b.LEVEL AS LEVEL,
          count(b.LEVEL) AS total_num
   FROM exam_record a
   LEFT JOIN user_info b ON a.uid = b.uid
   WHERE a.submit_time IS NOT NULL
   GROUP BY b.LEVEL) b ON a.LEVEL = b.LEVEL
ORDER BY a.LEVEL DESC,
         ratio DESC
```

----------------------------------------

TITLE: Inserting Test Data for Implicit Conversion Analysis in MySQL
DESCRIPTION: SQL insert statements to add specific test cases for demonstrating string to number conversion rules.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/index-invalidation-caused-by-implicit-conversion.md#2025-04-20_snippet_2

LANGUAGE: SQL
CODE:
```
INSERT INTO `test1` (`id`, `num1`, `num2`, `type1`, `type2`, `str1`, `str2`) VALUES ('10000001', '10000', '10000a', '0', '0', '2df3d9465ty2e4hd523', '2df3d9465ty2e4hd523');
INSERT INTO `test1` (`id`, `num1`, `num2`, `type1`, `type2`, `str1`, `str2`) VALUES ('10000002', '10000', '010000', '0', '0', '2df3d9465ty2e4hd523', '2df3d9465ty2e4hd523');
INSERT INTO `test1` (`id`, `num1`, `num2`, `type1`, `type2`, `str1`, `str2`) VALUES ('10000003', '10000', ' 10000', '0', '0', '2df3d9465ty2e4hd523', '2df3d9465ty2e4hd523');
```

----------------------------------------

TITLE: Date Comparison Recommended Example
DESCRIPTION: Shows the recommended way of comparing dates without using functions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-high-performance-optimization-specification-recommendations.md#2025-04-20_snippet_5

LANGUAGE: sql
CODE:
```
where create_time >= '20190101' and create_time < '20190102'
```

----------------------------------------

TITLE: Creating New User Info Table in SQL
DESCRIPTION: Creates a new table user_info_vip with specified columns including auto-increment ID, unique user ID, and various user information fields with appropriate constraints and character encoding.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_8

LANGUAGE: SQL
CODE:
```
CREATE TABLE IF NOT EXISTS user_info_vip(
    id INT(11) PRIMARY KEY AUTO_INCREMENT COMMENT'自增ID',
    uid INT(11) UNIQUE NOT NULL COMMENT '用户ID',
    nick_name VARCHAR(64) COMMENT'昵称',
    achievement INT(11) DEFAULT 0 COMMENT '成就值',
    `level` INT(11) COMMENT '用户等级',
    job VARCHAR(32) COMMENT '职业方向',
    register_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '注册时间'
)CHARACTER SET UTF8
```

----------------------------------------

TITLE: UPDATE Records with Tag Replacement
DESCRIPTION: Shows two approaches to update tag values in the examination_info table: direct UPDATE and using REPLACE function.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_3

LANGUAGE: SQL
CODE:
```
UPDATE examination_info SET tag = 'Python' WHERE tag='PYTHON'
```

LANGUAGE: SQL
CODE:
```
UPDATE examination_info
SET tag = REPLACE(tag,'PYTHON','Python')
```

----------------------------------------

TITLE: Docker Image Management
DESCRIPTION: Commands for creating, saving and loading Docker images.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_13

LANGUAGE: shell
CODE:
```
docker commit -m "描述信息" -a "镜像作者" tomcat01 my_tomcat:1.0
docker save my_tomcat:1.0 -o my-tomcat-1.0.tar
docker load -i my-tomcat-1.0.tar
```

----------------------------------------

TITLE: Segment Class Declaration in JDK 1.7 ConcurrentHashMap
DESCRIPTION: Definition of Segment class that extends ReentrantLock to provide segment-level locking in JDK 1.7's ConcurrentHashMap implementation
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
static class Segment<K,V> extends ReentrantLock implements Serializable {
}
```

----------------------------------------

TITLE: Configuring Young Generation Memory in Java
DESCRIPTION: Sets the minimum and maximum sizes for the young generation memory using -XX:NewSize and -XX:MaxNewSize. The example sets a minimum of 256MB and maximum of 1024MB.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-parameters-intro.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
-XX:NewSize=256m
-XX:MaxNewSize=1024m
```

----------------------------------------

TITLE: Configuring Aliyun Docker mirror acceleration
DESCRIPTION: 配置阿里云Docker镜像加速器的命令，通过修改Docker的daemon配置文件并重启服务来实现加速下载镜像。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_3

LANGUAGE: shell
CODE:
```
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://679xpnpz.mirror.aliyuncs.com"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker
```

----------------------------------------

TITLE: Host Header Example in HTTP 1.1
DESCRIPTION: Demonstrates the format of an HTTP 1.1 request with Host header field, showing how the protocol handles multiple hosts on a single IP address.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/network/http1.0-vs-http1.1.md#2025-04-20_snippet_0

LANGUAGE: plain
CODE:
```
GET /home.html HTTP/1.1
Host: example1.org
```

----------------------------------------

TITLE: Using SUBSTRING_INDEX Function Examples in SQL
DESCRIPTION: Examples showing how to use SUBSTRING_INDEX function to extract parts of strings based on delimiters, with different count parameters for left and right extraction.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_8

LANGUAGE: sql
CODE:
```
SELECT SUBSTRING_INDEX('apple,banana,cherry', ',', 1);
SELECT SUBSTRING_INDEX('apple,banana,cherry', ',', -1);
SELECT SUBSTRING_INDEX('apple,banana,cherry', ',', 2);
SELECT SUBSTRING_INDEX('apple,banana,cherry', ',', -2);
```

----------------------------------------

TITLE: Method Types in Java - No Parameters No Return
DESCRIPTION: Examples of methods with no parameters and no return value, including a method with early return statement.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_12

LANGUAGE: java
CODE:
```
public void f1() {
    //......
}
// 下面这个方法也没有返回值，虽然用到了 return
public void f(int a) {
    if (...) {
        // 表示结束方法的执行,下方的输出语句不会执行
        return;
    }
    System.out.println(a);
}
```

----------------------------------------

TITLE: Getting Size of CopyOnWriteArrayList in Java
DESCRIPTION: Implementation of the size() method in CopyOnWriteArrayList, demonstrating how the list size is determined.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/copyonwritearraylist-source-code.md#2025-04-20_snippet_3

LANGUAGE: Java
CODE:
```
public int size() {
    return getArray().length;
}
```

----------------------------------------

TITLE: Arrays.copyOf() Test Example for Array Expansion in Java
DESCRIPTION: A test example showing how Arrays.copyOf() can be used to expand an array to a larger size while preserving the original elements. This is commonly used for array resizing operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_14

LANGUAGE: java
CODE:
```
public class ArrayscopyOfTest {

  public static void main(String[] args) {
    int[] a = new int[3];
    a[0] = 0;
    a[1] = 1;
    a[2] = 2;
    int[] b = Arrays.copyOf(a, 10);
    System.out.println("b.length"+b.length);
  }
}
```

----------------------------------------

TITLE: Applying Aggregate Functions with Window Functions in MySQL
DESCRIPTION: Shows how to use aggregate functions like SUM() in combination with window functions to perform calculations over a specified range of rows.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_4

LANGUAGE: sql
CODE:
```
SELECT col1, col2, SUM(col1) OVER () AS sum_col
FROM table;
```

----------------------------------------

TITLE: Bytecode for String Creation with Pre-existing Constant Pool Entry
DESCRIPTION: This bytecode shows the instruction sequence when creating a string literal followed by a new String() object with the same value. This demonstrates how the JVM reuses the constant pool entry from the first string when creating the second.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_19

LANGUAGE: java
CODE:
```
0 ldc #2 <abc>
2 astore_1
3 new #3 <java/lang/String>
6 dup
7 ldc #2 <abc>
9 invokespecial #4 <java/lang/String.<init> : (Ljava/lang/String;)V>
12 astore_2
13 return
```

----------------------------------------

TITLE: Recommended Table Insert Example
DESCRIPTION: Shows the recommended way of inserting data by explicitly specifying column names.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-high-performance-optimization-specification-recommendations.md#2025-04-20_snippet_2

LANGUAGE: sql
CODE:
```
insert into t(c1,c2,c3) values ('a','b','c');
```

----------------------------------------

TITLE: Redis List类型实现队列操作
DESCRIPTION: 展示了如何使用RPUSH和LPOP命令实现队列的入队和出队操作。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_4

LANGUAGE: bash
CODE:
```
> RPUSH myList value1
(integer) 1
> RPUSH myList value2 value3
(integer) 3
> LPOP myList
"value1"
> LRANGE myList 0 1
1) "value2"
2) "value3"
> LRANGE myList 0 -1
1) "value2"
2) "value3"
```

----------------------------------------

TITLE: Memory Allocation Testing
DESCRIPTION: Code demonstrating memory allocation behavior with byte array creation and memory statistics monitoring.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-intro.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
byte[] b = new byte[1 * 1024 * 1024];
System.out.println("分配了1M空间给数组");
System.out.println("Xmx=" + Runtime.getRuntime().maxMemory() / 1024.0 / 1024 + "M");
System.out.println("free mem=" + Runtime.getRuntime().freeMemory() / 1024.0 / 1024 + "M");
System.out.println("total mem=" + Runtime.getRuntime().totalMemory() / 1024.0 / 1024 + "M");
```

----------------------------------------

TITLE: MySQL Time Zone Management Commands
DESCRIPTION: A set of SQL commands for viewing and setting time zones in MySQL, both for the current session and globally.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/some-thoughts-on-database-storage-time.md#2025-04-20_snippet_4

LANGUAGE: SQL
CODE:
```
# View current session time zone
SELECT @@session.time_zone;
# Set current session time zone
SET time_zone = 'Europe/Helsinki';
SET time_zone = "+00:00";
# View global database time zone
SELECT @@global.time_zone;
# Set global time zone
SET GLOBAL time_zone = '+8:00';
SET GLOBAL time_zone = 'Europe/Helsinki';
```

----------------------------------------

TITLE: Method Types in Java - With Parameters No Return
DESCRIPTION: Example of a method that accepts parameters but has no return value.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_13

LANGUAGE: java
CODE:
```
public void f2(Parameter 1, ..., Parameter n) {
    //......
}
```

----------------------------------------

TITLE: Legacy HashMap put Implementation (JDK 1.7) - Java
DESCRIPTION: JDK 1.7 version of HashMap put method showing older implementation using head insertion for collision resolution and simpler structure without tree conversion.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/hashmap-source-code.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
public V put(K key, V value)
    if (table == EMPTY_TABLE) {
    inflateTable(threshold);
}
    if (key == null)
        return putForNullKey(value);
    int hash = hash(key);
    int i = indexFor(hash, table.length);
    for (Entry<K,V> e = table[i]; e != null; e = e.next) {
        Object k;
        if (e.hash == hash && ((k = e.key) == key || key.equals(k))) {
            V oldValue = e.value;
            e.value = value;
            e.recordAccess(this);
            return oldValue;
        }
    }

    modCount++;
    addEntry(hash, key, value, i);
    return null;
}
```

----------------------------------------

TITLE: Inserting Current Date and Time into MySQL Table
DESCRIPTION: SQL command to insert the current date and time into both DATETIME and TIMESTAMP columns of the 'time_zone_test' table.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/some-thoughts-on-database-storage-time.md#2025-04-20_snippet_1

LANGUAGE: SQL
CODE:
```
INSERT INTO time_zone_test(date_time,time_stamp) VALUES(NOW(),NOW());
```

----------------------------------------

TITLE: 查看ZooKeeper指定目录下的子节点
DESCRIPTION: 使用ls命令查看node1目录下的所有子节点。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_8

LANGUAGE: shell
CODE:
```
[zk: 127.0.0.1:2181(CONNECTED) 5] ls /node1
[node1.1]
```

----------------------------------------

TITLE: Merging Two Sorted Linked Lists - Recursive Solution
DESCRIPTION: Recursive implementation for merging two sorted linked lists. Provides a more concise solution using recursion to combine the lists while maintaining sorted order.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_13

LANGUAGE: java
CODE:
```
public ListNode Merge(ListNode list1,ListNode list2) {
    if(list1 == null){
        return list2;
    }
    if(list2 == null){
        return list1;
    }
    if(list1.val <= list2.val){
        list1.next = Merge(list1.next, list2);
        return list1;
    }else{
        list2.next = Merge(list1, list2.next);
        return list2;
    }
}
```

----------------------------------------

TITLE: Creating and Using a Student Object in Java Main Method
DESCRIPTION: Demonstrates how to create a Student object and call its method in the main function of a Java application.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-intro.md#2025-04-20_snippet_1

LANGUAGE: Java
CODE:
```
public class App {
    public static void main(String[] args) {
        Student student = new Student("tellUrDream");
        student.sayName();
    }
}
```

----------------------------------------

TITLE: Optimized Solution using CASE expressions
DESCRIPTION: A more concise and optimized SQL solution that uses CASE expressions to handle the conditional logic in a single query, improving readability and performance.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_4

LANGUAGE: sql
CODE:
```
SELECT
	ui.uid,
	SUM(
	IF
	( start_time IS NOT NULL AND score IS NULL, 1, 0 )) AS incomplete_cnt,#3.试卷未完成数
	ROUND( AVG( IF ( start_time IS NOT NULL AND score IS NULL, 1, 0 )), 3 ) AS incomplete_rate #4.未完成率

FROM
	user_info ui
	LEFT JOIN exam_record USING ( uid )
WHERE
CASE

		WHEN (#1.当有任意一个0级用户未完成试卷数大于2时
		SELECT
			MAX( lv0_incom_cnt )
		FROM
			(
			SELECT
				SUM(
				IF
				( score IS NULL, 1, 0 )) AS lv0_incom_cnt
			FROM
				user_info
				JOIN exam_record USING ( uid )
			WHERE
				LEVEL = 0
			GROUP BY
				uid
			) table1
			)> 2 THEN
			uid IN ( #1.1找出每个0级用户
			SELECT uid FROM user_info WHERE LEVEL = 0 ) ELSE uid IN ( #2.若不存在这样的用户，找出有作答记录的用户
			SELECT DISTINCT uid FROM exam_record )
		END
		GROUP BY
			ui.uid
	ORDER BY
	incomplete_rate #5.结果按未完成率升序排序
```

----------------------------------------

TITLE: System.arraycopy() Test Example in Java
DESCRIPTION: A simple test demonstrating how System.arraycopy() can be used to shift elements within the same array, showing its ability to handle overlapping regions correctly.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arraylist-source-code.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
public class ArraycopyTest {

  public static void main(String[] args) {
    // TODO Auto-generated method stub
    int[] a = new int[10];
    a[0] = 0;
    a[1] = 1;
    a[2] = 2;
    a[3] = 3;
    System.arraycopy(a, 2, a, 3, 3);
    a[2]=99;
    for (int i = 0; i < a.length; i++) {
      System.out.print(a[i] + " ");
    }
  }

}
```

----------------------------------------

TITLE: Analyzing Popular Exam Categories for Frequent Test-Takers in SQL
DESCRIPTION: This SQL query identifies users who complete at least 3 exams per month and then analyzes their preferred exam categories. It joins exam records with exam information and aggregates results by tag.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_9

LANGUAGE: SQL
CODE:
```
SELECT tag,
       count(start_time) AS tag_cnt
FROM exam_record record
INNER JOIN examination_info info ON record.exam_id = info.exam_id
WHERE UID IN
    (SELECT UID
     FROM exam_record record
     GROUP BY UID,
              MONTH (start_time)
     HAVING count(submit_time) >= 3)
GROUP BY tag
ORDER BY tag_cnt DESC
```

----------------------------------------

TITLE: String Templates Examples in Different Languages
DESCRIPTION: Examples showing string template syntax across different programming languages including Angular, TypeScript, Visual Basic, and Python.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java21.md#2025-04-20_snippet_0

LANGUAGE: typescript
CODE:
```
"Greetings {{ name }}!"  //Angular
`Greetings ${ name }!`;    //Typescript
$"Greetings { name }!"    //Visual basic
f"Greetings { name }!"    //Python
```

----------------------------------------

TITLE: Redis DB Structure Definition with Expiry Dictionary
DESCRIPTION: This code shows the structure of Redis database (redisDb) containing the main dictionary for data and the expires dictionary for tracking key expiration times, illustrating how Redis manages key lifetimes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_7

LANGUAGE: c
CODE:
```
typedef struct redisDb {
    ...

    dict *dict;     //数据库键空间,保存着数据库中所有键值对
    dict *expires   // 过期字典,保存着键的过期时间
    ...
} redisDb;
```

----------------------------------------

TITLE: MongoDB Covered Query Example
DESCRIPTION: Example of a covered query that can be satisfied entirely using an index without examining the actual documents.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mongodb/mongodb-questions-02.md#2025-04-20_snippet_4

LANGUAGE: SQL
CODE:
```
db.users.find({gender:"M"},{user_name:1,_id:0})
```

----------------------------------------

TITLE: MySQL Table Maintenance Operations
DESCRIPTION: Instructions for table maintenance tasks including analyzing key distribution, checking table errors and optimizing data file fragmentation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_10

LANGUAGE: sql
CODE:
```
/* 表维护 */
-- 分析和存储表的关键字分布
ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE 表名 ...
[...truncated for brevity...]
```

----------------------------------------

TITLE: Method Types in Java - With Return No Parameters
DESCRIPTION: Example of a method that returns a value but takes no parameters.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_14

LANGUAGE: java
CODE:
```
public int f3() {
    //......
    return x;
}
```

----------------------------------------

TITLE: Configuring Zone-based Load Balancing in Spring Cloud
DESCRIPTION: Example of configuring zone-based load balancing using ZonePreferenceServiceInstanceListSupplier in Spring Cloud Load Balancer.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/load-balancing.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class CustomLoadBalancerConfiguration {
    // 使用基于区域的负载平衡方法
    @Bean
    public ServiceInstanceListSupplier discoveryClientServiceInstanceListSupplier(
            ConfigurableApplicationContext context) {
        return ServiceInstanceListSupplier.builder()
                    .withDiscoveryClient()
                    .withZonePreference()
                    .withCaching()
                    .build(context);
    }
}
```

----------------------------------------

TITLE: Java数值字面量 (Java)
DESCRIPTION: 展示了Java 7引入的数值字面量语法,允许在数字间插入下划线以提高可读性。编译器会在编译阶段移除这些下划线。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
public class Test {
    public static void main(String... args) {
        int i = 10_000;
        System.out.println(i);
    }
}
```

----------------------------------------

TITLE: 获取ZooKeeper节点数据和状态
DESCRIPTION: 使用get命令获取节点node1的数据内容和状态信息，包括版本、时间等元数据。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_6

LANGUAGE: shell
CODE:
```
[zk: zookeeper(CONNECTED) 12] get -s /node1
set node1
cZxid = 0x47
ctime = Sun Jan 20 10:22:59 CST 2019
mZxid = 0x4b
mtime = Sun Jan 20 10:41:10 CST 2019
pZxid = 0x4a
cversion = 1
dataVersion = 1
aclVersion = 0
ephemeralOwner = 0x0
dataLength = 9
numChildren = 1
```

----------------------------------------

TITLE: Modifying Table Structure in SQL
DESCRIPTION: Alters user_info table by adding a new school column, renaming job column to profession, and modifying the achievement column's default value.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_9

LANGUAGE: SQL
CODE:
```
ALTER TABLE user_info
    ADD school VARCHAR(15) AFTER level,
    CHANGE job profession VARCHAR(10),
    MODIFY achievement INT(11) DEFAULT 0;
```

----------------------------------------

TITLE: Defining and Implementing a Generic Interface in Java
DESCRIPTION: This code snippet demonstrates how to define a generic interface and implement it in Java, both with and without specifying the type parameter.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-03.md#2025-04-20_snippet_7

LANGUAGE: Java
CODE:
```
public interface Generator<T> {
    public T method();
}

class GeneratorImpl<T> implements Generator<T>{
    @Override
    public T method() {
        return null;
    }
}

class GeneratorImpl implements Generator<String> {
    @Override
    public String method() {
        return "hello";
    }
}
```

----------------------------------------

TITLE: Implementing Delayed Interface for DelayQueue
DESCRIPTION: The Delayed interface requires implementing getDelay() and compareTo() methods to enable elements to be stored in DelayQueue. This interface defines the remaining delay time of elements and comparison rules between elements by extending the Comparable interface.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/delayqueue-source-code.md#2025-04-20_snippet_4

LANGUAGE: java
CODE:
```
interface Delayed extends Comparable<Delayed> {
    long getDelay(TimeUnit unit);
}
```

----------------------------------------

TITLE: Revoking MySQL Permissions Syntax
DESCRIPTION: Shows the REVOKE command syntax for removing permissions from MySQL users, including privilege types and levels.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_10

LANGUAGE: sql
CODE:
```
REVOKE   privilege_type [(column_list)]
        [, priv_type [(column_list)]]...
ON [object_type] privilege_level
FROM user [, user]...
```

----------------------------------------

TITLE: Enabling MySQL Query Cache via SQL Commands
DESCRIPTION: SQL commands to dynamically enable and configure the query cache in MySQL without restarting the server. These global settings activate the cache and allocate memory for it.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-query-cache.md#2025-04-20_snippet_3

LANGUAGE: properties
CODE:
```
set global  query_cache_type=1;
set global  query_cache_size=600000;
```

----------------------------------------

TITLE: Data Manipulation in SQL
DESCRIPTION: Covers SQL commands for data manipulation including inserting, querying, updating, and deleting data from tables.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_3

LANGUAGE: SQL
CODE:
```
/* 数据操作 */ ------------------
-- 增
    INSERT [INTO] 表名 [(字段列表)] VALUES (值列表)[, (值列表), ...]
        -- 如果要插入的值列表包含所有字段并且顺序一致，则可以省略字段列表。
        -- 可同时插入多条数据记录！
        REPLACE与INSERT类似，唯一的区别是对于匹配的行，现有行（与主键/唯一键比较）的数据会被替换，如果没有现有行，则插入新行。
    INSERT [INTO] 表名 SET 字段名=值[, 字段名=值, ...]
-- 查
    SELECT 字段列表 FROM 表名[ 其他子句]
        -- 可来自多个表的多个字段
        -- 其他子句可以不使用
        -- 字段列表可以用*代替，表示所有字段
-- 删
    DELETE FROM 表名[ 删除条件子句]
        没有条件子句，则会删除全部
-- 改
    UPDATE 表名 SET 字段名=新值[, 字段名=新值] [更新条件]
```

----------------------------------------

TITLE: Generational ZGC Configuration
DESCRIPTION: Command to enable Generational ZGC in Java 21.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java21.md#2025-04-20_snippet_5

LANGUAGE: bash
CODE:
```
// 启用分代ZGC
java -XX:+UseZGC -XX:+ZGenerational ...
```

----------------------------------------

TITLE: Demonstrating Happens-Before Relationship in Java
DESCRIPTION: This code snippet demonstrates the happens-before relationship between operations in Java. It shows that while operations 1 and 2 can be reordered, they must both happen before operation 3.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/jmm.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
int userNum = getUserNum();   // 1
int teacherNum = getTeacherNum();   // 2
int totalNum = userNum + teacherNum;  // 3
```

----------------------------------------

TITLE: Manual GC Testing
DESCRIPTION: Code demonstrating the effect of manual garbage collection on memory statistics.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-intro.md#2025-04-20_snippet_7

LANGUAGE: java
CODE:
```
System.gc();
System.out.println("Xmx=" + Runtime.getRuntime().maxMemory() / 1024.0 / 1024 + "M");
System.out.println("free mem=" + Runtime.getRuntime().freeMemory() / 1024.0 / 1024 + "M");
System.out.println("total mem=" + Runtime.getRuntime().totalMemory() / 1024.0 / 1024 + "M");
```

----------------------------------------

TITLE: Internal Lock Implementation in Curator
DESCRIPTION: Implementation of the internal locking mechanism that handles lock reentrance by tracking thread-specific lock data and incrementing lock count for reentrant acquisitions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
private boolean internalLock(long time, TimeUnit unit) throws Exception {
  Thread currentThread = Thread.currentThread();
  LockData lockData = threadData.get(currentThread);
  if (lockData != null) {
    lockData.lockCount.incrementAndGet();
    return true;
  }
  String lockPath = internals.attemptLock(time, unit, getLockNodeBytes());
  if (lockPath != null) {
    LockData newLockData = new LockData(currentThread, lockPath);
    threadData.put(currentThread, newLockData);
    return true;
  }

  return false;
}
```

----------------------------------------

TITLE: String Object Creation with Pre-existing Constant Pool Entry
DESCRIPTION: This code demonstrates string object creation when the string literal already exists in the constant pool. The first line places "abc" in the constant pool, and the second creates a new string object in the heap but reuses the constant pool entry.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_18

LANGUAGE: java
CODE:
```
// 字符串常量池中已存在字符串对象"abc"
String s1 = "abc";
// 下面这段代码只会在堆中创建 1 个字符串对象"abc"
String s2 = new String("abc");
```

----------------------------------------

TITLE: Demonstrating ConcurrentModificationException in Enhanced For Loop in Java
DESCRIPTION: Shows how modifying a collection while iterating over it using an enhanced for loop can lead to a ConcurrentModificationException. This is due to the underlying use of an Iterator that maintains its own view of the collection.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/syntactic-sugar.md#2025-04-20_snippet_12

LANGUAGE: java
CODE:
```
for (Student stu : students) {
    if (stu.getId() == 2)
        students.remove(stu);
}
```

----------------------------------------

TITLE: Database Operations in SQL
DESCRIPTION: Covers SQL commands for database operations including creating, viewing, modifying, and deleting databases.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/a-thousand-lines-of-mysql-study-notes.md#2025-04-20_snippet_1

LANGUAGE: SQL
CODE:
```
/* 数据库操作 */
-- 查看当前数据库
    SELECT DATABASE();
-- 显示当前时间、用户名、数据库版本
    SELECT now(), user(), version();
-- 创建库
    CREATE DATABASE[ IF NOT EXISTS] 数据库名 数据库选项
    数据库选项：
        CHARACTER SET charset_name
        COLLATE collation_name
-- 查看已有库
    SHOW DATABASES[ LIKE 'PATTERN']
-- 查看当前库信息
    SHOW CREATE DATABASE 数据库名
-- 修改库的选项信息
    ALTER DATABASE 库名 选项信息
-- 删除库
    DROP DATABASE[ IF EXISTS] 数据库名
        同时删除该数据库相关的目录及其目录内容
```

----------------------------------------

TITLE: Dropping Multiple Tables in SQL
DESCRIPTION: Demonstrates how to drop multiple exam record backup tables from years 2011-2014 if they exist.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_10

LANGUAGE: SQL
CODE:
```
DROP TABLE IF EXISTS exam_record_2011;
DROP TABLE IF EXISTS exam_record_2012;
DROP TABLE IF EXISTS exam_record_2013;
DROP TABLE IF EXISTS exam_record_2014;
```

----------------------------------------

TITLE: Java 9 Module System Example
DESCRIPTION: Demonstrates how to use exports keyword in module-info.java to control package access.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java9.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
module my.module {
    //exports 公开指定包的所有公共成员
    exports com.my.package.name;
}

module my.module {
     //exports…to 限制访问的成员范围
    export com.my.package.name to com.specific.package;
}
```

----------------------------------------

TITLE: Using ROW_NUMBER() Window Function in MySQL
DESCRIPTION: Demonstrates how to use the ROW_NUMBER() function to assign unique integer values to each row in a result set, ordered by a specified column.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_0

LANGUAGE: sql
CODE:
```
SELECT col1, col2, ROW_NUMBER() OVER (ORDER BY col1) AS row_num
FROM table;
```

----------------------------------------

TITLE: Configuring RDB Persistence Settings in Redis
DESCRIPTION: Default RDB persistence configuration in redis.conf showing automatic snapshot trigger conditions based on number of key changes and time intervals.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-persistence.md#2025-04-20_snippet_0

LANGUAGE: clojure
CODE:
```
save 900 1           #在900秒(15分钟)之后，如果至少有1个key发生变化，Redis就会自动触发bgsave命令创建快照。

save 300 10          #在300秒(5分钟)之后，如果至少有10个key发生变化，Redis就会自动触发bgsave命令创建快照。

save 60 10000        #在60秒(1分钟)之后，如果至少有10000个key发生变化，Redis就会自动触发bgsave命令创建快照。
```

----------------------------------------

TITLE: Creating Customer Order Table with Basic Indexes
DESCRIPTION: Creates a table named cus_order with id, score and name fields, using InnoDB engine and utf8mb4 charset.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-index.md#2025-04-20_snippet_4

LANGUAGE: sql
CODE:
```
CREATE TABLE `cus_order` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `score` int(11) NOT NULL,
  `name` varchar(11) NOT NULL DEFAULT '',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=100000 DEFAULT CHARSET=utf8mb4;
```

----------------------------------------

TITLE: Using MySQL Stored Procedure
DESCRIPTION: Demonstrates how to call a stored procedure and retrieve its output.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_20

LANGUAGE: sql
CODE:
```
set @b=5;
call proc_adder(2,@b,@s);
select @s as sum;
```

----------------------------------------

TITLE: BlockingQueue Interface Definition in Java
DESCRIPTION: Defines the methods of the BlockingQueue interface, including blocking and non-blocking operations for adding and removing elements.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
public interface BlockingQueue<E> extends Queue<E> {

     //元素入队成功返回true，反之则会抛出异常IllegalStateException
    boolean add(E e);

     //元素入队成功返回true，反之返回false
    boolean offer(E e);

     //元素入队成功则直接返回，如果队列已满元素不可入队则将线程阻塞，因为阻塞期间可能会被打断，所以这里方法签名抛出了InterruptedException
    void put(E e) throws InterruptedException;

   //和上一个方法一样,只不过队列满时只会阻塞单位为unit，时间为timeout的时长，如果在等待时长内没有入队成功则直接返回false。
    boolean offer(E e, long timeout, TimeUnit unit)
        throws InterruptedException;

    //从队头取出一个元素，如果队列为空则阻塞等待，因为会阻塞线程的缘故，所以该方法可能会被打断，所以签名定义了InterruptedException
    E take() throws InterruptedException;

      //取出队头的元素并返回，如果当前队列为空则阻塞等待timeout且单位为unit的时长，如果这个时间段没有元素则直接返回null。
    E poll(long timeout, TimeUnit unit)
        throws InterruptedException;

      //获取队列剩余元素个数
    int remainingCapacity();

     //删除我们指定的对象，如果成功返回true，反之返回false。
    boolean remove(Object o);

    //判断队列中是否包含指定元素
    public boolean contains(Object o);

     //将队列中的元素全部存到指定的集合中
    int drainTo(Collection<? super E> c);

    //转移maxElements个元素到集合中
    int drainTo(Collection<? super E> c, int maxElements);
}
```

----------------------------------------

TITLE: Implicit Type Conversion Example
DESCRIPTION: Example showing how implicit type conversion can cause index invalidation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-high-performance-optimization-specification-recommendations.md#2025-04-20_snippet_3

LANGUAGE: sql
CODE:
```
select name,phone from customer where id = '111';
```

----------------------------------------

TITLE: Redis Memory Policy Enum Definition
DESCRIPTION: C code defining the enumeration of available memory eviction policies in Redis's config.c file. Shows all supported eviction strategies including LRU, LFU, random, and TTL-based policies.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_12

LANGUAGE: c
CODE:
```
configEnum maxmemory_policy_enum[] = {
    {"volatile-lru", MAXMEMORY_VOLATILE_LRU},
    {"volatile-lfu", MAXMEMORY_VOLATILE_LFU},
    {"volatile-random",MAXMEMORY_VOLATILE_RANDOM},
    {"volatile-ttl",MAXMEMORY_VOLATILE_TTL},
    {"allkeys-lru",MAXMEMORY_ALLKEYS_LRU},
    {"allkeys-lfu",MAXMEMORY_ALLKEYS_LFU},
    {"allkeys-random",MAXMEMORY_ALLKEYS_RANDOM},
    {"noeviction",MAXMEMORY_NO_EVICTION},
    {NULL, 0}
};
```

----------------------------------------

TITLE: Redis Bio Thread Operation Definitions
DESCRIPTION: This code from Redis's bio.h header file defines background thread operations in Redis, including file closing, AOF fsync, and lazy freeing operations, showing Redis's internal background job handling mechanism.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
#ifndef __BIO_H
#define __BIO_H

/* Exported API */
void bioInit(void);
void bioCreateBackgroundJob(int type, void *arg1, void *arg2, void *arg3);
unsigned long long bioPendingJobsOfType(int type);
unsigned long long bioWaitStepOfType(int type);
time_t bioOlderJobOfType(int type);
void bioKillThreads(void);

/* Background job opcodes */
#define BIO_CLOSE_FILE    0 /* Deferred close(2) syscall. */
#define BIO_AOF_FSYNC     1 /* Deferred AOF fsync. */
#define BIO_LAZY_FREE     2 /* Deferred objects freeing. */
#define BIO_NUM_OPS       3

#endif
```

----------------------------------------

TITLE: Creating Student Table with Composite Index
DESCRIPTION: Creates a table named student with composite index on name and class fields.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-index.md#2025-04-20_snippet_6

LANGUAGE: sql
CODE:
```
CREATE TABLE `student` (
  `id` int NOT NULL,
  `name` varchar(100) DEFAULT NULL,
  `class` varchar(100) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `name_class_idx` (`name`,`class`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

----------------------------------------

TITLE: Changing MySQL User Password
DESCRIPTION: Shows how to set a new password for a MySQL user.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_18

LANGUAGE: sql
CODE:
```
SET PASSWORD FOR myuser = 'mypass';
```

----------------------------------------

TITLE: Container Lifecycle Management
DESCRIPTION: Commands for starting, stopping, restarting and removing Docker containers.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_9

LANGUAGE: shell
CODE:
```
docker start c2f5d78c5d1a
docker restart c2f5d78c5d1a
docker stop c2f5d78c5d1a
docker kill c2f5d78c5d1a
docker rm d5b6c177c151
docker rm -f d5b6c177c151
docker rm -f $(docker ps -qa)
```

----------------------------------------

TITLE: Creating Multiple Indexes in SQL
DESCRIPTION: Creates multiple types of indexes on examination_info table including regular, unique, and fulltext indexes.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_11

LANGUAGE: SQL
CODE:
```
ALTER TABLE examination_info
    ADD INDEX idx_duration(duration),
    ADD UNIQUE INDEX uniq_idx_exam_id(exam_id),
    ADD FULLTEXT INDEX full_idx_tag(tag);
```

----------------------------------------

TITLE: LockData Class Definition in Curator
DESCRIPTION: Static inner class that stores lock metadata including owning thread, lock path and lock count for implementing reentrant locks.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-lock-implementations.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
private final ConcurrentMap<Thread, LockData> threadData = Maps.newConcurrentMap();

private static class LockData
{
    final Thread owningThread;
    final String lockPath;
    final AtomicInteger lockCount = new AtomicInteger(1);

    private LockData(Thread owningThread, String lockPath)
    {
      this.owningThread = owningThread;
      this.lockPath = lockPath;
    }
}
```

----------------------------------------

TITLE: Inefficient Long Sum Calculation Using Wrapper Class
DESCRIPTION: This code demonstrates an inefficient way to calculate a sum using Long wrapper class, which should be avoided due to unnecessary boxing and unboxing operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
private static long sum() {
    // 应该使用 long 而不是 Long
    Long sum = 0L;
    for (long i = 0; i <= Integer.MAX_VALUE; i++)
        sum += i;
    return sum;
}
```

----------------------------------------

TITLE: Batch Data Insertion Stored Procedure
DESCRIPTION: Defines a stored procedure to insert test data into cus_order table with randomized scores and sequential names.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-index.md#2025-04-20_snippet_5

LANGUAGE: sql
CODE:
```
DELIMITER ;;
CREATE DEFINER=`root`@`%` PROCEDURE `BatchinsertDataToCusOder`(IN start_num INT,IN max_num INT)
BEGIN
      DECLARE i INT default start_num;
      WHILE i < max_num DO
          insert into `cus_order`(`id`, `score`, `name`)
          values (i,RAND() * 1000000,CONCAT('user', i));
          SET i = i + 1;
      END WHILE;
  END;;
DELIMITER ;
```

----------------------------------------

TITLE: Inserting a Single Row After Batch Insert in MySQL
DESCRIPTION: Inserting a single row to show how the auto-increment value has been affected by the previous batch insert operation.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-auto-increment-primary-key-continuous.md#2025-04-20_snippet_6

LANGUAGE: sql
CODE:
```
insert into test_pk2 values(null,6,6)
```

----------------------------------------

TITLE: Deleting MySQL User Account
DESCRIPTION: Demonstrates how to remove a MySQL user account.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_14

LANGUAGE: sql
CODE:
```
DROP USER myuser;
```

----------------------------------------

TITLE: Filtering Level 0 Users with Incomplete Exams - Initial Query
DESCRIPTION: SQL query to identify level 0 users who have more than 2 incomplete exams. This is the first step in determining which condition applies for the final solution.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_0

LANGUAGE: sql
CODE:
```
SELECT ui.uid UID
FROM user_info ui
LEFT JOIN exam_record er ON ui.uid = er.uid
WHERE ui.uid IN
    (SELECT ui.uid
     FROM user_info ui
     LEFT JOIN exam_record er ON ui.uid = er.uid
     WHERE er.submit_time IS NULL
       AND ui.LEVEL = 0 )
GROUP BY ui.uid
HAVING sum(IF(er.submit_time IS NULL, 1, 0)) > 2
```

----------------------------------------

TITLE: Demonstrating Transaction Rollback with Auto-Increment Values in MySQL
DESCRIPTION: SQL transaction example showing how auto-increment values are not rolled back even when the transaction is aborted.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-auto-increment-primary-key-continuous.md#2025-04-20_snippet_3

LANGUAGE: sql
CODE:
```
begin;
insert into test_pk values(null, 3, 3);
rollback;
```

----------------------------------------

TITLE: Redis Configuration for HZ and Dynamic HZ Settings
DESCRIPTION: This code shows the Redis configuration properties for hz (frequency of background tasks) and dynamic-hz (allows Redis to adjust hz value automatically), which control how often Redis performs background tasks like expiring keys.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_10

LANGUAGE: properties
CODE:
```
# 默认为 10
hz 10
# 默认开启
dynamic-hz yes
```

----------------------------------------

TITLE: Counting Total Online Users Using Redis Bitmap OR Operation
DESCRIPTION: This code demonstrates using BITOP with OR operation to combine user activity data from multiple days, and then using BITCOUNT to get the total count of unique active users during that period.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_2

LANGUAGE: bash
CODE:
```
> BITOP or desk2 20210308 20210309
(integer) 1
> BITCOUNT desk2
(integer) 2
```

----------------------------------------

TITLE: Pulling Docker Images
DESCRIPTION: Commands to search for and pull Docker images from Docker Hub, using MySQL as an example.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
docker search mysql # 查看mysql相关镜像
docker pull mysql:5.7 # 拉取mysql镜像
docker image ls # 查看所有已下载镜像
```

----------------------------------------

TITLE: 使用AtomicMarkableReference进行带标记的引用类型原子操作
DESCRIPTION: 展示了如何使用AtomicMarkableReference类对带有布尔标记的引用类型进行原子操作。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/atomic-classes.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
AtomicMarkableReference<String> amr = new AtomicMarkableReference<>("SnailClimb", false);

boolean[] initialMark = new boolean[1];
String initialRef = amr.get(initialMark);
System.out.println("Initial Reference: " + initialRef + ", Initial Mark: " + initialMark[0]);

String oldRef = initialRef;
String newRef = "Daisy";
boolean oldMark = initialMark[0];
boolean newMark = true;

boolean isUpdated = amr.compareAndSet(oldRef, newRef, oldMark, newMark);
System.out.println("Update Success: " + isUpdated);

boolean[] updatedMark = new boolean[1];
String updatedRef = amr.get(updatedMark);
System.out.println("Updated Reference: " + updatedRef + ", Updated Mark: " + updatedMark[0]);

boolean isUpdatedWithWrongMark = amr.compareAndSet(newRef, "John", oldMark, !newMark);
System.out.println("Update with Wrong Mark Success: " + isUpdatedWithWrongMark);

boolean[] finalMark = new boolean[1];
String finalRef = amr.get(finalMark);
System.out.println("Final Reference: " + finalRef + ", Final Mark: " + finalMark[0]);
```

----------------------------------------

TITLE: Docker image listing commands
DESCRIPTION: 用于列出Docker中当前所有镜像的命令，可以查看镜像的详细信息，包括名称、标签、ID、创建时间和大小。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_4

LANGUAGE: shell
CODE:
```
docker images
```

LANGUAGE: shell
CODE:
```
docker image MySQL
```

LANGUAGE: shell
CODE:
```
docker images -q
```

----------------------------------------

TITLE: Creating BCrypt Password Encoder Bean in Spring Security
DESCRIPTION: Implementation of a Bean that returns a BCryptPasswordEncoder for Spring Security. BCrypt is a password hashing function recommended for password storage due to its adaptive nature and built-in salt mechanism.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/security/encryption-algorithms.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
@Bean
public PasswordEncoder passwordEncoder(){
    return new BCryptPasswordEncoder();
}
```

----------------------------------------

TITLE: Implementing ReentrantLock Class Definition
DESCRIPTION: Basic class definition showing ReentrantLock implementing Lock interface
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_12

LANGUAGE: java
CODE:
```
public class ReentrantLock implements Lock, java.io.Serializable {}
```

----------------------------------------

TITLE: Case-Sensitive Tag Filtering and Counting
DESCRIPTION: Complex SQL query using CTE to filter and count examination tags while handling case sensitivity, joining the same table to compare uppercase conversions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_11

LANGUAGE: sql
CODE:
```
WITH a AS
  (SELECT tag,
          COUNT(start_time) AS answer_cnt
   FROM exam_record er
   JOIN examination_info ei ON er.exam_id = ei.exam_id
   GROUP BY tag)
SELECT a.tag,
       b.answer_cnt
FROM a
INNER JOIN a AS b ON UPPER(a.tag)= b.tag
AND a.tag != b.tag
WHERE a.answer_cnt < 3;
```

----------------------------------------

TITLE: Building Docker Images
DESCRIPTION: Command to build a Docker image from a Dockerfile with a specified name and version tag.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_2

LANGUAGE: bash
CODE:
```
#
# imageName 是镜像名称，1.0.0 是镜像的版本号或标签
docker build -t imageName:1.0.0 .
```

----------------------------------------

TITLE: Non-Index Compatible MongoDB Sort Operations
DESCRIPTION: Examples of MongoDB sort operations that cannot use a compound index because they don't match the index's sort direction or field order.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mongodb/mongodb-questions-02.md#2025-04-20_snippet_1

LANGUAGE: SQL
CODE:
```
db.s2.find().sort({"userid": 1, "score": 1})
db.s2.find().sort({"userid": -1, "score": -1})
db.s2.find().sort({"score": 1, "userid": -1})
db.s2.find().sort({"score": 1, "userid": 1})
db.s2.find().sort({"score": -1, "userid": -1})
db.s2.find().sort({"score": -1, "userid": 1})
```

----------------------------------------

TITLE: Querying MySQL User Information
DESCRIPTION: Shows how to view MySQL user accounts stored in the mysql database.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_11

LANGUAGE: sql
CODE:
```
USE mysql;
SELECT user FROM user;
```

----------------------------------------

TITLE: Lambda Local Variable Syntax in Java 11
DESCRIPTION: Shows how to use the var keyword in Lambda expression parameters, which was added as an enhancement to type inference capabilities.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java11.md#2025-04-20_snippet_3

LANGUAGE: java
CODE:
```
// 下面两者是等价的
Consumer<String> consumer = (var i) -> System.out.println(i);
Consumer<String> consumer = (String i) -> System.out.println(i);
```

----------------------------------------

TITLE: Granting MySQL Permissions Syntax
DESCRIPTION: Demonstrates the GRANT command syntax for assigning permissions to MySQL users. Includes options for privilege levels, SSL requirements, and resource limitations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_9

LANGUAGE: sql
CODE:
```
GRANT privilege,[privilege],.. ON privilege_level
TO user [IDENTIFIED BY password]
[REQUIRE tsl_option]
[WITH [GRANT_OPTION | resource_option]];
```

----------------------------------------

TITLE: 使用DISCARD取消Redis事务
DESCRIPTION: 演示了如何使用DISCARD命令取消一个已经开始的事务，清空事务队列中的所有命令。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-02.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
> MULTI
OK
> SET PROJECT "JavaGuide"
QUEUED
> GET PROJECT
QUEUED
> DISCARD
OK
```

----------------------------------------

TITLE: Collections Utility Class Search Operations
DESCRIPTION: Search and replace operations provided by the Collections utility class
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_13

LANGUAGE: java
CODE:
```
int binarySearch(List list, Object key)//对List进行二分查找，返回索引，注意List必须是有序的
int max(Collection coll)//根据元素的自然顺序，返回最大的元素。 类比int min(Collection coll)
int max(Collection coll, Comparator c)//根据定制排序，返回最大元素，排序规则由Comparatator类控制。类比int min(Collection coll, Comparator c)
void fill(List list, Object obj)//用指定的元素代替指定list中的所有元素
int frequency(Collection c, Object o)//统计元素出现次数
int indexOfSubList(List list, List target)//统计target在list中第一次出现的索引，找不到则返回-1，类比int lastIndexOfSubList(List source, list target)
boolean replaceAll(List list, Object oldVal, Object newVal)//用新元素替换旧元素
```

----------------------------------------

TITLE: 使用Curator自动创建所需的父节点
DESCRIPTION: 使用creatingParentsIfNeeded()方法在创建节点时自动创建所需的父节点，更加简便。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_16

LANGUAGE: java
CODE:
```
zkClient.create().creatingParentsIfNeeded().withMode(CreateMode.PERSISTENT).forPath("/node1/00001");
```

----------------------------------------

TITLE: Removing Docker Images
DESCRIPTION: Process for removing Docker images, including checking for container references, stopping containers, and then removing the image.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_3

LANGUAGE: bash
CODE:
```
➜  ~ docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES
c4cd691d9f80        mysql:5.7           "docker-entrypoint.s…"   7 weeks ago         Up 12 days          0.0.0.0:3306->3306/tcp, 33060/tcp   mysql
```

LANGUAGE: bash
CODE:
```
➜  ~ docker images
REPOSITORY              TAG                 IMAGE ID            CREATED             SIZE
mysql                   5.7                 f6509bac4980        3 months ago        373MB
```

LANGUAGE: bash
CODE:
```
docker rmi f6509bac4980 #  或者 docker rmi mysql
```

----------------------------------------

TITLE: Viewing MySQL Triggers
DESCRIPTION: SQL command to display all triggers in the current database.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_24

LANGUAGE: sql
CODE:
```
SHOW TRIGGERS;
```

----------------------------------------

TITLE: Get Operation in Java 8 ConcurrentHashMap
DESCRIPTION: This method retrieves a value from the Java 8 ConcurrentHashMap based on the provided key. It handles different node types including regular nodes, trees, and forwarding nodes during table expansion.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/concurrent-hash-map-source-code.md#2025-04-20_snippet_8

LANGUAGE: java
CODE:
```
public V get(Object key) {
    Node<K,V>[] tab; Node<K,V> e, p; int n, eh; K ek;
    int h = spread(key.hashCode());
    if ((tab = table) != null && (n = tab.length) > 0 &&
        (e = tabAt(tab, (n - 1) & h)) != null) {
        if ((eh = e.hash) == h) {
            if ((ek = e.key) == key || (ek != null && key.equals(ek)))
                return e.val;
        }
        else if (eh < 0)
            return (p = e.find(h, key)) != null ? p.val : null;
        while ((e = e.next) != null) {
            if (e.hash == h &&
                ((ek = e.key) == key || (ek != null && key.equals(ek))))
                return e.val;
        }
    }
    return null;
}
```

----------------------------------------

TITLE: Static Variable Declaration in Java
DESCRIPTION: This code snippet shows how to declare a static variable in Java, which is shared among all instances of a class.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_9

LANGUAGE: Java
CODE:
```
public class StaticVariableExample {
    // 静态变量
    public static int staticVar = 0;
}
```

----------------------------------------

TITLE: SQL Query for Exam Activity Data Extraction
DESCRIPTION: A SQL query that extracts and formats exam activity data, creating date-based fields for month and day analysis, and adding a 'exam' tag to identify the activity type.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_12

LANGUAGE: SQL
CODE:
```
SELECT
		uid,
		exam_id AS ans_id,
		start_time AS act_time,
		date_format( start_time, '%Y%m' ) AS act_month,
		date_format( start_time, '%Y%m%d' ) AS act_day,
		'exam' AS tag
	FROM
		exam_record
```

----------------------------------------

TITLE: Creating MySQL Trigger Syntax
DESCRIPTION: Basic syntax for creating a trigger in MySQL. Shows the structure including trigger name, timing, event, target table and trigger statements.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_22

LANGUAGE: sql
CODE:
```
CREATE TRIGGER trigger_name
trigger_time
trigger_event
ON table_name
FOR EACH ROW
BEGIN
  trigger_statements
END;
```

----------------------------------------

TITLE: SQL INSERT语句示例
DESCRIPTION: 展示了插入完整行和部分列数据的不同写法
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_2

LANGUAGE: sql
CODE:
```
# 插入一行
INSERT INTO user
VALUES (10, 'root', 'root', 'xxxx@163.com');
# 插入多行
INSERT INTO user
VALUES (10, 'root', 'root', 'xxxx@163.com'), (12, 'user1', 'user1', 'xxxx@163.com'), (18, 'user2', 'user2', 'xxxx@163.com');

INSERT INTO user(username, password, email)
VALUES ('admin', 'admin', 'xxxx@163.com');
```

----------------------------------------

TITLE: Collectors toUnmodifiable Methods in Java 10
DESCRIPTION: Demonstrates the usage of new Collectors methods for creating unmodifiable collections from streams.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java10.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
var list = new ArrayList<>();
list.stream().collect(Collectors.toUnmodifiableList());
list.stream().collect(Collectors.toUnmodifiableSet());
```

----------------------------------------

TITLE: String Object Creation and Constant Pool in Java
DESCRIPTION: This example demonstrates how string literals are stored in the string constant pool. Two variables referencing the same string literal point to the same object in memory.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_15

LANGUAGE: java
CODE:
```
// 在字符串常量池中创建字符串对象 "ab"
// 将字符串对象 "ab" 的引用赋值给 aa
String aa = "ab";
// 直接返回字符串常量池中字符串对象 "ab"，赋值给引用 bb
String bb = "ab";
System.out.println(aa==bb); // true
```

----------------------------------------

TITLE: SQL JOIN连接查询
DESCRIPTION: 展示了基本的表连接查询语法
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_8

LANGUAGE: sql
CODE:
```
select c.cust_name, o.order_num
from Customers c
inner join Orders o
on c.cust_id = o.cust_id
order by c.cust_name;
```

----------------------------------------

TITLE: Java Employee Class Example
DESCRIPTION: Simple example of a Java class definition used to demonstrate class file analysis.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/class-file-structure.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
package top.snailclimb.bean;
public class Employee {
   ...
}
```

----------------------------------------

TITLE: Creating User Table with Index Condition Pushdown Example
DESCRIPTION: Creates a user table to demonstrate index condition pushdown functionality with composite index on zipcode and birthdate.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-index.md#2025-04-20_snippet_7

LANGUAGE: sql
CODE:
```
CREATE TABLE `user` (
  `id` int NOT NULL AUTO_INCREMENT,
  `username` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `zipcode` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci NOT NULL,
  `birthdate` date NOT NULL,
  PRIMARY KEY (`id`),
  KEY `idx_username_birthdate` (`zipcode`,`birthdate`) ) ENGINE=InnoDB AUTO_INCREMENT=1001 DEFAULT CHARSET=utf8mb4;
```

----------------------------------------

TITLE: Maven Lifecycle Command Example
DESCRIPTION: Command format for executing Maven lifecycle phases.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/maven/maven-core-concepts.md#2025-04-20_snippet_3

LANGUAGE: bash
CODE:
```
mvn 阶段 [阶段2] ...[阶段n]
```

----------------------------------------

TITLE: Complete NIO Selector Server Implementation
DESCRIPTION: A complete example showing how to implement a server using NIO Selector to handle multiple client connections, including connection acceptance, reading, and writing operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/nio-basis.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
import java.io.IOException;
import java.net.InetSocketAddress;
import java.nio.ByteBuffer;
import java.nio.channels.SelectionKey;
import java.nio.channels.Selector;
import java.nio.channels.ServerSocketChannel;
import java.nio.channels.SocketChannel;
import java.util.Iterator;
import java.util.Set;

public class NioSelectorExample {

  public static void main(String[] args) {
    try {
      ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();
      serverSocketChannel.configureBlocking(false);
      serverSocketChannel.socket().bind(new InetSocketAddress(8080));

      Selector selector = Selector.open();
      // 将 ServerSocketChannel 注册到 Selector 并监听 OP_ACCEPT 事件
      serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);

      while (true) {
        int readyChannels = selector.select();

        if (readyChannels == 0) {
          continue;
        }

        Set<SelectionKey> selectedKeys = selector.selectedKeys();
        Iterator<SelectionKey> keyIterator = selectedKeys.iterator();

        while (keyIterator.hasNext()) {
          SelectionKey key = keyIterator.next();

          if (key.isAcceptable()) {
            // 处理连接事件
            ServerSocketChannel server = (ServerSocketChannel) key.channel();
            SocketChannel client = server.accept();
            client.configureBlocking(false);

            // 将客户端通道注册到 Selector 并监听 OP_READ 事件
            client.register(selector, SelectionKey.OP_READ);
          } else if (key.isReadable()) {
            // 处理读事件
            SocketChannel client = (SocketChannel) key.channel();
            ByteBuffer buffer = ByteBuffer.allocate(1024);
            int bytesRead = client.read(buffer);

            if (bytesRead > 0) {
              buffer.flip();
              System.out.println("收到数据：" +new String(buffer.array(), 0, bytesRead));
              // 将客户端通道注册到 Selector 并监听 OP_WRITE 事件
              client.register(selector, SelectionKey.OP_WRITE);
            } else if (bytesRead < 0) {
              // 客户端断开连接
              client.close();
            }
          } else if (key.isWritable()) {
            // 处理写事件
            SocketChannel client = (SocketChannel) key.channel();
            ByteBuffer buffer = ByteBuffer.wrap("Hello, Client!".getBytes());
            client.write(buffer);

            // 将客户端通道注册到 Selector 并监听 OP_READ 事件
            client.register(selector, SelectionKey.OP_READ);
          }

          keyIterator.remove();
        }
      }
    } catch (IOException e) {
      e.printStackTrace();
    }
  }
}
```

----------------------------------------

TITLE: Dropping MySQL Trigger
DESCRIPTION: SQL command to safely remove a trigger if it exists.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_25

LANGUAGE: sql
CODE:
```
DROP TRIGGER IF EXISTS trigger_insert_user;
```

----------------------------------------

TITLE: 操作Redis String类型的基本命令
DESCRIPTION: 展示了Redis String类型的基本操作命令,包括SET、GET、EXISTS、STRLEN、DEL等。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
> SET key value
OK
> GET key
"value"
> EXISTS key
(integer) 1
> STRLEN key
(integer) 5
> DEL key
(integer) 1
> GET key
(nil)
```

----------------------------------------

TITLE: 使用Curator创建持久化节点
DESCRIPTION: 展示了使用Curator创建持久化节点的几种方式，包括创建单个节点和自动创建父节点的方法。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_14

LANGUAGE: java
CODE:
```
//注意:下面的代码会报错，下文说了具体原因
zkClient.create().forPath("/node1/00001");
zkClient.create().withMode(CreateMode.PERSISTENT).forPath("/node1/00002");
```

----------------------------------------

TITLE: SQL 注释语法
DESCRIPTION: 展示了SQL支持的三种注释方式
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_1

LANGUAGE: sql
CODE:
```
## 注释1
-- 注释2
/* 注释3 */
```

----------------------------------------

TITLE: TCP sniffing with Scapy
DESCRIPTION: Code snippet showing the core part of a Python script that uses Scapy to sniff TCP packets on the localhost interface, focusing specifically on the TCP connection between local endpoints on port 8000.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/network/network-attack-means.md#2025-04-20_snippet_2

LANGUAGE: python
CODE:
```
# This is a partial code snippet showing the key part of the TCP sniffing functionality
```

----------------------------------------

TITLE: Demonstrating Long Integer Overflow in Java
DESCRIPTION: This code shows how long integers can overflow when they exceed their maximum value, resulting in unexpected behavior.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-01.md#2025-04-20_snippet_7

LANGUAGE: Java
CODE:
```
long l = Long.MAX_VALUE;
System.out.println(l + 1); // -9223372036854775808
System.out.println(l + 1 == Long.MIN_VALUE); // true
```

----------------------------------------

TITLE: Comparing String Objects in Java
DESCRIPTION: This code snippet demonstrates the comparison of String objects using == and equals() methods, showing the difference between reference comparison and value comparison.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-basic-questions-02.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
String a = new String("ab"); // a 为一个引用
String b = new String("ab"); // b为另一个引用,对象的内容一样
String aa = "ab"; // 放在常量池中
String bb = "ab"; // 从常量池中查找
System.out.println(aa == bb);// true
System.out.println(a == b);// false
System.out.println(a.equals(b));// true
System.out.println(42 == 42.0);// true
```

----------------------------------------

TITLE: Modifying MySQL Username
DESCRIPTION: Shows how to change an existing MySQL username and refresh privileges.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_13

LANGUAGE: sql
CODE:
```
UPDATE user SET user='newuser' WHERE user='myuser';
FLUSH PRIVILEGES;
```

----------------------------------------

TITLE: Docker image download command
DESCRIPTION: 从Docker Hub下载指定镜像的命令，可以指定具体的版本标签。如果不指定版本，默认会下载最新版本的镜像。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_5

LANGUAGE: shell
CODE:
```
docker pull MySQL:5.7
```

----------------------------------------

TITLE: Configuring Load Balancing in Spring Cloud Gateway
DESCRIPTION: This YAML snippet demonstrates how to configure load balancing in Spring Cloud Gateway using the 'lb' keyword in the URI. It also includes predicates and filters for the route.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/spring-cloud-gateway-questions.md#2025-04-20_snippet_2

LANGUAGE: yaml
CODE:
```
spring:
  cloud:
    gateway:
      routes:
        - id: route_member # 第三方微服务路由规则
          uri: lb://passjava-member # 负载均衡，将请求转发到注册中心注册的 passjava-member 服务
          predicates: # 断言
            - Path=/api/member/** # 如果前端请求路径包含 api/member，则应用这条路由规则
          filters: #过滤器
            - RewritePath=/api/(?<segment>.*),/$\{segment} # 将跳转路径中包含的api替换成空
```

----------------------------------------

TITLE: Dropping Multiple Indexes in SQL
DESCRIPTION: Removes unique and fulltext indexes from the examination_info table.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_12

LANGUAGE: SQL
CODE:
```
DROP INDEX uniq_idx_exam_id ON examination_info;
DROP INDEX full_idx_tag ON examination_info;
```

----------------------------------------

TITLE: Creating User Insert History Trigger Example
DESCRIPTION: Example of creating an AFTER INSERT trigger that logs user additions to a history table. Uses DELIMITER to handle multiple statements.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_23

LANGUAGE: sql
CODE:
```
DELIMITER $
CREATE TRIGGER `trigger_insert_user`
AFTER INSERT ON `user`
FOR EACH ROW
BEGIN
    INSERT INTO `user_history`(user_id, operate_type, operate_time)
    VALUES (NEW.id, 'add a user',  now());
END $
DELIMITER ;
```

----------------------------------------

TITLE: Installing Docker on Mac using Homebrew
DESCRIPTION: 简单的Homebrew命令用于在Mac系统上安装Docker。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_0

LANGUAGE: shell
CODE:
```
brew install --cask docker
```

----------------------------------------

TITLE: 使用Curator创建节点并指定数据内容
DESCRIPTION: 创建节点时同时设置节点的数据内容，并展示如何获取节点内容。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_18

LANGUAGE: java
CODE:
```
zkClient.create().creatingParentsIfNeeded().withMode(CreateMode.EPHEMERAL).forPath("/node1/00001","java".getBytes());
zkClient.getData().forPath("/node1/00001");//获取节点的数据内容，获取到的是 byte数组
```

----------------------------------------

TITLE: 使用Curator检测节点是否存在
DESCRIPTION: 检查节点是否存在，返回非null表示节点已创建成功。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_19

LANGUAGE: java
CODE:
```
zkClient.checkExists().forPath("/node1/00001");//不为null的话，说明节点创建成功
```

----------------------------------------

TITLE: Comparing SQL and NoSQL Databases in Markdown Table
DESCRIPTION: 这个Markdown表格比较了SQL和NoSQL数据库在各个方面的区别,包括数据存储模型、发展历程、例子、ACID属性、性能、扩展、用途和查询语法。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/nosql.md#2025-04-20_snippet_0

LANGUAGE: markdown
CODE:
```
|              | SQL 数据库                                                                 | NoSQL 数据库                                                                                                                            |
| :----------- | -------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| 数据存储模型 | 结构化存储，具有固定行和列的表格                                           | 非结构化存储。文档：JSON 文档，键值：键值对，宽列：包含行和动态列的表，图：节点和边                                                     |
| 发展历程     | 开发于 1970 年代，重点是减少数据重复                                       | 开发于 2000 年代后期，重点是提升可扩展性，减少大规模数据的存储成本                                                                      |
| 例子         | Oracle、MySQL、Microsoft SQL Server、PostgreSQL                            | 文档：MongoDB、CouchDB，键值：Redis、DynamoDB，宽列：Cassandra、 HBase，图表：Neo4j、 Amazon Neptune、Giraph                            |
| ACID 属性    | 提供原子性、一致性、隔离性和持久性 (ACID) 属性                             | 通常不支持 ACID 事务，为了可扩展、高性能进行了权衡，少部分支持比如 MongoDB 。不过，MongoDB 对 ACID 事务 的支持和 MySQL 还是有所区别的。 |
| 性能         | 性能通常取决于磁盘子系统。要获得最佳性能，通常需要优化查询、索引和表结构。 | 性能通常由底层硬件集群大小、网络延迟以及调用应用程序来决定。                                                                            |
| 扩展         | 垂直（使用性能更强大的服务器进行扩展）、读写分离、分库分表                 | 横向（增加服务器的方式横向扩展，通常是基于分片机制）                                                                                    |
| 用途         | 普通企业级的项目的数据存储                                                 | 用途广泛比如图数据库支持分析和遍历连接数据之间的关系、键值数据库可以处理大量数据扩展和极高的状态变化                                    |
| 查询语法     | 结构化查询语言 (SQL)                                                       | 数据访问语法可能因数据库而异                                                                                                            |
```

----------------------------------------

TITLE: Network Command Example - PING
DESCRIPTION: Example of using the PING command showing its basic syntax
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/network/other-network-questions.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
ping baidu.com
```

----------------------------------------

TITLE: Java Class Declaration with Helper Class
DESCRIPTION: Example of a Java file containing two class declarations in a single file - a main class with entry point and a helper class with a utility method.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java22-23.md#2025-04-20_snippet_5

LANGUAGE: java
CODE:
```
class Prog {
    public static void main(String[] args) { Helper.run(); }
}

class Helper {
    static void run() { System.out.println("Hello!"); }
}
```

----------------------------------------

TITLE: Configuring InnoDB Log File Group in MySQL
DESCRIPTION: Example configuration for setting InnoDB log file group parameters in MySQL. Note that these parameters are deprecated in MySQL 8.0.30 and later versions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-logs.md#2025-04-20_snippet_0

LANGUAGE: properties
CODE:
```
[mysqld]
innodb_log_file_size = 10485760
innodb_log_files_in_group = 64
```

----------------------------------------

TITLE: Viewing MySQL User Permissions
DESCRIPTION: Shows how to check permissions granted to a specific MySQL user.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_15

LANGUAGE: sql
CODE:
```
SHOW GRANTS FOR myuser;
```

----------------------------------------

TITLE: Processing Long Nicknames
DESCRIPTION: SQL query to handle long nicknames by truncating those over 13 characters and appending '...' while preserving shorter ones.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-05.md#2025-04-20_snippet_10

LANGUAGE: sql
CODE:
```
SELECT
	uid,
CASE
		WHEN CHAR_LENGTH( nick_name ) > 13 THEN
		CONCAT( SUBSTR( nick_name, 1, 10 ), '...' ) ELSE nick_name
	END AS nick_name
FROM
	user_info
WHERE
	CHAR_LENGTH( nick_name ) > 10
GROUP BY
	uid;
```

----------------------------------------

TITLE: 使用Curator递归删除节点及其子节点
DESCRIPTION: 删除指定节点及其所有子节点，适用于清理整个节点树的情况。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_21

LANGUAGE: java
CODE:
```
zkClient.delete().deletingChildrenIfNeeded().forPath("/node1");
```

----------------------------------------

TITLE: Installing Docker on Linux using convenience script
DESCRIPTION: 在Linux系统上使用Docker官方提供的便捷安装脚本安装Docker，这里指定使用阿里云镜像加速安装过程。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_1

LANGUAGE: shell
CODE:
```
curl -fsSL get.docker.com -o get-docker.sh
```

LANGUAGE: shell
CODE:
```
sh get-docker.sh --mirror Aliyun
```

----------------------------------------

TITLE: Docker image removal commands
DESCRIPTION: 删除Docker镜像的各种命令，包括通过名称、版本标签或ID删除，以及强制删除和批量删除的方法。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_7

LANGUAGE: shell
CODE:
```
docker image rm MySQL:5.5
```

LANGUAGE: shell
CODE:
```
docker image rm bf756fb1ae65
```

LANGUAGE: shell
CODE:
```
docker image rm -f bf756fb1ae65
```

LANGUAGE: shell
CODE:
```
docker rmi -f $(docker images MySQL -q)
```

----------------------------------------

TITLE: Pushing Docker Images
DESCRIPTION: Command to push a Docker image to a private registry, with Harbor used as an example registry.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_4

LANGUAGE: bash
CODE:
```
# 将镜像推送到私有镜像仓库 Harbor
# harbor.example.com是私有镜像仓库的地址，ubuntu是镜像的名称，18.04是镜像的版本标签
docker push harbor.example.com/ubuntu:18.04
```

----------------------------------------

TITLE: 配置AOF持久化的fsync策略
DESCRIPTION: 展示了Redis配置文件中三种不同的AOF持久化方式(fsync策略)，分别是always(每次写入)、everysec(每秒同步)和no(由操作系统决定)。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-02.md#2025-04-20_snippet_5

LANGUAGE: bash
CODE:
```
appendfsync always    #每次有数据修改发生时，都会调用fsync函数同步AOF文件，fsync完成后线程返回，这样会严重降低Redis的速度
appendfsync everysec  #每秒钟调用fsync函数同步一次AOF文件
appendfsync no        #让操作系统决定何时进行同步，一般为30秒一次
```

----------------------------------------

TITLE: MySQL 8.0 Query Cache Variables Output
DESCRIPTION: Shows the output of checking query cache variables in MySQL 8.0 or later, where query cache functionality has been removed. Only the have_query_cache variable remains, set to NO.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-query-cache.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
mysql> show variables like '%query_cache%';
+------------------+-------+
| Variable_name    | Value |
+------------------+-------+
| have_query_cache | NO    |
+------------------+-------+
1 row in set (0.01 sec)
```

----------------------------------------

TITLE: Kong Zipkin Plugin Configuration
DESCRIPTION: cURL command to enable and configure the Zipkin plugin for a Kong service
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/api-gateway.md#2025-04-20_snippet_1

LANGUAGE: shell
CODE:
```
$ curl -X POST http://kong:8001/services/{service}/plugins \
    --data "name=zipkin"  \
    --data "config.http_endpoint=http://your.zipkin.collector:9411/api/v2/spans" \
    --data "config.sample_ratio=0.001"
```

----------------------------------------

TITLE: Replacing Spaces in a String Using Regular Expressions in Java
DESCRIPTION: This one-line solution uses Java's replaceAll method with a regular expression to replace all spaces with "%20". It's more concise but might be less efficient for very large strings due to the internal string processing overhead.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/the-sword-refers-to-offer.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
public String replaceSpace(StringBuffer str) {
    //return str.toString().replaceAll(" ", "%20");
    //public String replaceAll(String regex,String replacement)
    //用给定的替换替换与给定的regular expression匹配的此字符串的每个子字符串。
    //\ 转义字符. 如果你要使用 "\" 本身, 则应该使用 "\\". String类型中的空格用"\s"表示，所以我这里猜测"\\s"就是代表空格的意思
    return str.toString().replaceAll("\\s", "%20");
}
```

----------------------------------------

TITLE: 查看ZooKeeper根目录下的子节点
DESCRIPTION: 使用ls命令查看ZooKeeper根目录下的所有子节点。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_7

LANGUAGE: shell
CODE:
```
[zk: 127.0.0.1:2181(CONNECTED) 37] ls /
[dubbo, ZooKeeper, node1]
```

----------------------------------------

TITLE: SQL条件查询示例
DESCRIPTION: 展示了WHERE、IN、BETWEEN等条件查询的用法
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_7

LANGUAGE: sql
CODE:
```
SELECT * FROM products
WHERE vend_id IN ('DLL01', 'BRS01');

SELECT *
FROM products
WHERE prod_price BETWEEN 3 AND 5;

SELECT prod_id, prod_name, prod_price
FROM products
WHERE vend_id = 'DLL01' AND prod_price <= 4;
```

----------------------------------------

TITLE: SQL Query for Practice Question Activity Data Extraction
DESCRIPTION: A SQL query that extracts and formats practice question activity data, similar to the exam query but for question practice records, adding a 'question' tag to differentiate the activity type.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-03.md#2025-04-20_snippet_13

LANGUAGE: SQL
CODE:
```
SELECT
		uid,
		question_id AS ans_id,
		submit_time AS act_time,
		date_format( submit_time, '%Y%m' ) AS act_month,
		date_format( submit_time, '%Y%m%d' ) AS act_day,
		'question' AS tag
	FROM
		practice_record
```

----------------------------------------

TITLE: Docker Compose PS Command Options
DESCRIPTION: Commands for viewing the status of containers started with Docker Compose, including options to display only service names or filter by specific service.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_11

LANGUAGE: bash
CODE:
```
# 查看所有容器的状态信息
docker-compose ps
# 只显示服务名称
docker-compose ps --services
# 查看指定服务的容器
docker-compose ps service_name
```

----------------------------------------

TITLE: Static import demonstration in Java
DESCRIPTION: This code snippet illustrates the usage of static import in Java. It shows how to import static members from a class and use them without class name qualification.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-keyword-summary.md#2025-04-20_snippet_4

LANGUAGE: Java
CODE:
```
 //将Math中的所有静态资源导入，这时候可以直接使用里面的静态方法，而不用通过类名进行调用
 //如果只想导入单一某个静态方法，只需要将*换成对应的方法名即可
import static java.lang.Math.*;//换成import static java.lang.Math.max;具有一样的效果
public class Demo {
  public static void main(String[] args) {
    int max = max(1,2);
    System.out.println(max);
  }
}
```

----------------------------------------

TITLE: Connecting to TCP server using netcat
DESCRIPTION: Command to connect to the previously created TCP server on localhost port 8000 using netcat. This establishes the TCP connection that will be targeted by the reset attack.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/network/network-attack-means.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
nc 127.0.0.1 8000
```

----------------------------------------

TITLE: Docker Compose Up Command Options
DESCRIPTION: Various options for the 'docker-compose up' command that allow starting containers with different configurations such as running in background, force recreation, rebuilding images, or specifying individual services.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_7

LANGUAGE: bash
CODE:
```
# 在当前目录下寻找 docker-compose.yml 文件，并根据其中定义的服务启动应用程序
docker-compose up
# 后台启动
docker-compose up -d
# 强制重新创建所有容器，即使它们已经存在
docker-compose up --force-recreate
# 重新构建镜像
docker-compose up --build
# 指定要启动的服务名称，而不是启动所有服务
# 可以同时指定多个服务，用空格分隔。
docker-compose up service_name
```

----------------------------------------

TITLE: Running MySQL 8.0.32 Docker Container with Custom Configuration
DESCRIPTION: Docker command to run a MySQL 8.0.32 container with a custom configuration file mounted.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-logs.md#2025-04-20_snippet_1

LANGUAGE: bash
CODE:
```
docker run -d -p 3312:3309 -e MYSQL_ROOT_PASSWORD=your-password -v /path/to/your/conf:/etc/mysql/conf.d --name
MySQL830 mysql:8.0.32
```

----------------------------------------

TITLE: HashMap Bin Treeification Logic (Java)
DESCRIPTION: This method in HashMap determines whether to convert a bin to a red-black tree or resize the array based on the current array size.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-questions-02.md#2025-04-20_snippet_6

LANGUAGE: Java
CODE:
```
final void treeifyBin(Node<K,V>[] tab, int hash) {
    int n, index; Node<K,V> e;
    if (tab == null || (n = tab.length) < MIN_TREEIFY_CAPACITY)
        resize();
    else if ((e = tab[index = (n - 1) & hash]) != null) {
        TreeNode<K,V> hd = null, tl = null;
        do {
            TreeNode<K,V> p = replacementTreeNode(e, null);
            if (tl == null)
                hd = p;
            else {
                p.prev = tl;
                tl.next = p;
            }
            tl = p;
        } while ((e = e.next) != null);
        if ((tab[index] = hd) != null)
            hd.treeify(tab);
    }
}
```

----------------------------------------

TITLE: 查看ZooKeeper节点子节点列表和状态
DESCRIPTION: 使用ls2命令同时查看节点node1的子节点列表和状态信息。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_10

LANGUAGE: shell
CODE:
```
[zk: 127.0.0.1:2181(CONNECTED) 7] ls2 /node1
[node1.1]
cZxid = 0x47
ctime = Sun Jan 20 10:22:59 CST 2019
mZxid = 0x47
mtime = Sun Jan 20 10:22:59 CST 2019
pZxid = 0x4a
cversion = 1
dataVersion = 0
aclVersion = 0
ephemeralOwner = 0x0
dataLength = 11
numChildren = 1
```

----------------------------------------

TITLE: Setting up TCP server using netcat
DESCRIPTION: Command to start a TCP server listening on port 8000 using netcat. This is used as part of the TCP reset attack demonstration.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/network/network-attack-means.md#2025-04-20_snippet_0

LANGUAGE: bash
CODE:
```
nc -nvl 8000
```

----------------------------------------

TITLE: Defining ReadView Class Structure in InnoDB
DESCRIPTION: The ReadView class structure from InnoDB's implementation. It contains critical fields used for transaction visibility determination, including transaction ID limits and active transaction lists that define which data versions should be visible to the current transaction.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/innodb-implementation-of-mvcc.md#2025-04-20_snippet_0

LANGUAGE: c
CODE:
```
class ReadView {
  /* ... */
private:
  trx_id_t m_low_limit_id;      /* 大于等于这个 ID 的事务均不可见 */

  trx_id_t m_up_limit_id;       /* 小于这个 ID 的事务均可见 */

  trx_id_t m_creator_trx_id;    /* 创建该 Read View 的事务ID */

  trx_id_t m_low_limit_no;      /* 事务 Number, 小于该 Number 的 Undo Logs 均可以被 Purge */

  ids_t m_ids;                  /* 创建 Read View 时的活跃事务列表 */

  m_closed;                     /* 标记 Read View 是否 close */
}
```

----------------------------------------

TITLE: Retrieving ZooKeeper Node Data and Metadata (Shell)
DESCRIPTION: Demonstrates how to use the ZooKeeper shell to retrieve data and metadata for a ZooKeeper node. This example shows the output of the 'get' command for the '/dubbo' node, including its data (null in this case) and various metadata fields.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-intro.md#2025-04-20_snippet_0

LANGUAGE: shell
CODE:
```
[zk: 127.0.0.1:2181(CONNECTED) 6] get /dubbo
# 该数据节点关联的数据内容为空
null
# 下面是该数据节点的一些状态信息，其实就是 Stat 对象的格式化输出
cZxid = 0x2
ctime = Tue Nov 27 11:05:34 CST 2018
mZxid = 0x2
mtime = Tue Nov 27 11:05:34 CST 2018
pZxid = 0x3
cversion = 1
dataVersion = 0
aclVersion = 0
ephemeralOwner = 0x0
dataLength = 0
numChildren = 1
```

----------------------------------------

TITLE: Querying MySQL Version
DESCRIPTION: Shows how to query the version of MySQL using SQL.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-questions-01.md#2025-04-20_snippet_0

LANGUAGE: sql
CODE:
```
SELECT VERSION();
```

----------------------------------------

TITLE: Query High Incompletion Rate Users Monthly Stats
DESCRIPTION: Complex SQL query to analyze exam statistics for users with high incompletion rates (top 50%) who are level 6 or 7, showing their total and completed exam counts for the last three months of activity.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-04.md#2025-04-20_snippet_11

LANGUAGE: sql
CODE:
```
SELECT t1.uid,
       t1.month_d,
       count(*) AS total_cnt,
       count(t1.submit_time) AS complete_cnt
FROM
  (SELECT UID,
          count(submit_time IS NULL OR NULL)/ count(start_time) AS num,
          PERCENT_RANK() OVER (
                               ORDER BY count(submit_time IS NULL OR NULL)/ count(start_time)) AS ranking
   FROM exam_record
   LEFT JOIN examination_info USING (exam_id)
   WHERE tag = 'SQL'
   GROUP BY UID) t
INNER JOIN
  (SELECT UID,
        date_format(start_time, '%Y%m') AS month_d,
        submit_time,
        exam_id,
        dense_rank() OVER (PARTITION BY UID
                           ORDER BY date_format(start_time, '%Y%m') DESC) AS ranking
   FROM exam_record
   LEFT JOIN user_info USING (UID)
   WHERE LEVEL IN (6,7) ) t1 USING (UID)
WHERE t1.ranking <= 3 AND t.ranking >= 0.5
GROUP BY t1.uid,
         t1.month_d
ORDER BY t1.uid,
         t1.month_d
```

----------------------------------------

TITLE: Defining Page Metadata in Markdown Frontmatter
DESCRIPTION: This snippet defines the page title, category, and meta tags for keywords and description using YAML frontmatter in a Markdown file. It sets up SEO-relevant information for the page about SQL optimization techniques.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/sql-optimization.md#2025-04-20_snippet_0

LANGUAGE: yaml
CODE:
```
---
title: 常见SQL优化手段总结（付费）
category: 高性能
head:
  - - meta
    - name: keywords
      content: 分页优化,索引,Show Profile,慢 SQL
  - - meta
    - name: description
      content: SQL 优化是一个大家都比较关注的热门话题，无论你在面试，还是工作中，都很有可能会遇到。如果某天你负责的某个线上接口，出现了性能问题，需要做优化。那么你首先想到的很有可能是优化 SQL 优化，因为它的改造成本相对于代码来说也要小得多。
---
```

----------------------------------------

TITLE: Redis设置key过期时间
DESCRIPTION: 展示了如何使用EXPIRE和SETEX命令为key设置过期时间。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-data-structures-01.md#2025-04-20_snippet_3

LANGUAGE: bash
CODE:
```
> EXPIRE key 60
(integer) 1
> SETEX key 60 value # 设置值并设置过期时间
OK
> TTL key
(integer) 56
```

----------------------------------------

TITLE: Demonstrating Controller Type Checking Without Adapter Pattern in Spring MVC
DESCRIPTION: This snippet shows the problematic approach of handling different Controller types without using the adapter pattern. It uses multiple if-else conditions to check the instance type, which violates the open-closed principle and makes the code difficult to maintain.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/spring-design-patterns-summary.md#2025-04-20_snippet_6

LANGUAGE: java
CODE:
```
if(mappedHandler.getHandler() instanceof MultiActionController){
   ((MultiActionController)mappedHandler.getHandler()).xxx
}else if(mappedHandler.getHandler() instanceof XXX){
    ...
}else if(...){
   ...
}
```

----------------------------------------

TITLE: 使用Curator获取节点的所有子节点路径
DESCRIPTION: 获取指定节点下的所有子节点路径列表，方便遍历或操作子节点。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_23

LANGUAGE: java
CODE:
```
List<String> childrenPaths = zkClient.getChildren().forPath("/node1");
```

----------------------------------------

TITLE: Incorrect Table Insert Example
DESCRIPTION: Shows the non-recommended way of inserting data without specifying column names.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-high-performance-optimization-specification-recommendations.md#2025-04-20_snippet_1

LANGUAGE: sql
CODE:
```
insert into t values ('a','b','c');
```

----------------------------------------

TITLE: Java API Documentation Code Snippet Examples
DESCRIPTION: Shows the old and new ways of including code snippets in Javadoc documentation, comparing pre-Java 18 approach with the new @snippet tag.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/new-features/java18.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
/**
 * The following code shows how to use {@code Optional.isPresent}:
 * {@snippet :
 * if (v.isPresent()) {
 *     System.out.println("v: " + v.get());
 * }
 * }
 */
```

----------------------------------------

TITLE: Redis Configuration File Policy Setting
DESCRIPTION: Example of how to set the memory eviction policy in the redis.conf configuration file.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_14

LANGUAGE: properties
CODE:
```
maxmemory-policy noeviction
```

----------------------------------------

TITLE: Github Profile Customization Markdown
DESCRIPTION: Example markdown showing how to customize Github profile page with statistics and dynamic content
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/git/github-tips.md#2025-04-20_snippet_1

LANGUAGE: markdown
CODE:
```
![个性化首页展示效果](https://oss.javaguide.cn/java-guide-blog/image-20210616221212259.png)
![通过github-readme-stats动态生成GitHub统计信息](https://oss.javaguide.cn/java-guide-blog/image-20210616221312426.png)
```

----------------------------------------

TITLE: ConcurrentHashMap Default Constructor Implementation
DESCRIPTION: Default constructor for ConcurrentHashMap that initializes with default capacity (16), load factor (0.75) and concurrency level (16).
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/concurrent-hash-map-source-code.md#2025-04-20_snippet_0

LANGUAGE: java
CODE:
```
public ConcurrentHashMap() {
    this(DEFAULT_INITIAL_CAPACITY, DEFAULT_LOAD_FACTOR, DEFAULT_CONCURRENCY_LEVEL);
}
```

----------------------------------------

TITLE: Displaying ZooKeeper Data Model Structure
DESCRIPTION: Illustrates the tree-like hierarchical data model structure used by ZooKeeper, showing znodes organized in a file system-like layout.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-plus.md#2025-04-20_snippet_0

LANGUAGE: markdown
CODE:
```
![zk数据模型](https://oss.javaguide.cn/p3-juejin/663240470d524dd4ac6e68bde0b666eb~tplv-k3u1fbpfcp-zoom-1.jpeg)
```

----------------------------------------

TITLE: 在ZooKeeper创建子节点
DESCRIPTION: 使用create命令在node1节点下创建子节点node1.1，并设置其值为123。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_4

LANGUAGE: shell
CODE:
```
[zk: 127.0.0.1:2181(CONNECTED) 1] create /node1/node1.1 123
Created /node1/node1.1
```

----------------------------------------

TITLE: Configuring MySQL Query Cache in my.cnf
DESCRIPTION: Configuration settings to enable and configure the query cache in MySQL versions prior to 8.0. These settings define the cache type and allocated memory size.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-query-cache.md#2025-04-20_snippet_2

LANGUAGE: properties
CODE:
```
query_cache_type=1
query_cache_size=600000
```

----------------------------------------

TITLE: 删除ZooKeeper节点
DESCRIPTION: 使用delete命令删除指定的节点，需要注意的是被删除节点不能有子节点。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_11

LANGUAGE: shell
CODE:
```
[zk: 127.0.0.1:2181(CONNECTED) 3] delete /node1/node1.1
```

----------------------------------------

TITLE: Illustrating ZooKeeper Watcher Mechanism
DESCRIPTION: Diagram showing how the Watcher mechanism works in ZooKeeper, with clients registering watchers and servers sending notifications on events.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-plus.md#2025-04-20_snippet_1

LANGUAGE: markdown
CODE:
```
![watcher机制](https://oss.javaguide.cn/p3-juejin/ac87b7cff7b44c63997ff0f6a7b6d2eb~tplv-k3u1fbpfcp-zoom-1.jpeg)
```

----------------------------------------

TITLE: 使用Curator删除子节点
DESCRIPTION: 删除指定的子节点，不会影响其他节点。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_20

LANGUAGE: java
CODE:
```
zkClient.delete().forPath("/node1/00001");
```

----------------------------------------

TITLE: 使用Curator创建父节点
DESCRIPTION: 先创建父节点，然后再创建子节点，避免因为父节点不存在而导致的异常。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_15

LANGUAGE: java
CODE:
```
zkClient.create().forPath("/node1");
```

----------------------------------------

TITLE: Viewing Table Structure with AUTO_INCREMENT Information in MySQL
DESCRIPTION: Command to view the table structure including the AUTO_INCREMENT value after inserting data.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-auto-increment-primary-key-continuous.md#2025-04-20_snippet_1

LANGUAGE: sql
CODE:
```
show create table
```

----------------------------------------

TITLE: Granting Specific MySQL Permissions
DESCRIPTION: Example of granting SELECT and INSERT permissions to a MySQL user.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_16

LANGUAGE: sql
CODE:
```
GRANT SELECT, INSERT ON *.* TO myuser;
```

----------------------------------------

TITLE: Creating Project Badge URLs in Markdown
DESCRIPTION: Example of using shields.io to generate project status badges in markdown format
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/git/github-tips.md#2025-04-20_snippet_0

LANGUAGE: markdown
CODE:
```
![项目徽章](https://oss.javaguide.cn/2020-11/image-20201107143136559.png)
![自定义项目徽章](https://oss.javaguide.cn/2020-11/image-20201107143502356.png)
![描述项目状态的徽章](https://oss.javaguide.cn/2020-11/image-20201107143752642.png)
```

----------------------------------------

TITLE: Initializing ThreadPoolExecutor with ArrayBlockingQueue in Java
DESCRIPTION: Example of creating a ThreadPoolExecutor with an ArrayBlockingQueue as the work queue. Shows the constructor signature including the BlockingQueue parameter.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/arrayblockingqueue-source-code.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public ThreadPoolExecutor(int corePoolSize,
                            int maximumPoolSize,
                            long keepAliveTime,
                            TimeUnit unit,
                            BlockingQueue<Runnable> workQueue,
                            ThreadFactory threadFactory,
                            RejectedExecutionHandler handler) {// ...}
```

----------------------------------------

TITLE: Querying Date and Time Data from MySQL Table
DESCRIPTION: SQL query to select and display the values from DATETIME and TIMESTAMP columns of the 'time_zone_test' table.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/some-thoughts-on-database-storage-time.md#2025-04-20_snippet_2

LANGUAGE: SQL
CODE:
```
SELECT date_time, time_stamp FROM time_zone_test;
```

----------------------------------------

TITLE: AOP Log Annotation Definition
DESCRIPTION: Custom annotation definition for logging aspect implementation in Spring AOP
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/framework/spring/ioc-and-aop.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
@Target({ElementType.PARAMETER,ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface Log {
    String description() default "";
    MethodType methodType() default MethodType.OTHER;
}
```

----------------------------------------

TITLE: 在ZooKeeper根目录创建节点
DESCRIPTION: 使用create命令在ZooKeeper根目录创建节点node1，并设置其值为"node1"。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_3

LANGUAGE: shell
CODE:
```
[zk: 127.0.0.1:2181(CONNECTED) 34] create /node1 "node1"
```

----------------------------------------

TITLE: Byte Size Conversion Table
DESCRIPTION: A simple conversion table showing the relationships between different byte-based units of digital information.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-logs.md#2025-04-20_snippet_2

LANGUAGE: java
CODE:
```
1 Byte = 8bit
1 KB = 1024 Byte
1 MB = 1024 KB
1 GB = 1024 MB
1 TB = 1024 GB
```

----------------------------------------

TITLE: 使用Redis-CLI的--bigkeys参数查找大键
DESCRIPTION: 使用Redis自带的命令行工具通过--bigkeys参数扫描整个键空间，查找最大的键及每种键类型的平均大小。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-02.md#2025-04-20_snippet_6

LANGUAGE: bash
CODE:
```
# redis-cli -p 6379 --bigkeys

# Scanning the entire keyspace to find biggest keys as well as
# average sizes per key type.  You can use -i 0.1 to sleep 0.1 sec
```

----------------------------------------

TITLE: Setting MySQL Session Time Zone
DESCRIPTION: SQL command to change the time zone of the current MySQL session to UTC+8.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/some-thoughts-on-database-storage-time.md#2025-04-20_snippet_3

LANGUAGE: SQL
CODE:
```
SET time_zone = '+8:00';
```

----------------------------------------

TITLE: Hello World Servlet Implementation
DESCRIPTION: Sample Java servlet code demonstrating a basic web application that can be deployed to a Docker container.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_11

LANGUAGE: java
CODE:
```
public class HelloServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        resp.getWriter().println("Hello World!");
    }

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        doGet(req,resp);
    }
}
```

----------------------------------------

TITLE: Creating MySQL Stored Procedure
DESCRIPTION: Example of creating a stored procedure that adds two numbers with input and output parameters.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-syntax-summary.md#2025-04-20_snippet_19

LANGUAGE: sql
CODE:
```
DROP PROCEDURE IF EXISTS `proc_adder`;
DELIMITER ;;
CREATE DEFINER=`root`@`localhost` PROCEDURE `proc_adder`(IN a int, IN b int, OUT sum int)
BEGIN
    DECLARE c int;
    if a is null then set a = 0;
    end if;

    if b is null then set b = 0;
    end if;

    set sum  = a + b;
END
;;
DELIMITER ;
```

----------------------------------------

TITLE: StampedLock Class Declaration
DESCRIPTION: Basic class declaration of StampedLock showing it implements Serializable interface.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-concurrent-questions-02.md#2025-04-20_snippet_15

LANGUAGE: java
CODE:
```
public class StampedLock implements java.io.Serializable {
}
```

----------------------------------------

TITLE: Date Comparison Non-Recommended Example
DESCRIPTION: Shows the inefficient way of comparing dates using functions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/mysql/mysql-high-performance-optimization-specification-recommendations.md#2025-04-20_snippet_4

LANGUAGE: sql
CODE:
```
where date(create_time)='20190101'
```

----------------------------------------

TITLE: Defining a Simple Student Class in Java
DESCRIPTION: A basic Java class definition for a Student object with a name property and a method to print the name.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-intro.md#2025-04-20_snippet_0

LANGUAGE: Java
CODE:
```
public class Student {
    private String name;
    
    public Student(String name) {
        this.name = name;
    }
    
    public void sayName() {
        System.out.println(name);
    }
}
```

----------------------------------------

TITLE: Embedding WeChat QR Code Image in Markdown
DESCRIPTION: Markdown image syntax used to display the JavaGuide official WeChat public account QR code from a remote image URL.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/snippets/article-footer.snippet.md#2025-04-20_snippet_0

LANGUAGE: markdown
CODE:
```
![JavaGuide 官方公众号](https://oss.javaguide.cn/github/javaguide/gongzhonghaoxuanchuan.png)
```

----------------------------------------

TITLE: Multiple Row Insertion in SQL with Specified Fields
DESCRIPTION: Demonstrates how to insert multiple exam records with specified fields into an exam_record table. The example shows proper datetime handling and NULL value usage.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_0

LANGUAGE: SQL
CODE:
```
INSERT INTO exam_record (uid, exam_id, start_time, submit_time, score) VALUES
(1001, 9001, '2021-09-01 22:11:12', '2021-09-01 23:01:12', 90),
(1002, 9002, '2021-09-04 07:01:02', NULL, NULL);
```

----------------------------------------

TITLE: Example CDN Timestamp Anti-theft URL Format
DESCRIPTION: Demonstrates the structure of a CDN URL with timestamp-based anti-theft protection, including the secret signature and expiration time parameters.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-performance/cdn.md#2025-04-20_snippet_0

LANGUAGE: plain
CODE:
```
http://cdn.wangsu.com/4/123.mp3? wsSecret=79aead3bd7b5db4adeffb93a010298b5&wsTime=1601026312
```

----------------------------------------

TITLE: Redis Expiration Keys Per Loop Constant
DESCRIPTION: This code defines the constant that specifies how many keys Redis checks for expiration in each iteration during the active expiry cycle, set to 20 in Redis 7.2 version.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/redis/redis-questions-01.md#2025-04-20_snippet_9

LANGUAGE: c
CODE:
```
#define ACTIVE_EXPIRE_CYCLE_KEYS_PER_LOOP 20 /* Keys for each DB loop. */
```

----------------------------------------

TITLE: 进入ZooKeeper容器的bin目录
DESCRIPTION: 进入ZooKeeper容器内的bin目录，准备连接ZooKeeper服务。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/distributed-process-coordination/zookeeper/zookeeper-in-action.md#2025-04-20_snippet_2

LANGUAGE: bash
CODE:
```
root@eaf70fc620cb:/apache-zookeeper-3.5.8-bin# cd bin
```

----------------------------------------

TITLE: Markdown Front Matter Configuration
DESCRIPTION: YAML front matter configuration for the FAQ page defining title, category and icon.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/javaguide/faq.md#2025-04-20_snippet_0

LANGUAGE: yaml
CODE:
```
---
title: 常见问题
category: 走近项目
icon: help
---
```

----------------------------------------

TITLE: Auto Refresh Header Setting in Servlet
DESCRIPTION: Shows how to set an auto-refresh header in HttpServletResponse to redirect to a different page after 5 seconds.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/system-design/J2EE基础知识.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
Response.setHeader("Refresh","5;URL=http://localhost:8080/servlet/example.htm");
```

----------------------------------------

TITLE: Specifying Custom Docker Compose File for Down Command
DESCRIPTION: Command demonstrating how to use a custom Docker Compose file name when stopping and removing containers with the down command.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-intro.md#2025-04-20_snippet_10

LANGUAGE: bash
CODE:
```
docker-compose -f docker-compose.prod.yml down
```

----------------------------------------

TITLE: Starting Docker service on Linux
DESCRIPTION: 在Linux系统上启动Docker服务并设置开机自启。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_2

LANGUAGE: shell
CODE:
```
systemctl start docker
```

LANGUAGE: shell
CODE:
```
systemctl enable docker
```

----------------------------------------

TITLE: Docker image search command
DESCRIPTION: 用于在Docker Hub中搜索镜像的命令，可以搜索特定名称的镜像以及特定版本的镜像。
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/tools/docker/docker-in-action.md#2025-04-20_snippet_6

LANGUAGE: shell
CODE:
```
docker search MySQL
```

LANGUAGE: shell
CODE:
```
docker search MySQL:5.5
```

----------------------------------------

TITLE: Markdown Documentation of System Resilience Patterns
DESCRIPTION: A detailed markdown document explaining timeout and retry mechanisms concepts, configuration recommendations, and implementation strategies for distributed systems and microservices.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/high-availability/timeout-and-retry.md#2025-04-20_snippet_0

LANGUAGE: markdown
CODE:
```
---
title: 超时&重试详解
category: 高可用
icon: retry
---
```

----------------------------------------

TITLE: Demonstrating Buffer Operations in Java NIO
DESCRIPTION: A complete example showing the lifecycle of a CharBuffer, including creation, writing, flipping, reading, and clearing. It also includes a helper method to print the buffer's state.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/io/nio-basis.md#2025-04-20_snippet_2

LANGUAGE: Java
CODE:
```
import java.nio.*;

public class CharBufferDemo {
    public static void main(String[] args) {
        // Allocate a CharBuffer with capacity 8
        CharBuffer buffer = CharBuffer.allocate(8);
        System.out.println("Initial state:");
        printState(buffer);

        // Write 3 characters to the buffer
        buffer.put('a').put('b').put('c');
        System.out.println("State after writing 3 characters:");
        printState(buffer);

        // Call flip() to prepare for reading
        buffer.flip();
        System.out.println("State after calling flip():");
        printState(buffer);

        // Read characters
        while (buffer.hasRemaining()) {
            System.out.print(buffer.get());
        }

        // Call clear() to reset the buffer
        buffer.clear();
        System.out.println("\nState after calling clear():");
        printState(buffer);
    }

    // Print buffer's capacity, limit, position, and mark
    private static void printState(CharBuffer buffer) {
        System.out.print("capacity: " + buffer.capacity());
        System.out.print(", limit: " + buffer.limit());
        System.out.print(", position: " + buffer.position());
        System.out.print(", mark: " + buffer.mark());
        System.out.println("\n");
    }
}
```

----------------------------------------

TITLE: Static and non-static method comparison in Java
DESCRIPTION: This code snippet demonstrates the difference between static and non-static methods in Java. It shows how static methods can be called without creating an instance of the class.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/java-keyword-summary.md#2025-04-20_snippet_5

LANGUAGE: Java
CODE:
```
class Foo {
    int i;
    public Foo(int i) {
       this.i = i;
    }
    public static String method1() {
       return "An example string that doesn't depend on i (an instance variable)";
    }
    public int method2() {
       return this.i + 1;  //Depends on i
    }
}
```

----------------------------------------

TITLE: Feign Request Interceptor for Propagating TraceId
DESCRIPTION: Implementation of a Feign RequestInterceptor that adds the requestId from the current thread's MDC to outgoing HTTP requests, enabling traceId propagation in microservices architecture.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/threadlocal.md#2025-04-20_snippet_14

LANGUAGE: java
CODE:
```
@Component
@Slf4j
public class FeignInvokeInterceptor implements RequestInterceptor {

    @Override
    public void apply(RequestTemplate template) {
        String requestId = MDC.get("requestId");
        if (StringUtils.isNotBlank(requestId)) {
            template.header("requestId", requestId);
        }
    }
}
```

----------------------------------------

TITLE: Configuring Filters in Spring Cloud Gateway
DESCRIPTION: This YAML snippet shows how to configure filters in Spring Cloud Gateway. It includes a RewritePath filter to modify the request URL by removing the 'api' prefix.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/spring-cloud-gateway-questions.md#2025-04-20_snippet_1

LANGUAGE: yaml
CODE:
```
filters: #过滤器
  - RewritePath=/api/(?<segment>.*),/$\{segment} # 将跳转路径中包含的 "api" 替换成空
```

----------------------------------------

TITLE: Defining a Protocol Buffer Message in Protobuf
DESCRIPTION: A simple Protocol Buffer (protobuf) definition file example. It defines a 'Person' message with 'name' and 'age' fields, demonstrating the basic syntax of protobuf schema definition.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/serialization.md#2025-04-20_snippet_2

LANGUAGE: Protobuf
CODE:
```
syntax = "proto3";

message Person {
  string name = 1;
  int32 age = 2;
}
```

----------------------------------------

TITLE: Reversing a Linked List in Java
DESCRIPTION: Implementation for reversing a singly linked list. Uses three pointers to track previous, current and next nodes while iterating through the list to reverse the links.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/cs-basics/algorithms/linkedlist-algorithm-problems.md#2025-04-20_snippet_1

LANGUAGE: java
CODE:
```
public class ListNode {
  int val;
  ListNode next = null;

  ListNode(int val) {
    this.val = val;
  }
}
```

LANGUAGE: java
CODE:
```
public class Solution {

  public ListNode ReverseList(ListNode head) {

    ListNode next = null;
    ListNode pre = null;

    while (head != null) {
      // 保存要反转到头的那个节点
      next = head.next;
      // 要反转的那个节点指向已经反转的上一个节点(备注:第一次反转的时候会指向null)
      head.next = pre;
      // 上一个已经反转到头部的节点
      pre = head;
      // 一直向链表尾走
      head = next;
    }
    return pre;
  }

}
```

----------------------------------------

TITLE: Configuring Tomcat Single Thread Mode
DESCRIPTION: Property configuration to set Tomcat web server to single thread mode. This is generally not recommended for production use as it severely limits concurrent request handling capability.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/concurrent/java-thread-pool-best-practices.md#2025-04-20_snippet_4

LANGUAGE: properties
CODE:
```
server.tomcat.max-threads=1
```

----------------------------------------

TITLE: Creating a TCP Socket in C
DESCRIPTION: This code snippet demonstrates how to create a TCP socket using the socket() function in C. It specifies the use of IPv4 (AF_INET) and TCP protocol (SOCK_STREAM).
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/distributed-system/rpc/http&rpc.md#2025-04-20_snippet_0

LANGUAGE: ini
CODE:
```
fd = socket(AF_INET,SOCK_STREAM,0);
```

----------------------------------------

TITLE: Displaying Star History Graph for JavaGuide Repository in Markdown
DESCRIPTION: This snippet displays a graph showing the star history of the JavaGuide repository using an external API. It includes the image description and the URL to generate the graph.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/README.md#2025-04-20_snippet_1

LANGUAGE: Markdown
CODE:
```
![Stars](https://api.star-history.com/svg?repos=Snailclimb/JavaGuide&type=Date)
```

----------------------------------------

TITLE: DELETE with Time Difference Calculation
DESCRIPTION: Demonstrates two approaches to delete records based on time difference calculations using TIMEDIFF and TIMESTAMPDIFF functions.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/database/sql/sql-questions-02.md#2025-04-20_snippet_5

LANGUAGE: SQL
CODE:
```
DELETE FROM exam_record WHERE MINUTE (TIMEDIFF(submit_time , start_time)) < 5 AND score < 60
```

LANGUAGE: SQL
CODE:
```
DELETE FROM exam_record WHERE TIMESTAMPDIFF(MINUTE, start_time, submit_time) < 5 AND score < 60
```

----------------------------------------

TITLE: Displaying JavaGuide Official WeChat Account Image in Markdown
DESCRIPTION: This snippet displays an image of the JavaGuide official WeChat account using Markdown syntax. It includes the image description and the URL to the image file.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/README.md#2025-04-20_snippet_0

LANGUAGE: Markdown
CODE:
```
![JavaGuide 官方公众号](https://oss.javaguide.cn/github/javaguide/gongzhonghaoxuanchuan.png)
```

----------------------------------------

TITLE: Custom Array to ArrayList Conversion Utility
DESCRIPTION: Shows a manual implementation of array to ArrayList conversion that supports modification operations.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/collection/java-collection-precautions-for-use.md#2025-04-20_snippet_9

LANGUAGE: java
CODE:
```
static <T> List<T> arrayToList(final T[] array) {
  final List<T> l = new ArrayList<T>(array.length);

  for (final T s : array) {
    l.add(s);
  }
  return l;
}

Integer [] myArray = { 1, 2, 3 };
System.out.println(arrayToList(myArray).getClass());//class java.util.ArrayList
```

----------------------------------------

TITLE: Reference Passing Example in C++
DESCRIPTION: Illustrates true reference passing in C++ to contrast with Java's value passing mechanism.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/basis/why-there-only-value-passing-in-java.md#2025-04-20_snippet_4

LANGUAGE: C++
CODE:
```
#include <iostream>

void incr(int& num)
{
    std::cout << "incr before: " << num << "\n";
    num++;
    std::cout << "incr after: " << num << "\n";
}

int main()
{
    int age = 10;
    std::cout << "invoke before: " << age << "\n";
    incr(age);
    std::cout << "invoke after: " << age << "\n";
}
```

----------------------------------------

TITLE: Selecting Garbage Collectors in Java
DESCRIPTION: Specifies which garbage collector to use. Options include Serial, Parallel, CMS, and G1 collectors.
SOURCE: https://github.com/snailclimb/javaguide/blob/main/docs/java/jvm/jvm-parameters-intro.md#2025-04-20_snippet_5

LANGUAGE: bash
CODE:
```
-XX:+UseSerialGC
-XX:+UseParallelGC
-XX:+UseConcMarkSweepGC
-XX:+UseG1GC
```